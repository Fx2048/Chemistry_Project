1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on  6/2/24 at  0:11:07 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOBID=1729573710
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOBID=1729573710
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides, Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14758): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14779): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_oxidized.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_oxidized.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_oxidized.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR OXIDIZED PHOSPHOLIPID
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR OXIDIZED PHOSPHOLIPIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 01. 2024. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:     6/ 1/24     23:14:48      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        8   Number of residues   =     1064
         Number of atoms         =    16808   Number of groups     =     5107
         Number of bonds         =    16948   Number of angles     =    30573
         Number of dihedrals     =    44622   Number of impropers  =     2792
         Number of cross-terms   =     1048   Number of autogens   =        0
         Number of HB acceptors  =     1636   Number of HB donors  =     1899
         Number of NB exclusions =        0   Total charge =  -20.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 4668.64207
 TITLE> * CALC BOTAREA = 4544.17453
 TITLE> * CALC XMAX = 53.0976697
 TITLE> * CALC XMIN = -63.901078
 TITLE> * CALC YMAX = 49.2032461
 TITLE> * CALC YMIN = -53.8313906
 TITLE> * CALC ZMAX = 29.6192606
 TITLE> * CALC ZMIN = -33.9938086
 TITLE> *  DATE:     6/ 1/24     23:17:27      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>  16808 atoms have been selected out of  16808
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 128.065641
 Parameter: A <- "128.065641"
  
 CHARMM>     SET B        = 128.065641
 Parameter: B <- "128.065641"
  
 CHARMM>     SET C        = 108.613069
 Parameter: C <- "108.613069"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = -2.187274
 Parameter: ZCEN <- "-2.187274"
  
 CHARMM>     SET NLIPTOP  = 183
 Parameter: NLIPTOP <- "183"
  
 CHARMM>     SET NLIPBOT  = 185
 Parameter: NLIPBOT <- "185"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 36.4938086
 Parameter: WATBOXZ <- "36.4938086"
  
 CHARMM>     SET NCHARGE  = -20
 Parameter: NCHARGE <- "-20"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 01. 2024. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     6/ 2/24      0: 0: 5      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        9   Number of residues   =     1432
         Number of atoms         =    60232   Number of groups     =    15411
         Number of bonds         =    60004   Number of angles     =   113741
         Number of dihedrals     =   159806   Number of impropers  =     3528
         Number of cross-terms   =     1048   Number of autogens   =        0
         Number of HB acceptors  =     1636   Number of HB donors  =     1899
         Number of NB exclusions =        0   Total charge =  -20.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF1064 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 01. 2024. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     6/ 2/24      0: 0: 5      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  60232
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     60232 SELECTED ATOMS:
    XMIN =  -70.025230 XMAX =   70.810982 XAVE =   -0.079310
    YMIN =  -71.190795 YMAX =   69.405357 YAVE =    0.570681
    ZMIN =  -35.015952 ZMAX =   30.416522 ZAVE =   -0.057651
    WMIN =    0.000000 WMAX =    0.061048 WAVE =    0.000016
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "70.8109815"
 RDCMND substituted energy or value "?XMIN" to "-70.0252297"
Evaluating: INT((70.8109815--70.0252297+5.0)/0.5)+1
 Parameter: XDIM <- "292"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "69.405357"
 RDCMND substituted energy or value "?YMIN" to "-71.1907949"
Evaluating: INT((69.405357--71.1907949+5.0)/0.5)+1
 Parameter: YDIM <- "292"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "30.4165221"
 RDCMND substituted energy or value "?ZMIN" to "-35.0159517"
Evaluating: INT((30.4165221--35.0159517+5.0)/0.5)+1
 Parameter: ZDIM <- "141"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "292"
 Parameter: YDIM -> "292"
 Parameter: ZDIM -> "141"
Evaluating: 292*292*141
 Parameter: SPACE <- "12022224"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "12022224" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "12022224"
 SELRPN>  60232 atoms have been selected out of  60232
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -72.7652 XMAX=     73.5510 NX= 291
   YMIN=    -73.9439 YMAX=     72.1454 NY= 291
   ZMIN=    -37.7560 ZMAX=     33.1747 NZ= 141


 A TOTAL OF    19892   VACUUM POINTS WERE FOUND
 A TOTAL OF  5569528 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  6350601 EXTERNAL POINTS WERE FOUND
 A TOTAL OF 11920129 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  707225.836102
 TOTAL SELECTED  VOLUME = 1513633.327361
 TOTAL FREE      VOLUME =    2525.911771
 FRACTIONAL FREE VOLUME =       0.355887
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "707225.836"
 Parameter: SYSVOL <- "707225.836"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "128.065641"
 Parameter: B -> "128.065641"
 Parameter: C -> "108.613069"
 Parameter: SYSVOL -> "707225.836"
Evaluating: (128.065641*128.065641*108.613069)-707225.836
 Parameter: VOLUMN <- "1074116.3"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  60232
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  60232
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  60232
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-20"
Evaluating: INT(-20)
 Parameter: NCHARGE <- "-20"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-20"
Evaluating: -20
 Parameter: CGTOT <- "-20"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-20"
 Parameter: POSCHARGE -> "1"
 Comparing "-20" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-20)/1)
 Parameter: NPOS <- "20"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NEGCHARGE -> "1"
 Comparing "-20" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NPOS -> "20"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-20+20*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "20"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NPOS -> "20"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-20+20*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "20"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1074116.3"
 Parameter: NEGVAL -> "1"
Evaluating: 20+INT(0.15*6.021*0.0001*1074116.3)*1
 Parameter: NPOS <- "117"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1074116.3"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*1074116.3)*1
 Parameter: NNEG <- "97"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "117" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "97" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "117" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "117"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment  10 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =       10   Number of residues   =     1549
         Number of atoms         =    60349   Number of groups     =    15528
         Number of bonds         =    60004   Number of angles     =   113741
         Number of dihedrals     =   159806   Number of impropers  =     3528
         Number of cross-terms   =     1048   Number of autogens   =        0
         Number of HB acceptors  =     1636   Number of HB donors  =     1899
         Number of NB exclusions =        0   Total charge =   97.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    117 atoms have been selected out of  60349
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>    117 atoms have been selected out of  60349
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "97" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "97"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment  11 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =       11   Number of residues   =     1646
         Number of atoms         =    60446   Number of groups     =    15625
         Number of bonds         =    60004   Number of angles     =   113741
         Number of dihedrals     =   159806   Number of impropers  =     3528
         Number of cross-terms   =     1048   Number of autogens   =        0
         Number of HB acceptors  =     1636   Number of HB donors  =     1899
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     97 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     97 atoms have been selected out of  60446
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    214 atoms have been selected out of  60446
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    214 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "117"
 Parameter: NNEG -> "97"
Evaluating: 117+97
 Parameter: NION <- "214"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "117"
 Parameter: NPOSTOT <- "117"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "97"
 Parameter: NNEGTOT <- "97"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "214"
 Parameter: NIONTOT <- "214"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "214" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "128.065641"
 Parameter: B -> "128.065641"
 Parameter: C -> "108.613069"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =  128.06564 B    =  128.06564 C     =  108.61307
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 01. 2024. JOBID=1729573710
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 01. 2024. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "-2.187274"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000 -2.187274
 RESIDUE 1160 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE 1184 OPERATED ON BY TRANSFORMATION N1Z0Z0R1
 RESIDUE 1211 OPERATED ON BY TRANSFORMATION N1Z0Z0R1
 RESIDUE 1224 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE 1228 OPERATED ON BY TRANSFORMATION N1Z0Z0R1
 RESIDUE 1232 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE 1246 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE 1323 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE 1405 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE 1412 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE 1428 OPERATED ON BY TRANSFORMATION Z0N1Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       53.21
    2  N1Z0N1R1 has       0       0       0       52.25
    3  N1P1N1R1 has       0       0       0       53.10
    4  Z0N1N1R1 has       0       0       0       52.53
    5  Z0Z0N1R1 has       0       0       0       43.18
    6  Z0P1N1R1 has       0       0       0       52.50
    7  N1N1Z0R1 has     443     106       8        0.00
    8  N1Z0Z0R1 has    7710    1812      92        0.00
    9  N1P1Z0R1 has     775     187      12        0.00
   10  Z0N1Z0R1 has    7947    1876      83        0.00
   12  N1N1P1R1 has       0       0       0       57.49
   13  N1Z0P1R1 has       0       0       0       57.05
   14  N1P1P1R1 has       0       0       0       57.68
 Total of77321 atoms and19606 groups and 1841 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  60232 atoms have been selected out of  60446
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "1" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.976916522"
Evaluating: 128.065641*(0.976916522-0.5)
 Parameter: XPOS <- "61.0766201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.147226419"
Evaluating: 128.065641*(0.147226419-0.5)
 Parameter: YPOS <- "-45.1781748"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.149634357"
Evaluating: 108.613069*(0.149634357-0.5)+-2.187274
 Parameter: ZPOS <- "-40.2415618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.2415618" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.0766201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.0766201-0
 Parameter: XTRAN <- "61.0766201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.1781748"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.1781748-0
 Parameter: YTRAN <- "-45.1781748"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.2415618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.2415618-0
 Parameter: ZTRAN <- "-40.2415618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.0766201"
 Parameter: YTRAN -> "-45.1781748"
 Parameter: ZTRAN -> "-40.2415618"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    61.076620  -45.178175  -40.241562
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.350681136"
Evaluating: 0.350681136*360.0
 Parameter: XPHI <- "126.245209"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303619004"
Evaluating: 0.303619004*360.0
 Parameter: YPHI <- "109.302841"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28650445"
Evaluating: 0.28650445*360.0
 Parameter: ZPHI <- "103.141602"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.0766201"
 Parameter: YPOS -> "-45.1781748"
 Parameter: ZPOS -> "-40.2415618"
 Parameter: XPHI -> "126.245209"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.591242    0.806494
    0.000000   -0.806494   -0.591242

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.0766201"
 Parameter: YPOS -> "-45.1781748"
 Parameter: ZPOS -> "-40.2415618"
 Parameter: YPHI -> "109.302841"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.330561    0.000000   -0.943785
    0.000000    1.000000    0.000000
    0.943785    0.000000   -0.330561

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.0766201"
 Parameter: YPOS -> "-45.1781748"
 Parameter: ZPOS -> "-40.2415618"
 Parameter: ZPHI -> "103.141602"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.227358    0.973811    0.000000
   -0.973811   -0.227358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  103.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.076620 XMAX =   61.076620 XAVE =   61.076620
    YMIN =  -45.178175 YMAX =  -45.178175 YAVE =  -45.178175
    ZMIN =  -40.241562 ZMAX =  -40.241562 ZAVE =  -40.241562
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.0766201"
Evaluating: 61.0766201+3.5
 Parameter: XMAX <- "64.5766201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.1781748"
Evaluating: -45.1781748+3.5
 Parameter: YMAX <- "-41.6781748"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.2415618"
Evaluating: -40.2415618+3.5
 Parameter: ZMAX <- "-36.7415618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.0766201"
Evaluating: 61.0766201-3.5
 Parameter: XMIN <- "57.5766201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.1781748"
Evaluating: -45.1781748-3.5
 Parameter: YMIN <- "-48.6781748"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.2415618"
Evaluating: -40.2415618-3.5
 Parameter: ZMIN <- "-43.7415618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.5766201"
 Parameter: XMIN -> "57.5766201"
 Parameter: YMAX -> "-41.6781748"
 Parameter: YMIN -> "-48.6781748"
 Parameter: ZMAX -> "-36.7415618"
 Parameter: ZMIN -> "-43.7415618"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "2" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "2" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.98606713"
Evaluating: 128.065641*(0.98606713-0.5)
 Parameter: XPOS <- "62.2484986"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.764993616"
Evaluating: 128.065641*(0.764993616-0.5)
 Parameter: YPOS <- "33.9365773"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.17278162"
Evaluating: 108.613069*(0.17278162-0.5)+-2.187274
 Parameter: ZPOS <- "-37.7274665"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.7274665" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "62.2484986"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 62.2484986-0
 Parameter: XTRAN <- "62.2484986"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.9365773"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.9365773-0
 Parameter: YTRAN <- "33.9365773"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7274665"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.7274665-0
 Parameter: ZTRAN <- "-37.7274665"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "62.2484986"
 Parameter: YTRAN -> "33.9365773"
 Parameter: ZTRAN -> "-37.7274665"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    62.248499   33.936577  -37.727466
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313414401"
Evaluating: 0.313414401*360.0
 Parameter: XPHI <- "112.829184"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712412115"
Evaluating: 0.712412115*360.0
 Parameter: YPHI <- "256.468361"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452081773"
Evaluating: 0.452081773*360.0
 Parameter: ZPHI <- "162.749438"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "62.2484986"
 Parameter: YPOS -> "33.9365773"
 Parameter: ZPOS -> "-37.7274665"
 Parameter: XPHI -> "112.829184"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.387985    0.921666
    0.000000   -0.921666   -0.387985

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "62.2484986"
 Parameter: YPOS -> "33.9365773"
 Parameter: ZPOS -> "-37.7274665"
 Parameter: YPHI -> "256.468361"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.233982    0.000000    0.972241
    0.000000    1.000000    0.000000
   -0.972241    0.000000   -0.233982

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "62.2484986"
 Parameter: YPOS -> "33.9365773"
 Parameter: ZPOS -> "-37.7274665"
 Parameter: ZPHI -> "162.749438"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.955017    0.296551    0.000000
   -0.296551   -0.955017    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  162.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   62.248499 XMAX =   62.248499 XAVE =   62.248499
    YMIN =   33.936577 YMAX =   33.936577 YAVE =   33.936577
    ZMIN =  -37.727466 ZMAX =  -37.727466 ZAVE =  -37.727466
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "62.2484986"
Evaluating: 62.2484986+3.5
 Parameter: XMAX <- "65.7484986"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.9365773"
Evaluating: 33.9365773+3.5
 Parameter: YMAX <- "37.4365773"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7274665"
Evaluating: -37.7274665+3.5
 Parameter: ZMAX <- "-34.2274665"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "62.2484986"
Evaluating: 62.2484986-3.5
 Parameter: XMIN <- "58.7484986"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.9365773"
Evaluating: 33.9365773-3.5
 Parameter: YMIN <- "30.4365773"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7274665"
Evaluating: -37.7274665-3.5
 Parameter: ZMIN <- "-41.2274665"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.7484986"
 Parameter: XMIN -> "58.7484986"
 Parameter: YMAX -> "37.4365773"
 Parameter: YMIN -> "30.4365773"
 Parameter: ZMAX -> "-34.2274665"
 Parameter: ZMIN -> "-41.2274665"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "3" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "3" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.191924627"
Evaluating: 128.065641*(0.191924627-0.5)
 Parameter: XPOS <- "-39.4538701"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.463049928"
Evaluating: 128.065641*(0.463049928-0.5)
 Parameter: YPOS <- "-4.73203466"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.379712873"
Evaluating: 108.613069*(0.379712873-0.5)+-2.187274
 Parameter: ZPOS <- "-15.252028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.252028" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.4538701"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.4538701-0
 Parameter: XTRAN <- "-39.4538701"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.73203466"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.73203466-0
 Parameter: YTRAN <- "-4.73203466"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.252028"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.252028-0
 Parameter: ZTRAN <- "-15.252028"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.4538701"
 Parameter: YTRAN -> "-4.73203466"
 Parameter: ZTRAN -> "-15.252028"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -39.453870   -4.732035  -15.252028
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641156952"
Evaluating: 0.641156952*360.0
 Parameter: XPHI <- "230.816503"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657697887"
Evaluating: 0.657697887*360.0
 Parameter: YPHI <- "236.771239"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89587949"
Evaluating: 0.89587949*360.0
 Parameter: ZPHI <- "322.516616"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.4538701"
 Parameter: YPOS -> "-4.73203466"
 Parameter: ZPOS -> "-15.252028"
 Parameter: XPHI -> "230.816503"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.631806   -0.775127
    0.000000    0.775127   -0.631806

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.4538701"
 Parameter: YPOS -> "-4.73203466"
 Parameter: ZPOS -> "-15.252028"
 Parameter: YPHI -> "236.771239"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.547983    0.000000    0.836489
    0.000000    1.000000    0.000000
   -0.836489    0.000000   -0.547983

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.4538701"
 Parameter: YPOS -> "-4.73203466"
 Parameter: ZPOS -> "-15.252028"
 Parameter: ZPHI -> "322.516616"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.793530   -0.608531    0.000000
    0.608531    0.793530    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.453870 XMAX =  -39.453870 XAVE =  -39.453870
    YMIN =   -4.732035 YMAX =   -4.732035 YAVE =   -4.732035
    ZMIN =  -15.252028 ZMAX =  -15.252028 ZAVE =  -15.252028
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.4538701"
Evaluating: -39.4538701+3.5
 Parameter: XMAX <- "-35.9538701"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.73203466"
Evaluating: -4.73203466+3.5
 Parameter: YMAX <- "-1.23203466"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.252028"
Evaluating: -15.252028+3.5
 Parameter: ZMAX <- "-11.752028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.4538701"
Evaluating: -39.4538701-3.5
 Parameter: XMIN <- "-42.9538701"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.73203466"
Evaluating: -4.73203466-3.5
 Parameter: YMIN <- "-8.23203466"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.252028"
Evaluating: -15.252028-3.5
 Parameter: ZMIN <- "-18.752028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.9538701"
 Parameter: XMIN -> "-42.9538701"
 Parameter: YMAX -> "-1.23203466"
 Parameter: YMIN -> "-8.23203466"
 Parameter: ZMAX -> "-11.752028"
 Parameter: ZMIN -> "-18.752028"
 SELRPN>     35 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      9 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60235 POS      POT      3        POT     -9050 PROF     ILE      444      CG2           4.5283
60235 POS      POT      3        POT     -9247 PROF     ILE      456      CD            3.7980
60235 POS      POT      3        POT     -9375 PROF     LEU      467      CB            2.4946
60235 POS      POT      3        POT     -9378 PROF     LEU      467      CG            1.5668
60235 POS      POT      3        POT     -9380 PROF     LEU      467      CD1           2.0226
60235 POS      POT      3        POT     -9384 PROF     LEU      467      CD2           0.6724
60235 POS      POT      3        POT     -**** PROF     LEU      617      CD1           3.1681
60235 POS      POT      3        POT     -**** PROF     LEU      619      CD1           4.5811
60235 POS      POT      3        POT     -**** PROF     LEU      619      CD2           3.8054
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "3" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.139797772"
Evaluating: 128.065641*(0.139797772-0.5)
 Parameter: XPOS <- "-46.1295292"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.520019364"
Evaluating: 128.065641*(0.520019364-0.5)
 Parameter: YPOS <- "2.56379268"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.677584517"
Evaluating: 108.613069*(0.677584517-0.5)+-2.187274
 Parameter: ZPOS <- "17.1007254"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.1007254" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.1007254" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.453870 XMAX =  -39.453870 XAVE =  -39.453870
    YMIN =   -4.732035 YMAX =   -4.732035 YAVE =   -4.732035
    ZMIN =  -15.252028 ZMAX =  -15.252028 ZAVE =  -15.252028
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.1295292"
 RDCMND substituted energy or value "?XAVE" to "-39.4538701"
Evaluating: -46.1295292--39.4538701
 Parameter: XTRAN <- "-6.6756591"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.56379268"
 RDCMND substituted energy or value "?YAVE" to "-4.73203466"
Evaluating: 2.56379268--4.73203466
 Parameter: YTRAN <- "7.29582734"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.1007254"
 RDCMND substituted energy or value "?ZAVE" to "-15.252028"
Evaluating: 17.1007254--15.252028
 Parameter: ZTRAN <- "32.3527534"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.6756591"
 Parameter: YTRAN -> "7.29582734"
 Parameter: ZTRAN -> "32.3527534"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -6.675659    7.295827   32.352753
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345176867"
Evaluating: 0.345176867*360.0
 Parameter: XPHI <- "124.263672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.285092196"
Evaluating: 0.285092196*360.0
 Parameter: YPHI <- "102.633191"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670318419"
Evaluating: 0.670318419*360.0
 Parameter: ZPHI <- "241.314631"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.1295292"
 Parameter: YPOS -> "2.56379268"
 Parameter: ZPOS -> "17.1007254"
 Parameter: XPHI -> "124.263672"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.563002    0.826455
    0.000000   -0.826455   -0.563002

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.1295292"
 Parameter: YPOS -> "2.56379268"
 Parameter: ZPOS -> "17.1007254"
 Parameter: YPHI -> "102.633191"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.218709    0.000000   -0.975790
    0.000000    1.000000    0.000000
    0.975790    0.000000   -0.218709

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.1295292"
 Parameter: YPOS -> "2.56379268"
 Parameter: ZPOS -> "17.1007254"
 Parameter: ZPHI -> "241.314631"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.479999   -0.877269    0.000000
    0.877269   -0.479999    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.129529 XMAX =  -46.129529 XAVE =  -46.129529
    YMIN =    2.563793 YMAX =    2.563793 YAVE =    2.563793
    ZMIN =   17.100725 ZMAX =   17.100725 ZAVE =   17.100725
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.1295292"
Evaluating: -46.1295292+3.5
 Parameter: XMAX <- "-42.6295292"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.56379268"
Evaluating: 2.56379268+3.5
 Parameter: YMAX <- "6.06379268"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.1007254"
Evaluating: 17.1007254+3.5
 Parameter: ZMAX <- "20.6007254"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.1295292"
Evaluating: -46.1295292-3.5
 Parameter: XMIN <- "-49.6295292"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.56379268"
Evaluating: 2.56379268-3.5
 Parameter: YMIN <- "-0.93620732"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.1007254"
Evaluating: 17.1007254-3.5
 Parameter: ZMIN <- "13.6007254"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.6295292"
 Parameter: XMIN -> "-49.6295292"
 Parameter: YMAX -> "6.06379268"
 Parameter: YMIN -> "-0.93620732"
 Parameter: ZMAX -> "20.6007254"
 Parameter: ZMIN -> "13.6007254"
 SELRPN>      8 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      2 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60235 POS      POT      3        POT     -**** PROF     LYS      522      CE            2.7480
60235 POS      POT      3        POT     -**** PROF     LYS      522      NZ            3.2471
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "3" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.92397768"
Evaluating: 128.065641*(0.92397768-0.5)
 Parameter: XPOS <- "54.2969734"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.722265456"
Evaluating: 128.065641*(0.722265456-0.5)
 Parameter: YPOS <- "28.4645681"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.287336787"
Evaluating: 108.613069*(0.287336787-0.5)+-2.187274
 Parameter: ZPOS <- "-25.2852782"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.2852782" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.129529 XMAX =  -46.129529 XAVE =  -46.129529
    YMIN =    2.563793 YMAX =    2.563793 YAVE =    2.563793
    ZMIN =   17.100725 ZMAX =   17.100725 ZAVE =   17.100725
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.2969734"
 RDCMND substituted energy or value "?XAVE" to "-46.1295292"
Evaluating: 54.2969734--46.1295292
 Parameter: XTRAN <- "100.426503"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.4645681"
 RDCMND substituted energy or value "?YAVE" to "2.56379268"
Evaluating: 28.4645681-2.56379268
 Parameter: YTRAN <- "25.9007754"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.2852782"
 RDCMND substituted energy or value "?ZAVE" to "17.1007254"
Evaluating: -25.2852782-17.1007254
 Parameter: ZTRAN <- "-42.3860036"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "100.426503"
 Parameter: YTRAN -> "25.9007754"
 Parameter: ZTRAN -> "-42.3860036"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   100.426503   25.900775  -42.386004
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907454313"
Evaluating: 0.907454313*360.0
 Parameter: XPHI <- "326.683553"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956153377"
Evaluating: 0.956153377*360.0
 Parameter: YPHI <- "344.215216"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336668522"
Evaluating: 0.336668522*360.0
 Parameter: ZPHI <- "121.200668"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.2969734"
 Parameter: YPOS -> "28.4645681"
 Parameter: ZPOS -> "-25.2852782"
 Parameter: XPHI -> "326.683553"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.835650   -0.549263
    0.000000    0.549263    0.835650

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.2969734"
 Parameter: YPOS -> "28.4645681"
 Parameter: ZPOS -> "-25.2852782"
 Parameter: YPHI -> "344.215216"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.962290    0.000000    0.272025
    0.000000    1.000000    0.000000
   -0.272025    0.000000    0.962290

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.2969734"
 Parameter: YPOS -> "28.4645681"
 Parameter: ZPOS -> "-25.2852782"
 Parameter: ZPHI -> "121.200668"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.518037    0.855358    0.000000
   -0.855358   -0.518037    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.296973 XMAX =   54.296973 XAVE =   54.296973
    YMIN =   28.464568 YMAX =   28.464568 YAVE =   28.464568
    ZMIN =  -25.285278 ZMAX =  -25.285278 ZAVE =  -25.285278
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.2969732"
Evaluating: 54.2969732+3.5
 Parameter: XMAX <- "57.7969732"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.4645678"
Evaluating: 28.4645678+3.5
 Parameter: YMAX <- "31.9645678"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.2852783"
Evaluating: -25.2852783+3.5
 Parameter: ZMAX <- "-21.7852783"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.2969732"
Evaluating: 54.2969732-3.5
 Parameter: XMIN <- "50.7969732"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.4645678"
Evaluating: 28.4645678-3.5
 Parameter: YMIN <- "24.9645678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.2852783"
Evaluating: -25.2852783-3.5
 Parameter: ZMIN <- "-28.7852783"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.7969732"
 Parameter: XMIN -> "50.7969732"
 Parameter: YMAX -> "31.9645678"
 Parameter: YMIN -> "24.9645678"
 Parameter: ZMAX -> "-21.7852783"
 Parameter: ZMIN -> "-28.7852783"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "4" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "4" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.122138285"
Evaluating: 128.065641*(0.122138285-0.5)
 Parameter: XPOS <- "-48.3911027"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.483059447"
Evaluating: 128.065641*(0.483059447-0.5)
 Parameter: YPOS <- "-2.16950278"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.685643084"
Evaluating: 108.613069*(0.685643084-0.5)+-2.187274
 Parameter: ZPOS <- "17.9759911"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.9759911" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.9759911" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.3911027"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.3911027-0
 Parameter: XTRAN <- "-48.3911027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.16950278"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.16950278-0
 Parameter: YTRAN <- "-2.16950278"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.9759911"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.9759911-0
 Parameter: ZTRAN <- "17.9759911"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.3911027"
 Parameter: YTRAN -> "-2.16950278"
 Parameter: ZTRAN -> "17.9759911"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -48.391103   -2.169503   17.975991
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120229748"
Evaluating: 0.120229748*360.0
 Parameter: XPHI <- "43.2827093"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409052562"
Evaluating: 0.409052562*360.0
 Parameter: YPHI <- "147.258922"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945683344"
Evaluating: 0.945683344*360.0
 Parameter: ZPHI <- "340.446004"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.3911027"
 Parameter: YPOS -> "-2.16950278"
 Parameter: ZPOS -> "17.9759911"
 Parameter: XPHI -> "43.2827093"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.727980    0.685599
    0.000000   -0.685599    0.727980

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.3911027"
 Parameter: YPOS -> "-2.16950278"
 Parameter: ZPOS -> "17.9759911"
 Parameter: YPHI -> "147.258922"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.841123    0.000000   -0.540843
    0.000000    1.000000    0.000000
    0.540843    0.000000   -0.841123

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  147.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.3911027"
 Parameter: YPOS -> "-2.16950278"
 Parameter: ZPOS -> "17.9759911"
 Parameter: ZPHI -> "340.446004"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.942326   -0.334695    0.000000
    0.334695    0.942326    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.391103 XMAX =  -48.391103 XAVE =  -48.391103
    YMIN =   -2.169503 YMAX =   -2.169503 YAVE =   -2.169503
    ZMIN =   17.975991 ZMAX =   17.975991 ZAVE =   17.975991
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.3911027"
Evaluating: -48.3911027+3.5
 Parameter: XMAX <- "-44.8911027"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.16950278"
Evaluating: -2.16950278+3.5
 Parameter: YMAX <- "1.33049722"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.9759911"
Evaluating: 17.9759911+3.5
 Parameter: ZMAX <- "21.4759911"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.3911027"
Evaluating: -48.3911027-3.5
 Parameter: XMIN <- "-51.8911027"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.16950278"
Evaluating: -2.16950278-3.5
 Parameter: YMIN <- "-5.66950278"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.9759911"
Evaluating: 17.9759911-3.5
 Parameter: ZMIN <- "14.4759911"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.8911027"
 Parameter: XMIN -> "-51.8911027"
 Parameter: YMAX -> "1.33049722"
 Parameter: YMIN -> "-5.66950278"
 Parameter: ZMAX -> "21.4759911"
 Parameter: ZMIN -> "14.4759911"
 SELRPN>     12 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      5 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60236 POS      POT      4        POT     -**** PROF     LYS      522      CB            4.7471
60236 POS      POT      4        POT     -**** PROF     LYS      522      CG            4.0233
60236 POS      POT      4        POT     -**** PROF     GLN      527      CA            5.0896
60236 POS      POT      4        POT     -**** PROF     GLN      527      CB            3.5466
60236 POS      POT      4        POT     -**** PROF     GLN      527      CG            3.3297
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "4" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.848310434"
Evaluating: 128.065641*(0.848310434-0.5)
 Parameter: XPOS <- "44.606599"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.465982895"
Evaluating: 128.065641*(0.465982895-0.5)
 Parameter: YPOS <- "-4.35642236"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.973153345"
Evaluating: 108.613069*(0.973153345-0.5)+-2.187274
 Parameter: ZPOS <- "49.2033629"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.2033629" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.2033629" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.391103 XMAX =  -48.391103 XAVE =  -48.391103
    YMIN =   -2.169503 YMAX =   -2.169503 YAVE =   -2.169503
    ZMIN =   17.975991 ZMAX =   17.975991 ZAVE =   17.975991
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.606599"
 RDCMND substituted energy or value "?XAVE" to "-48.3911027"
Evaluating: 44.606599--48.3911027
 Parameter: XTRAN <- "92.9977017"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.35642236"
 RDCMND substituted energy or value "?YAVE" to "-2.16950278"
Evaluating: -4.35642236--2.16950278
 Parameter: YTRAN <- "-2.18691958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.2033629"
 RDCMND substituted energy or value "?ZAVE" to "17.9759911"
Evaluating: 49.2033629-17.9759911
 Parameter: ZTRAN <- "31.2273718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "92.9977017"
 Parameter: YTRAN -> "-2.18691958"
 Parameter: ZTRAN -> "31.2273718"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    92.997702   -2.186920   31.227372
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104427674"
Evaluating: 0.104427674*360.0
 Parameter: XPHI <- "37.5939626"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.864537986E-03"
Evaluating: 5.864537986E-03*360.0
 Parameter: YPHI <- "2.11123367"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.152286889"
Evaluating: 0.152286889*360.0
 Parameter: ZPHI <- "54.82328"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.606599"
 Parameter: YPOS -> "-4.35642236"
 Parameter: ZPOS -> "49.2033629"
 Parameter: XPHI -> "37.5939626"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.792354    0.610062
    0.000000   -0.610062    0.792354

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.606599"
 Parameter: YPOS -> "-4.35642236"
 Parameter: ZPOS -> "49.2033629"
 Parameter: YPHI -> "2.11123367"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999321    0.000000   -0.036840
    0.000000    1.000000    0.000000
    0.036840    0.000000    0.999321

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.606599"
 Parameter: YPOS -> "-4.35642236"
 Parameter: ZPOS -> "49.2033629"
 Parameter: ZPHI -> "54.82328"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.576100    0.817379    0.000000
   -0.817379    0.576100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.606599 XMAX =   44.606599 XAVE =   44.606599
    YMIN =   -4.356422 YMAX =   -4.356422 YAVE =   -4.356422
    ZMIN =   49.203363 ZMAX =   49.203363 ZAVE =   49.203363
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.606599"
Evaluating: 44.606599+3.5
 Parameter: XMAX <- "48.106599"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.35642236"
Evaluating: -4.35642236+3.5
 Parameter: YMAX <- "-0.85642236"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.2033629"
Evaluating: 49.2033629+3.5
 Parameter: ZMAX <- "52.7033629"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.606599"
Evaluating: 44.606599-3.5
 Parameter: XMIN <- "41.106599"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.35642236"
Evaluating: -4.35642236-3.5
 Parameter: YMIN <- "-7.85642236"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.2033629"
Evaluating: 49.2033629-3.5
 Parameter: ZMIN <- "45.7033629"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.106599"
 Parameter: XMIN -> "41.106599"
 Parameter: YMAX -> "-0.85642236"
 Parameter: YMIN -> "-7.85642236"
 Parameter: ZMAX -> "52.7033629"
 Parameter: ZMIN -> "45.7033629"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "5" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "5" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.408541058"
Evaluating: 128.065641*(0.408541058-0.5)
 Parameter: XPOS <- "-11.712748"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.526327441"
Evaluating: 128.065641*(0.526327441-0.5)
 Parameter: YPOS <- "3.37164061"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.461280496E-02"
Evaluating: 108.613069*(1.461280496E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-54.9066669"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.9066669" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.712748"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.712748-0
 Parameter: XTRAN <- "-11.712748"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.37164061"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.37164061-0
 Parameter: YTRAN <- "3.37164061"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.9066669"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.9066669-0
 Parameter: ZTRAN <- "-54.9066669"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.712748"
 Parameter: YTRAN -> "3.37164061"
 Parameter: ZTRAN -> "-54.9066669"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -11.712748    3.371641  -54.906667
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343423583"
Evaluating: 0.343423583*360.0
 Parameter: XPHI <- "123.63249"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.849231616"
Evaluating: 0.849231616*360.0
 Parameter: YPHI <- "305.723382"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173665262"
Evaluating: 0.173665262*360.0
 Parameter: ZPHI <- "62.5194943"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.712748"
 Parameter: YPOS -> "3.37164061"
 Parameter: ZPOS -> "-54.9066669"
 Parameter: XPHI -> "123.63249"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.553864    0.832607
    0.000000   -0.832607   -0.553864

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.712748"
 Parameter: YPOS -> "3.37164061"
 Parameter: ZPOS -> "-54.9066669"
 Parameter: YPHI -> "305.723382"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.583873    0.000000    0.811845
    0.000000    1.000000    0.000000
   -0.811845    0.000000    0.583873

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.712748"
 Parameter: YPOS -> "3.37164061"
 Parameter: ZPOS -> "-54.9066669"
 Parameter: ZPHI -> "62.5194943"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.461447    0.887168    0.000000
   -0.887168    0.461447    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.712748 XMAX =  -11.712748 XAVE =  -11.712748
    YMIN =    3.371641 YMAX =    3.371641 YAVE =    3.371641
    ZMIN =  -54.906667 ZMAX =  -54.906667 ZAVE =  -54.906667
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.712748"
Evaluating: -11.712748+3.5
 Parameter: XMAX <- "-8.212748"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.37164061"
Evaluating: 3.37164061+3.5
 Parameter: YMAX <- "6.87164061"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.9066669"
Evaluating: -54.9066669+3.5
 Parameter: ZMAX <- "-51.4066669"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.712748"
Evaluating: -11.712748-3.5
 Parameter: XMIN <- "-15.212748"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.37164061"
Evaluating: 3.37164061-3.5
 Parameter: YMIN <- "-0.12835939"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.9066669"
Evaluating: -54.9066669-3.5
 Parameter: ZMIN <- "-58.4066669"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.212748"
 Parameter: XMIN -> "-15.212748"
 Parameter: YMAX -> "6.87164061"
 Parameter: YMIN -> "-0.12835939"
 Parameter: ZMAX -> "-51.4066669"
 Parameter: ZMIN -> "-58.4066669"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "6" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "6" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.874373303"
Evaluating: 128.065641*(0.874373303-0.5)
 Parameter: XPOS <- "47.944357"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.321517509"
Evaluating: 128.065641*(0.321517509-0.5)
 Parameter: YPOS <- "-22.8574746"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "8.128207516E-02"
Evaluating: 108.613069*(8.128207516E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-47.6655129"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.6655129" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.944357"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.944357-0
 Parameter: XTRAN <- "47.944357"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.8574746"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.8574746-0
 Parameter: YTRAN <- "-22.8574746"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.6655129"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.6655129-0
 Parameter: ZTRAN <- "-47.6655129"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.944357"
 Parameter: YTRAN -> "-22.8574746"
 Parameter: ZTRAN -> "-47.6655129"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    47.944357  -22.857475  -47.665513
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.770542591E-02"
Evaluating: 9.770542591E-02*360.0
 Parameter: XPHI <- "35.1739533"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671739261"
Evaluating: 0.671739261*360.0
 Parameter: YPHI <- "241.826134"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.422249803"
Evaluating: 0.422249803*360.0
 Parameter: ZPHI <- "152.009929"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.944357"
 Parameter: YPOS -> "-22.8574746"
 Parameter: ZPOS -> "-47.6655129"
 Parameter: XPHI -> "35.1739533"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.817407    0.576061
    0.000000   -0.576061    0.817407

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.944357"
 Parameter: YPOS -> "-22.8574746"
 Parameter: ZPOS -> "-47.6655129"
 Parameter: YPHI -> "241.826134"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.472149    0.000000    0.881519
    0.000000    1.000000    0.000000
   -0.881519    0.000000   -0.472149

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.944357"
 Parameter: YPOS -> "-22.8574746"
 Parameter: ZPOS -> "-47.6655129"
 Parameter: ZPHI -> "152.009929"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.883029    0.469319    0.000000
   -0.469319   -0.883029    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  152.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.944357 XMAX =   47.944357 XAVE =   47.944357
    YMIN =  -22.857475 YMAX =  -22.857475 YAVE =  -22.857475
    ZMIN =  -47.665513 ZMAX =  -47.665513 ZAVE =  -47.665513
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.944357"
Evaluating: 47.944357+3.5
 Parameter: XMAX <- "51.444357"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.8574746"
Evaluating: -22.8574746+3.5
 Parameter: YMAX <- "-19.3574746"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.6655129"
Evaluating: -47.6655129+3.5
 Parameter: ZMAX <- "-44.1655129"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.944357"
Evaluating: 47.944357-3.5
 Parameter: XMIN <- "44.444357"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.8574746"
Evaluating: -22.8574746-3.5
 Parameter: YMIN <- "-26.3574746"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.6655129"
Evaluating: -47.6655129-3.5
 Parameter: ZMIN <- "-51.1655129"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.444357"
 Parameter: XMIN -> "44.444357"
 Parameter: YMAX -> "-19.3574746"
 Parameter: YMIN -> "-26.3574746"
 Parameter: ZMAX -> "-44.1655129"
 Parameter: ZMIN -> "-51.1655129"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "7" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "7" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.35456822"
Evaluating: 128.065641*(0.35456822-0.5)
 Parameter: XPOS <- "-18.6248141"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.45747727"
Evaluating: 128.065641*(0.45747727-0.5)
 Parameter: YPOS <- "-5.44570067"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.341199576"
Evaluating: 108.613069*(0.341199576-0.5)+-2.187274
 Parameter: ZPOS <- "-19.4350754"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.4350754" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.6248141"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.6248141-0
 Parameter: XTRAN <- "-18.6248141"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.44570067"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.44570067-0
 Parameter: YTRAN <- "-5.44570067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.4350754"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.4350754-0
 Parameter: ZTRAN <- "-19.4350754"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.6248141"
 Parameter: YTRAN -> "-5.44570067"
 Parameter: ZTRAN -> "-19.4350754"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -18.624814   -5.445701  -19.435075
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918998093"
Evaluating: 0.918998093*360.0
 Parameter: XPHI <- "330.839313"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84582912"
Evaluating: 0.84582912*360.0
 Parameter: YPHI <- "304.498483"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37773879"
Evaluating: 0.37773879*360.0
 Parameter: ZPHI <- "135.985964"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.6248141"
 Parameter: YPOS -> "-5.44570067"
 Parameter: ZPOS -> "-19.4350754"
 Parameter: XPHI -> "330.839313"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.873257   -0.487261
    0.000000    0.487261    0.873257

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.6248141"
 Parameter: YPOS -> "-5.44570067"
 Parameter: ZPOS -> "-19.4350754"
 Parameter: YPHI -> "304.498483"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.566384    0.000000    0.824141
    0.000000    1.000000    0.000000
   -0.824141    0.000000    0.566384

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   55.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.6248141"
 Parameter: YPOS -> "-5.44570067"
 Parameter: ZPOS -> "-19.4350754"
 Parameter: ZPHI -> "135.985964"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.719170    0.694835    0.000000
   -0.694835   -0.719170    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.624814 XMAX =  -18.624814 XAVE =  -18.624814
    YMIN =   -5.445701 YMAX =   -5.445701 YAVE =   -5.445701
    ZMIN =  -19.435075 ZMAX =  -19.435075 ZAVE =  -19.435075
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.6248141"
Evaluating: -18.6248141+3.5
 Parameter: XMAX <- "-15.1248141"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.44570067"
Evaluating: -5.44570067+3.5
 Parameter: YMAX <- "-1.94570067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.4350754"
Evaluating: -19.4350754+3.5
 Parameter: ZMAX <- "-15.9350754"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.6248141"
Evaluating: -18.6248141-3.5
 Parameter: XMIN <- "-22.1248141"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.44570067"
Evaluating: -5.44570067-3.5
 Parameter: YMIN <- "-8.94570067"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.4350754"
Evaluating: -19.4350754-3.5
 Parameter: ZMIN <- "-22.9350754"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.1248141"
 Parameter: XMIN -> "-22.1248141"
 Parameter: YMAX -> "-1.94570067"
 Parameter: YMIN -> "-8.94570067"
 Parameter: ZMAX -> "-15.9350754"
 Parameter: ZMIN -> "-22.9350754"
 SELRPN>     17 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     11 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      C12           3.9335
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      C11           3.0111
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      P             2.2708
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      O13           3.0005
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      O14           2.0623
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      O11           3.6620
60239 POS      POT      7        POT     -**** MEMB     DMPC     200      O12           1.9471
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "7" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.736763552"
Evaluating: 128.065641*(0.736763552-0.5)
 Parameter: XPOS <- "30.3212761"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.379301398E-02"
Evaluating: 128.065641*(7.379301398E-02-0.5)
 Parameter: YPOS <- "-54.5824709"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.956692914"
Evaluating: 108.613069*(0.956692914-0.5)+-2.187274
 Parameter: ZPOS <- "47.415545"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.415545" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.415545" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.624814 XMAX =  -18.624814 XAVE =  -18.624814
    YMIN =   -5.445701 YMAX =   -5.445701 YAVE =   -5.445701
    ZMIN =  -19.435075 ZMAX =  -19.435075 ZAVE =  -19.435075
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.3212761"
 RDCMND substituted energy or value "?XAVE" to "-18.6248141"
Evaluating: 30.3212761--18.6248141
 Parameter: XTRAN <- "48.9460902"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.5824709"
 RDCMND substituted energy or value "?YAVE" to "-5.44570067"
Evaluating: -54.5824709--5.44570067
 Parameter: YTRAN <- "-49.1367702"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.415545"
 RDCMND substituted energy or value "?ZAVE" to "-19.4350754"
Evaluating: 47.415545--19.4350754
 Parameter: ZTRAN <- "66.8506204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.9460902"
 Parameter: YTRAN -> "-49.1367702"
 Parameter: ZTRAN -> "66.8506204"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    48.946090  -49.136770   66.850620
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604205749"
Evaluating: 0.604205749*360.0
 Parameter: XPHI <- "217.51407"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919312037"
Evaluating: 0.919312037*360.0
 Parameter: YPHI <- "330.952333"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.141049641"
Evaluating: 0.141049641*360.0
 Parameter: ZPHI <- "50.7778708"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.3212761"
 Parameter: YPOS -> "-54.5824709"
 Parameter: ZPOS -> "47.415545"
 Parameter: XPHI -> "217.51407"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.793204   -0.608956
    0.000000    0.608956   -0.793204

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  142.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.3212761"
 Parameter: YPOS -> "-54.5824709"
 Parameter: ZPOS -> "47.415545"
 Parameter: YPHI -> "330.952333"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.874216    0.000000    0.485537
    0.000000    1.000000    0.000000
   -0.485537    0.000000    0.874216

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.3212761"
 Parameter: YPOS -> "-54.5824709"
 Parameter: ZPOS -> "47.415545"
 Parameter: ZPHI -> "50.7778708"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.632329    0.774700    0.000000
   -0.774700    0.632329    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   50.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.321276 XMAX =   30.321276 XAVE =   30.321276
    YMIN =  -54.582471 YMAX =  -54.582471 YAVE =  -54.582471
    ZMIN =   47.415545 ZMAX =   47.415545 ZAVE =   47.415545
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.3212761"
Evaluating: 30.3212761+3.5
 Parameter: XMAX <- "33.8212761"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.5824709"
Evaluating: -54.5824709+3.5
 Parameter: YMAX <- "-51.0824709"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.415545"
Evaluating: 47.415545+3.5
 Parameter: ZMAX <- "50.915545"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.3212761"
Evaluating: 30.3212761-3.5
 Parameter: XMIN <- "26.8212761"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.5824709"
Evaluating: -54.5824709-3.5
 Parameter: YMIN <- "-58.0824709"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.415545"
Evaluating: 47.415545-3.5
 Parameter: ZMIN <- "43.915545"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.8212761"
 Parameter: XMIN -> "26.8212761"
 Parameter: YMAX -> "-51.0824709"
 Parameter: YMIN -> "-58.0824709"
 Parameter: ZMAX -> "50.915545"
 Parameter: ZMIN -> "43.915545"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "8" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "8" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.178152735"
Evaluating: 128.065641*(0.178152735-0.5)
 Parameter: XPOS <- "-41.2175763"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.246820729"
Evaluating: 128.065641*(0.246820729-0.5)
 Parameter: YPOS <- "-32.4235656"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.776200461"
Evaluating: 108.613069*(0.776200461-0.5)+-2.187274
 Parameter: ZPOS <- "27.8117057"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.8117057" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.8117057" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.2175763"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.2175763-0
 Parameter: XTRAN <- "-41.2175763"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.4235656"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.4235656-0
 Parameter: YTRAN <- "-32.4235656"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.8117057"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.8117057-0
 Parameter: ZTRAN <- "27.8117057"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.2175763"
 Parameter: YTRAN -> "-32.4235656"
 Parameter: ZTRAN -> "27.8117057"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -41.217576  -32.423566   27.811706
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.966839837"
Evaluating: 0.966839837*360.0
 Parameter: XPHI <- "348.062341"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.822895705"
Evaluating: 0.822895705*360.0
 Parameter: YPHI <- "296.242454"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547850895"
Evaluating: 0.547850895*360.0
 Parameter: ZPHI <- "197.226322"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.2175763"
 Parameter: YPOS -> "-32.4235656"
 Parameter: ZPOS -> "27.8117057"
 Parameter: XPHI -> "348.062341"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.978373   -0.206847
    0.000000    0.206847    0.978373

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   11.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.2175763"
 Parameter: YPOS -> "-32.4235656"
 Parameter: ZPOS -> "27.8117057"
 Parameter: YPHI -> "296.242454"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.442171    0.000000    0.896931
    0.000000    1.000000    0.000000
   -0.896931    0.000000    0.442171

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.2175763"
 Parameter: YPOS -> "-32.4235656"
 Parameter: ZPOS -> "27.8117057"
 Parameter: ZPHI -> "197.226322"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.955142   -0.296147    0.000000
    0.296147   -0.955142    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.217576 XMAX =  -41.217576 XAVE =  -41.217576
    YMIN =  -32.423566 YMAX =  -32.423566 YAVE =  -32.423566
    ZMIN =   27.811706 ZMAX =   27.811706 ZAVE =   27.811706
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.2175763"
Evaluating: -41.2175763+3.5
 Parameter: XMAX <- "-37.7175763"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.4235656"
Evaluating: -32.4235656+3.5
 Parameter: YMAX <- "-28.9235656"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.8117057"
Evaluating: 27.8117057+3.5
 Parameter: ZMAX <- "31.3117057"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.2175763"
Evaluating: -41.2175763-3.5
 Parameter: XMIN <- "-44.7175763"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.4235656"
Evaluating: -32.4235656-3.5
 Parameter: YMIN <- "-35.9235656"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.8117057"
Evaluating: 27.8117057-3.5
 Parameter: ZMIN <- "24.3117057"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.7175763"
 Parameter: XMIN -> "-44.7175763"
 Parameter: YMAX -> "-28.9235656"
 Parameter: YMIN -> "-35.9235656"
 Parameter: ZMAX -> "31.3117057"
 Parameter: ZMIN -> "24.3117057"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "9" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "9" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.508092748"
Evaluating: 128.065641*(0.508092748-0.5)
 Parameter: XPOS <- "1.03640296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.939381376"
Evaluating: 128.065641*(0.939381376-0.5)
 Parameter: YPOS <- "56.2696576"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.236309631"
Evaluating: 108.613069*(0.236309631-0.5)+-2.187274
 Parameter: ZPOS <- "-30.8274942"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.8274942" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.03640296"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.03640296-0
 Parameter: XTRAN <- "1.03640296"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.2696576"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 56.2696576-0
 Parameter: YTRAN <- "56.2696576"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.8274942"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.8274942-0
 Parameter: ZTRAN <- "-30.8274942"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.03640296"
 Parameter: YTRAN -> "56.2696576"
 Parameter: ZTRAN -> "-30.8274942"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     1.036403   56.269658  -30.827494
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640216849"
Evaluating: 0.640216849*360.0
 Parameter: XPHI <- "230.478066"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.818367051"
Evaluating: 0.818367051*360.0
 Parameter: YPHI <- "294.612138"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.79783694"
Evaluating: 0.79783694*360.0
 Parameter: ZPHI <- "287.221298"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.03640296"
 Parameter: YPOS -> "56.2696576"
 Parameter: ZPOS -> "-30.8274942"
 Parameter: XPHI -> "230.478066"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.636374   -0.771381
    0.000000    0.771381   -0.636374

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.03640296"
 Parameter: YPOS -> "56.2696576"
 Parameter: ZPOS -> "-30.8274942"
 Parameter: YPHI -> "294.612138"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.416473    0.000000    0.909148
    0.000000    1.000000    0.000000
   -0.909148    0.000000    0.416473

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.03640296"
 Parameter: YPOS -> "56.2696576"
 Parameter: ZPOS -> "-30.8274942"
 Parameter: ZPHI -> "287.221298"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.296063   -0.955168    0.000000
    0.955168    0.296063    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.036403 XMAX =    1.036403 XAVE =    1.036403
    YMIN =   56.269658 YMAX =   56.269658 YAVE =   56.269658
    ZMIN =  -30.827494 ZMAX =  -30.827494 ZAVE =  -30.827494
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.03640296"
Evaluating: 1.03640296+3.5
 Parameter: XMAX <- "4.53640296"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.2696576"
Evaluating: 56.2696576+3.5
 Parameter: YMAX <- "59.7696576"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.8274942"
Evaluating: -30.8274942+3.5
 Parameter: ZMAX <- "-27.3274942"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.03640296"
Evaluating: 1.03640296-3.5
 Parameter: XMIN <- "-2.46359704"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.2696576"
Evaluating: 56.2696576-3.5
 Parameter: YMIN <- "52.7696576"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.8274942"
Evaluating: -30.8274942-3.5
 Parameter: ZMIN <- "-34.3274942"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.53640296"
 Parameter: XMIN -> "-2.46359704"
 Parameter: YMAX -> "59.7696576"
 Parameter: YMIN -> "52.7696576"
 Parameter: ZMAX -> "-27.3274942"
 Parameter: ZMIN -> "-34.3274942"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "10" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "10" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.695268563"
Evaluating: 128.065641*(0.695268563-0.5)
 Parameter: XPOS <- "25.0071937"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.734414383"
Evaluating: 128.065641*(0.734414383-0.5)
 Parameter: YPOS <- "30.0204282"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.77651615"
Evaluating: 108.613069*(0.77651615-0.5)+-2.187274
 Parameter: ZPOS <- "27.8459937"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.8459937" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.8459937" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.0071937"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.0071937-0
 Parameter: XTRAN <- "25.0071937"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.0204282"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.0204282-0
 Parameter: YTRAN <- "30.0204282"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.8459937"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.8459937-0
 Parameter: ZTRAN <- "27.8459937"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.0071937"
 Parameter: YTRAN -> "30.0204282"
 Parameter: ZTRAN -> "27.8459937"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    25.007194   30.020428   27.845994
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380655621"
Evaluating: 0.380655621*360.0
 Parameter: XPHI <- "137.036024"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209378364"
Evaluating: 0.209378364*360.0
 Parameter: YPHI <- "75.376211"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926727897"
Evaluating: 0.926727897*360.0
 Parameter: ZPHI <- "333.622043"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.0071937"
 Parameter: YPOS -> "30.0204282"
 Parameter: ZPOS -> "27.8459937"
 Parameter: XPHI -> "137.036024"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.731782    0.681538
    0.000000   -0.681538   -0.731782

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.0071937"
 Parameter: YPOS -> "30.0204282"
 Parameter: ZPOS -> "27.8459937"
 Parameter: YPHI -> "75.376211"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.252471    0.000000   -0.967604
    0.000000    1.000000    0.000000
    0.967604    0.000000    0.252471

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.0071937"
 Parameter: YPOS -> "30.0204282"
 Parameter: ZPOS -> "27.8459937"
 Parameter: ZPHI -> "333.622043"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.895883   -0.444291    0.000000
    0.444291    0.895883    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   26.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.007194 XMAX =   25.007194 XAVE =   25.007194
    YMIN =   30.020428 YMAX =   30.020428 YAVE =   30.020428
    ZMIN =   27.845994 ZMAX =   27.845994 ZAVE =   27.845994
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.0071937"
Evaluating: 25.0071937+3.5
 Parameter: XMAX <- "28.5071937"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.0204282"
Evaluating: 30.0204282+3.5
 Parameter: YMAX <- "33.5204282"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.8459937"
Evaluating: 27.8459937+3.5
 Parameter: ZMAX <- "31.3459937"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.0071937"
Evaluating: 25.0071937-3.5
 Parameter: XMIN <- "21.5071937"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.0204282"
Evaluating: 30.0204282-3.5
 Parameter: YMIN <- "26.5204282"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.8459937"
Evaluating: 27.8459937-3.5
 Parameter: ZMIN <- "24.3459937"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.5071937"
 Parameter: XMIN -> "21.5071937"
 Parameter: YMAX -> "33.5204282"
 Parameter: YMIN -> "26.5204282"
 Parameter: ZMAX -> "31.3459937"
 Parameter: ZMIN -> "24.3459937"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "11" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "11" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.42599432"
Evaluating: 128.065641*(0.42599432-0.5)
 Parameter: XPOS <- "-9.47758485"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.631393108"
Evaluating: 128.065641*(0.631393108-0.5)
 Parameter: YPOS <- "16.8269426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "5.6500879E-02"
Evaluating: 108.613069*(5.6500879E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-50.3570746"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.3570746" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.47758485"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.47758485-0
 Parameter: XTRAN <- "-9.47758485"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.8269426"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.8269426-0
 Parameter: YTRAN <- "16.8269426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.3570746"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.3570746-0
 Parameter: ZTRAN <- "-50.3570746"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.47758485"
 Parameter: YTRAN -> "16.8269426"
 Parameter: ZTRAN -> "-50.3570746"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -9.477585   16.826943  -50.357075
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239639731"
Evaluating: 0.239639731*360.0
 Parameter: XPHI <- "86.2703032"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.414507166"
Evaluating: 0.414507166*360.0
 Parameter: YPHI <- "149.22258"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.194663288"
Evaluating: 0.194663288*360.0
 Parameter: ZPHI <- "70.0787837"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.47758485"
 Parameter: YPOS -> "16.8269426"
 Parameter: ZPOS -> "-50.3570746"
 Parameter: XPHI -> "86.2703032"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.065050    0.997882
    0.000000   -0.997882    0.065050

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.47758485"
 Parameter: YPOS -> "16.8269426"
 Parameter: ZPOS -> "-50.3570746"
 Parameter: YPHI -> "149.22258"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.859162    0.000000   -0.511704
    0.000000    1.000000    0.000000
    0.511704    0.000000   -0.859162

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  149.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.47758485"
 Parameter: YPOS -> "16.8269426"
 Parameter: ZPOS -> "-50.3570746"
 Parameter: ZPHI -> "70.0787837"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.340728    0.940162    0.000000
   -0.940162    0.340728    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.477585 XMAX =   -9.477585 XAVE =   -9.477585
    YMIN =   16.826943 YMAX =   16.826943 YAVE =   16.826943
    ZMIN =  -50.357075 ZMAX =  -50.357075 ZAVE =  -50.357075
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.47758485"
Evaluating: -9.47758485+3.5
 Parameter: XMAX <- "-5.97758485"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.8269426"
Evaluating: 16.8269426+3.5
 Parameter: YMAX <- "20.3269426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.3570746"
Evaluating: -50.3570746+3.5
 Parameter: ZMAX <- "-46.8570746"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.47758485"
Evaluating: -9.47758485-3.5
 Parameter: XMIN <- "-12.9775848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.8269426"
Evaluating: 16.8269426-3.5
 Parameter: YMIN <- "13.3269426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.3570746"
Evaluating: -50.3570746-3.5
 Parameter: ZMIN <- "-53.8570746"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.97758485"
 Parameter: XMIN -> "-12.9775848"
 Parameter: YMAX -> "20.3269426"
 Parameter: YMIN -> "13.3269426"
 Parameter: ZMAX -> "-46.8570746"
 Parameter: ZMIN -> "-53.8570746"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "12" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "12" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.603981346"
Evaluating: 128.065641*(0.603981346-0.5)
 Parameter: XPOS <- "13.3164377"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.128407371"
Evaluating: 128.065641*(0.128407371-0.5)
 Parameter: YPOS <- "-47.5882482"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.628821963"
Evaluating: 108.613069*(0.628821963-0.5)+-2.187274
 Parameter: ZPOS <- "11.8044748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.8044748" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.8044748" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "12" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.740789754"
Evaluating: 128.065641*(0.740789754-0.5)
 Parameter: XPOS <- "30.8368942"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.680390521"
Evaluating: 128.065641*(0.680390521-0.5)
 Parameter: YPOS <- "23.1018277"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.253016288"
Evaluating: 108.613069*(0.253016288-0.5)+-2.187274
 Parameter: ZPOS <- "-29.012933"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.012933" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.8368942"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.8368942-0
 Parameter: XTRAN <- "30.8368942"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.1018277"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.1018277-0
 Parameter: YTRAN <- "23.1018277"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.012933"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.012933-0
 Parameter: ZTRAN <- "-29.012933"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.8368942"
 Parameter: YTRAN -> "23.1018277"
 Parameter: ZTRAN -> "-29.012933"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    30.836894   23.101828  -29.012933
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115148997"
Evaluating: 0.115148997*360.0
 Parameter: XPHI <- "41.4536389"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547159341"
Evaluating: 0.547159341*360.0
 Parameter: YPHI <- "196.977363"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897972074"
Evaluating: 0.897972074*360.0
 Parameter: ZPHI <- "323.269947"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.8368942"
 Parameter: YPOS -> "23.1018277"
 Parameter: ZPOS -> "-29.012933"
 Parameter: XPHI -> "41.4536389"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.749492    0.662014
    0.000000   -0.662014    0.749492

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.8368942"
 Parameter: YPOS -> "23.1018277"
 Parameter: ZPOS -> "-29.012933"
 Parameter: YPHI -> "196.977363"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.956420    0.000000    0.291994
    0.000000    1.000000    0.000000
   -0.291994    0.000000   -0.956420

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.8368942"
 Parameter: YPOS -> "23.1018277"
 Parameter: ZPOS -> "-29.012933"
 Parameter: ZPHI -> "323.269947"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.801462   -0.598046    0.000000
    0.598046    0.801462    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.836894 XMAX =   30.836894 XAVE =   30.836894
    YMIN =   23.101828 YMAX =   23.101828 YAVE =   23.101828
    ZMIN =  -29.012933 ZMAX =  -29.012933 ZAVE =  -29.012933
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.8368942"
Evaluating: 30.8368942+3.5
 Parameter: XMAX <- "34.3368942"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.1018277"
Evaluating: 23.1018277+3.5
 Parameter: YMAX <- "26.6018277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.012933"
Evaluating: -29.012933+3.5
 Parameter: ZMAX <- "-25.512933"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.8368942"
Evaluating: 30.8368942-3.5
 Parameter: XMIN <- "27.3368942"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.1018277"
Evaluating: 23.1018277-3.5
 Parameter: YMIN <- "19.6018277"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.012933"
Evaluating: -29.012933-3.5
 Parameter: ZMIN <- "-32.512933"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.3368942"
 Parameter: XMIN -> "27.3368942"
 Parameter: YMAX -> "26.6018277"
 Parameter: YMIN -> "19.6018277"
 Parameter: ZMAX -> "-25.512933"
 Parameter: ZMIN -> "-32.512933"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60244 POS      POT      12       POT     -  91 PROA     GLU      395      OE2           4.8002
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "12" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.498753756"
Evaluating: 128.065641*(0.498753756-0.5)
 Parameter: XPOS <- "-0.159601037"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.884706462"
Evaluating: 128.065641*(0.884706462-0.5)
 Parameter: YPOS <- "49.2676797"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.86959405"
Evaluating: 108.613069*(0.86959405-0.5)+-2.187274
 Parameter: ZPOS <- "37.9554701"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.9554701" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.9554701" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.836894 XMAX =   30.836894 XAVE =   30.836894
    YMIN =   23.101828 YMAX =   23.101828 YAVE =   23.101828
    ZMIN =  -29.012933 ZMAX =  -29.012933 ZAVE =  -29.012933
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.159601037"
 RDCMND substituted energy or value "?XAVE" to "30.8368942"
Evaluating: -0.159601037-30.8368942
 Parameter: XTRAN <- "-30.9964952"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.2676797"
 RDCMND substituted energy or value "?YAVE" to "23.1018277"
Evaluating: 49.2676797-23.1018277
 Parameter: YTRAN <- "26.165852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.9554701"
 RDCMND substituted energy or value "?ZAVE" to "-29.012933"
Evaluating: 37.9554701--29.012933
 Parameter: ZTRAN <- "66.9684031"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.9964952"
 Parameter: YTRAN -> "26.165852"
 Parameter: ZTRAN -> "66.9684031"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -30.996495   26.165852   66.968403
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.874607253E-02"
Evaluating: 4.874607253E-02*360.0
 Parameter: XPHI <- "17.5485861"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533488028"
Evaluating: 0.533488028*360.0
 Parameter: YPHI <- "192.05569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174241178"
Evaluating: 0.174241178*360.0
 Parameter: ZPHI <- "62.7268241"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.159601037"
 Parameter: YPOS -> "49.2676797"
 Parameter: ZPOS -> "37.9554701"
 Parameter: XPHI -> "17.5485861"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.953462    0.301514
    0.000000   -0.301514    0.953462

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   17.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.159601037"
 Parameter: YPOS -> "49.2676797"
 Parameter: ZPOS -> "37.9554701"
 Parameter: YPHI -> "192.05569"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.977945    0.000000    0.208862
    0.000000    1.000000    0.000000
   -0.208862    0.000000   -0.977945

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.159601037"
 Parameter: YPOS -> "49.2676797"
 Parameter: ZPOS -> "37.9554701"
 Parameter: ZPHI -> "62.7268241"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.458233    0.888832    0.000000
   -0.888832    0.458233    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.159601 XMAX =   -0.159601 XAVE =   -0.159601
    YMIN =   49.267680 YMAX =   49.267680 YAVE =   49.267680
    ZMIN =   37.955470 ZMAX =   37.955470 ZAVE =   37.955470
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.159601054"
Evaluating: -0.159601054+3.5
 Parameter: XMAX <- "3.34039895"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.2676797"
Evaluating: 49.2676797+3.5
 Parameter: YMAX <- "52.7676797"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.9554701"
Evaluating: 37.9554701+3.5
 Parameter: ZMAX <- "41.4554701"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.159601054"
Evaluating: -0.159601054-3.5
 Parameter: XMIN <- "-3.65960105"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.2676797"
Evaluating: 49.2676797-3.5
 Parameter: YMIN <- "45.7676797"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.9554701"
Evaluating: 37.9554701-3.5
 Parameter: ZMIN <- "34.4554701"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.34039895"
 Parameter: XMIN -> "-3.65960105"
 Parameter: YMAX -> "52.7676797"
 Parameter: YMIN -> "45.7676797"
 Parameter: ZMAX -> "41.4554701"
 Parameter: ZMIN -> "34.4554701"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "13" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "13" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.60215273"
Evaluating: 128.065641*(0.60215273-0.5)
 Parameter: XPOS <- "13.0822548"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.424755918E-02"
Evaluating: 128.065641*(8.424755918E-02-0.5)
 Parameter: YPOS <- "-53.2436028"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.876589086"
Evaluating: 108.613069*(0.876589086-0.5)+-2.187274
 Parameter: ZPOS <- "38.7152224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.7152224" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.7152224" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0822548"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0822548-0
 Parameter: XTRAN <- "13.0822548"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.2436028"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.2436028-0
 Parameter: YTRAN <- "-53.2436028"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.7152224"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.7152224-0
 Parameter: ZTRAN <- "38.7152224"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0822548"
 Parameter: YTRAN -> "-53.2436028"
 Parameter: ZTRAN -> "38.7152224"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    13.082255  -53.243603   38.715222
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102416171"
Evaluating: 0.102416171*360.0
 Parameter: XPHI <- "36.8698216"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.16858572"
Evaluating: 0.16858572*360.0
 Parameter: YPHI <- "60.6908592"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103653508"
Evaluating: 0.103653508*360.0
 Parameter: ZPHI <- "37.3152629"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0822548"
 Parameter: YPOS -> "-53.2436028"
 Parameter: ZPOS -> "38.7152224"
 Parameter: XPHI -> "36.8698216"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.800001    0.599999
    0.000000   -0.599999    0.800001

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0822548"
 Parameter: YPOS -> "-53.2436028"
 Parameter: ZPOS -> "38.7152224"
 Parameter: YPHI -> "60.6908592"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.489522    0.000000   -0.871991
    0.000000    1.000000    0.000000
    0.871991    0.000000    0.489522

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0822548"
 Parameter: YPOS -> "-53.2436028"
 Parameter: ZPOS -> "38.7152224"
 Parameter: ZPHI -> "37.3152629"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.795312    0.606200    0.000000
   -0.606200    0.795312    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   37.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.082255 XMAX =   13.082255 XAVE =   13.082255
    YMIN =  -53.243603 YMAX =  -53.243603 YAVE =  -53.243603
    ZMIN =   38.715222 ZMAX =   38.715222 ZAVE =   38.715222
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0822548"
Evaluating: 13.0822548+3.5
 Parameter: XMAX <- "16.5822548"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.2436028"
Evaluating: -53.2436028+3.5
 Parameter: YMAX <- "-49.7436028"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.7152224"
Evaluating: 38.7152224+3.5
 Parameter: ZMAX <- "42.2152224"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0822548"
Evaluating: 13.0822548-3.5
 Parameter: XMIN <- "9.5822548"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.2436028"
Evaluating: -53.2436028-3.5
 Parameter: YMIN <- "-56.7436028"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.7152224"
Evaluating: 38.7152224-3.5
 Parameter: ZMIN <- "35.2152224"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5822548"
 Parameter: XMIN -> "9.5822548"
 Parameter: YMAX -> "-49.7436028"
 Parameter: YMIN -> "-56.7436028"
 Parameter: ZMAX -> "42.2152224"
 Parameter: ZMIN -> "35.2152224"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "14" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "14" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.971564936"
Evaluating: 128.065641*(0.971564936-0.5)
 Parameter: XPOS <- "60.3912658"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.711067367"
Evaluating: 128.065641*(0.711067367-0.5)
 Parameter: YPOS <- "27.0304776"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.375245925"
Evaluating: 108.613069*(0.375245925-0.5)+-2.187274
 Parameter: ZPOS <- "-15.737197"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.737197" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "60.3912658"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 60.3912658-0
 Parameter: XTRAN <- "60.3912658"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.0304776"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.0304776-0
 Parameter: YTRAN <- "27.0304776"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.737197"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.737197-0
 Parameter: ZTRAN <- "-15.737197"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "60.3912658"
 Parameter: YTRAN -> "27.0304776"
 Parameter: ZTRAN -> "-15.737197"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    60.391266   27.030478  -15.737197
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.822262471E-02"
Evaluating: 3.822262471E-02*360.0
 Parameter: XPHI <- "13.7601449"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.099000879E-02"
Evaluating: 5.099000879E-02*360.0
 Parameter: YPHI <- "18.3564032"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261503066"
Evaluating: 0.261503066*360.0
 Parameter: ZPHI <- "94.1411038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "60.3912658"
 Parameter: YPOS -> "27.0304776"
 Parameter: ZPOS -> "-15.737197"
 Parameter: XPHI -> "13.7601449"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.971300    0.237858
    0.000000   -0.237858    0.971300

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   13.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "60.3912658"
 Parameter: YPOS -> "27.0304776"
 Parameter: ZPOS -> "-15.737197"
 Parameter: YPHI -> "18.3564032"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.949116    0.000000   -0.314927
    0.000000    1.000000    0.000000
    0.314927    0.000000    0.949116

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   18.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "60.3912658"
 Parameter: YPOS -> "27.0304776"
 Parameter: ZPOS -> "-15.737197"
 Parameter: ZPHI -> "94.1411038"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.072213    0.997389    0.000000
   -0.997389   -0.072213    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   60.391266 XMAX =   60.391266 XAVE =   60.391266
    YMIN =   27.030478 YMAX =   27.030478 YAVE =   27.030478
    ZMIN =  -15.737197 ZMAX =  -15.737197 ZAVE =  -15.737197
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "60.3912658"
Evaluating: 60.3912658+3.5
 Parameter: XMAX <- "63.8912658"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.0304776"
Evaluating: 27.0304776+3.5
 Parameter: YMAX <- "30.5304776"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.737197"
Evaluating: -15.737197+3.5
 Parameter: ZMAX <- "-12.237197"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "60.3912658"
Evaluating: 60.3912658-3.5
 Parameter: XMIN <- "56.8912658"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.0304776"
Evaluating: 27.0304776-3.5
 Parameter: YMIN <- "23.5304776"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.737197"
Evaluating: -15.737197-3.5
 Parameter: ZMIN <- "-19.237197"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "63.8912658"
 Parameter: XMIN -> "56.8912658"
 Parameter: YMAX -> "30.5304776"
 Parameter: YMIN -> "23.5304776"
 Parameter: ZMAX -> "-12.237197"
 Parameter: ZMIN -> "-19.237197"
 SELRPN>     29 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     16 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60246 POS      POT      14       POT     -**** MEMB     DMPC     271      C3            3.9767
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      C12           3.6317
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      P             3.5207
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      O14           3.0344
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      O11           2.8781
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      C1            2.0967
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      C2            1.8654
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      O21           3.2056
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      C21           3.9876
60246 POS      POT      14       POT     -**** MEMB     DMPC     276      C3            2.5250
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "14" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.895360094"
Evaluating: 128.065641*(0.895360094-0.5)
 Parameter: XPOS <- "50.6320439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.794207751"
Evaluating: 128.065641*(0.794207751-0.5)
 Parameter: YPOS <- "37.6779042"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.802124475"
Evaluating: 108.613069*(0.802124475-0.5)+-2.187274
 Parameter: ZPOS <- "30.6273924"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.6273924" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.6273924" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   60.391266 XMAX =   60.391266 XAVE =   60.391266
    YMIN =   27.030478 YMAX =   27.030478 YAVE =   27.030478
    ZMIN =  -15.737197 ZMAX =  -15.737197 ZAVE =  -15.737197
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.6320439"
 RDCMND substituted energy or value "?XAVE" to "60.3912658"
Evaluating: 50.6320439-60.3912658
 Parameter: XTRAN <- "-9.7592219"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.6779042"
 RDCMND substituted energy or value "?YAVE" to "27.0304776"
Evaluating: 37.6779042-27.0304776
 Parameter: YTRAN <- "10.6474266"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.6273924"
 RDCMND substituted energy or value "?ZAVE" to "-15.737197"
Evaluating: 30.6273924--15.737197
 Parameter: ZTRAN <- "46.3645894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.7592219"
 Parameter: YTRAN -> "10.6474266"
 Parameter: ZTRAN -> "46.3645894"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -9.759222   10.647427   46.364589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807629976"
Evaluating: 0.807629976*360.0
 Parameter: XPHI <- "290.746791"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.382461051E-02"
Evaluating: 4.382461051E-02*360.0
 Parameter: YPHI <- "15.7768598"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968468089"
Evaluating: 0.968468089*360.0
 Parameter: ZPHI <- "348.648512"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.6320439"
 Parameter: YPOS -> "37.6779042"
 Parameter: ZPOS -> "30.6273924"
 Parameter: XPHI -> "290.746791"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.354239   -0.935155
    0.000000    0.935155    0.354239

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   69.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.6320439"
 Parameter: YPOS -> "37.6779042"
 Parameter: ZPOS -> "30.6273924"
 Parameter: YPHI -> "15.7768598"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.962328    0.000000   -0.271892
    0.000000    1.000000    0.000000
    0.271892    0.000000    0.962328

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.6320439"
 Parameter: YPOS -> "37.6779042"
 Parameter: ZPOS -> "30.6273924"
 Parameter: ZPHI -> "348.648512"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.980438   -0.196827    0.000000
    0.196827    0.980438    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.632044 XMAX =   50.632044 XAVE =   50.632044
    YMIN =   37.677904 YMAX =   37.677904 YAVE =   37.677904
    ZMIN =   30.627392 ZMAX =   30.627392 ZAVE =   30.627392
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.6320439"
Evaluating: 50.6320439+3.5
 Parameter: XMAX <- "54.1320439"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.6779042"
Evaluating: 37.6779042+3.5
 Parameter: YMAX <- "41.1779042"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.6273924"
Evaluating: 30.6273924+3.5
 Parameter: ZMAX <- "34.1273924"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.6320439"
Evaluating: 50.6320439-3.5
 Parameter: XMIN <- "47.1320439"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.6779042"
Evaluating: 37.6779042-3.5
 Parameter: YMIN <- "34.1779042"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.6273924"
Evaluating: 30.6273924-3.5
 Parameter: ZMIN <- "27.1273924"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.1320439"
 Parameter: XMIN -> "47.1320439"
 Parameter: YMAX -> "41.1779042"
 Parameter: YMIN -> "34.1779042"
 Parameter: ZMAX -> "34.1273924"
 Parameter: ZMIN -> "27.1273924"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "15" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "15" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.139136459"
Evaluating: 128.065641*(0.139136459-0.5)
 Parameter: XPOS <- "-46.2142207"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.810624956"
Evaluating: 128.065641*(0.810624956-0.5)
 Parameter: YPOS <- "39.7803841"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.278561173"
Evaluating: 108.613069*(0.278561173-0.5)+-2.187274
 Parameter: ZPOS <- "-26.2384246"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.2384246" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.2142207"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.2142207-0
 Parameter: XTRAN <- "-46.2142207"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.7803841"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.7803841-0
 Parameter: YTRAN <- "39.7803841"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.2384246"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.2384246-0
 Parameter: ZTRAN <- "-26.2384246"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.2142207"
 Parameter: YTRAN -> "39.7803841"
 Parameter: ZTRAN -> "-26.2384246"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -46.214221   39.780384  -26.238425
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895134929"
Evaluating: 0.895134929*360.0
 Parameter: XPHI <- "322.248574"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686449658"
Evaluating: 0.686449658*360.0
 Parameter: YPHI <- "247.121877"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950216698"
Evaluating: 0.950216698*360.0
 Parameter: ZPHI <- "342.078011"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.2142207"
 Parameter: YPOS -> "39.7803841"
 Parameter: ZPOS -> "-26.2384246"
 Parameter: XPHI -> "322.248574"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.790674   -0.612237
    0.000000    0.612237    0.790674

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   37.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.2142207"
 Parameter: YPOS -> "39.7803841"
 Parameter: ZPOS -> "-26.2384246"
 Parameter: YPHI -> "247.121877"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.388772    0.000000    0.921334
    0.000000    1.000000    0.000000
   -0.921334    0.000000   -0.388772

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.2142207"
 Parameter: YPOS -> "39.7803841"
 Parameter: ZPOS -> "-26.2384246"
 Parameter: ZPHI -> "342.078011"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.951476   -0.307722    0.000000
    0.307722    0.951476    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.214221 XMAX =  -46.214221 XAVE =  -46.214221
    YMIN =   39.780384 YMAX =   39.780384 YAVE =   39.780384
    ZMIN =  -26.238425 ZMAX =  -26.238425 ZAVE =  -26.238425
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.2142207"
Evaluating: -46.2142207+3.5
 Parameter: XMAX <- "-42.7142207"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.7803841"
Evaluating: 39.7803841+3.5
 Parameter: YMAX <- "43.2803841"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.2384246"
Evaluating: -26.2384246+3.5
 Parameter: ZMAX <- "-22.7384246"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.2142207"
Evaluating: -46.2142207-3.5
 Parameter: XMIN <- "-49.7142207"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.7803841"
Evaluating: 39.7803841-3.5
 Parameter: YMIN <- "36.2803841"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.2384246"
Evaluating: -26.2384246-3.5
 Parameter: ZMIN <- "-29.7384246"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.7142207"
 Parameter: XMIN -> "-49.7142207"
 Parameter: YMAX -> "43.2803841"
 Parameter: YMIN -> "36.2803841"
 Parameter: ZMAX -> "-22.7384246"
 Parameter: ZMIN -> "-29.7384246"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "16" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "16" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.202996962"
Evaluating: 128.065641*(0.202996962-0.5)
 Parameter: XPOS <- "-38.0358844"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.530523632E-02"
Evaluating: 128.065641*(6.530523632E-02-0.5)
 Parameter: YPOS <- "-55.6694636"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.343766269"
Evaluating: 108.613069*(0.343766269-0.5)+-2.187274
 Parameter: ZPOS <- "-19.156299"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.156299" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.0358844"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.0358844-0
 Parameter: XTRAN <- "-38.0358844"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.6694636"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.6694636-0
 Parameter: YTRAN <- "-55.6694636"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.156299"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.156299-0
 Parameter: ZTRAN <- "-19.156299"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.0358844"
 Parameter: YTRAN -> "-55.6694636"
 Parameter: ZTRAN -> "-19.156299"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -38.035884  -55.669464  -19.156299
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.52937383"
Evaluating: 0.52937383*360.0
 Parameter: XPHI <- "190.574579"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.509439506E-03"
Evaluating: 4.509439506E-03*360.0
 Parameter: YPHI <- "1.62339822"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.785250442"
Evaluating: 0.785250442*360.0
 Parameter: ZPHI <- "282.690159"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.0358844"
 Parameter: YPOS -> "-55.6694636"
 Parameter: ZPOS -> "-19.156299"
 Parameter: XPHI -> "190.574579"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983017   -0.183515
    0.000000    0.183515   -0.983017

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.0358844"
 Parameter: YPOS -> "-55.6694636"
 Parameter: ZPOS -> "-19.156299"
 Parameter: YPHI -> "1.62339822"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999599    0.000000   -0.028330
    0.000000    1.000000    0.000000
    0.028330    0.000000    0.999599

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.0358844"
 Parameter: YPOS -> "-55.6694636"
 Parameter: ZPOS -> "-19.156299"
 Parameter: ZPHI -> "282.690159"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.219679   -0.975572    0.000000
    0.975572    0.219679    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   77.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.035884 XMAX =  -38.035884 XAVE =  -38.035884
    YMIN =  -55.669464 YMAX =  -55.669464 YAVE =  -55.669464
    ZMIN =  -19.156299 ZMAX =  -19.156299 ZAVE =  -19.156299
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.0358844"
Evaluating: -38.0358844+3.5
 Parameter: XMAX <- "-34.5358844"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.6694636"
Evaluating: -55.6694636+3.5
 Parameter: YMAX <- "-52.1694636"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.156299"
Evaluating: -19.156299+3.5
 Parameter: ZMAX <- "-15.656299"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.0358844"
Evaluating: -38.0358844-3.5
 Parameter: XMIN <- "-41.5358844"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.6694636"
Evaluating: -55.6694636-3.5
 Parameter: YMIN <- "-59.1694636"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.156299"
Evaluating: -19.156299-3.5
 Parameter: ZMIN <- "-22.656299"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.5358844"
 Parameter: XMIN -> "-41.5358844"
 Parameter: YMAX -> "-52.1694636"
 Parameter: YMIN -> "-59.1694636"
 Parameter: ZMAX -> "-15.656299"
 Parameter: ZMIN -> "-22.656299"
 SELRPN>     13 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      6 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60248 POS      POT      16       POT     -**** MEMB     DMPC     356      N             3.6493
60248 POS      POT      16       POT     -**** MEMB     DMPC     356      C14           2.8102
60248 POS      POT      16       POT     -**** MEMB     DMPC     356      C12           3.3850
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "16" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.540840843E-02"
Evaluating: 128.065641*(2.540840843E-02-0.5)
 Parameter: XPOS <- "-60.7788764"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.568404219"
Evaluating: 128.065641*(0.568404219-0.5)
 Parameter: YPOS <- "8.76023015"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "6.478336512E-02"
Evaluating: 108.613069*(6.478336512E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-49.4574884"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.4574884" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.035884 XMAX =  -38.035884 XAVE =  -38.035884
    YMIN =  -55.669464 YMAX =  -55.669464 YAVE =  -55.669464
    ZMIN =  -19.156299 ZMAX =  -19.156299 ZAVE =  -19.156299
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.7788764"
 RDCMND substituted energy or value "?XAVE" to "-38.0358844"
Evaluating: -60.7788764--38.0358844
 Parameter: XTRAN <- "-22.742992"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.76023015"
 RDCMND substituted energy or value "?YAVE" to "-55.6694636"
Evaluating: 8.76023015--55.6694636
 Parameter: YTRAN <- "64.4296937"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.4574884"
 RDCMND substituted energy or value "?ZAVE" to "-19.156299"
Evaluating: -49.4574884--19.156299
 Parameter: ZTRAN <- "-30.3011894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.742992"
 Parameter: YTRAN -> "64.4296937"
 Parameter: ZTRAN -> "-30.3011894"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.742992   64.429694  -30.301189
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30684495"
Evaluating: 0.30684495*360.0
 Parameter: XPHI <- "110.464182"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484671576"
Evaluating: 0.484671576*360.0
 Parameter: YPHI <- "174.481767"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509889883"
Evaluating: 0.509889883*360.0
 Parameter: ZPHI <- "183.560358"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.7788764"
 Parameter: YPOS -> "8.76023015"
 Parameter: ZPOS -> "-49.4574884"
 Parameter: XPHI -> "110.464182"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.349622    0.936891
    0.000000   -0.936891   -0.349622

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.7788764"
 Parameter: YPOS -> "8.76023015"
 Parameter: ZPOS -> "-49.4574884"
 Parameter: YPHI -> "174.481767"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.995366    0.000000   -0.096163
    0.000000    1.000000    0.000000
    0.096163    0.000000   -0.995366

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.7788764"
 Parameter: YPOS -> "8.76023015"
 Parameter: ZPOS -> "-49.4574884"
 Parameter: ZPHI -> "183.560358"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.998070   -0.062100    0.000000
    0.062100   -0.998070    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  176.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.778876 XMAX =  -60.778876 XAVE =  -60.778876
    YMIN =    8.760230 YMAX =    8.760230 YAVE =    8.760230
    ZMIN =  -49.457488 ZMAX =  -49.457488 ZAVE =  -49.457488
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.7788764"
Evaluating: -60.7788764+3.5
 Parameter: XMAX <- "-57.2788764"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.76023013"
Evaluating: 8.76023013+3.5
 Parameter: YMAX <- "12.2602301"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.4574884"
Evaluating: -49.4574884+3.5
 Parameter: ZMAX <- "-45.9574884"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.7788764"
Evaluating: -60.7788764-3.5
 Parameter: XMIN <- "-64.2788764"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.76023013"
Evaluating: 8.76023013-3.5
 Parameter: YMIN <- "5.26023013"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.4574884"
Evaluating: -49.4574884-3.5
 Parameter: ZMIN <- "-52.9574884"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-57.2788764"
 Parameter: XMIN -> "-64.2788764"
 Parameter: YMAX -> "12.2602301"
 Parameter: YMIN -> "5.26023013"
 Parameter: ZMAX -> "-45.9574884"
 Parameter: ZMIN -> "-52.9574884"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "17" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "17" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.865972533"
Evaluating: 128.065641*(0.865972533-0.5)
 Parameter: XPOS <- "46.868507"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.167680517"
Evaluating: 128.065641*(0.167680517-0.5)
 Parameter: YPOS <- "-42.5587076"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.217146379"
Evaluating: 108.613069*(0.217146379-0.5)+-2.187274
 Parameter: ZPOS <- "-32.9088739"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.9088739" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.868507"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.868507-0
 Parameter: XTRAN <- "46.868507"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.5587076"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.5587076-0
 Parameter: YTRAN <- "-42.5587076"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.9088739"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.9088739-0
 Parameter: ZTRAN <- "-32.9088739"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.868507"
 Parameter: YTRAN -> "-42.5587076"
 Parameter: ZTRAN -> "-32.9088739"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    46.868507  -42.558708  -32.908874
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.585673539E-02"
Evaluating: 2.585673539E-02*360.0
 Parameter: XPHI <- "9.30842474"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612817308"
Evaluating: 0.612817308*360.0
 Parameter: YPHI <- "220.614231"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77964831"
Evaluating: 0.77964831*360.0
 Parameter: ZPHI <- "280.673392"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.868507"
 Parameter: YPOS -> "-42.5587076"
 Parameter: ZPOS -> "-32.9088739"
 Parameter: XPHI -> "9.30842474"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986832    0.161749
    0.000000   -0.161749    0.986832

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.868507"
 Parameter: YPOS -> "-42.5587076"
 Parameter: ZPOS -> "-32.9088739"
 Parameter: YPHI -> "220.614231"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.759110    0.000000    0.650963
    0.000000    1.000000    0.000000
   -0.650963    0.000000   -0.759110

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.868507"
 Parameter: YPOS -> "-42.5587076"
 Parameter: ZPOS -> "-32.9088739"
 Parameter: ZPHI -> "280.673392"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.185210   -0.982699    0.000000
    0.982699    0.185210    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   79.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.868507 XMAX =   46.868507 XAVE =   46.868507
    YMIN =  -42.558708 YMAX =  -42.558708 YAVE =  -42.558708
    ZMIN =  -32.908874 ZMAX =  -32.908874 ZAVE =  -32.908874
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.868507"
Evaluating: 46.868507+3.5
 Parameter: XMAX <- "50.368507"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.5587076"
Evaluating: -42.5587076+3.5
 Parameter: YMAX <- "-39.0587076"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.9088739"
Evaluating: -32.9088739+3.5
 Parameter: ZMAX <- "-29.4088739"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.868507"
Evaluating: 46.868507-3.5
 Parameter: XMIN <- "43.368507"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.5587076"
Evaluating: -42.5587076-3.5
 Parameter: YMIN <- "-46.0587076"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.9088739"
Evaluating: -32.9088739-3.5
 Parameter: ZMIN <- "-36.4088739"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.368507"
 Parameter: XMIN -> "43.368507"
 Parameter: YMAX -> "-39.0587076"
 Parameter: YMIN -> "-46.0587076"
 Parameter: ZMAX -> "-29.4088739"
 Parameter: ZMIN -> "-36.4088739"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "18" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "18" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.134554716"
Evaluating: 128.065641*(0.134554716-0.5)
 Parameter: XPOS <- "-46.8009845"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.997905368"
Evaluating: 128.065641*(0.997905368-0.5)
 Parameter: YPOS <- "63.7645701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.627091503"
Evaluating: 108.613069*(0.627091503-0.5)+-2.187274
 Parameter: ZPOS <- "11.6165242"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.6165242" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.6165242" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "18" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.327906286"
Evaluating: 128.065641*(0.327906286-0.5)
 Parameter: XPOS <- "-22.0392918"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.662030909"
Evaluating: 128.065641*(0.662030909-0.5)
 Parameter: YPOS <- "20.7505922"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.698040423"
Evaluating: 108.613069*(0.698040423-0.5)+-2.187274
 Parameter: ZPOS <- "19.3225041"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.3225041" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.3225041" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.0392918"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.0392918-0
 Parameter: XTRAN <- "-22.0392918"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.7505922"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.7505922-0
 Parameter: YTRAN <- "20.7505922"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.3225041"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.3225041-0
 Parameter: ZTRAN <- "19.3225041"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.0392918"
 Parameter: YTRAN -> "20.7505922"
 Parameter: ZTRAN -> "19.3225041"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.039292   20.750592   19.322504
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697444467"
Evaluating: 0.697444467*360.0
 Parameter: XPHI <- "251.080008"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848958201"
Evaluating: 0.848958201*360.0
 Parameter: YPHI <- "305.624952"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100446562"
Evaluating: 0.100446562*360.0
 Parameter: ZPHI <- "36.1607623"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.0392918"
 Parameter: YPOS -> "20.7505922"
 Parameter: ZPOS -> "19.3225041"
 Parameter: XPHI -> "251.080008"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.324248   -0.945972
    0.000000    0.945972   -0.324248

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.0392918"
 Parameter: YPOS -> "20.7505922"
 Parameter: ZPOS -> "19.3225041"
 Parameter: YPHI -> "305.624952"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.582477    0.000000    0.812847
    0.000000    1.000000    0.000000
   -0.812847    0.000000    0.582477

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.0392918"
 Parameter: YPOS -> "20.7505922"
 Parameter: ZPOS -> "19.3225041"
 Parameter: ZPHI -> "36.1607623"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.807365    0.590053    0.000000
   -0.590053    0.807365    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.039292 XMAX =  -22.039292 XAVE =  -22.039292
    YMIN =   20.750592 YMAX =   20.750592 YAVE =   20.750592
    ZMIN =   19.322504 ZMAX =   19.322504 ZAVE =   19.322504
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.0392918"
Evaluating: -22.0392918+3.5
 Parameter: XMAX <- "-18.5392918"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.7505922"
Evaluating: 20.7505922+3.5
 Parameter: YMAX <- "24.2505922"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.3225041"
Evaluating: 19.3225041+3.5
 Parameter: ZMAX <- "22.8225041"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.0392918"
Evaluating: -22.0392918-3.5
 Parameter: XMIN <- "-25.5392918"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.7505922"
Evaluating: 20.7505922-3.5
 Parameter: YMIN <- "17.2505922"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.3225041"
Evaluating: 19.3225041-3.5
 Parameter: ZMIN <- "15.8225041"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.5392918"
 Parameter: XMIN -> "-25.5392918"
 Parameter: YMAX -> "24.2505922"
 Parameter: YMIN -> "17.2505922"
 Parameter: ZMAX -> "22.8225041"
 Parameter: ZMIN -> "15.8225041"
 SELRPN>     33 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     13 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60250 POS      POT      18       POT     -6425 PROD     LEU      548      CB            3.8442
60250 POS      POT      18       POT     -6428 PROD     LEU      548      CG            2.8809
60250 POS      POT      18       POT     -6430 PROD     LEU      548      CD1           3.8148
60250 POS      POT      18       POT     -6434 PROD     LEU      548      CD2           2.8111
60250 POS      POT      18       POT     -6467 PROD     GLN      552      CA            3.4224
60250 POS      POT      18       POT     -6469 PROD     GLN      552      CB            2.9923
60250 POS      POT      18       POT     -6472 PROD     GLN      552      CG            4.0104
60250 POS      POT      18       POT     -6480 PROD     GLN      552      C             2.8198
60250 POS      POT      18       POT     -6481 PROD     GLN      552      O             2.7596
60250 POS      POT      18       POT     -6482 PROD     ARG      553      N             3.2860
60250 POS      POT      18       POT     -6484 PROD     ARG      553      CA            3.7942
60250 POS      POT      18       POT     -6550 PROD     ILE      556      CG1           3.5951
60250 POS      POT      18       POT     -6553 PROD     ILE      556      CD            2.6751
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "18" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.305360155"
Evaluating: 128.065641*(0.305360155-0.5)
 Parameter: XPOS <- "-24.9266765"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.727064366"
Evaluating: 128.065641*(0.727064366-0.5)
 Parameter: YPOS <- "29.0791436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.378785479"
Evaluating: 108.613069*(0.378785479-0.5)+-2.187274
 Parameter: ZPOS <- "-15.3527551"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.3527551" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.039292 XMAX =  -22.039292 XAVE =  -22.039292
    YMIN =   20.750592 YMAX =   20.750592 YAVE =   20.750592
    ZMIN =   19.322504 ZMAX =   19.322504 ZAVE =   19.322504
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.9266765"
 RDCMND substituted energy or value "?XAVE" to "-22.0392918"
Evaluating: -24.9266765--22.0392918
 Parameter: XTRAN <- "-2.8873847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.0791436"
 RDCMND substituted energy or value "?YAVE" to "20.7505922"
Evaluating: 29.0791436-20.7505922
 Parameter: YTRAN <- "8.3285514"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.3527551"
 RDCMND substituted energy or value "?ZAVE" to "19.3225041"
Evaluating: -15.3527551-19.3225041
 Parameter: ZTRAN <- "-34.6752592"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.8873847"
 Parameter: YTRAN -> "8.3285514"
 Parameter: ZTRAN -> "-34.6752592"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -2.887385    8.328551  -34.675259
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19120254"
Evaluating: 0.19120254*360.0
 Parameter: XPHI <- "68.8329144"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257242833"
Evaluating: 0.257242833*360.0
 Parameter: YPHI <- "92.6074199"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729891695"
Evaluating: 0.729891695*360.0
 Parameter: ZPHI <- "262.76101"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.9266765"
 Parameter: YPOS -> "29.0791436"
 Parameter: ZPOS -> "-15.3527551"
 Parameter: XPHI -> "68.8329144"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.361089    0.932531
    0.000000   -0.932531    0.361089

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.9266765"
 Parameter: YPOS -> "29.0791436"
 Parameter: ZPOS -> "-15.3527551"
 Parameter: YPHI -> "92.6074199"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.045492    0.000000   -0.998965
    0.000000    1.000000    0.000000
    0.998965    0.000000   -0.045492

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   92.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.9266765"
 Parameter: YPOS -> "29.0791436"
 Parameter: ZPOS -> "-15.3527551"
 Parameter: ZPHI -> "262.76101"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.126008   -0.992029    0.000000
    0.992029   -0.126008    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.926676 XMAX =  -24.926676 XAVE =  -24.926676
    YMIN =   29.079144 YMAX =   29.079144 YAVE =   29.079144
    ZMIN =  -15.352755 ZMAX =  -15.352755 ZAVE =  -15.352755
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.9266765"
Evaluating: -24.9266765+3.5
 Parameter: XMAX <- "-21.4266765"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.0791436"
Evaluating: 29.0791436+3.5
 Parameter: YMAX <- "32.5791436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.3527551"
Evaluating: -15.3527551+3.5
 Parameter: ZMAX <- "-11.8527551"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.9266765"
Evaluating: -24.9266765-3.5
 Parameter: XMIN <- "-28.4266765"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.0791436"
Evaluating: 29.0791436-3.5
 Parameter: YMIN <- "25.5791436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.3527551"
Evaluating: -15.3527551-3.5
 Parameter: ZMIN <- "-18.8527551"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.4266765"
 Parameter: XMIN -> "-28.4266765"
 Parameter: YMAX -> "32.5791436"
 Parameter: YMIN -> "25.5791436"
 Parameter: ZMAX -> "-11.8527551"
 Parameter: ZMIN -> "-18.8527551"
 SELRPN>     18 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      9 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      C11           2.8013
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      P             3.9055
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      O11           3.2795
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      O12           3.1231
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      C1            2.8553
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      C2            3.4165
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      O21           3.1069
60250 POS      POT      18       POT     -**** MEMB     DMPC     273      C21           3.8536
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "18" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.686225318E-02"
Evaluating: 128.065641*(9.686225318E-02-0.5)
 Parameter: XPOS <- "-51.628094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.243887228"
Evaluating: 128.065641*(0.243887228-0.5)
 Parameter: YPOS <- "-32.7992463"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.633191348"
Evaluating: 108.613069*(0.633191348-0.5)+-2.187274
 Parameter: ZPOS <- "12.2790471"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.2790471" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.2790471" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "18" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.812287313"
Evaluating: 128.065641*(0.812287313-0.5)
 Parameter: XPOS <- "39.9932749"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.660580187"
Evaluating: 128.065641*(0.660580187-0.5)
 Parameter: YPOS <- "20.5648046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.865178781"
Evaluating: 108.613069*(0.865178781-0.5)+-2.187274
 Parameter: ZPOS <- "37.4759141"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.4759141" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.4759141" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.926676 XMAX =  -24.926676 XAVE =  -24.926676
    YMIN =   29.079144 YMAX =   29.079144 YAVE =   29.079144
    ZMIN =  -15.352755 ZMAX =  -15.352755 ZAVE =  -15.352755
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.9932749"
 RDCMND substituted energy or value "?XAVE" to "-24.9266765"
Evaluating: 39.9932749--24.9266765
 Parameter: XTRAN <- "64.9199514"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.5648046"
 RDCMND substituted energy or value "?YAVE" to "29.0791436"
Evaluating: 20.5648046-29.0791436
 Parameter: YTRAN <- "-8.514339"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.4759141"
 RDCMND substituted energy or value "?ZAVE" to "-15.3527551"
Evaluating: 37.4759141--15.3527551
 Parameter: ZTRAN <- "52.8286692"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "64.9199514"
 Parameter: YTRAN -> "-8.514339"
 Parameter: ZTRAN -> "52.8286692"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    64.919951   -8.514339   52.828669
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.41537774E-02"
Evaluating: 6.41537774E-02*360.0
 Parameter: XPHI <- "23.0953599"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.97882844E-02"
Evaluating: 8.97882844E-02*360.0
 Parameter: YPHI <- "32.3237824"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192886143"
Evaluating: 0.192886143*360.0
 Parameter: ZPHI <- "69.4390115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.9932749"
 Parameter: YPOS -> "20.5648046"
 Parameter: ZPOS -> "37.4759141"
 Parameter: XPHI -> "23.0953599"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.919853    0.392263
    0.000000   -0.392263    0.919853

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.9932749"
 Parameter: YPOS -> "20.5648046"
 Parameter: ZPOS -> "37.4759141"
 Parameter: YPHI -> "32.3237824"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.845040    0.000000   -0.534703
    0.000000    1.000000    0.000000
    0.534703    0.000000    0.845040

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.9932749"
 Parameter: YPOS -> "20.5648046"
 Parameter: ZPOS -> "37.4759141"
 Parameter: ZPHI -> "69.4390115"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.351204    0.936299    0.000000
   -0.936299    0.351204    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.993275 XMAX =   39.993275 XAVE =   39.993275
    YMIN =   20.564805 YMAX =   20.564805 YAVE =   20.564805
    ZMIN =   37.475914 ZMAX =   37.475914 ZAVE =   37.475914
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.9932749"
Evaluating: 39.9932749+3.5
 Parameter: XMAX <- "43.4932749"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.5648046"
Evaluating: 20.5648046+3.5
 Parameter: YMAX <- "24.0648046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.4759141"
Evaluating: 37.4759141+3.5
 Parameter: ZMAX <- "40.9759141"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.9932749"
Evaluating: 39.9932749-3.5
 Parameter: XMIN <- "36.4932749"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.5648046"
Evaluating: 20.5648046-3.5
 Parameter: YMIN <- "17.0648046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.4759141"
Evaluating: 37.4759141-3.5
 Parameter: ZMIN <- "33.9759141"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.4932749"
 Parameter: XMIN -> "36.4932749"
 Parameter: YMAX -> "24.0648046"
 Parameter: YMIN -> "17.0648046"
 Parameter: ZMAX -> "40.9759141"
 Parameter: ZMIN -> "33.9759141"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "19" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "19" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.825251703"
Evaluating: 128.065641*(0.825251703-0.5)
 Parameter: XPOS <- "41.6535678"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.301375539"
Evaluating: 128.065641*(0.301375539-0.5)
 Parameter: YPOS <- "-25.4369689"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.281660565"
Evaluating: 108.613069*(0.281660565-0.5)+-2.187274
 Parameter: ZPOS <- "-25.9017901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.9017901" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.6535678"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.6535678-0
 Parameter: XTRAN <- "41.6535678"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4369689"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.4369689-0
 Parameter: YTRAN <- "-25.4369689"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.9017901"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.9017901-0
 Parameter: ZTRAN <- "-25.9017901"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.6535678"
 Parameter: YTRAN -> "-25.4369689"
 Parameter: ZTRAN -> "-25.9017901"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    41.653568  -25.436969  -25.901790
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.609306922"
Evaluating: 0.609306922*360.0
 Parameter: XPHI <- "219.350492"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364508896"
Evaluating: 0.364508896*360.0
 Parameter: YPHI <- "131.223203"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921883885"
Evaluating: 0.921883885*360.0
 Parameter: ZPHI <- "331.878199"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.6535678"
 Parameter: YPOS -> "-25.4369689"
 Parameter: ZPOS -> "-25.9017901"
 Parameter: XPHI -> "219.350492"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.773282   -0.634063
    0.000000    0.634063   -0.773282

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.6535678"
 Parameter: YPOS -> "-25.4369689"
 Parameter: ZPOS -> "-25.9017901"
 Parameter: YPHI -> "131.223203"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.658994    0.000000   -0.752148
    0.000000    1.000000    0.000000
    0.752148    0.000000   -0.658994

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.6535678"
 Parameter: YPOS -> "-25.4369689"
 Parameter: ZPOS -> "-25.9017901"
 Parameter: ZPHI -> "331.878199"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.881948   -0.471347    0.000000
    0.471347    0.881948    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.653568 XMAX =   41.653568 XAVE =   41.653568
    YMIN =  -25.436969 YMAX =  -25.436969 YAVE =  -25.436969
    ZMIN =  -25.901790 ZMAX =  -25.901790 ZAVE =  -25.901790
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.6535678"
Evaluating: 41.6535678+3.5
 Parameter: XMAX <- "45.1535678"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4369689"
Evaluating: -25.4369689+3.5
 Parameter: YMAX <- "-21.9369689"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.9017901"
Evaluating: -25.9017901+3.5
 Parameter: ZMAX <- "-22.4017901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.6535678"
Evaluating: 41.6535678-3.5
 Parameter: XMIN <- "38.1535678"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4369689"
Evaluating: -25.4369689-3.5
 Parameter: YMIN <- "-28.9369689"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.9017901"
Evaluating: -25.9017901-3.5
 Parameter: ZMIN <- "-29.4017901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.1535678"
 Parameter: XMIN -> "38.1535678"
 Parameter: YMAX -> "-21.9369689"
 Parameter: YMIN -> "-28.9369689"
 Parameter: ZMAX -> "-22.4017901"
 Parameter: ZMIN -> "-29.4017901"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "20" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "20" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.705738619"
Evaluating: 128.065641*(0.705738619-0.5)
 Parameter: XPOS <- "26.3480481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.279240148"
Evaluating: 128.065641*(0.279240148-0.5)
 Parameter: YPOS <- "-28.271752"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.15211508"
Evaluating: 108.613069*(0.15211508-0.5)+-2.187274
 Parameter: ZPOS <- "-39.9721228"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.9721228" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.3480481"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.3480481-0
 Parameter: XTRAN <- "26.3480481"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.271752"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.271752-0
 Parameter: YTRAN <- "-28.271752"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9721228"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.9721228-0
 Parameter: ZTRAN <- "-39.9721228"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.3480481"
 Parameter: YTRAN -> "-28.271752"
 Parameter: ZTRAN -> "-39.9721228"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    26.348048  -28.271752  -39.972123
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992150844"
Evaluating: 0.992150844*360.0
 Parameter: XPHI <- "357.174304"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840527791"
Evaluating: 0.840527791*360.0
 Parameter: YPHI <- "302.590005"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.709955528"
Evaluating: 0.709955528*360.0
 Parameter: ZPHI <- "255.58399"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.3480481"
 Parameter: YPOS -> "-28.271752"
 Parameter: ZPOS -> "-39.9721228"
 Parameter: XPHI -> "357.174304"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998784   -0.049298
    0.000000    0.049298    0.998784

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.3480481"
 Parameter: YPOS -> "-28.271752"
 Parameter: ZPOS -> "-39.9721228"
 Parameter: YPHI -> "302.590005"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.538624    0.000000    0.842546
    0.000000    1.000000    0.000000
   -0.842546    0.000000    0.538624

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.3480481"
 Parameter: YPOS -> "-28.271752"
 Parameter: ZPOS -> "-39.9721228"
 Parameter: ZPHI -> "255.58399"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.248961   -0.968514    0.000000
    0.968514   -0.248961    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.348048 XMAX =   26.348048 XAVE =   26.348048
    YMIN =  -28.271752 YMAX =  -28.271752 YAVE =  -28.271752
    ZMIN =  -39.972123 ZMAX =  -39.972123 ZAVE =  -39.972123
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.3480481"
Evaluating: 26.3480481+3.5
 Parameter: XMAX <- "29.8480481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.271752"
Evaluating: -28.271752+3.5
 Parameter: YMAX <- "-24.771752"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9721228"
Evaluating: -39.9721228+3.5
 Parameter: ZMAX <- "-36.4721228"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.3480481"
Evaluating: 26.3480481-3.5
 Parameter: XMIN <- "22.8480481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.271752"
Evaluating: -28.271752-3.5
 Parameter: YMIN <- "-31.771752"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9721228"
Evaluating: -39.9721228-3.5
 Parameter: ZMIN <- "-43.4721228"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.8480481"
 Parameter: XMIN -> "22.8480481"
 Parameter: YMAX -> "-24.771752"
 Parameter: YMIN -> "-31.771752"
 Parameter: ZMAX -> "-36.4721228"
 Parameter: ZMIN -> "-43.4721228"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "21" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.326747217"
Evaluating: 128.065641*(0.326747217-0.5)
 Parameter: XPOS <- "-22.1877287"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.379797511"
Evaluating: 128.065641*(0.379797511-0.5)
 Parameter: YPOS <- "-15.3938088"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.725590608"
Evaluating: 108.613069*(0.725590608-0.5)+-2.187274
 Parameter: ZPOS <- "22.3148143"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.3148143" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.3148143" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.1877287"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.1877287-0
 Parameter: XTRAN <- "-22.1877287"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.3938088"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.3938088-0
 Parameter: YTRAN <- "-15.3938088"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.3148143"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.3148143-0
 Parameter: ZTRAN <- "22.3148143"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.1877287"
 Parameter: YTRAN -> "-15.3938088"
 Parameter: ZTRAN -> "22.3148143"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.187729  -15.393809   22.314814
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973697108"
Evaluating: 0.973697108*360.0
 Parameter: XPHI <- "350.530959"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270130031"
Evaluating: 0.270130031*360.0
 Parameter: YPHI <- "97.2468112"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.692205548"
Evaluating: 0.692205548*360.0
 Parameter: ZPHI <- "249.193997"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.1877287"
 Parameter: YPOS -> "-15.3938088"
 Parameter: ZPOS -> "22.3148143"
 Parameter: XPHI -> "350.530959"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986375   -0.164515
    0.000000    0.164515    0.986375

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    9.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.1877287"
 Parameter: YPOS -> "-15.3938088"
 Parameter: ZPOS -> "22.3148143"
 Parameter: YPHI -> "97.2468112"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.126144    0.000000   -0.992012
    0.000000    1.000000    0.000000
    0.992012    0.000000   -0.126144

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.1877287"
 Parameter: YPOS -> "-15.3938088"
 Parameter: ZPOS -> "22.3148143"
 Parameter: ZPHI -> "249.193997"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.355205   -0.934788    0.000000
    0.934788   -0.355205    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.187729 XMAX =  -22.187729 XAVE =  -22.187729
    YMIN =  -15.393809 YMAX =  -15.393809 YAVE =  -15.393809
    ZMIN =   22.314814 ZMAX =   22.314814 ZAVE =   22.314814
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.1877287"
Evaluating: -22.1877287+3.5
 Parameter: XMAX <- "-18.6877287"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.3938088"
Evaluating: -15.3938088+3.5
 Parameter: YMAX <- "-11.8938088"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.3148143"
Evaluating: 22.3148143+3.5
 Parameter: ZMAX <- "25.8148143"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.1877287"
Evaluating: -22.1877287-3.5
 Parameter: XMIN <- "-25.6877287"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.3938088"
Evaluating: -15.3938088-3.5
 Parameter: YMIN <- "-18.8938088"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.3148143"
Evaluating: 22.3148143-3.5
 Parameter: ZMIN <- "18.8148143"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.6877287"
 Parameter: XMIN -> "-25.6877287"
 Parameter: YMAX -> "-11.8938088"
 Parameter: YMIN -> "-18.8938088"
 Parameter: ZMAX -> "25.8148143"
 Parameter: ZMIN -> "18.8148143"
 SELRPN>      9 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      3 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60253 POS      POT      21       POT     -**** MEMB     DMPC     64       N             3.9256
60253 POS      POT      21       POT     -**** MEMB     DMPC     64       C13           2.9655
60253 POS      POT      21       POT     -**** MEMB     DMPC     64       C14           3.6578
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.749718714"
Evaluating: 128.065641*(0.749718714-0.5)
 Parameter: XPOS <- "31.9803872"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.773562468"
Evaluating: 128.065641*(0.773562468-0.5)
 Parameter: YPOS <- "35.0339528"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.302759412"
Evaluating: 108.613069*(0.302759412-0.5)+-2.187274
 Parameter: ZPOS <- "-23.6101796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.6101796" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.187729 XMAX =  -22.187729 XAVE =  -22.187729
    YMIN =  -15.393809 YMAX =  -15.393809 YAVE =  -15.393809
    ZMIN =   22.314814 ZMAX =   22.314814 ZAVE =   22.314814
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.9803872"
 RDCMND substituted energy or value "?XAVE" to "-22.1877287"
Evaluating: 31.9803872--22.1877287
 Parameter: XTRAN <- "54.1681159"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.0339528"
 RDCMND substituted energy or value "?YAVE" to "-15.3938088"
Evaluating: 35.0339528--15.3938088
 Parameter: YTRAN <- "50.4277616"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.6101796"
 RDCMND substituted energy or value "?ZAVE" to "22.3148143"
Evaluating: -23.6101796-22.3148143
 Parameter: ZTRAN <- "-45.9249939"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.1681159"
 Parameter: YTRAN -> "50.4277616"
 Parameter: ZTRAN -> "-45.9249939"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    54.168116   50.427762  -45.924994
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874562357"
Evaluating: 0.874562357*360.0
 Parameter: XPHI <- "314.842449"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173552771"
Evaluating: 0.173552771*360.0
 Parameter: YPHI <- "62.4789976"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847695011"
Evaluating: 0.847695011*360.0
 Parameter: ZPHI <- "305.170204"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.9803872"
 Parameter: YPOS -> "35.0339528"
 Parameter: ZPOS -> "-23.6101796"
 Parameter: XPHI -> "314.842449"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.705160   -0.709048
    0.000000    0.709048    0.705160

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.9803872"
 Parameter: YPOS -> "35.0339528"
 Parameter: ZPOS -> "-23.6101796"
 Parameter: YPHI -> "62.4789976"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.462074    0.000000   -0.886842
    0.000000    1.000000    0.000000
    0.886842    0.000000    0.462074

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.9803872"
 Parameter: YPOS -> "35.0339528"
 Parameter: ZPOS -> "-23.6101796"
 Parameter: ZPHI -> "305.170204"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.576007   -0.817445    0.000000
    0.817445    0.576007    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.980387 XMAX =   31.980387 XAVE =   31.980387
    YMIN =   35.033953 YMAX =   35.033953 YAVE =   35.033953
    ZMIN =  -23.610180 ZMAX =  -23.610180 ZAVE =  -23.610180
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.9803872"
Evaluating: 31.9803872+3.5
 Parameter: XMAX <- "35.4803872"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.0339528"
Evaluating: 35.0339528+3.5
 Parameter: YMAX <- "38.5339528"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.6101796"
Evaluating: -23.6101796+3.5
 Parameter: ZMAX <- "-20.1101796"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.9803872"
Evaluating: 31.9803872-3.5
 Parameter: XMIN <- "28.4803872"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.0339528"
Evaluating: 35.0339528-3.5
 Parameter: YMIN <- "31.5339528"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.6101796"
Evaluating: -23.6101796-3.5
 Parameter: ZMIN <- "-27.1101796"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.4803872"
 Parameter: XMIN -> "28.4803872"
 Parameter: YMAX -> "38.5339528"
 Parameter: YMIN -> "31.5339528"
 Parameter: ZMAX -> "-20.1101796"
 Parameter: ZMIN -> "-27.1101796"
 SELRPN>      4 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      2 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60253 POS      POT      21       POT     - 101 PROA     ASN      396      CG            3.9137
60253 POS      POT      21       POT     - 103 PROA     ASN      396      ND2           3.4464
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.262081096"
Evaluating: 128.065641*(0.262081096-0.5)
 Parameter: XPOS <- "-30.4692369"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.172374485"
Evaluating: 128.065641*(0.172374485-0.5)
 Parameter: YPOS <- "-41.9575716"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.710401469"
Evaluating: 108.613069*(0.710401469-0.5)+-2.187274
 Parameter: ZPOS <- "20.6650753"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.6650753" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.6650753" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.980387 XMAX =   31.980387 XAVE =   31.980387
    YMIN =   35.033953 YMAX =   35.033953 YAVE =   35.033953
    ZMIN =  -23.610180 ZMAX =  -23.610180 ZAVE =  -23.610180
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.4692369"
 RDCMND substituted energy or value "?XAVE" to "31.9803872"
Evaluating: -30.4692369-31.9803872
 Parameter: XTRAN <- "-62.4496241"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.9575716"
 RDCMND substituted energy or value "?YAVE" to "35.0339528"
Evaluating: -41.9575716-35.0339528
 Parameter: YTRAN <- "-76.9915244"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.6650753"
 RDCMND substituted energy or value "?ZAVE" to "-23.6101796"
Evaluating: 20.6650753--23.6101796
 Parameter: ZTRAN <- "44.2752549"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.4496241"
 Parameter: YTRAN -> "-76.9915244"
 Parameter: ZTRAN -> "44.2752549"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -62.449624  -76.991524   44.275255
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.266523244"
Evaluating: 0.266523244*360.0
 Parameter: XPHI <- "95.9483678"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867024947"
Evaluating: 0.867024947*360.0
 Parameter: YPHI <- "312.128981"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304163152"
Evaluating: 0.304163152*360.0
 Parameter: ZPHI <- "109.498735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.4692369"
 Parameter: YPOS -> "-41.9575716"
 Parameter: ZPOS -> "20.6650753"
 Parameter: XPHI -> "95.9483678"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.103632    0.994616
    0.000000   -0.994616   -0.103632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   95.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.4692369"
 Parameter: YPOS -> "-41.9575716"
 Parameter: ZPOS -> "20.6650753"
 Parameter: YPHI -> "312.128981"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.670802    0.000000    0.741637
    0.000000    1.000000    0.000000
   -0.741637    0.000000    0.670802

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.4692369"
 Parameter: YPOS -> "-41.9575716"
 Parameter: ZPOS -> "20.6650753"
 Parameter: ZPHI -> "109.498735"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.333786    0.942649    0.000000
   -0.942649   -0.333786    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  109.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.469237 XMAX =  -30.469237 XAVE =  -30.469237
    YMIN =  -41.957572 YMAX =  -41.957572 YAVE =  -41.957572
    ZMIN =   20.665075 ZMAX =   20.665075 ZAVE =   20.665075
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.4692369"
Evaluating: -30.4692369+3.5
 Parameter: XMAX <- "-26.9692369"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.9575716"
Evaluating: -41.9575716+3.5
 Parameter: YMAX <- "-38.4575716"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.6650753"
Evaluating: 20.6650753+3.5
 Parameter: ZMAX <- "24.1650753"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.4692369"
Evaluating: -30.4692369-3.5
 Parameter: XMIN <- "-33.9692369"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.9575716"
Evaluating: -41.9575716-3.5
 Parameter: YMIN <- "-45.4575716"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.6650753"
Evaluating: 20.6650753-3.5
 Parameter: ZMIN <- "17.1650753"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.9692369"
 Parameter: XMIN -> "-33.9692369"
 Parameter: YMAX -> "-38.4575716"
 Parameter: YMIN -> "-45.4575716"
 Parameter: ZMAX -> "24.1650753"
 Parameter: ZMIN -> "17.1650753"
 SELRPN>     17 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      5 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60253 POS      POT      21       POT     -**** MEMB     DMPC     139      N             1.6092
60253 POS      POT      21       POT     -**** MEMB     DMPC     139      C13           1.5575
60253 POS      POT      21       POT     -**** MEMB     DMPC     139      C14           1.4723
60253 POS      POT      21       POT     -**** MEMB     DMPC     139      C15           2.6134
60253 POS      POT      21       POT     -**** MEMB     DMPC     139      C12           2.8455
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.817248055"
Evaluating: 128.065641*(0.817248055-0.5)
 Parameter: XPOS <- "40.6285755"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.736452676"
Evaluating: 128.065641*(0.736452676-0.5)
 Parameter: YPOS <- "30.2814635"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.462746289"
Evaluating: 108.613069*(0.462746289-0.5)+-2.187274
 Parameter: ZPOS <- "-6.23351388"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.23351388" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.23351388" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.897984155E-02"
Evaluating: 128.065641*(6.897984155E-02-0.5)
 Parameter: XPOS <- "-55.1988729"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.4290058"
Evaluating: 128.065641*(0.4290058-0.5)
 Parameter: YPOS <- "-9.09191773"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.582330093"
Evaluating: 108.613069*(0.582330093-0.5)+-2.187274
 Parameter: ZPOS <- "6.75485007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.75485007" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.75485007" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "21" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.139072026"
Evaluating: 128.065641*(0.139072026-0.5)
 Parameter: XPOS <- "-46.2224723"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.506721565"
Evaluating: 128.065641*(0.506721565-0.5)
 Parameter: YPOS <- "0.86080153"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.875722115"
Evaluating: 108.613069*(0.875722115-0.5)+-2.187274
 Parameter: ZPOS <- "38.621058"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.621058" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.621058" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.469237 XMAX =  -30.469237 XAVE =  -30.469237
    YMIN =  -41.957572 YMAX =  -41.957572 YAVE =  -41.957572
    ZMIN =   20.665075 ZMAX =   20.665075 ZAVE =   20.665075
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.2224723"
 RDCMND substituted energy or value "?XAVE" to "-30.4692369"
Evaluating: -46.2224723--30.4692369
 Parameter: XTRAN <- "-15.7532354"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.86080153"
 RDCMND substituted energy or value "?YAVE" to "-41.9575716"
Evaluating: 0.86080153--41.9575716
 Parameter: YTRAN <- "42.8183731"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.621058"
 RDCMND substituted energy or value "?ZAVE" to "20.6650753"
Evaluating: 38.621058-20.6650753
 Parameter: ZTRAN <- "17.9559827"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.7532354"
 Parameter: YTRAN -> "42.8183731"
 Parameter: ZTRAN -> "17.9559827"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -15.753235   42.818373   17.955983
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598820603"
Evaluating: 0.598820603*360.0
 Parameter: XPHI <- "215.575417"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262177761"
Evaluating: 0.262177761*360.0
 Parameter: YPHI <- "94.383994"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244772403"
Evaluating: 0.244772403*360.0
 Parameter: ZPHI <- "88.1180651"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.2224723"
 Parameter: YPOS -> "0.86080153"
 Parameter: ZPOS -> "38.621058"
 Parameter: XPHI -> "215.575417"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.813350   -0.581774
    0.000000    0.581774   -0.813350

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  144.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.2224723"
 Parameter: YPOS -> "0.86080153"
 Parameter: ZPOS -> "38.621058"
 Parameter: YPHI -> "94.383994"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.076440    0.000000   -0.997074
    0.000000    1.000000    0.000000
    0.997074    0.000000   -0.076440

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.2224723"
 Parameter: YPOS -> "0.86080153"
 Parameter: ZPOS -> "38.621058"
 Parameter: ZPHI -> "88.1180651"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.032840    0.999461    0.000000
   -0.999461    0.032840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.222472 XMAX =  -46.222472 XAVE =  -46.222472
    YMIN =    0.860802 YMAX =    0.860802 YAVE =    0.860802
    ZMIN =   38.621058 ZMAX =   38.621058 ZAVE =   38.621058
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.2224723"
Evaluating: -46.2224723+3.5
 Parameter: XMAX <- "-42.7224723"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.860801513"
Evaluating: 0.860801513+3.5
 Parameter: YMAX <- "4.36080151"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.621058"
Evaluating: 38.621058+3.5
 Parameter: ZMAX <- "42.121058"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.2224723"
Evaluating: -46.2224723-3.5
 Parameter: XMIN <- "-49.7224723"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.860801513"
Evaluating: 0.860801513-3.5
 Parameter: YMIN <- "-2.63919849"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.621058"
Evaluating: 38.621058-3.5
 Parameter: ZMIN <- "35.121058"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.7224723"
 Parameter: XMIN -> "-49.7224723"
 Parameter: YMAX -> "4.36080151"
 Parameter: YMIN -> "-2.63919849"
 Parameter: ZMAX -> "42.121058"
 Parameter: ZMIN -> "35.121058"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "22" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "22" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.294882872"
Evaluating: 128.065641*(0.294882872-0.5)
 Parameter: XPOS <- "-26.2684565"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.119424393"
Evaluating: 128.065641*(0.119424393-0.5)
 Parameter: YPOS <- "-48.7386591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.876656305"
Evaluating: 108.613069*(0.876656305-0.5)+-2.187274
 Parameter: ZPOS <- "38.7225232"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.7225232" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.7225232" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.2684565"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.2684565-0
 Parameter: XTRAN <- "-26.2684565"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.7386591"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.7386591-0
 Parameter: YTRAN <- "-48.7386591"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.7225232"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.7225232-0
 Parameter: ZTRAN <- "38.7225232"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.2684565"
 Parameter: YTRAN -> "-48.7386591"
 Parameter: ZTRAN -> "38.7225232"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -26.268456  -48.738659   38.722523
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.983632327E-03"
Evaluating: 7.983632327E-03*360.0
 Parameter: XPHI <- "2.87410764"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492516554"
Evaluating: 0.492516554*360.0
 Parameter: YPHI <- "177.305959"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.413518182"
Evaluating: 0.413518182*360.0
 Parameter: ZPHI <- "148.866546"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.2684565"
 Parameter: YPOS -> "-48.7386591"
 Parameter: ZPOS -> "38.7225232"
 Parameter: XPHI -> "2.87410764"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998742    0.050142
    0.000000   -0.050142    0.998742

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    2.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.2684565"
 Parameter: YPOS -> "-48.7386591"
 Parameter: ZPOS -> "38.7225232"
 Parameter: YPHI -> "177.305959"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.998895    0.000000   -0.047003
    0.000000    1.000000    0.000000
    0.047003    0.000000   -0.998895

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.2684565"
 Parameter: YPOS -> "-48.7386591"
 Parameter: ZPOS -> "38.7225232"
 Parameter: ZPHI -> "148.866546"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.855965    0.517033    0.000000
   -0.517033   -0.855965    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  148.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.268456 XMAX =  -26.268456 XAVE =  -26.268456
    YMIN =  -48.738659 YMAX =  -48.738659 YAVE =  -48.738659
    ZMIN =   38.722523 ZMAX =   38.722523 ZAVE =   38.722523
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.2684565"
Evaluating: -26.2684565+3.5
 Parameter: XMAX <- "-22.7684565"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.7386591"
Evaluating: -48.7386591+3.5
 Parameter: YMAX <- "-45.2386591"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.7225232"
Evaluating: 38.7225232+3.5
 Parameter: ZMAX <- "42.2225232"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.2684565"
Evaluating: -26.2684565-3.5
 Parameter: XMIN <- "-29.7684565"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.7386591"
Evaluating: -48.7386591-3.5
 Parameter: YMIN <- "-52.2386591"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.7225232"
Evaluating: 38.7225232-3.5
 Parameter: ZMIN <- "35.2225232"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.7684565"
 Parameter: XMIN -> "-29.7684565"
 Parameter: YMAX -> "-45.2386591"
 Parameter: YMIN -> "-52.2386591"
 Parameter: ZMAX -> "42.2225232"
 Parameter: ZMIN -> "35.2225232"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "23" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "23" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.834220184"
Evaluating: 128.065641*(0.834220184-0.5)
 Parameter: XPOS <- "42.8021221"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.499611438"
Evaluating: 128.065641*(0.499611438-0.5)
 Parameter: YPOS <- "-4.97614416E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.530913648"
Evaluating: 108.613069*(0.530913648-0.5)+-2.187274
 Parameter: ZPOS <- "1.17035218"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.17035218" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.17035218" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "23" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.835321019"
Evaluating: 128.065641*(0.835321019-0.5)
 Parameter: XPOS <- "42.9431012"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.626398649"
Evaluating: 128.065641*(0.626398649-0.5)
 Parameter: YPOS <- "16.187324"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.949453192"
Evaluating: 108.613069*(0.949453192-0.5)+-2.187274
 Parameter: ZPOS <- "46.6292166"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.6292166" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.6292166" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.9431012"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.9431012-0
 Parameter: XTRAN <- "42.9431012"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.187324"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.187324-0
 Parameter: YTRAN <- "16.187324"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.6292166"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.6292166-0
 Parameter: ZTRAN <- "46.6292166"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.9431012"
 Parameter: YTRAN -> "16.187324"
 Parameter: ZTRAN -> "46.6292166"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    42.943101   16.187324   46.629217
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758450982"
Evaluating: 0.758450982*360.0
 Parameter: XPHI <- "273.042354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28343674"
Evaluating: 0.28343674*360.0
 Parameter: YPHI <- "102.037226"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.892922274"
Evaluating: 0.892922274*360.0
 Parameter: ZPHI <- "321.452019"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.9431012"
 Parameter: YPOS -> "16.187324"
 Parameter: ZPOS -> "46.6292166"
 Parameter: XPHI -> "273.042354"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.053074   -0.998591
    0.000000    0.998591    0.053074

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.9431012"
 Parameter: YPOS -> "16.187324"
 Parameter: ZPOS -> "46.6292166"
 Parameter: YPHI -> "102.037226"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.208547    0.000000   -0.978012
    0.000000    1.000000    0.000000
    0.978012    0.000000   -0.208547

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.9431012"
 Parameter: YPOS -> "16.187324"
 Parameter: ZPOS -> "46.6292166"
 Parameter: ZPHI -> "321.452019"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.782087   -0.623170    0.000000
    0.623170    0.782087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.943101 XMAX =   42.943101 XAVE =   42.943101
    YMIN =   16.187324 YMAX =   16.187324 YAVE =   16.187324
    ZMIN =   46.629217 ZMAX =   46.629217 ZAVE =   46.629217
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.9431012"
Evaluating: 42.9431012+3.5
 Parameter: XMAX <- "46.4431012"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.187324"
Evaluating: 16.187324+3.5
 Parameter: YMAX <- "19.687324"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.6292166"
Evaluating: 46.6292166+3.5
 Parameter: ZMAX <- "50.1292166"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.9431012"
Evaluating: 42.9431012-3.5
 Parameter: XMIN <- "39.4431012"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.187324"
Evaluating: 16.187324-3.5
 Parameter: YMIN <- "12.687324"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.6292166"
Evaluating: 46.6292166-3.5
 Parameter: ZMIN <- "43.1292166"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.4431012"
 Parameter: XMIN -> "39.4431012"
 Parameter: YMAX -> "19.687324"
 Parameter: YMIN -> "12.687324"
 Parameter: ZMAX -> "50.1292166"
 Parameter: ZMIN -> "43.1292166"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "24" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "24" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.16808621"
Evaluating: 128.065641*(0.16808621-0.5)
 Parameter: XPOS <- "-42.5067523"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.526360315"
Evaluating: 128.065641*(0.526360315-0.5)
 Parameter: YPOS <- "3.37585064"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.396515019"
Evaluating: 108.613069*(0.396515019-0.5)+-2.187274
 Parameter: ZPOS <- "-13.4270954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.4270954" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.4270954" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "24" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.44085728"
Evaluating: 128.065641*(0.44085728-0.5)
 Parameter: XPOS <- "-7.57415035"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.436180188"
Evaluating: 128.065641*(0.436180188-0.5)
 Parameter: YPOS <- "-8.17312513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.348408919"
Evaluating: 108.613069*(0.348408919-0.5)+-2.187274
 Parameter: ZPOS <- "-18.6520465"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6520465" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.57415035"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.57415035-0
 Parameter: XTRAN <- "-7.57415035"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.17312513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.17312513-0
 Parameter: YTRAN <- "-8.17312513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6520465"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6520465-0
 Parameter: ZTRAN <- "-18.6520465"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.57415035"
 Parameter: YTRAN -> "-8.17312513"
 Parameter: ZTRAN -> "-18.6520465"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.574150   -8.173125  -18.652047
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631616714"
Evaluating: 0.631616714*360.0
 Parameter: XPHI <- "227.382017"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950809702"
Evaluating: 0.950809702*360.0
 Parameter: YPHI <- "342.291493"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957761613"
Evaluating: 0.957761613*360.0
 Parameter: ZPHI <- "344.794181"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.57415035"
 Parameter: YPOS -> "-8.17312513"
 Parameter: ZPOS -> "-18.6520465"
 Parameter: XPHI -> "227.382017"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.677107   -0.735885
    0.000000    0.735885   -0.677107

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.57415035"
 Parameter: YPOS -> "-8.17312513"
 Parameter: ZPOS -> "-18.6520465"
 Parameter: YPHI -> "342.291493"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.952616    0.000000    0.304175
    0.000000    1.000000    0.000000
   -0.304175    0.000000    0.952616

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.57415035"
 Parameter: YPOS -> "-8.17312513"
 Parameter: ZPOS -> "-18.6520465"
 Parameter: ZPHI -> "344.794181"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.964990   -0.262287    0.000000
    0.262287    0.964990    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.574150 XMAX =   -7.574150 XAVE =   -7.574150
    YMIN =   -8.173125 YMAX =   -8.173125 YAVE =   -8.173125
    ZMIN =  -18.652047 ZMAX =  -18.652047 ZAVE =  -18.652047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.57415035"
Evaluating: -7.57415035+3.5
 Parameter: XMAX <- "-4.07415035"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.17312513"
Evaluating: -8.17312513+3.5
 Parameter: YMAX <- "-4.67312513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6520465"
Evaluating: -18.6520465+3.5
 Parameter: ZMAX <- "-15.1520465"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.57415035"
Evaluating: -7.57415035-3.5
 Parameter: XMIN <- "-11.0741504"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.17312513"
Evaluating: -8.17312513-3.5
 Parameter: YMIN <- "-11.6731251"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6520465"
Evaluating: -18.6520465-3.5
 Parameter: ZMIN <- "-22.1520465"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.07415035"
 Parameter: XMIN -> "-11.0741504"
 Parameter: YMAX -> "-4.67312513"
 Parameter: YMIN -> "-11.6731251"
 Parameter: ZMAX -> "-15.1520465"
 Parameter: ZMIN -> "-22.1520465"
 SELRPN>     17 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      9 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      C12           3.5121
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      C11           2.4610
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      P             0.8611
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      O13           1.4647
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      O14           1.2386
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      O11           2.4279
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      O12           1.8597
60256 POS      POT      24       POT     -**** MEMB     DMPC     208      C1            3.4369
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "24" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.370142691"
Evaluating: 128.065641*(0.370142691-0.5)
 Parameter: XPOS <- "-16.6302595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.280622553"
Evaluating: 128.065641*(0.280622553-0.5)
 Parameter: YPOS <- "-28.0947134"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.417426796"
Evaluating: 108.613069*(0.417426796-0.5)+-2.187274
 Parameter: ZPOS <- "-11.1558031"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.1558031" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.1558031" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "24" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.142642245"
Evaluating: 128.065641*(0.142642245-0.5)
 Parameter: XPOS <- "-45.76525"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.893629984"
Evaluating: 128.065641*(0.893629984-0.5)
 Parameter: YPOS <- "50.4104762"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.71392556"
Evaluating: 108.613069*(0.71392556-0.5)+-2.187274
 Parameter: ZPOS <- "21.0478376"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.0478376" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.0478376" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.574150 XMAX =   -7.574150 XAVE =   -7.574150
    YMIN =   -8.173125 YMAX =   -8.173125 YAVE =   -8.173125
    ZMIN =  -18.652047 ZMAX =  -18.652047 ZAVE =  -18.652047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.76525"
 RDCMND substituted energy or value "?XAVE" to "-7.57415035"
Evaluating: -45.76525--7.57415035
 Parameter: XTRAN <- "-38.1910996"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.4104762"
 RDCMND substituted energy or value "?YAVE" to "-8.17312513"
Evaluating: 50.4104762--8.17312513
 Parameter: YTRAN <- "58.5836013"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.0478376"
 RDCMND substituted energy or value "?ZAVE" to "-18.6520465"
Evaluating: 21.0478376--18.6520465
 Parameter: ZTRAN <- "39.6998841"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.1910996"
 Parameter: YTRAN -> "58.5836013"
 Parameter: ZTRAN -> "39.6998841"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -38.191100   58.583601   39.699884
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718439896"
Evaluating: 0.718439896*360.0
 Parameter: XPHI <- "258.638363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.458668135"
Evaluating: 0.458668135*360.0
 Parameter: YPHI <- "165.120529"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.843197428"
Evaluating: 0.843197428*360.0
 Parameter: ZPHI <- "303.551074"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.76525"
 Parameter: YPOS -> "50.4104762"
 Parameter: ZPOS -> "21.0478376"
 Parameter: XPHI -> "258.638363"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.197001   -0.980403
    0.000000    0.980403   -0.197001

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.76525"
 Parameter: YPOS -> "50.4104762"
 Parameter: ZPOS -> "21.0478376"
 Parameter: YPHI -> "165.120529"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.966468    0.000000   -0.256787
    0.000000    1.000000    0.000000
    0.256787    0.000000   -0.966468

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.76525"
 Parameter: YPOS -> "50.4104762"
 Parameter: ZPOS -> "21.0478376"
 Parameter: ZPHI -> "303.551074"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.552680   -0.833393    0.000000
    0.833393    0.552680    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   56.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.765250 XMAX =  -45.765250 XAVE =  -45.765250
    YMIN =   50.410476 YMAX =   50.410476 YAVE =   50.410476
    ZMIN =   21.047838 ZMAX =   21.047838 ZAVE =   21.047838
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.76525"
Evaluating: -45.76525+3.5
 Parameter: XMAX <- "-42.26525"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.4104762"
Evaluating: 50.4104762+3.5
 Parameter: YMAX <- "53.9104762"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.0478376"
Evaluating: 21.0478376+3.5
 Parameter: ZMAX <- "24.5478376"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.76525"
Evaluating: -45.76525-3.5
 Parameter: XMIN <- "-49.26525"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.4104762"
Evaluating: 50.4104762-3.5
 Parameter: YMIN <- "46.9104762"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.0478376"
Evaluating: 21.0478376-3.5
 Parameter: ZMIN <- "17.5478376"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.26525"
 Parameter: XMIN -> "-49.26525"
 Parameter: YMAX -> "53.9104762"
 Parameter: YMIN -> "46.9104762"
 Parameter: ZMAX -> "24.5478376"
 Parameter: ZMIN -> "17.5478376"
 SELRPN>      9 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      3 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "25" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "25" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.213866309"
Evaluating: 128.065641*(0.213866309-0.5)
 Parameter: XPOS <- "-36.6438945"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.669407458"
Evaluating: 128.065641*(0.669407458-0.5)
 Parameter: YPOS <- "21.6952747"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.609080602"
Evaluating: 108.613069*(0.609080602-0.5)+-2.187274
 Parameter: ZPOS <- "9.66030495"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.66030495" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.66030495" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "25" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.816782625"
Evaluating: 128.065641*(0.816782625-0.5)
 Parameter: XPOS <- "40.5689699"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.948327116"
Evaluating: 128.065641*(0.948327116-0.5)
 Parameter: YPOS <- "57.4152995"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.544743536"
Evaluating: 108.613069*(0.544743536-0.5)+-2.187274
 Parameter: ZPOS <- "2.67245876"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.67245876" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.67245876" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "25" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.335026822"
Evaluating: 128.065641*(0.335026822-0.5)
 Parameter: XPOS <- "-21.1273958"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.279331877"
Evaluating: 128.065641*(0.279331877-0.5)
 Parameter: YPOS <- "-28.2600046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.623459275"
Evaluating: 108.613069*(0.623459275-0.5)+-2.187274
 Parameter: ZPOS <- "11.2220168"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.2220168" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.2220168" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "25" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.105582078"
Evaluating: 128.065641*(0.105582078-0.5)
 Parameter: XPOS <- "-50.511384"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.621547844"
Evaluating: 128.065641*(0.621547844-0.5)
 Parameter: YPOS <- "15.5661026"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.172098274"
Evaluating: 108.613069*(0.172098274-0.5)+-2.187274
 Parameter: ZPOS <- "-37.8016868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.8016868" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.511384"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.511384-0
 Parameter: XTRAN <- "-50.511384"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.5661026"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.5661026-0
 Parameter: YTRAN <- "15.5661026"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.8016868"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.8016868-0
 Parameter: ZTRAN <- "-37.8016868"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.511384"
 Parameter: YTRAN -> "15.5661026"
 Parameter: ZTRAN -> "-37.8016868"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -50.511384   15.566103  -37.801687
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.573196771"
Evaluating: 0.573196771*360.0
 Parameter: XPHI <- "206.350838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.65484204E-02"
Evaluating: 7.65484204E-02*360.0
 Parameter: YPHI <- "27.5574313"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805995896"
Evaluating: 0.805995896*360.0
 Parameter: ZPHI <- "290.158523"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.511384"
 Parameter: YPOS -> "15.5661026"
 Parameter: ZPOS -> "-37.8016868"
 Parameter: XPHI -> "206.350838"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.896093   -0.443866
    0.000000    0.443866   -0.896093

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  153.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.511384"
 Parameter: YPOS -> "15.5661026"
 Parameter: ZPOS -> "-37.8016868"
 Parameter: YPHI -> "27.5574313"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.886548    0.000000   -0.462637
    0.000000    1.000000    0.000000
    0.462637    0.000000    0.886548

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.511384"
 Parameter: YPOS -> "15.5661026"
 Parameter: ZPOS -> "-37.8016868"
 Parameter: ZPHI -> "290.158523"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.344619   -0.938743    0.000000
    0.938743    0.344619    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.511384 XMAX =  -50.511384 XAVE =  -50.511384
    YMIN =   15.566103 YMAX =   15.566103 YAVE =   15.566103
    ZMIN =  -37.801687 ZMAX =  -37.801687 ZAVE =  -37.801687
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.511384"
Evaluating: -50.511384+3.5
 Parameter: XMAX <- "-47.011384"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.5661026"
Evaluating: 15.5661026+3.5
 Parameter: YMAX <- "19.0661026"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.8016868"
Evaluating: -37.8016868+3.5
 Parameter: ZMAX <- "-34.3016868"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.511384"
Evaluating: -50.511384-3.5
 Parameter: XMIN <- "-54.011384"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.5661026"
Evaluating: 15.5661026-3.5
 Parameter: YMIN <- "12.0661026"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.8016868"
Evaluating: -37.8016868-3.5
 Parameter: ZMIN <- "-41.3016868"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.011384"
 Parameter: XMIN -> "-54.011384"
 Parameter: YMAX -> "19.0661026"
 Parameter: YMIN -> "12.0661026"
 Parameter: ZMAX -> "-34.3016868"
 Parameter: ZMIN -> "-41.3016868"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "26" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "26" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.348954048"
Evaluating: 128.065641*(0.348954048-0.5)
 Parameter: XPOS <- "-19.3437967"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.914597271"
Evaluating: 128.065641*(0.914597271-0.5)
 Parameter: YPOS <- "53.0956653"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.582497674E-02"
Evaluating: 108.613069*(4.582497674E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.5166171"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.5166171" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.3437967"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.3437967-0
 Parameter: XTRAN <- "-19.3437967"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.0956653"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.0956653-0
 Parameter: YTRAN <- "53.0956653"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.5166171"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.5166171-0
 Parameter: ZTRAN <- "-51.5166171"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.3437967"
 Parameter: YTRAN -> "53.0956653"
 Parameter: ZTRAN -> "-51.5166171"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -19.343797   53.095665  -51.516617
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856829387"
Evaluating: 0.856829387*360.0
 Parameter: XPHI <- "308.458579"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537434968"
Evaluating: 0.537434968*360.0
 Parameter: YPHI <- "193.476588"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810889724"
Evaluating: 0.810889724*360.0
 Parameter: ZPHI <- "291.920301"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.3437967"
 Parameter: YPOS -> "53.0956653"
 Parameter: ZPOS -> "-51.5166171"
 Parameter: XPHI -> "308.458579"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.621949   -0.783058
    0.000000    0.783058    0.621949

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.3437967"
 Parameter: YPOS -> "53.0956653"
 Parameter: ZPOS -> "-51.5166171"
 Parameter: YPHI -> "193.476588"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.972465    0.000000    0.233048
    0.000000    1.000000    0.000000
   -0.233048    0.000000   -0.972465

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.3437967"
 Parameter: YPOS -> "53.0956653"
 Parameter: ZPOS -> "-51.5166171"
 Parameter: ZPHI -> "291.920301"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.373317   -0.927704    0.000000
    0.927704    0.373317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.343797 XMAX =  -19.343797 XAVE =  -19.343797
    YMIN =   53.095665 YMAX =   53.095665 YAVE =   53.095665
    ZMIN =  -51.516617 ZMAX =  -51.516617 ZAVE =  -51.516617
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.3437967"
Evaluating: -19.3437967+3.5
 Parameter: XMAX <- "-15.8437967"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.0956653"
Evaluating: 53.0956653+3.5
 Parameter: YMAX <- "56.5956653"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.5166171"
Evaluating: -51.5166171+3.5
 Parameter: ZMAX <- "-48.0166171"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.3437967"
Evaluating: -19.3437967-3.5
 Parameter: XMIN <- "-22.8437967"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.0956653"
Evaluating: 53.0956653-3.5
 Parameter: YMIN <- "49.5956653"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.5166171"
Evaluating: -51.5166171-3.5
 Parameter: ZMIN <- "-55.0166171"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.8437967"
 Parameter: XMIN -> "-22.8437967"
 Parameter: YMAX -> "56.5956653"
 Parameter: YMIN -> "49.5956653"
 Parameter: ZMAX -> "-48.0166171"
 Parameter: ZMIN -> "-55.0166171"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "27" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "27" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.617192244E-02"
Evaluating: 128.065641*(9.617192244E-02-0.5)
 Parameter: XPOS <- "-51.7165016"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.420184945"
Evaluating: 128.065641*(0.420184945-0.5)
 Parameter: YPOS <- "-10.2215662"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "5.790173615E-02"
Evaluating: 108.613069*(5.790173615E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-50.2049232"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.2049232" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.7165016"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.7165016-0
 Parameter: XTRAN <- "-51.7165016"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.2215662"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.2215662-0
 Parameter: YTRAN <- "-10.2215662"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.2049232"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.2049232-0
 Parameter: ZTRAN <- "-50.2049232"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.7165016"
 Parameter: YTRAN -> "-10.2215662"
 Parameter: ZTRAN -> "-50.2049232"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -51.716502  -10.221566  -50.204923
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527273357"
Evaluating: 0.527273357*360.0
 Parameter: XPHI <- "189.818409"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.266976186"
Evaluating: 0.266976186*360.0
 Parameter: YPHI <- "96.111427"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808521809"
Evaluating: 0.808521809*360.0
 Parameter: ZPHI <- "291.067851"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.7165016"
 Parameter: YPOS -> "-10.2215662"
 Parameter: ZPOS -> "-50.2049232"
 Parameter: XPHI -> "189.818409"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.985353   -0.170526
    0.000000    0.170526   -0.985353

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  170.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.7165016"
 Parameter: YPOS -> "-10.2215662"
 Parameter: ZPOS -> "-50.2049232"
 Parameter: YPHI -> "96.111427"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.106462    0.000000   -0.994317
    0.000000    1.000000    0.000000
    0.994317    0.000000   -0.106462

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   96.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.7165016"
 Parameter: YPOS -> "-10.2215662"
 Parameter: ZPOS -> "-50.2049232"
 Parameter: ZPHI -> "291.067851"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.359473   -0.933155    0.000000
    0.933155    0.359473    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.716502 XMAX =  -51.716502 XAVE =  -51.716502
    YMIN =  -10.221566 YMAX =  -10.221566 YAVE =  -10.221566
    ZMIN =  -50.204923 ZMAX =  -50.204923 ZAVE =  -50.204923
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.7165016"
Evaluating: -51.7165016+3.5
 Parameter: XMAX <- "-48.2165016"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.2215662"
Evaluating: -10.2215662+3.5
 Parameter: YMAX <- "-6.7215662"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.2049232"
Evaluating: -50.2049232+3.5
 Parameter: ZMAX <- "-46.7049232"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.7165016"
Evaluating: -51.7165016-3.5
 Parameter: XMIN <- "-55.2165016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.2215662"
Evaluating: -10.2215662-3.5
 Parameter: YMIN <- "-13.7215662"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.2049232"
Evaluating: -50.2049232-3.5
 Parameter: ZMIN <- "-53.7049232"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.2165016"
 Parameter: XMIN -> "-55.2165016"
 Parameter: YMAX -> "-6.7215662"
 Parameter: YMIN -> "-13.7215662"
 Parameter: ZMAX -> "-46.7049232"
 Parameter: ZMIN -> "-53.7049232"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "28" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "28" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.782661627E-02"
Evaluating: 128.065641*(6.782661627E-02-0.5)
 Parameter: XPOS <- "-55.3465614"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.967652474"
Evaluating: 128.065641*(0.967652474-0.5)
 Parameter: YPOS <- "59.8902138"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.494565071"
Evaluating: 108.613069*(0.494565071-0.5)+-2.187274
 Parameter: ZPOS <- "-2.77757832"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.77757832" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.77757832" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "28" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.997277815"
Evaluating: 128.065641*(0.997277815-0.5)
 Parameter: XPOS <- "63.6842021"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.639590758"
Evaluating: 128.065641*(0.639590758-0.5)
 Parameter: YPOS <- "17.8767799"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.262762791"
Evaluating: 108.613069*(0.262762791-0.5)+-2.187274
 Parameter: ZPOS <- "-27.9543354"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.9543354" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "63.6842021"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 63.6842021-0
 Parameter: XTRAN <- "63.6842021"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.8767799"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.8767799-0
 Parameter: YTRAN <- "17.8767799"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.9543354"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.9543354-0
 Parameter: ZTRAN <- "-27.9543354"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "63.6842021"
 Parameter: YTRAN -> "17.8767799"
 Parameter: ZTRAN -> "-27.9543354"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    63.684202   17.876780  -27.954335
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.182246207"
Evaluating: 0.182246207*360.0
 Parameter: XPHI <- "65.6086345"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.965445824"
Evaluating: 0.965445824*360.0
 Parameter: YPHI <- "347.560497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.963198455E-02"
Evaluating: 3.963198455E-02*360.0
 Parameter: ZPHI <- "14.2675144"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "63.6842021"
 Parameter: YPOS -> "17.8767799"
 Parameter: ZPOS -> "-27.9543354"
 Parameter: XPHI -> "65.6086345"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.412967    0.910746
    0.000000   -0.910746    0.412967

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   65.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "63.6842021"
 Parameter: YPOS -> "17.8767799"
 Parameter: ZPOS -> "-27.9543354"
 Parameter: YPHI -> "347.560497"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.976524    0.000000    0.215409
    0.000000    1.000000    0.000000
   -0.215409    0.000000    0.976524

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   12.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "63.6842021"
 Parameter: YPOS -> "17.8767799"
 Parameter: ZPOS -> "-27.9543354"
 Parameter: ZPHI -> "14.2675144"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.969156    0.246450    0.000000
   -0.246450    0.969156    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   63.684202 XMAX =   63.684202 XAVE =   63.684202
    YMIN =   17.876780 YMAX =   17.876780 YAVE =   17.876780
    ZMIN =  -27.954335 ZMAX =  -27.954335 ZAVE =  -27.954335
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "63.6842021"
Evaluating: 63.6842021+3.5
 Parameter: XMAX <- "67.1842021"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.8767799"
Evaluating: 17.8767799+3.5
 Parameter: YMAX <- "21.3767799"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.9543354"
Evaluating: -27.9543354+3.5
 Parameter: ZMAX <- "-24.4543354"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "63.6842021"
Evaluating: 63.6842021-3.5
 Parameter: XMIN <- "60.1842021"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.8767799"
Evaluating: 17.8767799-3.5
 Parameter: YMIN <- "14.3767799"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.9543354"
Evaluating: -27.9543354-3.5
 Parameter: ZMIN <- "-31.4543354"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "67.1842021"
 Parameter: XMIN -> "60.1842021"
 Parameter: YMAX -> "21.3767799"
 Parameter: YMIN -> "14.3767799"
 Parameter: ZMAX -> "-24.4543354"
 Parameter: ZMIN -> "-31.4543354"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "29" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "29" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.515204744"
Evaluating: 128.065641*(0.515204744-0.5)
 Parameter: XPOS <- "1.94720529"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.583876038"
Evaluating: 128.065641*(0.583876038-0.5)
 Parameter: YPOS <- "10.7416386"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.431325975"
Evaluating: 108.613069*(0.431325975-0.5)+-2.187274
 Parameter: ZPOS <- "-9.64617062"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.64617062" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.64617062" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "29" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.339724287E-02"
Evaluating: 128.065641*(5.339724287E-02-0.5)
 Parameter: XPOS <- "-57.1944684"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.773185706"
Evaluating: 128.065641*(0.773185706-0.5)
 Parameter: YPOS <- "34.9857026"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.232774459"
Evaluating: 108.613069*(0.232774459-0.5)+-2.187274
 Parameter: ZPOS <- "-31.2114601"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.2114601" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.1944684"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.1944684-0
 Parameter: XTRAN <- "-57.1944684"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.9857026"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.9857026-0
 Parameter: YTRAN <- "34.9857026"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.2114601"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.2114601-0
 Parameter: ZTRAN <- "-31.2114601"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.1944684"
 Parameter: YTRAN -> "34.9857026"
 Parameter: ZTRAN -> "-31.2114601"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -57.194468   34.985703  -31.211460
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148068404"
Evaluating: 0.148068404*360.0
 Parameter: XPHI <- "53.3046254"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798890402"
Evaluating: 0.798890402*360.0
 Parameter: YPHI <- "287.600545"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302532032"
Evaluating: 0.302532032*360.0
 Parameter: ZPHI <- "108.911532"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.1944684"
 Parameter: YPOS -> "34.9857026"
 Parameter: ZPOS -> "-31.2114601"
 Parameter: XPHI -> "53.3046254"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.597560    0.801824
    0.000000   -0.801824    0.597560

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.1944684"
 Parameter: YPOS -> "34.9857026"
 Parameter: ZPOS -> "-31.2114601"
 Parameter: YPHI -> "287.600545"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.302379    0.000000    0.953188
    0.000000    1.000000    0.000000
   -0.953188    0.000000    0.302379

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.1944684"
 Parameter: YPOS -> "34.9857026"
 Parameter: ZPOS -> "-31.2114601"
 Parameter: ZPHI -> "108.911532"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.324108    0.946020    0.000000
   -0.946020   -0.324108    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.194468 XMAX =  -57.194468 XAVE =  -57.194468
    YMIN =   34.985703 YMAX =   34.985703 YAVE =   34.985703
    ZMIN =  -31.211460 ZMAX =  -31.211460 ZAVE =  -31.211460
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.1944684"
Evaluating: -57.1944684+3.5
 Parameter: XMAX <- "-53.6944684"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.9857026"
Evaluating: 34.9857026+3.5
 Parameter: YMAX <- "38.4857026"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.2114601"
Evaluating: -31.2114601+3.5
 Parameter: ZMAX <- "-27.7114601"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.1944684"
Evaluating: -57.1944684-3.5
 Parameter: XMIN <- "-60.6944684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.9857026"
Evaluating: 34.9857026-3.5
 Parameter: YMIN <- "31.4857026"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.2114601"
Evaluating: -31.2114601-3.5
 Parameter: ZMIN <- "-34.7114601"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.6944684"
 Parameter: XMIN -> "-60.6944684"
 Parameter: YMAX -> "38.4857026"
 Parameter: YMIN -> "31.4857026"
 Parameter: ZMAX -> "-27.7114601"
 Parameter: ZMIN -> "-34.7114601"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "30" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "30" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.777996404"
Evaluating: 128.065641*(0.777996404-0.5)
 Parameter: XPOS <- "35.6017877"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.181498819"
Evaluating: 128.065641*(0.181498819-0.5)
 Parameter: YPOS <- "-40.7890579"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.870991617"
Evaluating: 108.613069*(0.870991617-0.5)+-2.187274
 Parameter: ZPOS <- "38.1072641"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.1072641" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.1072641" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.6017877"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.6017877-0
 Parameter: XTRAN <- "35.6017877"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.7890579"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.7890579-0
 Parameter: YTRAN <- "-40.7890579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.1072641"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.1072641-0
 Parameter: ZTRAN <- "38.1072641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.6017877"
 Parameter: YTRAN -> "-40.7890579"
 Parameter: ZTRAN -> "38.1072641"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    35.601788  -40.789058   38.107264
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429957707"
Evaluating: 0.429957707*360.0
 Parameter: XPHI <- "154.784775"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604045545"
Evaluating: 0.604045545*360.0
 Parameter: YPHI <- "217.456396"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188144748"
Evaluating: 0.188144748*360.0
 Parameter: ZPHI <- "67.7321093"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.6017877"
 Parameter: YPOS -> "-40.7890579"
 Parameter: ZPOS -> "38.1072641"
 Parameter: XPHI -> "154.784775"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.904714    0.426020
    0.000000   -0.426020   -0.904714

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.6017877"
 Parameter: YPOS -> "-40.7890579"
 Parameter: ZPOS -> "38.1072641"
 Parameter: YPHI -> "217.456396"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.793816    0.000000    0.608157
    0.000000    1.000000    0.000000
   -0.608157    0.000000   -0.793816

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.6017877"
 Parameter: YPOS -> "-40.7890579"
 Parameter: ZPOS -> "38.1072641"
 Parameter: ZPHI -> "67.7321093"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.378938    0.925422    0.000000
   -0.925422    0.378938    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.601788 XMAX =   35.601788 XAVE =   35.601788
    YMIN =  -40.789058 YMAX =  -40.789058 YAVE =  -40.789058
    ZMIN =   38.107264 ZMAX =   38.107264 ZAVE =   38.107264
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.6017877"
Evaluating: 35.6017877+3.5
 Parameter: XMAX <- "39.1017877"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.7890579"
Evaluating: -40.7890579+3.5
 Parameter: YMAX <- "-37.2890579"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.1072641"
Evaluating: 38.1072641+3.5
 Parameter: ZMAX <- "41.6072641"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.6017877"
Evaluating: 35.6017877-3.5
 Parameter: XMIN <- "32.1017877"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.7890579"
Evaluating: -40.7890579-3.5
 Parameter: YMIN <- "-44.2890579"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.1072641"
Evaluating: 38.1072641-3.5
 Parameter: ZMIN <- "34.6072641"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.1017877"
 Parameter: XMIN -> "32.1017877"
 Parameter: YMAX -> "-37.2890579"
 Parameter: YMIN -> "-44.2890579"
 Parameter: ZMAX -> "41.6072641"
 Parameter: ZMIN -> "34.6072641"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "31" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "31" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.320603882"
Evaluating: 128.065641*(0.320603882-0.5)
 Parameter: XPOS <- "-22.9744788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.873236019"
Evaluating: 128.065641*(0.873236019-0.5)
 Parameter: YPOS <- "47.79871"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.831986731"
Evaluating: 108.613069*(0.831986731-0.5)+-2.187274
 Parameter: ZPOS <- "33.8708237"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.8708237" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.8708237" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.9744788"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.9744788-0
 Parameter: XTRAN <- "-22.9744788"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.79871"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.79871-0
 Parameter: YTRAN <- "47.79871"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.8708237"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.8708237-0
 Parameter: ZTRAN <- "33.8708237"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.9744788"
 Parameter: YTRAN -> "47.79871"
 Parameter: ZTRAN -> "33.8708237"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.974479   47.798710   33.870824
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504262051"
Evaluating: 0.504262051*360.0
 Parameter: XPHI <- "181.534338"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954020935"
Evaluating: 0.954020935*360.0
 Parameter: YPHI <- "343.447537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.721957589"
Evaluating: 0.721957589*360.0
 Parameter: ZPHI <- "259.904732"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.9744788"
 Parameter: YPOS -> "47.79871"
 Parameter: ZPOS -> "33.8708237"
 Parameter: XPHI -> "181.534338"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999641   -0.026776
    0.000000    0.026776   -0.999641

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  178.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.9744788"
 Parameter: YPOS -> "47.79871"
 Parameter: ZPOS -> "33.8708237"
 Parameter: YPHI -> "343.447537"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.958559    0.000000    0.284893
    0.000000    1.000000    0.000000
   -0.284893    0.000000    0.958559

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.9744788"
 Parameter: YPOS -> "47.79871"
 Parameter: ZPOS -> "33.8708237"
 Parameter: ZPHI -> "259.904732"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.175285   -0.984518    0.000000
    0.984518   -0.175285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.974479 XMAX =  -22.974479 XAVE =  -22.974479
    YMIN =   47.798710 YMAX =   47.798710 YAVE =   47.798710
    ZMIN =   33.870824 ZMAX =   33.870824 ZAVE =   33.870824
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.9744788"
Evaluating: -22.9744788+3.5
 Parameter: XMAX <- "-19.4744788"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.79871"
Evaluating: 47.79871+3.5
 Parameter: YMAX <- "51.29871"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.8708237"
Evaluating: 33.8708237+3.5
 Parameter: ZMAX <- "37.3708237"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.9744788"
Evaluating: -22.9744788-3.5
 Parameter: XMIN <- "-26.4744788"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.79871"
Evaluating: 47.79871-3.5
 Parameter: YMIN <- "44.29871"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.8708237"
Evaluating: 33.8708237-3.5
 Parameter: ZMIN <- "30.3708237"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.4744788"
 Parameter: XMIN -> "-26.4744788"
 Parameter: YMAX -> "51.29871"
 Parameter: YMIN -> "44.29871"
 Parameter: ZMAX -> "37.3708237"
 Parameter: ZMIN -> "30.3708237"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "32" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "32" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.42533133"
Evaluating: 128.065641*(0.42533133-0.5)
 Parameter: XPOS <- "-9.56249109"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.947913598"
Evaluating: 128.065641*(0.947913598-0.5)
 Parameter: YPOS <- "57.362342"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.199730303"
Evaluating: 108.613069*(0.199730303-0.5)+-2.187274
 Parameter: ZPOS <- "-34.8004873"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.8004873" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.56249109"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.56249109-0
 Parameter: XTRAN <- "-9.56249109"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.362342"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.362342-0
 Parameter: YTRAN <- "57.362342"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.8004873"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.8004873-0
 Parameter: ZTRAN <- "-34.8004873"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.56249109"
 Parameter: YTRAN -> "57.362342"
 Parameter: ZTRAN -> "-34.8004873"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -9.562491   57.362342  -34.800487
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633361932"
Evaluating: 0.633361932*360.0
 Parameter: XPHI <- "228.010296"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26203169"
Evaluating: 0.26203169*360.0
 Parameter: YPHI <- "94.3314084"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668638216"
Evaluating: 0.668638216*360.0
 Parameter: ZPHI <- "240.709758"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.56249109"
 Parameter: YPOS -> "57.362342"
 Parameter: ZPOS -> "-34.8004873"
 Parameter: XPHI -> "228.010296"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.668997   -0.743265
    0.000000    0.743265   -0.668997

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.56249109"
 Parameter: YPOS -> "57.362342"
 Parameter: ZPOS -> "-34.8004873"
 Parameter: YPHI -> "94.3314084"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.075525    0.000000   -0.997144
    0.000000    1.000000    0.000000
    0.997144    0.000000   -0.075525

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.56249109"
 Parameter: YPOS -> "57.362342"
 Parameter: ZPOS -> "-34.8004873"
 Parameter: ZPHI -> "240.709758"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.489234   -0.872153    0.000000
    0.872153   -0.489234    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.562491 XMAX =   -9.562491 XAVE =   -9.562491
    YMIN =   57.362342 YMAX =   57.362342 YAVE =   57.362342
    ZMIN =  -34.800487 ZMAX =  -34.800487 ZAVE =  -34.800487
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.56249109"
Evaluating: -9.56249109+3.5
 Parameter: XMAX <- "-6.06249109"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.362342"
Evaluating: 57.362342+3.5
 Parameter: YMAX <- "60.862342"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.8004873"
Evaluating: -34.8004873+3.5
 Parameter: ZMAX <- "-31.3004873"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.56249109"
Evaluating: -9.56249109-3.5
 Parameter: XMIN <- "-13.0624911"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.362342"
Evaluating: 57.362342-3.5
 Parameter: YMIN <- "53.862342"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.8004873"
Evaluating: -34.8004873-3.5
 Parameter: ZMIN <- "-38.3004873"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.06249109"
 Parameter: XMIN -> "-13.0624911"
 Parameter: YMAX -> "60.862342"
 Parameter: YMIN -> "53.862342"
 Parameter: ZMAX -> "-31.3004873"
 Parameter: ZMIN -> "-38.3004873"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "33" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "33" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.82392169"
Evaluating: 128.065641*(0.82392169-0.5)
 Parameter: XPOS <- "41.4832389"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.693419392E-02"
Evaluating: 128.065641*(7.693419392E-02-0.5)
 Parameter: YPOS <- "-54.1801936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.362777646"
Evaluating: 108.613069*(0.362777646-0.5)+-2.187274
 Parameter: ZPOS <- "-17.091415"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.091415" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.4832389"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.4832389-0
 Parameter: XTRAN <- "41.4832389"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.1801936"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.1801936-0
 Parameter: YTRAN <- "-54.1801936"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.091415"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.091415-0
 Parameter: ZTRAN <- "-17.091415"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.4832389"
 Parameter: YTRAN -> "-54.1801936"
 Parameter: ZTRAN -> "-17.091415"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    41.483239  -54.180194  -17.091415
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457270714"
Evaluating: 0.457270714*360.0
 Parameter: XPHI <- "164.617457"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.434575861"
Evaluating: 0.434575861*360.0
 Parameter: YPHI <- "156.44731"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.292557432"
Evaluating: 0.292557432*360.0
 Parameter: ZPHI <- "105.320676"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.4832389"
 Parameter: YPOS -> "-54.1801936"
 Parameter: ZPOS -> "-17.091415"
 Parameter: XPHI -> "164.617457"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.964176    0.265262
    0.000000   -0.265262   -0.964176

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  164.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.4832389"
 Parameter: YPOS -> "-54.1801936"
 Parameter: ZPOS -> "-17.091415"
 Parameter: YPHI -> "156.44731"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.916693    0.000000   -0.399592
    0.000000    1.000000    0.000000
    0.399592    0.000000   -0.916693

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.4832389"
 Parameter: YPOS -> "-54.1801936"
 Parameter: ZPOS -> "-17.091415"
 Parameter: ZPHI -> "105.320676"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.264221    0.964462    0.000000
   -0.964462   -0.264221    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  105.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.483239 XMAX =   41.483239 XAVE =   41.483239
    YMIN =  -54.180194 YMAX =  -54.180194 YAVE =  -54.180194
    ZMIN =  -17.091415 ZMAX =  -17.091415 ZAVE =  -17.091415
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.4832389"
Evaluating: 41.4832389+3.5
 Parameter: XMAX <- "44.9832389"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.1801936"
Evaluating: -54.1801936+3.5
 Parameter: YMAX <- "-50.6801936"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.091415"
Evaluating: -17.091415+3.5
 Parameter: ZMAX <- "-13.591415"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.4832389"
Evaluating: 41.4832389-3.5
 Parameter: XMIN <- "37.9832389"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.1801936"
Evaluating: -54.1801936-3.5
 Parameter: YMIN <- "-57.6801936"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.091415"
Evaluating: -17.091415-3.5
 Parameter: ZMIN <- "-20.591415"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.9832389"
 Parameter: XMIN -> "37.9832389"
 Parameter: YMAX -> "-50.6801936"
 Parameter: YMIN -> "-57.6801936"
 Parameter: ZMAX -> "-13.591415"
 Parameter: ZMIN -> "-20.591415"
 SELRPN>     23 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      7 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60265 POS      POT      33       POT     -**** MEMB     DMPC     284      N             2.8919
60265 POS      POT      33       POT     -**** MEMB     DMPC     284      C13           1.9388
60265 POS      POT      33       POT     -**** MEMB     DMPC     284      C15           2.8284
60265 POS      POT      33       POT     -**** MEMB     DMPC     284      C12           3.8960
60265 POS      POT      33       POT     -**** MEMB     DMPC     285      O13           3.6390
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "33" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.841857238"
Evaluating: 128.065641*(0.841857238-0.5)
 Parameter: XPOS <- "43.7801663"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.504429917"
Evaluating: 128.065641*(0.504429917-0.5)
 Parameter: YPOS <- "0.56732016"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.83905785"
Evaluating: 108.613069*(0.83905785-0.5)+-2.187274
 Parameter: ZPOS <- "34.6388397"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.6388397" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.6388397" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.483239 XMAX =   41.483239 XAVE =   41.483239
    YMIN =  -54.180194 YMAX =  -54.180194 YAVE =  -54.180194
    ZMIN =  -17.091415 ZMAX =  -17.091415 ZAVE =  -17.091415
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.7801663"
 RDCMND substituted energy or value "?XAVE" to "41.4832389"
Evaluating: 43.7801663-41.4832389
 Parameter: XTRAN <- "2.2969274"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.56732016"
 RDCMND substituted energy or value "?YAVE" to "-54.1801936"
Evaluating: 0.56732016--54.1801936
 Parameter: YTRAN <- "54.7475138"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.6388397"
 RDCMND substituted energy or value "?ZAVE" to "-17.091415"
Evaluating: 34.6388397--17.091415
 Parameter: ZTRAN <- "51.7302547"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.2969274"
 Parameter: YTRAN -> "54.7475138"
 Parameter: ZTRAN -> "51.7302547"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     2.296927   54.747514   51.730255
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.089447499E-02"
Evaluating: 6.089447499E-02*360.0
 Parameter: XPHI <- "21.922011"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.936271833E-02"
Evaluating: 3.936271833E-02*360.0
 Parameter: YPHI <- "14.1705786"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735709516"
Evaluating: 0.735709516*360.0
 Parameter: ZPHI <- "264.855426"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.7801663"
 Parameter: YPOS -> "0.56732016"
 Parameter: ZPOS -> "34.6388397"
 Parameter: XPHI -> "21.922011"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.927693    0.373344
    0.000000   -0.373344    0.927693

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   21.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.7801663"
 Parameter: YPOS -> "0.56732016"
 Parameter: ZPOS -> "34.6388397"
 Parameter: YPHI -> "14.1705786"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.969571    0.000000   -0.244810
    0.000000    1.000000    0.000000
    0.244810    0.000000    0.969571

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   14.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.7801663"
 Parameter: YPOS -> "0.56732016"
 Parameter: ZPOS -> "34.6388397"
 Parameter: ZPHI -> "264.855426"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.089669   -0.995972    0.000000
    0.995972   -0.089669    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.780166 XMAX =   43.780166 XAVE =   43.780166
    YMIN =    0.567320 YMAX =    0.567320 YAVE =    0.567320
    ZMIN =   34.638840 ZMAX =   34.638840 ZAVE =   34.638840
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.7801663"
Evaluating: 43.7801663+3.5
 Parameter: XMAX <- "47.2801663"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.56732016"
Evaluating: 0.56732016+3.5
 Parameter: YMAX <- "4.06732016"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.6388397"
Evaluating: 34.6388397+3.5
 Parameter: ZMAX <- "38.1388397"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.7801663"
Evaluating: 43.7801663-3.5
 Parameter: XMIN <- "40.2801663"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.56732016"
Evaluating: 0.56732016-3.5
 Parameter: YMIN <- "-2.93267984"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.6388397"
Evaluating: 34.6388397-3.5
 Parameter: ZMIN <- "31.1388397"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.2801663"
 Parameter: XMIN -> "40.2801663"
 Parameter: YMAX -> "4.06732016"
 Parameter: YMIN -> "-2.93267984"
 Parameter: ZMAX -> "38.1388397"
 Parameter: ZMIN -> "31.1388397"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "34" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "34" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.604715742"
Evaluating: 128.065641*(0.604715742-0.5)
 Parameter: XPOS <- "13.4104886"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.383326423"
Evaluating: 128.065641*(0.383326423-0.5)
 Parameter: YPOS <- "-14.9418764"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.359091047"
Evaluating: 108.613069*(0.359091047-0.5)+-2.187274
 Parameter: ZPOS <- "-17.4918278"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.4918278" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.4104886"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.4104886-0
 Parameter: XTRAN <- "13.4104886"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.9418764"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.9418764-0
 Parameter: YTRAN <- "-14.9418764"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.4918278"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.4918278-0
 Parameter: ZTRAN <- "-17.4918278"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.4104886"
 Parameter: YTRAN -> "-14.9418764"
 Parameter: ZTRAN -> "-17.4918278"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    13.410489  -14.941876  -17.491828
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.497991471"
Evaluating: 0.497991471*360.0
 Parameter: XPHI <- "179.27693"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699554194"
Evaluating: 0.699554194*360.0
 Parameter: YPHI <- "251.83951"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197002559"
Evaluating: 0.197002559*360.0
 Parameter: ZPHI <- "70.9209212"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.4104886"
 Parameter: YPOS -> "-14.9418764"
 Parameter: ZPOS -> "-17.4918278"
 Parameter: XPHI -> "179.27693"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999920    0.012620
    0.000000   -0.012620   -0.999920

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.4104886"
 Parameter: YPOS -> "-14.9418764"
 Parameter: ZPOS -> "-17.4918278"
 Parameter: YPHI -> "251.83951"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.311680    0.000000    0.950187
    0.000000    1.000000    0.000000
   -0.950187    0.000000   -0.311680

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.4104886"
 Parameter: YPOS -> "-14.9418764"
 Parameter: ZPOS -> "-17.4918278"
 Parameter: ZPHI -> "70.9209212"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.326873    0.945068    0.000000
   -0.945068    0.326873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.410489 XMAX =   13.410489 XAVE =   13.410489
    YMIN =  -14.941876 YMAX =  -14.941876 YAVE =  -14.941876
    ZMIN =  -17.491828 ZMAX =  -17.491828 ZAVE =  -17.491828
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.4104886"
Evaluating: 13.4104886+3.5
 Parameter: XMAX <- "16.9104886"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.9418764"
Evaluating: -14.9418764+3.5
 Parameter: YMAX <- "-11.4418764"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.4918278"
Evaluating: -17.4918278+3.5
 Parameter: ZMAX <- "-13.9918278"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.4104886"
Evaluating: 13.4104886-3.5
 Parameter: XMIN <- "9.9104886"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.9418764"
Evaluating: -14.9418764-3.5
 Parameter: YMIN <- "-18.4418764"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.4918278"
Evaluating: -17.4918278-3.5
 Parameter: ZMIN <- "-20.9918278"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.9104886"
 Parameter: XMIN -> "9.9104886"
 Parameter: YMAX -> "-11.4418764"
 Parameter: YMIN -> "-18.4418764"
 Parameter: ZMAX -> "-13.9918278"
 Parameter: ZMIN -> "-20.9918278"
 SELRPN>     33 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     16 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60266 POS      POT      34       POT     -**** MEMB     DMPC     188      C2            3.8225
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      O11           3.6882
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      C1            2.6802
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      C2            2.1603
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      O21           3.4975
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      C21           3.9520
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      O22           3.5729
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      C3            2.1191
60266 POS      POT      34       POT     -**** MEMB     DMPC     225      O31           3.4848
60266 POS      POT      34       POT     -**** MEMB     DMPC     229      N             3.3208
60266 POS      POT      34       POT     -**** MEMB     DMPC     229      C15           1.9166
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "34" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.598322739"
Evaluating: 128.065641*(0.598322739-0.5)
 Parameter: XPOS <- "12.5917646"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.790814509"
Evaluating: 128.065641*(0.790814509-0.5)
 Parameter: YPOS <- "37.2433465"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.873370917"
Evaluating: 108.613069*(0.873370917-0.5)+-2.187274
 Parameter: ZPOS <- "38.3656872"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.3656872" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.3656872" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.410489 XMAX =   13.410489 XAVE =   13.410489
    YMIN =  -14.941876 YMAX =  -14.941876 YAVE =  -14.941876
    ZMIN =  -17.491828 ZMAX =  -17.491828 ZAVE =  -17.491828
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.5917646"
 RDCMND substituted energy or value "?XAVE" to "13.4104886"
Evaluating: 12.5917646-13.4104886
 Parameter: XTRAN <- "-0.818724"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.2433465"
 RDCMND substituted energy or value "?YAVE" to "-14.9418764"
Evaluating: 37.2433465--14.9418764
 Parameter: YTRAN <- "52.1852229"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.3656872"
 RDCMND substituted energy or value "?ZAVE" to "-17.4918278"
Evaluating: 38.3656872--17.4918278
 Parameter: ZTRAN <- "55.857515"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.818724"
 Parameter: YTRAN -> "52.1852229"
 Parameter: ZTRAN -> "55.857515"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -0.818724   52.185223   55.857515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466581596"
Evaluating: 0.466581596*360.0
 Parameter: XPHI <- "167.969375"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397779041"
Evaluating: 0.397779041*360.0
 Parameter: YPHI <- "143.200455"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.326426735"
Evaluating: 0.326426735*360.0
 Parameter: ZPHI <- "117.513625"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.5917646"
 Parameter: YPOS -> "37.2433465"
 Parameter: ZPOS -> "38.3656872"
 Parameter: XPHI -> "167.969375"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978036    0.208434
    0.000000   -0.208434   -0.978036

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.5917646"
 Parameter: YPOS -> "37.2433465"
 Parameter: ZPOS -> "38.3656872"
 Parameter: YPHI -> "143.200455"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.800736    0.000000   -0.599017
    0.000000    1.000000    0.000000
    0.599017    0.000000   -0.800736

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  143.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.5917646"
 Parameter: YPOS -> "37.2433465"
 Parameter: ZPOS -> "38.3656872"
 Parameter: ZPHI -> "117.513625"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.461960    0.886901    0.000000
   -0.886901   -0.461960    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  117.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.591765 XMAX =   12.591765 XAVE =   12.591765
    YMIN =   37.243347 YMAX =   37.243347 YAVE =   37.243347
    ZMIN =   38.365687 ZMAX =   38.365687 ZAVE =   38.365687
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.5917646"
Evaluating: 12.5917646+3.5
 Parameter: XMAX <- "16.0917646"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.2433465"
Evaluating: 37.2433465+3.5
 Parameter: YMAX <- "40.7433465"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.3656872"
Evaluating: 38.3656872+3.5
 Parameter: ZMAX <- "41.8656872"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.5917646"
Evaluating: 12.5917646-3.5
 Parameter: XMIN <- "9.0917646"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.2433465"
Evaluating: 37.2433465-3.5
 Parameter: YMIN <- "33.7433465"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.3656872"
Evaluating: 38.3656872-3.5
 Parameter: ZMIN <- "34.8656872"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.0917646"
 Parameter: XMIN -> "9.0917646"
 Parameter: YMAX -> "40.7433465"
 Parameter: YMIN -> "33.7433465"
 Parameter: ZMAX -> "41.8656872"
 Parameter: ZMIN -> "34.8656872"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "35" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "35" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.170700126"
Evaluating: 128.065641*(0.170700126-0.5)
 Parameter: XPOS <- "-42.1719994"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.746227899"
Evaluating: 128.065641*(0.746227899-0.5)
 Parameter: YPOS <- "31.5333337"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.484181735"
Evaluating: 108.613069*(0.484181735-0.5)+-2.187274
 Parameter: ZPOS <- "-3.90534431"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.90534431" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.90534431" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "35" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.938074238"
Evaluating: 128.065641*(0.938074238-0.5)
 Parameter: XPOS <- "56.1022581"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.196751816E-02"
Evaluating: 128.065641*(2.196751816E-02-0.5)
 Parameter: YPOS <- "-61.2195362"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.640034409"
Evaluating: 108.613069*(0.640034409-0.5)+-2.187274
 Parameter: ZPOS <- "13.0222929"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.0222929" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.0222929" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "35" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.397159942"
Evaluating: 128.065641*(0.397159942-0.5)
 Parameter: XPOS <- "-13.1702779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.802902707"
Evaluating: 128.065641*(0.802902707-0.5)
 Parameter: YPOS <- "38.7914293"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.791968212"
Evaluating: 108.613069*(0.791968212-0.5)+-2.187274
 Parameter: ZPOS <- "29.5242896"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.5242896" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.5242896" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.1702779"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.1702779-0
 Parameter: XTRAN <- "-13.1702779"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.7914293"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.7914293-0
 Parameter: YTRAN <- "38.7914293"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.5242896"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.5242896-0
 Parameter: ZTRAN <- "29.5242896"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.1702779"
 Parameter: YTRAN -> "38.7914293"
 Parameter: ZTRAN -> "29.5242896"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -13.170278   38.791429   29.524290
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697958015"
Evaluating: 0.697958015*360.0
 Parameter: XPHI <- "251.264885"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554760822"
Evaluating: 0.554760822*360.0
 Parameter: YPHI <- "199.713896"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537303655"
Evaluating: 0.537303655*360.0
 Parameter: ZPHI <- "193.429316"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.1702779"
 Parameter: YPOS -> "38.7914293"
 Parameter: ZPOS -> "29.5242896"
 Parameter: XPHI -> "251.264885"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.321193   -0.947014
    0.000000    0.947014   -0.321193

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.1702779"
 Parameter: YPOS -> "38.7914293"
 Parameter: ZPOS -> "29.5242896"
 Parameter: YPHI -> "199.713896"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.941389    0.000000    0.337324
    0.000000    1.000000    0.000000
   -0.337324    0.000000   -0.941389

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.1702779"
 Parameter: YPOS -> "38.7914293"
 Parameter: ZPOS -> "29.5242896"
 Parameter: ZPHI -> "193.429316"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.972657   -0.232246    0.000000
    0.232246   -0.972657    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.170278 XMAX =  -13.170278 XAVE =  -13.170278
    YMIN =   38.791429 YMAX =   38.791429 YAVE =   38.791429
    ZMIN =   29.524290 ZMAX =   29.524290 ZAVE =   29.524290
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.1702779"
Evaluating: -13.1702779+3.5
 Parameter: XMAX <- "-9.6702779"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.7914293"
Evaluating: 38.7914293+3.5
 Parameter: YMAX <- "42.2914293"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.5242896"
Evaluating: 29.5242896+3.5
 Parameter: ZMAX <- "33.0242896"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.1702779"
Evaluating: -13.1702779-3.5
 Parameter: XMIN <- "-16.6702779"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.7914293"
Evaluating: 38.7914293-3.5
 Parameter: YMIN <- "35.2914293"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.5242896"
Evaluating: 29.5242896-3.5
 Parameter: ZMIN <- "26.0242896"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.6702779"
 Parameter: XMIN -> "-16.6702779"
 Parameter: YMAX -> "42.2914293"
 Parameter: YMIN -> "35.2914293"
 Parameter: ZMAX -> "33.0242896"
 Parameter: ZMIN -> "26.0242896"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "36" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "36" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.241008241"
Evaluating: 128.065641*(0.241008241-0.5)
 Parameter: XPOS <- "-33.1679456"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.124742419"
Evaluating: 128.065641*(0.124742419-0.5)
 Parameter: YPOS <- "-48.0576027"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.996676371"
Evaluating: 108.613069*(0.996676371-0.5)+-2.187274
 Parameter: ZPOS <- "51.758271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.758271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.758271" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.1679456"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.1679456-0
 Parameter: XTRAN <- "-33.1679456"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.0576027"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.0576027-0
 Parameter: YTRAN <- "-48.0576027"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.758271"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.758271-0
 Parameter: ZTRAN <- "51.758271"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.1679456"
 Parameter: YTRAN -> "-48.0576027"
 Parameter: ZTRAN -> "51.758271"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -33.167946  -48.057603   51.758271
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793408582"
Evaluating: 0.793408582*360.0
 Parameter: XPHI <- "285.62709"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825410762"
Evaluating: 0.825410762*360.0
 Parameter: YPHI <- "297.147874"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.295134554"
Evaluating: 0.295134554*360.0
 Parameter: ZPHI <- "106.248439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.1679456"
 Parameter: YPOS -> "-48.0576027"
 Parameter: ZPOS -> "51.758271"
 Parameter: XPHI -> "285.62709"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.269375   -0.963035
    0.000000    0.963035    0.269375

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   74.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.1679456"
 Parameter: YPOS -> "-48.0576027"
 Parameter: ZPOS -> "51.758271"
 Parameter: YPHI -> "297.147874"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.456289    0.000000    0.889832
    0.000000    1.000000    0.000000
   -0.889832    0.000000    0.456289

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.1679456"
 Parameter: YPOS -> "-48.0576027"
 Parameter: ZPOS -> "51.758271"
 Parameter: ZPHI -> "106.248439"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.279803    0.960057    0.000000
   -0.960057   -0.279803    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.167946 XMAX =  -33.167946 XAVE =  -33.167946
    YMIN =  -48.057603 YMAX =  -48.057603 YAVE =  -48.057603
    ZMIN =   51.758271 ZMAX =   51.758271 ZAVE =   51.758271
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.1679456"
Evaluating: -33.1679456+3.5
 Parameter: XMAX <- "-29.6679456"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.0576027"
Evaluating: -48.0576027+3.5
 Parameter: YMAX <- "-44.5576027"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.758271"
Evaluating: 51.758271+3.5
 Parameter: ZMAX <- "55.258271"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.1679456"
Evaluating: -33.1679456-3.5
 Parameter: XMIN <- "-36.6679456"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.0576027"
Evaluating: -48.0576027-3.5
 Parameter: YMIN <- "-51.5576027"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.758271"
Evaluating: 51.758271-3.5
 Parameter: ZMIN <- "48.258271"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.6679456"
 Parameter: XMIN -> "-36.6679456"
 Parameter: YMAX -> "-44.5576027"
 Parameter: YMIN -> "-51.5576027"
 Parameter: ZMAX -> "55.258271"
 Parameter: ZMIN -> "48.258271"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "37" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "37" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.127416612"
Evaluating: 128.065641*(0.127416612-0.5)
 Parameter: XPOS <- "-47.7151304"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.682367929"
Evaluating: 128.065641*(0.682367929-0.5)
 Parameter: YPOS <- "23.3550657"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.821032681"
Evaluating: 108.613069*(0.821032681-0.5)+-2.187274
 Parameter: ZPOS <- "32.6810707"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.6810707" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.6810707" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.7151304"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.7151304-0
 Parameter: XTRAN <- "-47.7151304"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.3550657"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.3550657-0
 Parameter: YTRAN <- "23.3550657"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.6810707"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.6810707-0
 Parameter: ZTRAN <- "32.6810707"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.7151304"
 Parameter: YTRAN -> "23.3550657"
 Parameter: ZTRAN -> "32.6810707"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -47.715130   23.355066   32.681071
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316312558"
Evaluating: 0.316312558*360.0
 Parameter: XPHI <- "113.872521"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.62421846"
Evaluating: 0.62421846*360.0
 Parameter: YPHI <- "224.718646"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.931550386"
Evaluating: 0.931550386*360.0
 Parameter: ZPHI <- "335.358139"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.7151304"
 Parameter: YPOS -> "23.3550657"
 Parameter: ZPOS -> "32.6810707"
 Parameter: XPHI -> "113.872521"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.404703    0.914448
    0.000000   -0.914448   -0.404703

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.7151304"
 Parameter: YPOS -> "23.3550657"
 Parameter: ZPOS -> "32.6810707"
 Parameter: YPHI -> "224.718646"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.710571    0.000000    0.703626
    0.000000    1.000000    0.000000
   -0.703626    0.000000   -0.710571

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.7151304"
 Parameter: YPOS -> "23.3550657"
 Parameter: ZPOS -> "32.6810707"
 Parameter: ZPHI -> "335.358139"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.908932   -0.416945    0.000000
    0.416945    0.908932    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   24.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.715130 XMAX =  -47.715130 XAVE =  -47.715130
    YMIN =   23.355066 YMAX =   23.355066 YAVE =   23.355066
    ZMIN =   32.681071 ZMAX =   32.681071 ZAVE =   32.681071
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.7151304"
Evaluating: -47.7151304+3.5
 Parameter: XMAX <- "-44.2151304"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.3550657"
Evaluating: 23.3550657+3.5
 Parameter: YMAX <- "26.8550657"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.6810707"
Evaluating: 32.6810707+3.5
 Parameter: ZMAX <- "36.1810707"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.7151304"
Evaluating: -47.7151304-3.5
 Parameter: XMIN <- "-51.2151304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.3550657"
Evaluating: 23.3550657-3.5
 Parameter: YMIN <- "19.8550657"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.6810707"
Evaluating: 32.6810707-3.5
 Parameter: ZMIN <- "29.1810707"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.2151304"
 Parameter: XMIN -> "-51.2151304"
 Parameter: YMAX -> "26.8550657"
 Parameter: YMIN -> "19.8550657"
 Parameter: ZMAX -> "36.1810707"
 Parameter: ZMIN -> "29.1810707"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "38" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "38" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.449239347"
Evaluating: 128.065641*(0.449239347-0.5)
 Parameter: XPOS <- "-6.50069556"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.621046258"
Evaluating: 128.065641*(0.621046258-0.5)
 Parameter: YPOS <- "15.5018666"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.884819576"
Evaluating: 108.613069*(0.884819576-0.5)+-2.187274
 Parameter: ZPOS <- "39.6091612"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.6091612" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.6091612" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.50069556"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.50069556-0
 Parameter: XTRAN <- "-6.50069556"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.5018666"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.5018666-0
 Parameter: YTRAN <- "15.5018666"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.6091612"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.6091612-0
 Parameter: ZTRAN <- "39.6091612"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.50069556"
 Parameter: YTRAN -> "15.5018666"
 Parameter: ZTRAN -> "39.6091612"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -6.500696   15.501867   39.609161
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342378316"
Evaluating: 0.342378316*360.0
 Parameter: XPHI <- "123.256194"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.329968927"
Evaluating: 0.329968927*360.0
 Parameter: YPHI <- "118.788814"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455050315"
Evaluating: 0.455050315*360.0
 Parameter: ZPHI <- "163.818113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.50069556"
 Parameter: YPOS -> "15.5018666"
 Parameter: ZPOS -> "39.6091612"
 Parameter: XPHI -> "123.256194"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.548384    0.836227
    0.000000   -0.836227   -0.548384

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.50069556"
 Parameter: YPOS -> "15.5018666"
 Parameter: ZPOS -> "39.6091612"
 Parameter: YPHI -> "118.788814"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.481583    0.000000   -0.876401
    0.000000    1.000000    0.000000
    0.876401    0.000000   -0.481583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.50069556"
 Parameter: YPOS -> "15.5018666"
 Parameter: ZPOS -> "39.6091612"
 Parameter: ZPHI -> "163.818113"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.960382    0.278688    0.000000
   -0.278688   -0.960382    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.500696 XMAX =   -6.500696 XAVE =   -6.500696
    YMIN =   15.501867 YMAX =   15.501867 YAVE =   15.501867
    ZMIN =   39.609161 ZMAX =   39.609161 ZAVE =   39.609161
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.50069556"
Evaluating: -6.50069556+3.5
 Parameter: XMAX <- "-3.00069556"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.5018666"
Evaluating: 15.5018666+3.5
 Parameter: YMAX <- "19.0018666"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.6091612"
Evaluating: 39.6091612+3.5
 Parameter: ZMAX <- "43.1091612"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.50069556"
Evaluating: -6.50069556-3.5
 Parameter: XMIN <- "-10.0006956"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.5018666"
Evaluating: 15.5018666-3.5
 Parameter: YMIN <- "12.0018666"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.6091612"
Evaluating: 39.6091612-3.5
 Parameter: ZMIN <- "36.1091612"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.00069556"
 Parameter: XMIN -> "-10.0006956"
 Parameter: YMAX -> "19.0018666"
 Parameter: YMIN -> "12.0018666"
 Parameter: ZMAX -> "43.1091612"
 Parameter: ZMIN -> "36.1091612"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "39" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "39" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.924597816E-02"
Evaluating: 128.065641*(4.924597816E-02-0.5)
 Parameter: XPOS <- "-57.7261027"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.732054345"
Evaluating: 128.065641*(0.732054345-0.5)
 Parameter: YPOS <- "29.7181884"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.953559397"
Evaluating: 108.613069*(0.953559397-0.5)+-2.187274
 Parameter: ZPOS <- "47.0752041"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.0752041" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.0752041" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.7261027"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.7261027-0
 Parameter: XTRAN <- "-57.7261027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.7181884"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.7181884-0
 Parameter: YTRAN <- "29.7181884"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.0752041"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.0752041-0
 Parameter: ZTRAN <- "47.0752041"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.7261027"
 Parameter: YTRAN -> "29.7181884"
 Parameter: ZTRAN -> "47.0752041"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -57.726103   29.718188   47.075204
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995234034"
Evaluating: 0.995234034*360.0
 Parameter: XPHI <- "358.284252"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481353678"
Evaluating: 0.481353678*360.0
 Parameter: YPHI <- "173.287324"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835881106"
Evaluating: 0.835881106*360.0
 Parameter: ZPHI <- "300.917198"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.7261027"
 Parameter: YPOS -> "29.7181884"
 Parameter: ZPOS -> "47.0752041"
 Parameter: XPHI -> "358.284252"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999552   -0.029941
    0.000000    0.029941    0.999552

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    1.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.7261027"
 Parameter: YPOS -> "29.7181884"
 Parameter: ZPOS -> "47.0752041"
 Parameter: YPHI -> "173.287324"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.993145    0.000000   -0.116890
    0.000000    1.000000    0.000000
    0.116890    0.000000   -0.993145

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  173.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.7261027"
 Parameter: YPOS -> "29.7181884"
 Parameter: ZPOS -> "47.0752041"
 Parameter: ZPHI -> "300.917198"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.513799   -0.857911    0.000000
    0.857911    0.513799    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   59.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.726103 XMAX =  -57.726103 XAVE =  -57.726103
    YMIN =   29.718188 YMAX =   29.718188 YAVE =   29.718188
    ZMIN =   47.075204 ZMAX =   47.075204 ZAVE =   47.075204
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.7261027"
Evaluating: -57.7261027+3.5
 Parameter: XMAX <- "-54.2261027"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.7181884"
Evaluating: 29.7181884+3.5
 Parameter: YMAX <- "33.2181884"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.0752041"
Evaluating: 47.0752041+3.5
 Parameter: ZMAX <- "50.5752041"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.7261027"
Evaluating: -57.7261027-3.5
 Parameter: XMIN <- "-61.2261027"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.7181884"
Evaluating: 29.7181884-3.5
 Parameter: YMIN <- "26.2181884"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.0752041"
Evaluating: 47.0752041-3.5
 Parameter: ZMIN <- "43.5752041"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-54.2261027"
 Parameter: XMIN -> "-61.2261027"
 Parameter: YMAX -> "33.2181884"
 Parameter: YMIN -> "26.2181884"
 Parameter: ZMAX -> "50.5752041"
 Parameter: ZMIN -> "43.5752041"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "40" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "40" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.627231278"
Evaluating: 128.065641*(0.627231278-0.5)
 Parameter: XPOS <- "16.2939552"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.738057002"
Evaluating: 128.065641*(0.738057002-0.5)
 Parameter: YPOS <- "30.4869226"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.902697308"
Evaluating: 108.613069*(0.902697308-0.5)+-2.187274
 Parameter: ZPOS <- "41.5509165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.5509165" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.5509165" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.2939552"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.2939552-0
 Parameter: XTRAN <- "16.2939552"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.4869226"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.4869226-0
 Parameter: YTRAN <- "30.4869226"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.5509165"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.5509165-0
 Parameter: ZTRAN <- "41.5509165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.2939552"
 Parameter: YTRAN -> "30.4869226"
 Parameter: ZTRAN -> "41.5509165"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    16.293955   30.486923   41.550916
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771870405"
Evaluating: 0.771870405*360.0
 Parameter: XPHI <- "277.873346"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227235196"
Evaluating: 0.227235196*360.0
 Parameter: YPHI <- "81.8046706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404899087"
Evaluating: 0.404899087*360.0
 Parameter: ZPHI <- "145.763671"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.2939552"
 Parameter: YPOS -> "30.4869226"
 Parameter: ZPOS -> "41.5509165"
 Parameter: XPHI -> "277.873346"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.136984   -0.990573
    0.000000    0.990573    0.136984

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.2939552"
 Parameter: YPOS -> "30.4869226"
 Parameter: ZPOS -> "41.5509165"
 Parameter: YPHI -> "81.8046706"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.142548    0.000000   -0.989788
    0.000000    1.000000    0.000000
    0.989788    0.000000    0.142548

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.2939552"
 Parameter: YPOS -> "30.4869226"
 Parameter: ZPOS -> "41.5509165"
 Parameter: ZPHI -> "145.763671"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.826724    0.562608    0.000000
   -0.562608   -0.826724    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  145.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.293955 XMAX =   16.293955 XAVE =   16.293955
    YMIN =   30.486923 YMAX =   30.486923 YAVE =   30.486923
    ZMIN =   41.550916 ZMAX =   41.550916 ZAVE =   41.550916
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.2939552"
Evaluating: 16.2939552+3.5
 Parameter: XMAX <- "19.7939552"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.4869226"
Evaluating: 30.4869226+3.5
 Parameter: YMAX <- "33.9869226"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.5509165"
Evaluating: 41.5509165+3.5
 Parameter: ZMAX <- "45.0509165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.2939552"
Evaluating: 16.2939552-3.5
 Parameter: XMIN <- "12.7939552"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.4869226"
Evaluating: 30.4869226-3.5
 Parameter: YMIN <- "26.9869226"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.5509165"
Evaluating: 41.5509165-3.5
 Parameter: ZMIN <- "38.0509165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.7939552"
 Parameter: XMIN -> "12.7939552"
 Parameter: YMAX -> "33.9869226"
 Parameter: YMIN -> "26.9869226"
 Parameter: ZMAX -> "45.0509165"
 Parameter: ZMIN -> "38.0509165"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "41" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "41" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.555683355E-02"
Evaluating: 128.065641*(7.555683355E-02-0.5)
 Parameter: XPOS <- "-54.3565862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.364733292E-02"
Evaluating: 128.065641*(8.364733292E-02-0.5)
 Parameter: YPOS <- "-53.3204712"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "9.813020753E-02"
Evaluating: 108.613069*(9.813020753E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-45.8355855"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.8355855" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.3565862"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.3565862-0
 Parameter: XTRAN <- "-54.3565862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.3204712"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.3204712-0
 Parameter: YTRAN <- "-53.3204712"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.8355855"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.8355855-0
 Parameter: ZTRAN <- "-45.8355855"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.3565862"
 Parameter: YTRAN -> "-53.3204712"
 Parameter: ZTRAN -> "-45.8355855"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -54.356586  -53.320471  -45.835586
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.128504972E-02"
Evaluating: 8.128504972E-02*360.0
 Parameter: XPHI <- "29.2626179"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537512106"
Evaluating: 0.537512106*360.0
 Parameter: YPHI <- "193.504358"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.743886054"
Evaluating: 0.743886054*360.0
 Parameter: ZPHI <- "267.798979"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.3565862"
 Parameter: YPOS -> "-53.3204712"
 Parameter: ZPOS -> "-45.8355855"
 Parameter: XPHI -> "29.2626179"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.872388    0.488813
    0.000000   -0.488813    0.872388

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.3565862"
 Parameter: YPOS -> "-53.3204712"
 Parameter: ZPOS -> "-45.8355855"
 Parameter: YPHI -> "193.504358"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.972352    0.000000    0.233519
    0.000000    1.000000    0.000000
   -0.233519    0.000000   -0.972352

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.3565862"
 Parameter: YPOS -> "-53.3204712"
 Parameter: ZPOS -> "-45.8355855"
 Parameter: ZPHI -> "267.798979"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.038406   -0.999262    0.000000
    0.999262   -0.038406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.356586 XMAX =  -54.356586 XAVE =  -54.356586
    YMIN =  -53.320471 YMAX =  -53.320471 YAVE =  -53.320471
    ZMIN =  -45.835586 ZMAX =  -45.835586 ZAVE =  -45.835586
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.3565862"
Evaluating: -54.3565862+3.5
 Parameter: XMAX <- "-50.8565862"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.3204712"
Evaluating: -53.3204712+3.5
 Parameter: YMAX <- "-49.8204712"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.8355855"
Evaluating: -45.8355855+3.5
 Parameter: ZMAX <- "-42.3355855"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.3565862"
Evaluating: -54.3565862-3.5
 Parameter: XMIN <- "-57.8565862"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.3204712"
Evaluating: -53.3204712-3.5
 Parameter: YMIN <- "-56.8204712"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.8355855"
Evaluating: -45.8355855-3.5
 Parameter: ZMIN <- "-49.3355855"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.8565862"
 Parameter: XMIN -> "-57.8565862"
 Parameter: YMAX -> "-49.8204712"
 Parameter: YMIN -> "-56.8204712"
 Parameter: ZMAX -> "-42.3355855"
 Parameter: ZMIN -> "-49.3355855"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "42" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "42" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.873701925"
Evaluating: 128.065641*(0.873701925-0.5)
 Parameter: XPOS <- "47.8583766"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.821184681"
Evaluating: 128.065641*(0.821184681-0.5)
 Parameter: YPOS <- "41.1327221"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.829953016"
Evaluating: 108.613069*(0.829953016-0.5)+-2.187274
 Parameter: ZPOS <- "33.6499357"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.6499357" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.6499357" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.8583766"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.8583766-0
 Parameter: XTRAN <- "47.8583766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.1327221"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.1327221-0
 Parameter: YTRAN <- "41.1327221"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.6499357"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.6499357-0
 Parameter: ZTRAN <- "33.6499357"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.8583766"
 Parameter: YTRAN -> "41.1327221"
 Parameter: ZTRAN -> "33.6499357"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    47.858377   41.132722   33.649936
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.959949814"
Evaluating: 0.959949814*360.0
 Parameter: XPHI <- "345.581933"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798705007"
Evaluating: 0.798705007*360.0
 Parameter: YPHI <- "287.533803"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643896778"
Evaluating: 0.643896778*360.0
 Parameter: ZPHI <- "231.80284"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.8583766"
 Parameter: YPOS -> "41.1327221"
 Parameter: ZPOS -> "33.6499357"
 Parameter: XPHI -> "345.581933"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968505   -0.248995
    0.000000    0.248995    0.968505

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   14.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.8583766"
 Parameter: YPOS -> "41.1327221"
 Parameter: ZPOS -> "33.6499357"
 Parameter: YPHI -> "287.533803"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.301268    0.000000    0.953539
    0.000000    1.000000    0.000000
   -0.953539    0.000000    0.301268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.8583766"
 Parameter: YPOS -> "41.1327221"
 Parameter: ZPOS -> "33.6499357"
 Parameter: ZPHI -> "231.80284"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.618369   -0.785888    0.000000
    0.785888   -0.618369    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.858377 XMAX =   47.858377 XAVE =   47.858377
    YMIN =   41.132722 YMAX =   41.132722 YAVE =   41.132722
    ZMIN =   33.649936 ZMAX =   33.649936 ZAVE =   33.649936
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.8583766"
Evaluating: 47.8583766+3.5
 Parameter: XMAX <- "51.3583766"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.1327221"
Evaluating: 41.1327221+3.5
 Parameter: YMAX <- "44.6327221"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.6499357"
Evaluating: 33.6499357+3.5
 Parameter: ZMAX <- "37.1499357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.8583766"
Evaluating: 47.8583766-3.5
 Parameter: XMIN <- "44.3583766"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.1327221"
Evaluating: 41.1327221-3.5
 Parameter: YMIN <- "37.6327221"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.6499357"
Evaluating: 33.6499357-3.5
 Parameter: ZMIN <- "30.1499357"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.3583766"
 Parameter: XMIN -> "44.3583766"
 Parameter: YMAX -> "44.6327221"
 Parameter: YMIN -> "37.6327221"
 Parameter: ZMAX -> "37.1499357"
 Parameter: ZMIN -> "30.1499357"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "43" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "43" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.51493205"
Evaluating: 128.065641*(0.51493205-0.5)
 Parameter: XPOS <- "1.91228255"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.496480044"
Evaluating: 128.065641*(0.496480044-0.5)
 Parameter: YPOS <- "-0.450785421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.415831642"
Evaluating: 108.613069*(0.415831642-0.5)+-2.187274
 Parameter: ZPOS <- "-11.3290577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.3290577" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.3290577" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "43" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.219026504"
Evaluating: 128.065641*(0.219026504-0.5)
 Parameter: XPOS <- "-35.9830509"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.205039628"
Evaluating: 128.065641*(0.205039628-0.5)
 Parameter: YPOS <- "-37.7742891"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.572096044"
Evaluating: 108.613069*(0.572096044-0.5)+-2.187274
 Parameter: ZPOS <- "5.6432986"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.6432986" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.6432986" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "43" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.221029811"
Evaluating: 128.065641*(0.221029811-0.5)
 Parameter: XPOS <- "-35.7264961"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.83055976"
Evaluating: 128.065641*(0.83055976-0.5)
 Parameter: YPOS <- "42.3333476"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.742674885"
Evaluating: 108.613069*(0.742674885-0.5)+-2.187274
 Parameter: ZPOS <- "24.17039"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.17039" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.17039" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.7264961"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.7264961-0
 Parameter: XTRAN <- "-35.7264961"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.3333476"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.3333476-0
 Parameter: YTRAN <- "42.3333476"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.17039"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.17039-0
 Parameter: ZTRAN <- "24.17039"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.7264961"
 Parameter: YTRAN -> "42.3333476"
 Parameter: ZTRAN -> "24.17039"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -35.726496   42.333348   24.170390
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.785227219"
Evaluating: 0.785227219*360.0
 Parameter: XPHI <- "282.681799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.599502921"
Evaluating: 0.599502921*360.0
 Parameter: YPHI <- "215.821052"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102541368"
Evaluating: 0.102541368*360.0
 Parameter: ZPHI <- "36.9148925"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.7264961"
 Parameter: YPOS -> "42.3333476"
 Parameter: ZPOS -> "24.17039"
 Parameter: XPHI -> "282.681799"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.219536   -0.975604
    0.000000    0.975604    0.219536

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   77.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.7264961"
 Parameter: YPOS -> "42.3333476"
 Parameter: ZPOS -> "24.17039"
 Parameter: YPHI -> "215.821052"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.810849    0.000000    0.585256
    0.000000    1.000000    0.000000
   -0.585256    0.000000   -0.810849

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.7264961"
 Parameter: YPOS -> "42.3333476"
 Parameter: ZPOS -> "24.17039"
 Parameter: ZPHI -> "36.9148925"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.799529    0.600628    0.000000
   -0.600628    0.799529    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.726496 XMAX =  -35.726496 XAVE =  -35.726496
    YMIN =   42.333348 YMAX =   42.333348 YAVE =   42.333348
    ZMIN =   24.170390 ZMAX =   24.170390 ZAVE =   24.170390
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.7264961"
Evaluating: -35.7264961+3.5
 Parameter: XMAX <- "-32.2264961"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.3333476"
Evaluating: 42.3333476+3.5
 Parameter: YMAX <- "45.8333476"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.17039"
Evaluating: 24.17039+3.5
 Parameter: ZMAX <- "27.67039"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.7264961"
Evaluating: -35.7264961-3.5
 Parameter: XMIN <- "-39.2264961"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.3333476"
Evaluating: 42.3333476-3.5
 Parameter: YMIN <- "38.8333476"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.17039"
Evaluating: 24.17039-3.5
 Parameter: ZMIN <- "20.67039"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.2264961"
 Parameter: XMIN -> "-39.2264961"
 Parameter: YMAX -> "45.8333476"
 Parameter: YMIN -> "38.8333476"
 Parameter: ZMAX -> "27.67039"
 Parameter: ZMIN -> "20.67039"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "44" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.986183445"
Evaluating: 128.065641*(0.986183445-0.5)
 Parameter: XPOS <- "62.2633945"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.263730943"
Evaluating: 128.065641*(0.263730943-0.5)
 Parameter: YPOS <- "-30.2579482"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.637978033"
Evaluating: 108.613069*(0.637978033-0.5)+-2.187274
 Parameter: ZPOS <- "12.7989436"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.7989436" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.7989436" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.972549222"
Evaluating: 128.065641*(0.972549222-0.5)
 Parameter: XPOS <- "60.517319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.784816503"
Evaluating: 128.065641*(0.784816503-0.5)
 Parameter: YPOS <- "36.475208"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.609597101"
Evaluating: 108.613069*(0.609597101-0.5)+-2.187274
 Parameter: ZPOS <- "9.71640349"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.71640349" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.71640349" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.769417453"
Evaluating: 128.065641*(0.769417453-0.5)
 Parameter: XPOS <- "34.5031188"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.604704667"
Evaluating: 128.065641*(0.604704667-0.5)
 Parameter: YPOS <- "13.4090703"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.38715394"
Evaluating: 108.613069*(0.38715394-0.5)+-2.187274
 Parameter: ZPOS <- "-14.4438309"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.4438309" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.4438309" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.287319657"
Evaluating: 128.065641*(0.287319657-0.5)
 Parameter: XPOS <- "-27.2370445"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.328881377"
Evaluating: 128.065641*(0.328881377-0.5)
 Parameter: YPOS <- "-21.9144161"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.351377994"
Evaluating: 108.613069*(0.351377994-0.5)+-2.187274
 Parameter: ZPOS <- "-18.3295662"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.3295662" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.2370445"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.2370445-0
 Parameter: XTRAN <- "-27.2370445"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.9144161"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.9144161-0
 Parameter: YTRAN <- "-21.9144161"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.3295662"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.3295662-0
 Parameter: ZTRAN <- "-18.3295662"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.2370445"
 Parameter: YTRAN -> "-21.9144161"
 Parameter: ZTRAN -> "-18.3295662"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -27.237044  -21.914416  -18.329566
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210778822"
Evaluating: 0.210778822*360.0
 Parameter: XPHI <- "75.8803759"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270008618"
Evaluating: 0.270008618*360.0
 Parameter: YPHI <- "97.2031025"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710451766"
Evaluating: 0.710451766*360.0
 Parameter: ZPHI <- "255.762636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.2370445"
 Parameter: YPOS -> "-21.9144161"
 Parameter: ZPOS -> "-18.3295662"
 Parameter: XPHI -> "75.8803759"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.243947    0.969789
    0.000000   -0.969789    0.243947

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.2370445"
 Parameter: YPOS -> "-21.9144161"
 Parameter: ZPOS -> "-18.3295662"
 Parameter: YPHI -> "97.2031025"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.125387    0.000000   -0.992108
    0.000000    1.000000    0.000000
    0.992108    0.000000   -0.125387

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.2370445"
 Parameter: YPOS -> "-21.9144161"
 Parameter: ZPOS -> "-18.3295662"
 Parameter: ZPHI -> "255.762636"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.245940   -0.969285    0.000000
    0.969285   -0.245940    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.237044 XMAX =  -27.237044 XAVE =  -27.237044
    YMIN =  -21.914416 YMAX =  -21.914416 YAVE =  -21.914416
    ZMIN =  -18.329566 ZMAX =  -18.329566 ZAVE =  -18.329566
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.2370445"
Evaluating: -27.2370445+3.5
 Parameter: XMAX <- "-23.7370445"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.9144161"
Evaluating: -21.9144161+3.5
 Parameter: YMAX <- "-18.4144161"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.3295662"
Evaluating: -18.3295662+3.5
 Parameter: ZMAX <- "-14.8295662"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.2370445"
Evaluating: -27.2370445-3.5
 Parameter: XMIN <- "-30.7370445"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.9144161"
Evaluating: -21.9144161-3.5
 Parameter: YMIN <- "-25.4144161"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.3295662"
Evaluating: -18.3295662-3.5
 Parameter: ZMIN <- "-21.8295662"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.7370445"
 Parameter: XMIN -> "-30.7370445"
 Parameter: YMAX -> "-18.4144161"
 Parameter: YMIN -> "-25.4144161"
 Parameter: ZMAX -> "-14.8295662"
 Parameter: ZMIN -> "-21.8295662"
 SELRPN>     13 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      8 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60276 POS      POT      44       POT     -**** MEMB     DMPC     196      O14           3.5803
60276 POS      POT      44       POT     -**** MEMB     DMPC     261      C12           3.2396
60276 POS      POT      44       POT     -**** MEMB     DMPC     261      C11           2.0734
60276 POS      POT      44       POT     -**** MEMB     DMPC     261      P             3.4664
60276 POS      POT      44       POT     -**** MEMB     DMPC     261      O14           2.6475
60276 POS      POT      44       POT     -**** MEMB     DMPC     261      O12           3.0527
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.95460933"
Evaluating: 128.065641*(0.95460933-0.5)
 Parameter: XPOS <- "58.2198353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.575748495"
Evaluating: 128.065641*(0.575748495-0.5)
 Parameter: YPOS <- "9.70077957"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.477971697"
Evaluating: 108.613069*(0.477971697-0.5)+-2.187274
 Parameter: ZPOS <- "-4.57983559"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.57983559" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.57983559" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "44" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.407416627"
Evaluating: 128.065641*(0.407416627-0.5)
 Parameter: XPOS <- "-11.856749"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.436990643"
Evaluating: 128.065641*(0.436990643-0.5)
 Parameter: YPOS <- "-8.06933369"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.142134194"
Evaluating: 108.613069*(0.142134194-0.5)+-2.187274
 Parameter: ZPOS <- "-41.0561775"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.0561775" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.237044 XMAX =  -27.237044 XAVE =  -27.237044
    YMIN =  -21.914416 YMAX =  -21.914416 YAVE =  -21.914416
    ZMIN =  -18.329566 ZMAX =  -18.329566 ZAVE =  -18.329566
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.856749"
 RDCMND substituted energy or value "?XAVE" to "-27.2370445"
Evaluating: -11.856749--27.2370445
 Parameter: XTRAN <- "15.3802955"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.06933369"
 RDCMND substituted energy or value "?YAVE" to "-21.9144161"
Evaluating: -8.06933369--21.9144161
 Parameter: YTRAN <- "13.8450824"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.0561775"
 RDCMND substituted energy or value "?ZAVE" to "-18.3295662"
Evaluating: -41.0561775--18.3295662
 Parameter: ZTRAN <- "-22.7266113"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.3802955"
 Parameter: YTRAN -> "13.8450824"
 Parameter: ZTRAN -> "-22.7266113"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    15.380296   13.845082  -22.726611
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964337845"
Evaluating: 0.964337845*360.0
 Parameter: XPHI <- "347.161624"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.287825332"
Evaluating: 0.287825332*360.0
 Parameter: YPHI <- "103.61712"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.794897418E-02"
Evaluating: 8.794897418E-02*360.0
 Parameter: ZPHI <- "31.6616307"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.856749"
 Parameter: YPOS -> "-8.06933369"
 Parameter: ZPOS -> "-41.0561775"
 Parameter: XPHI -> "347.161624"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.975001   -0.222202
    0.000000    0.222202    0.975001

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.856749"
 Parameter: YPOS -> "-8.06933369"
 Parameter: ZPOS -> "-41.0561775"
 Parameter: YPHI -> "103.61712"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.235433    0.000000   -0.971891
    0.000000    1.000000    0.000000
    0.971891    0.000000   -0.235433

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.856749"
 Parameter: YPOS -> "-8.06933369"
 Parameter: ZPOS -> "-41.0561775"
 Parameter: ZPHI -> "31.6616307"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.851163    0.524902    0.000000
   -0.524902    0.851163    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.856749 XMAX =  -11.856749 XAVE =  -11.856749
    YMIN =   -8.069334 YMAX =   -8.069334 YAVE =   -8.069334
    ZMIN =  -41.056177 ZMAX =  -41.056177 ZAVE =  -41.056177
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.856749"
Evaluating: -11.856749+3.5
 Parameter: XMAX <- "-8.356749"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.0693337"
Evaluating: -8.0693337+3.5
 Parameter: YMAX <- "-4.5693337"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.0561775"
Evaluating: -41.0561775+3.5
 Parameter: ZMAX <- "-37.5561775"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.856749"
Evaluating: -11.856749-3.5
 Parameter: XMIN <- "-15.356749"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.0693337"
Evaluating: -8.0693337-3.5
 Parameter: YMIN <- "-11.5693337"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.0561775"
Evaluating: -41.0561775-3.5
 Parameter: ZMIN <- "-44.5561775"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.356749"
 Parameter: XMIN -> "-15.356749"
 Parameter: YMAX -> "-4.5693337"
 Parameter: YMIN -> "-11.5693337"
 Parameter: ZMAX -> "-37.5561775"
 Parameter: ZMIN -> "-44.5561775"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "45" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "45" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.128017634"
Evaluating: 128.065641*(0.128017634-0.5)
 Parameter: XPOS <- "-47.6381601"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.650477387"
Evaluating: 128.065641*(0.650477387-0.5)
 Parameter: YPOS <- "19.270983"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.229600421"
Evaluating: 108.613069*(0.229600421-0.5)+-2.187274
 Parameter: ZPOS <- "-31.5562021"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.5562021" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.6381601"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.6381601-0
 Parameter: XTRAN <- "-47.6381601"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.270983"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.270983-0
 Parameter: YTRAN <- "19.270983"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.5562021"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.5562021-0
 Parameter: ZTRAN <- "-31.5562021"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.6381601"
 Parameter: YTRAN -> "19.270983"
 Parameter: ZTRAN -> "-31.5562021"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -47.638160   19.270983  -31.556202
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.266646001"
Evaluating: 0.266646001*360.0
 Parameter: XPHI <- "95.9925604"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383448156"
Evaluating: 0.383448156*360.0
 Parameter: YPHI <- "138.041336"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185037558"
Evaluating: 0.185037558*360.0
 Parameter: ZPHI <- "66.6135209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.6381601"
 Parameter: YPOS -> "19.270983"
 Parameter: ZPOS -> "-31.5562021"
 Parameter: XPHI -> "95.9925604"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.104399    0.994535
    0.000000   -0.994535   -0.104399

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   95.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.6381601"
 Parameter: YPOS -> "19.270983"
 Parameter: ZPOS -> "-31.5562021"
 Parameter: YPHI -> "138.041336"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.743627    0.000000   -0.668594
    0.000000    1.000000    0.000000
    0.668594    0.000000   -0.743627

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  138.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.6381601"
 Parameter: YPOS -> "19.270983"
 Parameter: ZPOS -> "-31.5562021"
 Parameter: ZPHI -> "66.6135209"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.396931    0.917848    0.000000
   -0.917848    0.396931    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.638160 XMAX =  -47.638160 XAVE =  -47.638160
    YMIN =   19.270983 YMAX =   19.270983 YAVE =   19.270983
    ZMIN =  -31.556202 ZMAX =  -31.556202 ZAVE =  -31.556202
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.6381601"
Evaluating: -47.6381601+3.5
 Parameter: XMAX <- "-44.1381601"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.270983"
Evaluating: 19.270983+3.5
 Parameter: YMAX <- "22.770983"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.5562021"
Evaluating: -31.5562021+3.5
 Parameter: ZMAX <- "-28.0562021"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.6381601"
Evaluating: -47.6381601-3.5
 Parameter: XMIN <- "-51.1381601"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.270983"
Evaluating: 19.270983-3.5
 Parameter: YMIN <- "15.770983"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.5562021"
Evaluating: -31.5562021-3.5
 Parameter: ZMIN <- "-35.0562021"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.1381601"
 Parameter: XMIN -> "-51.1381601"
 Parameter: YMAX -> "22.770983"
 Parameter: YMIN -> "15.770983"
 Parameter: ZMAX -> "-28.0562021"
 Parameter: ZMIN -> "-35.0562021"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "46" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "46" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.832391141"
Evaluating: 128.065641*(0.832391141-0.5)
 Parameter: XPOS <- "42.5678845"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.519205395"
Evaluating: 128.065641*(0.519205395-0.5)
 Parameter: YPOS <- "2.45955122"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.289809979"
Evaluating: 108.613069*(0.289809979-0.5)+-2.187274
 Parameter: ZPOS <- "-25.0166573"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.0166573" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.5678845"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.5678845-0
 Parameter: XTRAN <- "42.5678845"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.45955122"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.45955122-0
 Parameter: YTRAN <- "2.45955122"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.0166573"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.0166573-0
 Parameter: ZTRAN <- "-25.0166573"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.5678845"
 Parameter: YTRAN -> "2.45955122"
 Parameter: ZTRAN -> "-25.0166573"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    42.567884    2.459551  -25.016657
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720995465"
Evaluating: 0.720995465*360.0
 Parameter: XPHI <- "259.558367"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107835889"
Evaluating: 0.107835889*360.0
 Parameter: YPHI <- "38.82092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136723814"
Evaluating: 0.136723814*360.0
 Parameter: ZPHI <- "49.220573"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.5678845"
 Parameter: YPOS -> "2.45955122"
 Parameter: ZPOS -> "-25.0166573"
 Parameter: XPHI -> "259.558367"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.181234   -0.983440
    0.000000    0.983440   -0.181234

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.5678845"
 Parameter: YPOS -> "2.45955122"
 Parameter: ZPOS -> "-25.0166573"
 Parameter: YPHI -> "38.82092"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.779109    0.000000   -0.626888
    0.000000    1.000000    0.000000
    0.626888    0.000000    0.779109

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.5678845"
 Parameter: YPOS -> "2.45955122"
 Parameter: ZPOS -> "-25.0166573"
 Parameter: ZPHI -> "49.220573"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.653149    0.757230    0.000000
   -0.757230    0.653149    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.567884 XMAX =   42.567884 XAVE =   42.567884
    YMIN =    2.459551 YMAX =    2.459551 YAVE =    2.459551
    ZMIN =  -25.016657 ZMAX =  -25.016657 ZAVE =  -25.016657
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.5678845"
Evaluating: 42.5678845+3.5
 Parameter: XMAX <- "46.0678845"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.45955122"
Evaluating: 2.45955122+3.5
 Parameter: YMAX <- "5.95955122"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.0166573"
Evaluating: -25.0166573+3.5
 Parameter: ZMAX <- "-21.5166573"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.5678845"
Evaluating: 42.5678845-3.5
 Parameter: XMIN <- "39.0678845"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.45955122"
Evaluating: 2.45955122-3.5
 Parameter: YMIN <- "-1.04044878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.0166573"
Evaluating: -25.0166573-3.5
 Parameter: ZMIN <- "-28.5166573"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.0678845"
 Parameter: XMIN -> "39.0678845"
 Parameter: YMAX -> "5.95955122"
 Parameter: YMIN -> "-1.04044878"
 Parameter: ZMAX -> "-21.5166573"
 Parameter: ZMIN -> "-28.5166573"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "47" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "47" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.645696322"
Evaluating: 128.065641*(0.645696322-0.5)
 Parameter: XPOS <- "18.6586929"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.157470614"
Evaluating: 128.065641*(0.157470614-0.5)
 Parameter: YPOS <- "-43.8662454"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.562957174"
Evaluating: 108.613069*(0.562957174-0.5)+-2.187274
 Parameter: ZPOS <- "4.65069788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.65069788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.65069788" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "47" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.510567059"
Evaluating: 128.065641*(0.510567059-0.5)
 Parameter: XPOS <- "1.35327718"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.126371689"
Evaluating: 128.065641*(0.126371689-0.5)
 Parameter: YPOS <- "-47.8489491"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.74828529E-02"
Evaluating: 108.613069*(1.74828529E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-54.5949422"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.5949422" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.35327718"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.35327718-0
 Parameter: XTRAN <- "1.35327718"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.8489491"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.8489491-0
 Parameter: YTRAN <- "-47.8489491"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.5949422"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.5949422-0
 Parameter: ZTRAN <- "-54.5949422"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.35327718"
 Parameter: YTRAN -> "-47.8489491"
 Parameter: ZTRAN -> "-54.5949422"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     1.353277  -47.848949  -54.594942
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318970222"
Evaluating: 0.318970222*360.0
 Parameter: XPHI <- "114.82928"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.288309813"
Evaluating: 0.288309813*360.0
 Parameter: YPHI <- "103.791533"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903068508"
Evaluating: 0.903068508*360.0
 Parameter: ZPHI <- "325.104663"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.35327718"
 Parameter: YPOS -> "-47.8489491"
 Parameter: ZPOS -> "-54.5949422"
 Parameter: XPHI -> "114.82928"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.419916    0.907563
    0.000000   -0.907563   -0.419916

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.35327718"
 Parameter: YPOS -> "-47.8489491"
 Parameter: ZPOS -> "-54.5949422"
 Parameter: YPHI -> "103.791533"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.238390    0.000000   -0.971170
    0.000000    1.000000    0.000000
    0.971170    0.000000   -0.238390

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.35327718"
 Parameter: YPOS -> "-47.8489491"
 Parameter: ZPOS -> "-54.5949422"
 Parameter: ZPHI -> "325.104663"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.820198   -0.572079    0.000000
    0.572079    0.820198    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.353277 XMAX =    1.353277 XAVE =    1.353277
    YMIN =  -47.848949 YMAX =  -47.848949 YAVE =  -47.848949
    ZMIN =  -54.594942 ZMAX =  -54.594942 ZAVE =  -54.594942
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.35327718"
Evaluating: 1.35327718+3.5
 Parameter: XMAX <- "4.85327718"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.8489491"
Evaluating: -47.8489491+3.5
 Parameter: YMAX <- "-44.3489491"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.5949422"
Evaluating: -54.5949422+3.5
 Parameter: ZMAX <- "-51.0949422"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.35327718"
Evaluating: 1.35327718-3.5
 Parameter: XMIN <- "-2.14672282"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.8489491"
Evaluating: -47.8489491-3.5
 Parameter: YMIN <- "-51.3489491"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.5949422"
Evaluating: -54.5949422-3.5
 Parameter: ZMIN <- "-58.0949422"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.85327718"
 Parameter: XMIN -> "-2.14672282"
 Parameter: YMAX -> "-44.3489491"
 Parameter: YMIN -> "-51.3489491"
 Parameter: ZMAX -> "-51.0949422"
 Parameter: ZMIN -> "-58.0949422"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "48" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "48" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.471288233"
Evaluating: 128.065641*(0.471288233-0.5)
 Parameter: XPOS <- "-3.67699085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.789164419"
Evaluating: 128.065641*(0.789164419-0.5)
 Parameter: YPOS <- "37.0320267"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.211207084"
Evaluating: 108.613069*(0.211207084-0.5)+-2.187274
 Parameter: ZPOS <- "-33.5539589"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.5539589" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.67699085"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.67699085-0
 Parameter: XTRAN <- "-3.67699085"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.0320267"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.0320267-0
 Parameter: YTRAN <- "37.0320267"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.5539589"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.5539589-0
 Parameter: ZTRAN <- "-33.5539589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.67699085"
 Parameter: YTRAN -> "37.0320267"
 Parameter: ZTRAN -> "-33.5539589"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -3.676991   37.032027  -33.553959
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179091851"
Evaluating: 0.179091851*360.0
 Parameter: XPHI <- "64.4730664"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.827380859"
Evaluating: 0.827380859*360.0
 Parameter: YPHI <- "297.857109"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495649678"
Evaluating: 0.495649678*360.0
 Parameter: ZPHI <- "178.433884"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.67699085"
 Parameter: YPOS -> "37.0320267"
 Parameter: ZPOS -> "-33.5539589"
 Parameter: XPHI -> "64.4730664"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.430935    0.902383
    0.000000   -0.902383    0.430935

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.67699085"
 Parameter: YPOS -> "37.0320267"
 Parameter: ZPOS -> "-33.5539589"
 Parameter: YPHI -> "297.857109"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.467268    0.000000    0.884116
    0.000000    1.000000    0.000000
   -0.884116    0.000000    0.467268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.67699085"
 Parameter: YPOS -> "37.0320267"
 Parameter: ZPOS -> "-33.5539589"
 Parameter: ZPHI -> "178.433884"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999626    0.027330    0.000000
   -0.027330   -0.999626    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  178.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.676991 XMAX =   -3.676991 XAVE =   -3.676991
    YMIN =   37.032027 YMAX =   37.032027 YAVE =   37.032027
    ZMIN =  -33.553959 ZMAX =  -33.553959 ZAVE =  -33.553959
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.67699085"
Evaluating: -3.67699085+3.5
 Parameter: XMAX <- "-0.17699085"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.0320267"
Evaluating: 37.0320267+3.5
 Parameter: YMAX <- "40.5320267"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.5539589"
Evaluating: -33.5539589+3.5
 Parameter: ZMAX <- "-30.0539589"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.67699085"
Evaluating: -3.67699085-3.5
 Parameter: XMIN <- "-7.17699085"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.0320267"
Evaluating: 37.0320267-3.5
 Parameter: YMIN <- "33.5320267"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.5539589"
Evaluating: -33.5539589-3.5
 Parameter: ZMIN <- "-37.0539589"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.17699085"
 Parameter: XMIN -> "-7.17699085"
 Parameter: YMAX -> "40.5320267"
 Parameter: YMIN -> "33.5320267"
 Parameter: ZMAX -> "-30.0539589"
 Parameter: ZMIN -> "-37.0539589"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "49" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "49" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.751507315"
Evaluating: 128.065641*(0.751507315-0.5)
 Parameter: XPOS <- "32.2094455"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.74316653"
Evaluating: 128.065641*(0.74316653-0.5)
 Parameter: YPOS <- "31.1412775"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "8.867781194E-02"
Evaluating: 108.613069*(8.867781194E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-46.8622392"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.8622392" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.2094455"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.2094455-0
 Parameter: XTRAN <- "32.2094455"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.1412775"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.1412775-0
 Parameter: YTRAN <- "31.1412775"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.8622392"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.8622392-0
 Parameter: ZTRAN <- "-46.8622392"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.2094455"
 Parameter: YTRAN -> "31.1412775"
 Parameter: ZTRAN -> "-46.8622392"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    32.209446   31.141278  -46.862239
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504022295"
Evaluating: 0.504022295*360.0
 Parameter: XPHI <- "181.448026"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.141679972"
Evaluating: 0.141679972*360.0
 Parameter: YPHI <- "51.0047899"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756214067"
Evaluating: 0.756214067*360.0
 Parameter: ZPHI <- "272.237064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.2094455"
 Parameter: YPOS -> "31.1412775"
 Parameter: ZPOS -> "-46.8622392"
 Parameter: XPHI -> "181.448026"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999681   -0.025270
    0.000000    0.025270   -0.999681

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  178.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.2094455"
 Parameter: YPOS -> "31.1412775"
 Parameter: ZPOS -> "-46.8622392"
 Parameter: YPHI -> "51.0047899"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.629255    0.000000   -0.777199
    0.000000    1.000000    0.000000
    0.777199    0.000000    0.629255

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.2094455"
 Parameter: YPOS -> "31.1412775"
 Parameter: ZPOS -> "-46.8622392"
 Parameter: ZPHI -> "272.237064"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.039034   -0.999238    0.000000
    0.999238    0.039034    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.209446 XMAX =   32.209446 XAVE =   32.209446
    YMIN =   31.141278 YMAX =   31.141278 YAVE =   31.141278
    ZMIN =  -46.862239 ZMAX =  -46.862239 ZAVE =  -46.862239
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.2094455"
Evaluating: 32.2094455+3.5
 Parameter: XMAX <- "35.7094455"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.1412775"
Evaluating: 31.1412775+3.5
 Parameter: YMAX <- "34.6412775"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.8622392"
Evaluating: -46.8622392+3.5
 Parameter: ZMAX <- "-43.3622392"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.2094455"
Evaluating: 32.2094455-3.5
 Parameter: XMIN <- "28.7094455"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.1412775"
Evaluating: 31.1412775-3.5
 Parameter: YMIN <- "27.6412775"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.8622392"
Evaluating: -46.8622392-3.5
 Parameter: ZMIN <- "-50.3622392"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.7094455"
 Parameter: XMIN -> "28.7094455"
 Parameter: YMAX -> "34.6412775"
 Parameter: YMIN -> "27.6412775"
 Parameter: ZMAX -> "-43.3622392"
 Parameter: ZMIN -> "-50.3622392"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "50" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "50" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.928581758"
Evaluating: 128.065641*(0.928581758-0.5)
 Parameter: XPOS <- "54.8865976"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.043070284E-02"
Evaluating: 128.065641*(4.043070284E-02-0.5)
 Parameter: YPOS <- "-58.8550366"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.779986733"
Evaluating: 108.613069*(0.779986733-0.5)+-2.187274
 Parameter: ZPOS <- "28.2229444"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.2229444" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.2229444" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.8865976"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 54.8865976-0
 Parameter: XTRAN <- "54.8865976"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-58.8550366"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -58.8550366-0
 Parameter: YTRAN <- "-58.8550366"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.2229444"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.2229444-0
 Parameter: ZTRAN <- "28.2229444"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.8865976"
 Parameter: YTRAN -> "-58.8550366"
 Parameter: ZTRAN -> "28.2229444"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    54.886598  -58.855037   28.222944
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871585406"
Evaluating: 0.871585406*360.0
 Parameter: XPHI <- "313.770746"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832414533"
Evaluating: 0.832414533*360.0
 Parameter: YPHI <- "299.669232"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696456233"
Evaluating: 0.696456233*360.0
 Parameter: ZPHI <- "250.724244"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.8865976"
 Parameter: YPOS -> "-58.8550366"
 Parameter: ZPOS -> "28.2229444"
 Parameter: XPHI -> "313.770746"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.691775   -0.722114
    0.000000    0.722114    0.691775

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   46.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.8865976"
 Parameter: YPOS -> "-58.8550366"
 Parameter: ZPOS -> "28.2229444"
 Parameter: YPHI -> "299.669232"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.494992    0.000000    0.868897
    0.000000    1.000000    0.000000
   -0.868897    0.000000    0.494992

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.8865976"
 Parameter: YPOS -> "-58.8550366"
 Parameter: ZPOS -> "28.2229444"
 Parameter: ZPHI -> "250.724244"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.330115   -0.943941    0.000000
    0.943941   -0.330115    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.886598 XMAX =   54.886598 XAVE =   54.886598
    YMIN =  -58.855037 YMAX =  -58.855037 YAVE =  -58.855037
    ZMIN =   28.222944 ZMAX =   28.222944 ZAVE =   28.222944
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.8865976"
Evaluating: 54.8865976+3.5
 Parameter: XMAX <- "58.3865976"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-58.8550366"
Evaluating: -58.8550366+3.5
 Parameter: YMAX <- "-55.3550366"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.2229444"
Evaluating: 28.2229444+3.5
 Parameter: ZMAX <- "31.7229444"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.8865976"
Evaluating: 54.8865976-3.5
 Parameter: XMIN <- "51.3865976"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-58.8550366"
Evaluating: -58.8550366-3.5
 Parameter: YMIN <- "-62.3550366"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.2229444"
Evaluating: 28.2229444-3.5
 Parameter: ZMIN <- "24.7229444"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.3865976"
 Parameter: XMIN -> "51.3865976"
 Parameter: YMAX -> "-55.3550366"
 Parameter: YMIN -> "-62.3550366"
 Parameter: ZMAX -> "31.7229444"
 Parameter: ZMIN -> "24.7229444"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "51" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "51" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.383899538"
Evaluating: 128.065641*(0.383899538-0.5)
 Parameter: XPOS <- "-14.8684801"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.107612086"
Evaluating: 128.065641*(0.107612086-0.5)
 Parameter: YPOS <- "-50.2514097"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.841696017"
Evaluating: 108.613069*(0.841696017-0.5)+-2.187274
 Parameter: ZPOS <- "34.9253791"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.9253791" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.9253791" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.8684801"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.8684801-0
 Parameter: XTRAN <- "-14.8684801"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.2514097"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.2514097-0
 Parameter: YTRAN <- "-50.2514097"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.9253791"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.9253791-0
 Parameter: ZTRAN <- "34.9253791"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.8684801"
 Parameter: YTRAN -> "-50.2514097"
 Parameter: ZTRAN -> "34.9253791"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -14.868480  -50.251410   34.925379
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.824408518E-02"
Evaluating: 1.824408518E-02*360.0
 Parameter: XPHI <- "6.56787066"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211819268"
Evaluating: 0.211819268*360.0
 Parameter: YPHI <- "76.2549365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243419025"
Evaluating: 0.243419025*360.0
 Parameter: ZPHI <- "87.630849"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.8684801"
 Parameter: YPOS -> "-50.2514097"
 Parameter: ZPOS -> "34.9253791"
 Parameter: XPHI -> "6.56787066"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.993437    0.114380
    0.000000   -0.114380    0.993437

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.8684801"
 Parameter: YPOS -> "-50.2514097"
 Parameter: ZPOS -> "34.9253791"
 Parameter: YPHI -> "76.2549365"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.237602    0.000000   -0.971363
    0.000000    1.000000    0.000000
    0.971363    0.000000    0.237602

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   76.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.8684801"
 Parameter: YPOS -> "-50.2514097"
 Parameter: ZPOS -> "34.9253791"
 Parameter: ZPHI -> "87.630849"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.041338    0.999145    0.000000
   -0.999145    0.041338    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.868480 XMAX =  -14.868480 XAVE =  -14.868480
    YMIN =  -50.251410 YMAX =  -50.251410 YAVE =  -50.251410
    ZMIN =   34.925379 ZMAX =   34.925379 ZAVE =   34.925379
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.8684801"
Evaluating: -14.8684801+3.5
 Parameter: XMAX <- "-11.3684801"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.2514097"
Evaluating: -50.2514097+3.5
 Parameter: YMAX <- "-46.7514097"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.9253791"
Evaluating: 34.9253791+3.5
 Parameter: ZMAX <- "38.4253791"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.8684801"
Evaluating: -14.8684801-3.5
 Parameter: XMIN <- "-18.3684801"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.2514097"
Evaluating: -50.2514097-3.5
 Parameter: YMIN <- "-53.7514097"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.9253791"
Evaluating: 34.9253791-3.5
 Parameter: ZMIN <- "31.4253791"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.3684801"
 Parameter: XMIN -> "-18.3684801"
 Parameter: YMAX -> "-46.7514097"
 Parameter: YMIN -> "-53.7514097"
 Parameter: ZMAX -> "38.4253791"
 Parameter: ZMIN -> "31.4253791"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "52" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "52" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.766624967"
Evaluating: 128.065641*(0.766624967-0.5)
 Parameter: XPOS <- "34.1454973"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.572632878"
Evaluating: 128.065641*(0.572632878-0.5)
 Parameter: YPOS <- "9.30177608"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.124817189"
Evaluating: 108.613069*(0.124817189-0.5)+-2.187274
 Parameter: ZPOS <- "-42.9370305"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.9370305" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.1454973"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.1454973-0
 Parameter: XTRAN <- "34.1454973"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.30177608"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.30177608-0
 Parameter: YTRAN <- "9.30177608"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.9370305"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.9370305-0
 Parameter: ZTRAN <- "-42.9370305"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.1454973"
 Parameter: YTRAN -> "9.30177608"
 Parameter: ZTRAN -> "-42.9370305"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    34.145497    9.301776  -42.937030
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30197469"
Evaluating: 0.30197469*360.0
 Parameter: XPHI <- "108.710888"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.348047883"
Evaluating: 0.348047883*360.0
 Parameter: YPHI <- "125.297238"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717290479"
Evaluating: 0.717290479*360.0
 Parameter: ZPHI <- "258.224572"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.1454973"
 Parameter: YPOS -> "9.30177608"
 Parameter: ZPOS -> "-42.9370305"
 Parameter: XPHI -> "108.710888"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.320793    0.947149
    0.000000   -0.947149   -0.320793

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.1454973"
 Parameter: YPOS -> "9.30177608"
 Parameter: ZPOS -> "-42.9370305"
 Parameter: YPHI -> "125.297238"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.577818    0.000000   -0.816165
    0.000000    1.000000    0.000000
    0.816165    0.000000   -0.577818

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  125.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.1454973"
 Parameter: YPOS -> "9.30177608"
 Parameter: ZPOS -> "-42.9370305"
 Parameter: ZPHI -> "258.224572"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.204076   -0.978955    0.000000
    0.978955   -0.204076    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.145497 XMAX =   34.145497 XAVE =   34.145497
    YMIN =    9.301776 YMAX =    9.301776 YAVE =    9.301776
    ZMIN =  -42.937030 ZMAX =  -42.937030 ZAVE =  -42.937030
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.1454973"
Evaluating: 34.1454973+3.5
 Parameter: XMAX <- "37.6454973"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.30177608"
Evaluating: 9.30177608+3.5
 Parameter: YMAX <- "12.8017761"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.9370305"
Evaluating: -42.9370305+3.5
 Parameter: ZMAX <- "-39.4370305"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.1454973"
Evaluating: 34.1454973-3.5
 Parameter: XMIN <- "30.6454973"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.30177608"
Evaluating: 9.30177608-3.5
 Parameter: YMIN <- "5.80177608"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.9370305"
Evaluating: -42.9370305-3.5
 Parameter: ZMIN <- "-46.4370305"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.6454973"
 Parameter: XMIN -> "30.6454973"
 Parameter: YMAX -> "12.8017761"
 Parameter: YMIN -> "5.80177608"
 Parameter: ZMAX -> "-39.4370305"
 Parameter: ZMIN -> "-46.4370305"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "53" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "53" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.847432766"
Evaluating: 128.065641*(0.847432766-0.5)
 Parameter: XPOS <- "44.4941999"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.211463887"
Evaluating: 128.065641*(0.211463887-0.5)
 Parameter: YPOS <- "-36.9515623"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.571410231"
Evaluating: 108.613069*(0.571410231-0.5)+-2.187274
 Parameter: ZPOS <- "5.56881035"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.56881035" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.56881035" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "53" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.202744613E-02"
Evaluating: 128.065641*(3.202744613E-02-0.5)
 Parameter: XPOS <- "-59.9312051"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.540094038"
Evaluating: 128.065641*(0.540094038-0.5)
 Parameter: YPOS <- "5.13466868"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.431487323"
Evaluating: 108.613069*(0.431487323-0.5)+-2.187274
 Parameter: ZPOS <- "-9.62864611"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.62864611" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.62864611" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "53" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.705983583"
Evaluating: 128.065641*(0.705983583-0.5)
 Parameter: XPOS <- "26.3794196"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.354427835"
Evaluating: 128.065641*(0.354427835-0.5)
 Parameter: YPOS <- "-18.6427926"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.754486382"
Evaluating: 108.613069*(0.754486382-0.5)+-2.187274
 Parameter: ZPOS <- "25.453273"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.453273" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.453273" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.3794196"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.3794196-0
 Parameter: XTRAN <- "26.3794196"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.6427926"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.6427926-0
 Parameter: YTRAN <- "-18.6427926"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.453273"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.453273-0
 Parameter: ZTRAN <- "25.453273"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.3794196"
 Parameter: YTRAN -> "-18.6427926"
 Parameter: ZTRAN -> "25.453273"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    26.379420  -18.642793   25.453273
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.275455259"
Evaluating: 0.275455259*360.0
 Parameter: XPHI <- "99.1638932"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.989200197"
Evaluating: 0.989200197*360.0
 Parameter: YPHI <- "356.112071"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.924639026"
Evaluating: 0.924639026*360.0
 Parameter: ZPHI <- "332.870049"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.3794196"
 Parameter: YPOS -> "-18.6427926"
 Parameter: ZPOS -> "25.453273"
 Parameter: XPHI -> "99.1638932"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.159259    0.987237
    0.000000   -0.987237   -0.159259

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   99.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.3794196"
 Parameter: YPOS -> "-18.6427926"
 Parameter: ZPOS -> "25.453273"
 Parameter: YPHI -> "356.112071"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.997699    0.000000    0.067805
    0.000000    1.000000    0.000000
   -0.067805    0.000000    0.997699

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.3794196"
 Parameter: YPOS -> "-18.6427926"
 Parameter: ZPOS -> "25.453273"
 Parameter: ZPHI -> "332.870049"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.889975   -0.456010    0.000000
    0.456010    0.889975    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   27.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.379420 XMAX =   26.379420 XAVE =   26.379420
    YMIN =  -18.642793 YMAX =  -18.642793 YAVE =  -18.642793
    ZMIN =   25.453273 ZMAX =   25.453273 ZAVE =   25.453273
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.3794196"
Evaluating: 26.3794196+3.5
 Parameter: XMAX <- "29.8794196"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.6427926"
Evaluating: -18.6427926+3.5
 Parameter: YMAX <- "-15.1427926"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.453273"
Evaluating: 25.453273+3.5
 Parameter: ZMAX <- "28.953273"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.3794196"
Evaluating: 26.3794196-3.5
 Parameter: XMIN <- "22.8794196"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.6427926"
Evaluating: -18.6427926-3.5
 Parameter: YMIN <- "-22.1427926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.453273"
Evaluating: 25.453273-3.5
 Parameter: ZMIN <- "21.953273"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.8794196"
 Parameter: XMIN -> "22.8794196"
 Parameter: YMAX -> "-15.1427926"
 Parameter: YMIN -> "-22.1427926"
 Parameter: ZMAX -> "28.953273"
 Parameter: ZMIN -> "21.953273"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "54" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "54" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.301484669"
Evaluating: 128.065641*(0.301484669-0.5)
 Parameter: XPOS <- "-25.4229931"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.799855317"
Evaluating: 128.065641*(0.799855317-0.5)
 Parameter: YPOS <- "38.4011634"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.435092633"
Evaluating: 108.613069*(0.435092633-0.5)+-2.187274
 Parameter: ZPOS <- "-9.23706233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.23706233" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.23706233" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "54" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.40603369"
Evaluating: 128.065641*(0.40603369-0.5)
 Parameter: XPOS <- "-12.0338557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.581716822"
Evaluating: 128.065641*(0.581716822-0.5)
 Parameter: YPOS <- "10.4651172"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "2.099500524E-02"
Evaluating: 108.613069*(2.099500524E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-54.2134765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.2134765" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.0338557"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.0338557-0
 Parameter: XTRAN <- "-12.0338557"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.4651172"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.4651172-0
 Parameter: YTRAN <- "10.4651172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.2134765"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.2134765-0
 Parameter: ZTRAN <- "-54.2134765"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.0338557"
 Parameter: YTRAN -> "10.4651172"
 Parameter: ZTRAN -> "-54.2134765"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -12.033856   10.465117  -54.213476
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515145066"
Evaluating: 0.515145066*360.0
 Parameter: XPHI <- "185.452224"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455784158"
Evaluating: 0.455784158*360.0
 Parameter: YPHI <- "164.082297"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199123288"
Evaluating: 0.199123288*360.0
 Parameter: ZPHI <- "71.6843837"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.0338557"
 Parameter: YPOS -> "10.4651172"
 Parameter: ZPOS -> "-54.2134765"
 Parameter: XPHI -> "185.452224"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995476   -0.095016
    0.000000    0.095016   -0.995476

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.0338557"
 Parameter: YPOS -> "10.4651172"
 Parameter: ZPOS -> "-54.2134765"
 Parameter: YPHI -> "164.082297"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.961657    0.000000   -0.274256
    0.000000    1.000000    0.000000
    0.274256    0.000000   -0.961657

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.0338557"
 Parameter: YPOS -> "10.4651172"
 Parameter: ZPOS -> "-54.2134765"
 Parameter: ZPHI -> "71.6843837"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.314251    0.949340    0.000000
   -0.949340    0.314251    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.033856 XMAX =  -12.033856 XAVE =  -12.033856
    YMIN =   10.465117 YMAX =   10.465117 YAVE =   10.465117
    ZMIN =  -54.213476 ZMAX =  -54.213476 ZAVE =  -54.213476
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.0338557"
Evaluating: -12.0338557+3.5
 Parameter: XMAX <- "-8.5338557"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.4651172"
Evaluating: 10.4651172+3.5
 Parameter: YMAX <- "13.9651172"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.2134765"
Evaluating: -54.2134765+3.5
 Parameter: ZMAX <- "-50.7134765"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.0338557"
Evaluating: -12.0338557-3.5
 Parameter: XMIN <- "-15.5338557"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.4651172"
Evaluating: 10.4651172-3.5
 Parameter: YMIN <- "6.9651172"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.2134765"
Evaluating: -54.2134765-3.5
 Parameter: ZMIN <- "-57.7134765"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.5338557"
 Parameter: XMIN -> "-15.5338557"
 Parameter: YMAX -> "13.9651172"
 Parameter: YMIN -> "6.9651172"
 Parameter: ZMAX -> "-50.7134765"
 Parameter: ZMIN -> "-57.7134765"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "55" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "55" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.983192499"
Evaluating: 128.065641*(0.983192499-0.5)
 Parameter: XPOS <- "61.8803571"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.520591368"
Evaluating: 128.065641*(0.520591368-0.5)
 Parameter: YPOS <- "2.63704674"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "9.158125477E-03"
Evaluating: 108.613069*(9.158125477E-03-0.5)+-2.187274
 Parameter: ZPOS <- "-55.4991164"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.4991164" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.8803571"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.8803571-0
 Parameter: XTRAN <- "61.8803571"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.63704674"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.63704674-0
 Parameter: YTRAN <- "2.63704674"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.4991164"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.4991164-0
 Parameter: ZTRAN <- "-55.4991164"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.8803571"
 Parameter: YTRAN -> "2.63704674"
 Parameter: ZTRAN -> "-55.4991164"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    61.880357    2.637047  -55.499116
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166593583"
Evaluating: 0.166593583*360.0
 Parameter: XPHI <- "59.9736899"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.828587249"
Evaluating: 0.828587249*360.0
 Parameter: YPHI <- "298.29141"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166383547"
Evaluating: 0.166383547*360.0
 Parameter: ZPHI <- "59.8980769"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.8803571"
 Parameter: YPOS -> "2.63704674"
 Parameter: ZPOS -> "-55.4991164"
 Parameter: XPHI -> "59.9736899"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.500398    0.865796
    0.000000   -0.865796    0.500398

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   59.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.8803571"
 Parameter: YPOS -> "2.63704674"
 Parameter: ZPOS -> "-55.4991164"
 Parameter: YPHI -> "298.29141"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.473956    0.000000    0.880548
    0.000000    1.000000    0.000000
   -0.880548    0.000000    0.473956

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   61.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.8803571"
 Parameter: YPOS -> "2.63704674"
 Parameter: ZPOS -> "-55.4991164"
 Parameter: ZPHI -> "59.8980769"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.501540    0.865135    0.000000
   -0.865135    0.501540    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.880357 XMAX =   61.880357 XAVE =   61.880357
    YMIN =    2.637047 YMAX =    2.637047 YAVE =    2.637047
    ZMIN =  -55.499116 ZMAX =  -55.499116 ZAVE =  -55.499116
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.8803571"
Evaluating: 61.8803571+3.5
 Parameter: XMAX <- "65.3803571"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.63704674"
Evaluating: 2.63704674+3.5
 Parameter: YMAX <- "6.13704674"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.4991164"
Evaluating: -55.4991164+3.5
 Parameter: ZMAX <- "-51.9991164"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.8803571"
Evaluating: 61.8803571-3.5
 Parameter: XMIN <- "58.3803571"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.63704674"
Evaluating: 2.63704674-3.5
 Parameter: YMIN <- "-0.86295326"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.4991164"
Evaluating: -55.4991164-3.5
 Parameter: ZMIN <- "-58.9991164"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.3803571"
 Parameter: XMIN -> "58.3803571"
 Parameter: YMAX -> "6.13704674"
 Parameter: YMIN -> "-0.86295326"
 Parameter: ZMAX -> "-51.9991164"
 Parameter: ZMIN -> "-58.9991164"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "56" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "56" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.900493721"
Evaluating: 128.065641*(0.900493721-0.5)
 Parameter: XPOS <- "51.2894851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.191602091"
Evaluating: 128.065641*(0.191602091-0.5)
 Parameter: YPOS <- "-39.4951759"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.937929105"
Evaluating: 108.613069*(0.937929105-0.5)+-2.187274
 Parameter: ZPOS <- "45.3775501"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.3775501" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.3775501" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.2894851"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.2894851-0
 Parameter: XTRAN <- "51.2894851"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.4951759"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.4951759-0
 Parameter: YTRAN <- "-39.4951759"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.3775501"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.3775501-0
 Parameter: ZTRAN <- "45.3775501"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.2894851"
 Parameter: YTRAN -> "-39.4951759"
 Parameter: ZTRAN -> "45.3775501"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    51.289485  -39.495176   45.377550
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209101884"
Evaluating: 0.209101884*360.0
 Parameter: XPHI <- "75.2766782"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.359363674E-02"
Evaluating: 2.359363674E-02*360.0
 Parameter: YPHI <- "8.49370923"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460861658"
Evaluating: 0.460861658*360.0
 Parameter: ZPHI <- "165.910197"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.2894851"
 Parameter: YPOS -> "-39.4951759"
 Parameter: ZPOS -> "45.3775501"
 Parameter: XPHI -> "75.2766782"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.254152    0.967164
    0.000000   -0.967164    0.254152

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.2894851"
 Parameter: YPOS -> "-39.4951759"
 Parameter: ZPOS -> "45.3775501"
 Parameter: YPHI -> "8.49370923"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.989032    0.000000   -0.147701
    0.000000    1.000000    0.000000
    0.147701    0.000000    0.989032

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    8.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.2894851"
 Parameter: YPOS -> "-39.4951759"
 Parameter: ZPOS -> "45.3775501"
 Parameter: ZPHI -> "165.910197"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.969915    0.243442    0.000000
   -0.243442   -0.969915    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.289485 XMAX =   51.289485 XAVE =   51.289485
    YMIN =  -39.495176 YMAX =  -39.495176 YAVE =  -39.495176
    ZMIN =   45.377550 ZMAX =   45.377550 ZAVE =   45.377550
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.2894851"
Evaluating: 51.2894851+3.5
 Parameter: XMAX <- "54.7894851"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.4951759"
Evaluating: -39.4951759+3.5
 Parameter: YMAX <- "-35.9951759"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.3775501"
Evaluating: 45.3775501+3.5
 Parameter: ZMAX <- "48.8775501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.2894851"
Evaluating: 51.2894851-3.5
 Parameter: XMIN <- "47.7894851"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.4951759"
Evaluating: -39.4951759-3.5
 Parameter: YMIN <- "-42.9951759"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.3775501"
Evaluating: 45.3775501-3.5
 Parameter: ZMIN <- "41.8775501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.7894851"
 Parameter: XMIN -> "47.7894851"
 Parameter: YMAX -> "-35.9951759"
 Parameter: YMIN -> "-42.9951759"
 Parameter: ZMAX -> "48.8775501"
 Parameter: ZMIN -> "41.8775501"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "57" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "57" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "1.195499257E-02"
Evaluating: 128.065641*(1.195499257E-02-0.5)
 Parameter: XPOS <- "-62.5017967"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.98566319"
Evaluating: 128.065641*(0.98566319-0.5)
 Parameter: YPOS <- "62.1967677"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.365563132"
Evaluating: 108.613069*(0.365563132-0.5)+-2.187274
 Parameter: ZPOS <- "-16.7888748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.7888748" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-62.5017967"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -62.5017967-0
 Parameter: XTRAN <- "-62.5017967"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "62.1967677"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 62.1967677-0
 Parameter: YTRAN <- "62.1967677"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.7888748"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.7888748-0
 Parameter: ZTRAN <- "-16.7888748"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.5017967"
 Parameter: YTRAN -> "62.1967677"
 Parameter: ZTRAN -> "-16.7888748"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -62.501797   62.196768  -16.788875
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431344869"
Evaluating: 0.431344869*360.0
 Parameter: XPHI <- "155.284153"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.886075356"
Evaluating: 0.886075356*360.0
 Parameter: YPHI <- "318.987128"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.600480915"
Evaluating: 0.600480915*360.0
 Parameter: ZPHI <- "216.173129"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-62.5017967"
 Parameter: YPOS -> "62.1967677"
 Parameter: ZPOS -> "-16.7888748"
 Parameter: XPHI -> "155.284153"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.908393    0.418118
    0.000000   -0.418118   -0.908393

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-62.5017967"
 Parameter: YPOS -> "62.1967677"
 Parameter: ZPOS -> "-16.7888748"
 Parameter: YPHI -> "318.987128"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.754562    0.000000    0.656229
    0.000000    1.000000    0.000000
   -0.656229    0.000000    0.754562

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   41.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-62.5017967"
 Parameter: YPOS -> "62.1967677"
 Parameter: ZPOS -> "-16.7888748"
 Parameter: ZPHI -> "216.173129"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.807237   -0.590227    0.000000
    0.590227   -0.807237    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  143.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.501797 XMAX =  -62.501797 XAVE =  -62.501797
    YMIN =   62.196768 YMAX =   62.196768 YAVE =   62.196768
    ZMIN =  -16.788875 ZMAX =  -16.788875 ZAVE =  -16.788875
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-62.5017967"
Evaluating: -62.5017967+3.5
 Parameter: XMAX <- "-59.0017967"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "62.1967677"
Evaluating: 62.1967677+3.5
 Parameter: YMAX <- "65.6967677"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.7888748"
Evaluating: -16.7888748+3.5
 Parameter: ZMAX <- "-13.2888748"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-62.5017967"
Evaluating: -62.5017967-3.5
 Parameter: XMIN <- "-66.0017967"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "62.1967677"
Evaluating: 62.1967677-3.5
 Parameter: YMIN <- "58.6967677"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.7888748"
Evaluating: -16.7888748-3.5
 Parameter: ZMIN <- "-20.2888748"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-59.0017967"
 Parameter: XMIN -> "-66.0017967"
 Parameter: YMAX -> "65.6967677"
 Parameter: YMIN -> "58.6967677"
 Parameter: ZMAX -> "-13.2888748"
 Parameter: ZMIN -> "-20.2888748"
 SELRPN>     13 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      5 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60289 POS      POT      57       POT     -**** MEMB     DMPC     368      N             3.8095
60289 POS      POT      57       POT     -**** MEMB     DMPC     368      C14           3.7610
60289 POS      POT      57       POT     -**** MEMB     DMPC     368      C12           2.8362
60289 POS      POT      57       POT     -**** MEMB     DMPC     368      C11           2.9950
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "57" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.735947346"
Evaluating: 128.065641*(0.735947346-0.5)
 Parameter: XPOS <- "30.2167481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.308801855"
Evaluating: 128.065641*(0.308801855-0.5)
 Parameter: YPOS <- "-24.485913"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.295428646"
Evaluating: 108.613069*(0.295428646-0.5)+-2.187274
 Parameter: ZPOS <- "-24.4063966"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.4063966" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.501797 XMAX =  -62.501797 XAVE =  -62.501797
    YMIN =   62.196768 YMAX =   62.196768 YAVE =   62.196768
    ZMIN =  -16.788875 ZMAX =  -16.788875 ZAVE =  -16.788875
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.2167481"
 RDCMND substituted energy or value "?XAVE" to "-62.5017967"
Evaluating: 30.2167481--62.5017967
 Parameter: XTRAN <- "92.7185448"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.485913"
 RDCMND substituted energy or value "?YAVE" to "62.1967677"
Evaluating: -24.485913-62.1967677
 Parameter: YTRAN <- "-86.6826807"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.4063966"
 RDCMND substituted energy or value "?ZAVE" to "-16.7888748"
Evaluating: -24.4063966--16.7888748
 Parameter: ZTRAN <- "-7.6175218"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "92.7185448"
 Parameter: YTRAN -> "-86.6826807"
 Parameter: ZTRAN -> "-7.6175218"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    92.718545  -86.682681   -7.617522
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644208331"
Evaluating: 0.644208331*360.0
 Parameter: XPHI <- "231.914999"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982896229"
Evaluating: 0.982896229*360.0
 Parameter: YPHI <- "353.842642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211371343"
Evaluating: 0.211371343*360.0
 Parameter: ZPHI <- "76.0936835"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.2167481"
 Parameter: YPOS -> "-24.485913"
 Parameter: ZPOS -> "-24.4063966"
 Parameter: XPHI -> "231.914999"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.616830   -0.787097
    0.000000    0.787097   -0.616830

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.2167481"
 Parameter: YPOS -> "-24.485913"
 Parameter: ZPOS -> "-24.4063966"
 Parameter: YPHI -> "353.842642"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.994231    0.000000    0.107259
    0.000000    1.000000    0.000000
   -0.107259    0.000000    0.994231

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.2167481"
 Parameter: YPOS -> "-24.485913"
 Parameter: ZPOS -> "-24.4063966"
 Parameter: ZPHI -> "76.0936835"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.240335    0.970690    0.000000
   -0.970690    0.240335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.216748 XMAX =   30.216748 XAVE =   30.216748
    YMIN =  -24.485913 YMAX =  -24.485913 YAVE =  -24.485913
    ZMIN =  -24.406397 ZMAX =  -24.406397 ZAVE =  -24.406397
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.2167481"
Evaluating: 30.2167481+3.5
 Parameter: XMAX <- "33.7167481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.485913"
Evaluating: -24.485913+3.5
 Parameter: YMAX <- "-20.985913"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.4063966"
Evaluating: -24.4063966+3.5
 Parameter: ZMAX <- "-20.9063966"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.2167481"
Evaluating: 30.2167481-3.5
 Parameter: XMIN <- "26.7167481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.485913"
Evaluating: -24.485913-3.5
 Parameter: YMIN <- "-27.985913"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.4063966"
Evaluating: -24.4063966-3.5
 Parameter: ZMIN <- "-27.9063966"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.7167481"
 Parameter: XMIN -> "26.7167481"
 Parameter: YMAX -> "-20.985913"
 Parameter: YMIN -> "-27.985913"
 Parameter: ZMAX -> "-20.9063966"
 Parameter: ZMIN -> "-27.9063966"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "58" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "58" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.329874736"
Evaluating: 128.065641*(0.329874736-0.5)
 Parameter: XPOS <- "-21.787201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.238559305"
Evaluating: 128.065641*(0.238559305-0.5)
 Parameter: YPOS <- "-33.4815702"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.622820349"
Evaluating: 108.613069*(0.622820349-0.5)+-2.187274
 Parameter: ZPOS <- "11.152621"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.152621" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.152621" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "58" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.159386263"
Evaluating: 128.065641*(0.159386263-0.5)
 Parameter: XPOS <- "-43.6209166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.997620602"
Evaluating: 128.065641*(0.997620602-0.5)
 Parameter: YPOS <- "63.7281014"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.882301712"
Evaluating: 108.613069*(0.882301712-0.5)+-2.187274
 Parameter: ZPOS <- "39.3356882"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.3356882" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.3356882" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.6209166"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.6209166-0
 Parameter: XTRAN <- "-43.6209166"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "63.7281014"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 63.7281014-0
 Parameter: YTRAN <- "63.7281014"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.3356882"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.3356882-0
 Parameter: ZTRAN <- "39.3356882"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.6209166"
 Parameter: YTRAN -> "63.7281014"
 Parameter: ZTRAN -> "39.3356882"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -43.620917   63.728101   39.335688
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636060817"
Evaluating: 0.636060817*360.0
 Parameter: XPHI <- "228.981894"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700897304"
Evaluating: 0.700897304*360.0
 Parameter: YPHI <- "252.323029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798574492"
Evaluating: 0.798574492*360.0
 Parameter: ZPHI <- "287.486817"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.6209166"
 Parameter: YPOS -> "63.7281014"
 Parameter: ZPOS -> "39.3356882"
 Parameter: XPHI -> "228.981894"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.656297   -0.754502
    0.000000    0.754502   -0.656297

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.6209166"
 Parameter: YPOS -> "63.7281014"
 Parameter: ZPOS -> "39.3356882"
 Parameter: YPHI -> "252.323029"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.303650    0.000000    0.952784
    0.000000    1.000000    0.000000
   -0.952784    0.000000   -0.303650

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.6209166"
 Parameter: YPOS -> "63.7281014"
 Parameter: ZPOS -> "39.3356882"
 Parameter: ZPHI -> "287.486817"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.300486   -0.953786    0.000000
    0.953786    0.300486    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.620917 XMAX =  -43.620917 XAVE =  -43.620917
    YMIN =   63.728101 YMAX =   63.728101 YAVE =   63.728101
    ZMIN =   39.335688 ZMAX =   39.335688 ZAVE =   39.335688
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.6209166"
Evaluating: -43.6209166+3.5
 Parameter: XMAX <- "-40.1209166"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "63.7281014"
Evaluating: 63.7281014+3.5
 Parameter: YMAX <- "67.2281014"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.3356882"
Evaluating: 39.3356882+3.5
 Parameter: ZMAX <- "42.8356882"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.6209166"
Evaluating: -43.6209166-3.5
 Parameter: XMIN <- "-47.1209166"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "63.7281014"
Evaluating: 63.7281014-3.5
 Parameter: YMIN <- "60.2281014"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.3356882"
Evaluating: 39.3356882-3.5
 Parameter: ZMIN <- "35.8356882"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.1209166"
 Parameter: XMIN -> "-47.1209166"
 Parameter: YMAX -> "67.2281014"
 Parameter: YMIN -> "60.2281014"
 Parameter: ZMAX -> "42.8356882"
 Parameter: ZMIN -> "35.8356882"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "59" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "59" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.970638215"
Evaluating: 128.065641*(0.970638215-0.5)
 Parameter: XPOS <- "60.2725847"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.448016126"
Evaluating: 128.065641*(0.448016126-0.5)
 Parameter: YPOS <- "-6.65734815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "7.739509336E-02"
Evaluating: 108.613069*(7.739509336E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-48.0876899"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.0876899" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "60.2725847"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 60.2725847-0
 Parameter: XTRAN <- "60.2725847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.65734815"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.65734815-0
 Parameter: YTRAN <- "-6.65734815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.0876899"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.0876899-0
 Parameter: ZTRAN <- "-48.0876899"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "60.2725847"
 Parameter: YTRAN -> "-6.65734815"
 Parameter: ZTRAN -> "-48.0876899"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    60.272585   -6.657348  -48.087690
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.421826391E-02"
Evaluating: 1.421826391E-02*360.0
 Parameter: XPHI <- "5.11857501"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450494448"
Evaluating: 0.450494448*360.0
 Parameter: YPHI <- "162.178001"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.435887497"
Evaluating: 0.435887497*360.0
 Parameter: ZPHI <- "156.919499"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "60.2725847"
 Parameter: YPOS -> "-6.65734815"
 Parameter: ZPOS -> "-48.0876899"
 Parameter: XPHI -> "5.11857501"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996012    0.089217
    0.000000   -0.089217    0.996012

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "60.2725847"
 Parameter: YPOS -> "-6.65734815"
 Parameter: ZPOS -> "-48.0876899"
 Parameter: YPHI -> "162.178001"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.952012    0.000000   -0.306061
    0.000000    1.000000    0.000000
    0.306061    0.000000   -0.952012

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "60.2725847"
 Parameter: YPOS -> "-6.65734815"
 Parameter: ZPOS -> "-48.0876899"
 Parameter: ZPHI -> "156.919499"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.919955    0.392024    0.000000
   -0.392024   -0.919955    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  156.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   60.272585 XMAX =   60.272585 XAVE =   60.272585
    YMIN =   -6.657348 YMAX =   -6.657348 YAVE =   -6.657348
    ZMIN =  -48.087690 ZMAX =  -48.087690 ZAVE =  -48.087690
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "60.2725847"
Evaluating: 60.2725847+3.5
 Parameter: XMAX <- "63.7725847"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.65734815"
Evaluating: -6.65734815+3.5
 Parameter: YMAX <- "-3.15734815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.0876899"
Evaluating: -48.0876899+3.5
 Parameter: ZMAX <- "-44.5876899"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "60.2725847"
Evaluating: 60.2725847-3.5
 Parameter: XMIN <- "56.7725847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.65734815"
Evaluating: -6.65734815-3.5
 Parameter: YMIN <- "-10.1573482"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.0876899"
Evaluating: -48.0876899-3.5
 Parameter: ZMIN <- "-51.5876899"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "63.7725847"
 Parameter: XMIN -> "56.7725847"
 Parameter: YMAX -> "-3.15734815"
 Parameter: YMIN -> "-10.1573482"
 Parameter: ZMAX -> "-44.5876899"
 Parameter: ZMIN -> "-51.5876899"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "60" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "60" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.641809788"
Evaluating: 128.065641*(0.641809788-0.5)
 Parameter: XPOS <- "18.1609614"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.553397978E-02"
Evaluating: 128.065641*(2.553397978E-02-0.5)
 Parameter: YPOS <- "-60.762795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.956817616"
Evaluating: 108.613069*(0.956817616-0.5)+-2.187274
 Parameter: ZPOS <- "47.4290892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.4290892" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.4290892" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.1609614"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.1609614-0
 Parameter: XTRAN <- "18.1609614"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-60.762795"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -60.762795-0
 Parameter: YTRAN <- "-60.762795"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.4290892"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.4290892-0
 Parameter: ZTRAN <- "47.4290892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.1609614"
 Parameter: YTRAN -> "-60.762795"
 Parameter: ZTRAN -> "47.4290892"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    18.160961  -60.762795   47.429089
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764506462"
Evaluating: 0.764506462*360.0
 Parameter: XPHI <- "275.222326"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307650223"
Evaluating: 0.307650223*360.0
 Parameter: YPHI <- "110.75408"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566628582"
Evaluating: 0.566628582*360.0
 Parameter: ZPHI <- "203.98629"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.1609614"
 Parameter: YPOS -> "-60.762795"
 Parameter: ZPOS -> "47.4290892"
 Parameter: XPHI -> "275.222326"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.091021   -0.995849
    0.000000    0.995849    0.091021

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   84.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.1609614"
 Parameter: YPOS -> "-60.762795"
 Parameter: ZPOS -> "47.4290892"
 Parameter: YPHI -> "110.75408"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.354358    0.000000   -0.935110
    0.000000    1.000000    0.000000
    0.935110    0.000000   -0.354358

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.1609614"
 Parameter: YPOS -> "-60.762795"
 Parameter: ZPOS -> "47.4290892"
 Parameter: ZPHI -> "203.98629"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.913643   -0.406518    0.000000
    0.406518   -0.913643    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  156.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.160961 XMAX =   18.160961 XAVE =   18.160961
    YMIN =  -60.762795 YMAX =  -60.762795 YAVE =  -60.762795
    ZMIN =   47.429089 ZMAX =   47.429089 ZAVE =   47.429089
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.1609614"
Evaluating: 18.1609614+3.5
 Parameter: XMAX <- "21.6609614"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-60.762795"
Evaluating: -60.762795+3.5
 Parameter: YMAX <- "-57.262795"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.4290892"
Evaluating: 47.4290892+3.5
 Parameter: ZMAX <- "50.9290892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.1609614"
Evaluating: 18.1609614-3.5
 Parameter: XMIN <- "14.6609614"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-60.762795"
Evaluating: -60.762795-3.5
 Parameter: YMIN <- "-64.262795"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.4290892"
Evaluating: 47.4290892-3.5
 Parameter: ZMIN <- "43.9290892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.6609614"
 Parameter: XMIN -> "14.6609614"
 Parameter: YMAX -> "-57.262795"
 Parameter: YMIN -> "-64.262795"
 Parameter: ZMAX -> "50.9290892"
 Parameter: ZMIN -> "43.9290892"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "61" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "61" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.258016265"
Evaluating: 128.065641*(0.258016265-0.5)
 Parameter: XPOS <- "-30.9898021"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.93632681"
Evaluating: 128.065641*(0.93632681-0.5)
 Parameter: YPOS <- "55.8784726"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.395189919"
Evaluating: 108.613069*(0.395189919-0.5)+-2.187274
 Parameter: ZPOS <- "-13.5710186"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.5710186" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.5710186" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "61" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.7639146"
Evaluating: 128.065641*(0.7639146-0.5)
 Parameter: XPOS <- "33.7983924"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.681246018"
Evaluating: 128.065641*(0.681246018-0.5)
 Parameter: YPOS <- "23.2113875"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.788146663"
Evaluating: 108.613069*(0.788146663-0.5)+-2.187274
 Parameter: ZPOS <- "29.1092194"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.1092194" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.1092194" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.7983924"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.7983924-0
 Parameter: XTRAN <- "33.7983924"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.2113875"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.2113875-0
 Parameter: YTRAN <- "23.2113875"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.1092194"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.1092194-0
 Parameter: ZTRAN <- "29.1092194"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.7983924"
 Parameter: YTRAN -> "23.2113875"
 Parameter: ZTRAN -> "29.1092194"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    33.798392   23.211388   29.109219
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.724037351"
Evaluating: 0.724037351*360.0
 Parameter: XPHI <- "260.653446"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745205044"
Evaluating: 0.745205044*360.0
 Parameter: YPHI <- "268.273816"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.94141342E-02"
Evaluating: 4.94141342E-02*360.0
 Parameter: ZPHI <- "17.7890883"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.7983924"
 Parameter: YPOS -> "23.2113875"
 Parameter: ZPOS -> "29.1092194"
 Parameter: XPHI -> "260.653446"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.162406   -0.986724
    0.000000    0.986724   -0.162406

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   99.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.7983924"
 Parameter: YPOS -> "23.2113875"
 Parameter: ZPOS -> "29.1092194"
 Parameter: YPHI -> "268.273816"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.030123    0.000000    0.999546
    0.000000    1.000000    0.000000
   -0.999546    0.000000   -0.030123

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.7983924"
 Parameter: YPOS -> "23.2113875"
 Parameter: ZPOS -> "29.1092194"
 Parameter: ZPHI -> "17.7890883"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.952188    0.305514    0.000000
   -0.305514    0.952188    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.798392 XMAX =   33.798392 XAVE =   33.798392
    YMIN =   23.211388 YMAX =   23.211388 YAVE =   23.211388
    ZMIN =   29.109219 ZMAX =   29.109219 ZAVE =   29.109219
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.7983924"
Evaluating: 33.7983924+3.5
 Parameter: XMAX <- "37.2983924"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.2113875"
Evaluating: 23.2113875+3.5
 Parameter: YMAX <- "26.7113875"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.1092194"
Evaluating: 29.1092194+3.5
 Parameter: ZMAX <- "32.6092194"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.7983924"
Evaluating: 33.7983924-3.5
 Parameter: XMIN <- "30.2983924"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.2113875"
Evaluating: 23.2113875-3.5
 Parameter: YMIN <- "19.7113875"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.1092194"
Evaluating: 29.1092194-3.5
 Parameter: ZMIN <- "25.6092194"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.2983924"
 Parameter: XMIN -> "30.2983924"
 Parameter: YMAX -> "26.7113875"
 Parameter: YMIN -> "19.7113875"
 Parameter: ZMAX -> "32.6092194"
 Parameter: ZMIN -> "25.6092194"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "62" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "62" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.238031563"
Evaluating: 128.065641*(0.238031563-0.5)
 Parameter: XPOS <- "-33.5491558"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.847184048"
Evaluating: 128.065641*(0.847184048-0.5)
 Parameter: YPOS <- "44.4623477"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "6.932673579E-02"
Evaluating: 108.613069*(6.932673579E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-48.964019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.964019" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.5491558"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.5491558-0
 Parameter: XTRAN <- "-33.5491558"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.4623477"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.4623477-0
 Parameter: YTRAN <- "44.4623477"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.964019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.964019-0
 Parameter: ZTRAN <- "-48.964019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.5491558"
 Parameter: YTRAN -> "44.4623477"
 Parameter: ZTRAN -> "-48.964019"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -33.549156   44.462348  -48.964019
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341687851"
Evaluating: 0.341687851*360.0
 Parameter: XPHI <- "123.007626"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764283611"
Evaluating: 0.764283611*360.0
 Parameter: YPHI <- "275.1421"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541398919"
Evaluating: 0.541398919*360.0
 Parameter: ZPHI <- "194.903611"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.5491558"
 Parameter: YPOS -> "44.4623477"
 Parameter: ZPOS -> "-48.964019"
 Parameter: XPHI -> "123.007626"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.544751    0.838598
    0.000000   -0.838598   -0.544751

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.5491558"
 Parameter: YPOS -> "44.4623477"
 Parameter: ZPOS -> "-48.964019"
 Parameter: YPHI -> "275.1421"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.089626    0.000000    0.995975
    0.000000    1.000000    0.000000
   -0.995975    0.000000    0.089626

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.5491558"
 Parameter: YPOS -> "44.4623477"
 Parameter: ZPOS -> "-48.964019"
 Parameter: ZPHI -> "194.903611"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.966360   -0.257194    0.000000
    0.257194   -0.966360    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.549156 XMAX =  -33.549156 XAVE =  -33.549156
    YMIN =   44.462348 YMAX =   44.462348 YAVE =   44.462348
    ZMIN =  -48.964019 ZMAX =  -48.964019 ZAVE =  -48.964019
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.5491558"
Evaluating: -33.5491558+3.5
 Parameter: XMAX <- "-30.0491558"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.4623477"
Evaluating: 44.4623477+3.5
 Parameter: YMAX <- "47.9623477"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.964019"
Evaluating: -48.964019+3.5
 Parameter: ZMAX <- "-45.464019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.5491558"
Evaluating: -33.5491558-3.5
 Parameter: XMIN <- "-37.0491558"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.4623477"
Evaluating: 44.4623477-3.5
 Parameter: YMIN <- "40.9623477"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.964019"
Evaluating: -48.964019-3.5
 Parameter: ZMIN <- "-52.464019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.0491558"
 Parameter: XMIN -> "-37.0491558"
 Parameter: YMAX -> "47.9623477"
 Parameter: YMIN -> "40.9623477"
 Parameter: ZMAX -> "-45.464019"
 Parameter: ZMIN -> "-52.464019"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "63" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "63" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.498600537"
Evaluating: 128.065641*(0.498600537-0.5)
 Parameter: XPOS <- "-0.179223126"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.688604307"
Evaluating: 128.065641*(0.688604307-0.5)
 Parameter: YPOS <- "24.1537315"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.601902564"
Evaluating: 108.613069*(0.601902564-0.5)+-2.187274
 Parameter: ZPOS <- "8.88067622"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.88067622" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.88067622" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "63" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.134254249E-02"
Evaluating: 128.065641*(5.134254249E-02-0.5)
 Parameter: XPOS <- "-57.4576049"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.546276149"
Evaluating: 128.065641*(0.546276149-0.5)
 Parameter: YPOS <- "5.92638468"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.765326866"
Evaluating: 108.613069*(0.765326866-0.5)+-2.187274
 Parameter: ZPOS <- "26.6306912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.6306912" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.6306912" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.4576049"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.4576049-0
 Parameter: XTRAN <- "-57.4576049"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.92638468"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.92638468-0
 Parameter: YTRAN <- "5.92638468"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.6306912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.6306912-0
 Parameter: ZTRAN <- "26.6306912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.4576049"
 Parameter: YTRAN -> "5.92638468"
 Parameter: ZTRAN -> "26.6306912"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -57.457605    5.926385   26.630691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.469653601E-02"
Evaluating: 4.469653601E-02*360.0
 Parameter: XPHI <- "16.090753"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.608952484"
Evaluating: 0.608952484*360.0
 Parameter: YPHI <- "219.222894"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867853209"
Evaluating: 0.867853209*360.0
 Parameter: ZPHI <- "312.427155"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.4576049"
 Parameter: YPOS -> "5.92638468"
 Parameter: ZPOS -> "26.6306912"
 Parameter: XPHI -> "16.090753"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.960824    0.277160
    0.000000   -0.277160    0.960824

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.4576049"
 Parameter: YPOS -> "5.92638468"
 Parameter: ZPOS -> "26.6306912"
 Parameter: YPHI -> "219.222894"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.774692    0.000000    0.632339
    0.000000    1.000000    0.000000
   -0.632339    0.000000   -0.774692

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  140.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.4576049"
 Parameter: YPOS -> "5.92638468"
 Parameter: ZPOS -> "26.6306912"
 Parameter: ZPHI -> "312.427155"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.674652   -0.738136    0.000000
    0.738136    0.674652    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.457605 XMAX =  -57.457605 XAVE =  -57.457605
    YMIN =    5.926385 YMAX =    5.926385 YAVE =    5.926385
    ZMIN =   26.630691 ZMAX =   26.630691 ZAVE =   26.630691
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.4576049"
Evaluating: -57.4576049+3.5
 Parameter: XMAX <- "-53.9576049"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.92638468"
Evaluating: 5.92638468+3.5
 Parameter: YMAX <- "9.42638468"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.6306912"
Evaluating: 26.6306912+3.5
 Parameter: ZMAX <- "30.1306912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.4576049"
Evaluating: -57.4576049-3.5
 Parameter: XMIN <- "-60.9576049"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.92638468"
Evaluating: 5.92638468-3.5
 Parameter: YMIN <- "2.42638468"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.6306912"
Evaluating: 26.6306912-3.5
 Parameter: ZMIN <- "23.1306912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.9576049"
 Parameter: XMIN -> "-60.9576049"
 Parameter: YMAX -> "9.42638468"
 Parameter: YMIN -> "2.42638468"
 Parameter: ZMAX -> "30.1306912"
 Parameter: ZMIN -> "23.1306912"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "64" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "64" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.550538718"
Evaluating: 128.065641*(0.550538718-0.5)
 Parameter: XPOS <- "6.47227332"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.540960653E-02"
Evaluating: 128.065641*(9.540960653E-02-0.5)
 Parameter: YPOS <- "-51.8141281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.316695345E-02"
Evaluating: 108.613069*(1.316695345E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-55.0637053"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.0637053" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.47227332"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.47227332-0
 Parameter: XTRAN <- "6.47227332"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.8141281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.8141281-0
 Parameter: YTRAN <- "-51.8141281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.0637053"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.0637053-0
 Parameter: ZTRAN <- "-55.0637053"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.47227332"
 Parameter: YTRAN -> "-51.8141281"
 Parameter: ZTRAN -> "-55.0637053"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     6.472273  -51.814128  -55.063705
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293334735"
Evaluating: 0.293334735*360.0
 Parameter: XPHI <- "105.600505"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.039075175E-02"
Evaluating: 7.039075175E-02*360.0
 Parameter: YPHI <- "25.3406706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919351275"
Evaluating: 0.919351275*360.0
 Parameter: ZPHI <- "330.966459"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.47227332"
 Parameter: YPOS -> "-51.8141281"
 Parameter: ZPOS -> "-55.0637053"
 Parameter: XPHI -> "105.600505"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.268928    0.963160
    0.000000   -0.963160   -0.268928

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.47227332"
 Parameter: YPOS -> "-51.8141281"
 Parameter: ZPOS -> "-55.0637053"
 Parameter: YPHI -> "25.3406706"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.903779    0.000000   -0.428000
    0.000000    1.000000    0.000000
    0.428000    0.000000    0.903779

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.47227332"
 Parameter: YPOS -> "-51.8141281"
 Parameter: ZPOS -> "-55.0637053"
 Parameter: ZPHI -> "330.966459"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.874336   -0.485322    0.000000
    0.485322    0.874336    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.472273 XMAX =    6.472273 XAVE =    6.472273
    YMIN =  -51.814128 YMAX =  -51.814128 YAVE =  -51.814128
    ZMIN =  -55.063705 ZMAX =  -55.063705 ZAVE =  -55.063705
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.47227332"
Evaluating: 6.47227332+3.5
 Parameter: XMAX <- "9.97227332"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.8141281"
Evaluating: -51.8141281+3.5
 Parameter: YMAX <- "-48.3141281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.0637053"
Evaluating: -55.0637053+3.5
 Parameter: ZMAX <- "-51.5637053"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.47227332"
Evaluating: 6.47227332-3.5
 Parameter: XMIN <- "2.97227332"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.8141281"
Evaluating: -51.8141281-3.5
 Parameter: YMIN <- "-55.3141281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.0637053"
Evaluating: -55.0637053-3.5
 Parameter: ZMIN <- "-58.5637053"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.97227332"
 Parameter: XMIN -> "2.97227332"
 Parameter: YMAX -> "-48.3141281"
 Parameter: YMIN -> "-55.3141281"
 Parameter: ZMAX -> "-51.5637053"
 Parameter: ZMIN -> "-58.5637053"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "65" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "65" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.1173716E-03"
Evaluating: 128.065641*(4.1173716E-03-0.5)
 Parameter: XPOS <- "-63.5055267"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.585785528"
Evaluating: 128.065641*(0.585785528-0.5)
 Parameter: YPOS <- "10.9861786"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.869745049"
Evaluating: 108.613069*(0.869745049-0.5)+-2.187274
 Parameter: ZPOS <- "37.9718705"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.9718705" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.9718705" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-63.5055267"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -63.5055267-0
 Parameter: XTRAN <- "-63.5055267"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.9861786"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.9861786-0
 Parameter: YTRAN <- "10.9861786"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.9718705"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.9718705-0
 Parameter: ZTRAN <- "37.9718705"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.5055267"
 Parameter: YTRAN -> "10.9861786"
 Parameter: ZTRAN -> "37.9718705"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -63.505527   10.986179   37.971871
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420505397"
Evaluating: 0.420505397*360.0
 Parameter: XPHI <- "151.381943"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.715453114"
Evaluating: 0.715453114*360.0
 Parameter: YPHI <- "257.563121"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83184564"
Evaluating: 0.83184564*360.0
 Parameter: ZPHI <- "299.46443"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-63.5055267"
 Parameter: YPOS -> "10.9861786"
 Parameter: ZPOS -> "37.9718705"
 Parameter: XPHI -> "151.381943"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.877832    0.478969
    0.000000   -0.478969   -0.877832

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  151.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-63.5055267"
 Parameter: YPOS -> "10.9861786"
 Parameter: ZPOS -> "37.9718705"
 Parameter: YPHI -> "257.563121"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.215364    0.000000    0.976534
    0.000000    1.000000    0.000000
   -0.976534    0.000000   -0.215364

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-63.5055267"
 Parameter: YPOS -> "10.9861786"
 Parameter: ZPOS -> "37.9718705"
 Parameter: ZPHI -> "299.46443"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.491883   -0.870661    0.000000
    0.870661    0.491883    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -63.505527 XMAX =  -63.505527 XAVE =  -63.505527
    YMIN =   10.986179 YMAX =   10.986179 YAVE =   10.986179
    ZMIN =   37.971871 ZMAX =   37.971871 ZAVE =   37.971871
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-63.5055267"
Evaluating: -63.5055267+3.5
 Parameter: XMAX <- "-60.0055267"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.9861786"
Evaluating: 10.9861786+3.5
 Parameter: YMAX <- "14.4861786"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.9718705"
Evaluating: 37.9718705+3.5
 Parameter: ZMAX <- "41.4718705"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-63.5055267"
Evaluating: -63.5055267-3.5
 Parameter: XMIN <- "-67.0055267"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.9861786"
Evaluating: 10.9861786-3.5
 Parameter: YMIN <- "7.4861786"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.9718705"
Evaluating: 37.9718705-3.5
 Parameter: ZMIN <- "34.4718705"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-60.0055267"
 Parameter: XMIN -> "-67.0055267"
 Parameter: YMAX -> "14.4861786"
 Parameter: YMIN -> "7.4861786"
 Parameter: ZMAX -> "41.4718705"
 Parameter: ZMIN -> "34.4718705"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "66" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "66" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.307789449"
Evaluating: 128.065641*(0.307789449-0.5)
 Parameter: XPOS <- "-24.6155674"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.037099744E-03"
Evaluating: 128.065641*(7.037099744E-03-0.5)
 Parameter: YPOS <- "-63.1316098"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.884568683"
Evaluating: 108.613069*(0.884568683-0.5)+-2.187274
 Parameter: ZPOS <- "39.5819109"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.5819109" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.5819109" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.6155674"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.6155674-0
 Parameter: XTRAN <- "-24.6155674"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-63.1316098"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -63.1316098-0
 Parameter: YTRAN <- "-63.1316098"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.5819109"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.5819109-0
 Parameter: ZTRAN <- "39.5819109"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.6155674"
 Parameter: YTRAN -> "-63.1316098"
 Parameter: ZTRAN -> "39.5819109"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -24.615567  -63.131610   39.581911
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450012314"
Evaluating: 0.450012314*360.0
 Parameter: XPHI <- "162.004433"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533095978"
Evaluating: 0.533095978*360.0
 Parameter: YPHI <- "191.914552"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256182806"
Evaluating: 0.256182806*360.0
 Parameter: ZPHI <- "92.2258102"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.6155674"
 Parameter: YPOS -> "-63.1316098"
 Parameter: ZPOS -> "39.5819109"
 Parameter: XPHI -> "162.004433"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951080    0.308943
    0.000000   -0.308943   -0.951080

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  162.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.6155674"
 Parameter: YPOS -> "-63.1316098"
 Parameter: ZPOS -> "39.5819109"
 Parameter: YPHI -> "191.914552"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.978457    0.000000    0.206453
    0.000000    1.000000    0.000000
   -0.206453    0.000000   -0.978457

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  168.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.6155674"
 Parameter: YPOS -> "-63.1316098"
 Parameter: ZPOS -> "39.5819109"
 Parameter: ZPHI -> "92.2258102"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.038838    0.999246    0.000000
   -0.999246   -0.038838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.615567 XMAX =  -24.615567 XAVE =  -24.615567
    YMIN =  -63.131610 YMAX =  -63.131610 YAVE =  -63.131610
    ZMIN =   39.581911 ZMAX =   39.581911 ZAVE =   39.581911
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.6155674"
Evaluating: -24.6155674+3.5
 Parameter: XMAX <- "-21.1155674"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-63.1316098"
Evaluating: -63.1316098+3.5
 Parameter: YMAX <- "-59.6316098"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.5819109"
Evaluating: 39.5819109+3.5
 Parameter: ZMAX <- "43.0819109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.6155674"
Evaluating: -24.6155674-3.5
 Parameter: XMIN <- "-28.1155674"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-63.1316098"
Evaluating: -63.1316098-3.5
 Parameter: YMIN <- "-66.6316098"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.5819109"
Evaluating: 39.5819109-3.5
 Parameter: ZMIN <- "36.0819109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.1155674"
 Parameter: XMIN -> "-28.1155674"
 Parameter: YMAX -> "-59.6316098"
 Parameter: YMIN -> "-66.6316098"
 Parameter: ZMAX -> "43.0819109"
 Parameter: ZMIN -> "36.0819109"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "67" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "67" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.985312343"
Evaluating: 128.065641*(0.985312343-0.5)
 Parameter: XPOS <- "62.1518363"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.569692839"
Evaluating: 128.065641*(0.569692839-0.5)
 Parameter: YPOS <- "8.9252581"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.870205483"
Evaluating: 108.613069*(0.870205483-0.5)+-2.187274
 Parameter: ZPOS <- "38.0218797"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.0218797" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.0218797" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "62.1518363"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 62.1518363-0
 Parameter: XTRAN <- "62.1518363"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.9252581"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.9252581-0
 Parameter: YTRAN <- "8.9252581"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.0218797"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.0218797-0
 Parameter: ZTRAN <- "38.0218797"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "62.1518363"
 Parameter: YTRAN -> "8.9252581"
 Parameter: ZTRAN -> "38.0218797"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    62.151836    8.925258   38.021880
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670191467"
Evaluating: 0.670191467*360.0
 Parameter: XPHI <- "241.268928"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907677407"
Evaluating: 0.907677407*360.0
 Parameter: YPHI <- "326.763867"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943576297"
Evaluating: 0.943576297*360.0
 Parameter: ZPHI <- "339.687467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "62.1518363"
 Parameter: YPOS -> "8.9252581"
 Parameter: ZPOS -> "38.0218797"
 Parameter: XPHI -> "241.268928"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.480699   -0.876886
    0.000000    0.876886   -0.480699

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "62.1518363"
 Parameter: YPOS -> "8.9252581"
 Parameter: ZPOS -> "38.0218797"
 Parameter: YPHI -> "326.763867"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.836419    0.000000    0.548091
    0.000000    1.000000    0.000000
   -0.548091    0.000000    0.836419

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "62.1518363"
 Parameter: YPOS -> "8.9252581"
 Parameter: ZPOS -> "38.0218797"
 Parameter: ZPHI -> "339.687467"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.937813   -0.347141    0.000000
    0.347141    0.937813    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   62.151836 XMAX =   62.151836 XAVE =   62.151836
    YMIN =    8.925258 YMAX =    8.925258 YAVE =    8.925258
    ZMIN =   38.021880 ZMAX =   38.021880 ZAVE =   38.021880
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "62.1518363"
Evaluating: 62.1518363+3.5
 Parameter: XMAX <- "65.6518363"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.9252581"
Evaluating: 8.9252581+3.5
 Parameter: YMAX <- "12.4252581"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.0218797"
Evaluating: 38.0218797+3.5
 Parameter: ZMAX <- "41.5218797"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "62.1518363"
Evaluating: 62.1518363-3.5
 Parameter: XMIN <- "58.6518363"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.9252581"
Evaluating: 8.9252581-3.5
 Parameter: YMIN <- "5.4252581"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.0218797"
Evaluating: 38.0218797-3.5
 Parameter: ZMIN <- "34.5218797"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.6518363"
 Parameter: XMIN -> "58.6518363"
 Parameter: YMAX -> "12.4252581"
 Parameter: YMIN -> "5.4252581"
 Parameter: ZMAX -> "41.5218797"
 Parameter: ZMIN -> "34.5218797"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "68" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "68" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.892104797"
Evaluating: 128.065641*(0.892104797-0.5)
 Parameter: XPOS <- "50.2151522"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.134844058"
Evaluating: 128.065641*(0.134844058-0.5)
 Parameter: YPOS <- "-46.7639298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.75381757"
Evaluating: 108.613069*(0.75381757-0.5)+-2.187274
 Parameter: ZPOS <- "25.3806312"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.3806312" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.3806312" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.2151522"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.2151522-0
 Parameter: XTRAN <- "50.2151522"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.7639298"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.7639298-0
 Parameter: YTRAN <- "-46.7639298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.3806312"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.3806312-0
 Parameter: ZTRAN <- "25.3806312"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.2151522"
 Parameter: YTRAN -> "-46.7639298"
 Parameter: ZTRAN -> "25.3806312"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    50.215152  -46.763930   25.380631
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60664827"
Evaluating: 0.60664827*360.0
 Parameter: XPHI <- "218.393377"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798535918"
Evaluating: 0.798535918*360.0
 Parameter: YPHI <- "287.47293"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.590625627E-02"
Evaluating: 1.590625627E-02*360.0
 Parameter: ZPHI <- "5.72625226"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.2151522"
 Parameter: YPOS -> "-46.7639298"
 Parameter: ZPOS -> "25.3806312"
 Parameter: XPHI -> "218.393377"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.783765   -0.621057
    0.000000    0.621057   -0.783765

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  141.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.2151522"
 Parameter: YPOS -> "-46.7639298"
 Parameter: ZPOS -> "25.3806312"
 Parameter: YPHI -> "287.47293"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.300255    0.000000    0.953859
    0.000000    1.000000    0.000000
   -0.953859    0.000000    0.300255

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.2151522"
 Parameter: YPOS -> "-46.7639298"
 Parameter: ZPOS -> "25.3806312"
 Parameter: ZPHI -> "5.72625226"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.995010    0.099776    0.000000
   -0.099776    0.995010    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    5.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.215152 XMAX =   50.215152 XAVE =   50.215152
    YMIN =  -46.763930 YMAX =  -46.763930 YAVE =  -46.763930
    ZMIN =   25.380631 ZMAX =   25.380631 ZAVE =   25.380631
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.2151522"
Evaluating: 50.2151522+3.5
 Parameter: XMAX <- "53.7151522"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.7639298"
Evaluating: -46.7639298+3.5
 Parameter: YMAX <- "-43.2639298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.3806312"
Evaluating: 25.3806312+3.5
 Parameter: ZMAX <- "28.8806312"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.2151522"
Evaluating: 50.2151522-3.5
 Parameter: XMIN <- "46.7151522"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.7639298"
Evaluating: -46.7639298-3.5
 Parameter: YMIN <- "-50.2639298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.3806312"
Evaluating: 25.3806312-3.5
 Parameter: ZMIN <- "21.8806312"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.7151522"
 Parameter: XMIN -> "46.7151522"
 Parameter: YMAX -> "-43.2639298"
 Parameter: YMIN -> "-50.2639298"
 Parameter: ZMAX -> "28.8806312"
 Parameter: ZMIN -> "21.8806312"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "69" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "69" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.589588224"
Evaluating: 128.065641*(0.589588224-0.5)
 Parameter: XPOS <- "11.4731733"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.934445292"
Evaluating: 128.065641*(0.934445292-0.5)
 Parameter: YPOS <- "55.6375148"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.864963143"
Evaluating: 108.613069*(0.864963143-0.5)+-2.187274
 Parameter: ZPOS <- "37.452493"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.452493" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.452493" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.4731733"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.4731733-0
 Parameter: XTRAN <- "11.4731733"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.6375148"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.6375148-0
 Parameter: YTRAN <- "55.6375148"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.452493"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.452493-0
 Parameter: ZTRAN <- "37.452493"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.4731733"
 Parameter: YTRAN -> "55.6375148"
 Parameter: ZTRAN -> "37.452493"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    11.473173   55.637515   37.452493
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171106332"
Evaluating: 0.171106332*360.0
 Parameter: XPHI <- "61.5982795"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75255695"
Evaluating: 0.75255695*360.0
 Parameter: YPHI <- "270.920502"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.275852223"
Evaluating: 0.275852223*360.0
 Parameter: ZPHI <- "99.3068003"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.4731733"
 Parameter: YPOS -> "55.6375148"
 Parameter: ZPOS -> "37.452493"
 Parameter: XPHI -> "61.5982795"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.475651    0.879634
    0.000000   -0.879634    0.475651

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.4731733"
 Parameter: YPOS -> "55.6375148"
 Parameter: ZPOS -> "37.452493"
 Parameter: YPHI -> "270.920502"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.016065    0.000000    0.999871
    0.000000    1.000000    0.000000
   -0.999871    0.000000    0.016065

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.4731733"
 Parameter: YPOS -> "55.6375148"
 Parameter: ZPOS -> "37.452493"
 Parameter: ZPHI -> "99.3068003"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.161721    0.986837    0.000000
   -0.986837   -0.161721    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.473173 XMAX =   11.473173 XAVE =   11.473173
    YMIN =   55.637515 YMAX =   55.637515 YAVE =   55.637515
    ZMIN =   37.452493 ZMAX =   37.452493 ZAVE =   37.452493
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.4731733"
Evaluating: 11.4731733+3.5
 Parameter: XMAX <- "14.9731733"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.6375148"
Evaluating: 55.6375148+3.5
 Parameter: YMAX <- "59.1375148"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.452493"
Evaluating: 37.452493+3.5
 Parameter: ZMAX <- "40.952493"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.4731733"
Evaluating: 11.4731733-3.5
 Parameter: XMIN <- "7.9731733"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.6375148"
Evaluating: 55.6375148-3.5
 Parameter: YMIN <- "52.1375148"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.452493"
Evaluating: 37.452493-3.5
 Parameter: ZMIN <- "33.952493"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.9731733"
 Parameter: XMIN -> "7.9731733"
 Parameter: YMAX -> "59.1375148"
 Parameter: YMIN -> "52.1375148"
 Parameter: ZMAX -> "40.952493"
 Parameter: ZMIN -> "33.952493"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "70" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "70" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.361594114"
Evaluating: 128.065641*(0.361594114-0.5)
 Parameter: XPOS <- "-17.7250385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.447536463"
Evaluating: 128.065641*(0.447536463-0.5)
 Parameter: YPOS <- "-6.7187765"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.834052004E-03"
Evaluating: 108.613069*(3.834052004E-03-0.5)+-2.187274
 Parameter: ZPOS <- "-56.0773803"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.0773803" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.7250385"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.7250385-0
 Parameter: XTRAN <- "-17.7250385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.7187765"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.7187765-0
 Parameter: YTRAN <- "-6.7187765"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.0773803"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.0773803-0
 Parameter: ZTRAN <- "-56.0773803"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.7250385"
 Parameter: YTRAN -> "-6.7187765"
 Parameter: ZTRAN -> "-56.0773803"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -17.725039   -6.718776  -56.077380
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983958791"
Evaluating: 0.983958791*360.0
 Parameter: XPHI <- "354.225165"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708823502"
Evaluating: 0.708823502*360.0
 Parameter: YPHI <- "255.176461"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210004304"
Evaluating: 0.210004304*360.0
 Parameter: ZPHI <- "75.6015494"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.7250385"
 Parameter: YPOS -> "-6.7187765"
 Parameter: ZPOS -> "-56.0773803"
 Parameter: XPHI -> "354.225165"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994925   -0.100619
    0.000000    0.100619    0.994925

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.7250385"
 Parameter: YPOS -> "-6.7187765"
 Parameter: ZPOS -> "-56.0773803"
 Parameter: YPHI -> "255.176461"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.255843    0.000000    0.966718
    0.000000    1.000000    0.000000
   -0.966718    0.000000   -0.255843

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.7250385"
 Parameter: YPOS -> "-6.7187765"
 Parameter: ZPOS -> "-56.0773803"
 Parameter: ZPHI -> "75.6015494"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.248664    0.968590    0.000000
   -0.968590    0.248664    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.725039 XMAX =  -17.725039 XAVE =  -17.725039
    YMIN =   -6.718776 YMAX =   -6.718776 YAVE =   -6.718776
    ZMIN =  -56.077380 ZMAX =  -56.077380 ZAVE =  -56.077380
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.7250385"
Evaluating: -17.7250385+3.5
 Parameter: XMAX <- "-14.2250385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.7187765"
Evaluating: -6.7187765+3.5
 Parameter: YMAX <- "-3.2187765"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.0773803"
Evaluating: -56.0773803+3.5
 Parameter: ZMAX <- "-52.5773803"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.7250385"
Evaluating: -17.7250385-3.5
 Parameter: XMIN <- "-21.2250385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.7187765"
Evaluating: -6.7187765-3.5
 Parameter: YMIN <- "-10.2187765"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.0773803"
Evaluating: -56.0773803-3.5
 Parameter: ZMIN <- "-59.5773803"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.2250385"
 Parameter: XMIN -> "-21.2250385"
 Parameter: YMAX -> "-3.2187765"
 Parameter: YMIN -> "-10.2187765"
 Parameter: ZMAX -> "-52.5773803"
 Parameter: ZMIN -> "-59.5773803"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "71" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "71" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.935586143"
Evaluating: 128.065641*(0.935586143-0.5)
 Parameter: XPOS <- "55.7836186"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.160786297"
Evaluating: 128.065641*(0.160786297-0.5)
 Parameter: YPOS <- "-43.4416203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.572903496"
Evaluating: 108.613069*(0.572903496-0.5)+-2.187274
 Parameter: ZPOS <- "5.73099844"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.73099844" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.73099844" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "71" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.741324108"
Evaluating: 128.065641*(0.741324108-0.5)
 Parameter: XPOS <- "30.9053266"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.665706497"
Evaluating: 128.065641*(0.665706497-0.5)
 Parameter: YPOS <- "21.2213088"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.534661818"
Evaluating: 108.613069*(0.534661818-0.5)+-2.187274
 Parameter: ZPOS <- "1.57745243"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.57745243" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.57745243" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "71" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.412854065E-02"
Evaluating: 128.065641*(6.412854065E-02-0.5)
 Parameter: XPOS <- "-55.8201578"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.827674813"
Evaluating: 128.065641*(0.827674813-0.5)
 Parameter: YPOS <- "41.963885"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.80304465E-02"
Evaluating: 108.613069*(4.80304465E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.2770743"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.2770743" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.8201578"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -55.8201578-0
 Parameter: XTRAN <- "-55.8201578"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.963885"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.963885-0
 Parameter: YTRAN <- "41.963885"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.2770743"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.2770743-0
 Parameter: ZTRAN <- "-51.2770743"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-55.8201578"
 Parameter: YTRAN -> "41.963885"
 Parameter: ZTRAN -> "-51.2770743"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -55.820158   41.963885  -51.277074
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574287988"
Evaluating: 0.574287988*360.0
 Parameter: XPHI <- "206.743676"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.869619337"
Evaluating: 0.869619337*360.0
 Parameter: YPHI <- "313.062961"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.630471982"
Evaluating: 0.630471982*360.0
 Parameter: ZPHI <- "226.969914"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.8201578"
 Parameter: YPOS -> "41.963885"
 Parameter: ZPOS -> "-51.2770743"
 Parameter: XPHI -> "206.743676"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.893029   -0.450000
    0.000000    0.450000   -0.893029

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  153.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.8201578"
 Parameter: YPOS -> "41.963885"
 Parameter: ZPOS -> "-51.2770743"
 Parameter: YPHI -> "313.062961"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.682802    0.000000    0.730604
    0.000000    1.000000    0.000000
   -0.730604    0.000000    0.682802

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.8201578"
 Parameter: YPOS -> "41.963885"
 Parameter: ZPOS -> "-51.2770743"
 Parameter: ZPHI -> "226.969914"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.682382   -0.730995    0.000000
    0.730995   -0.682382    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  133.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.820158 XMAX =  -55.820158 XAVE =  -55.820158
    YMIN =   41.963885 YMAX =   41.963885 YAVE =   41.963885
    ZMIN =  -51.277074 ZMAX =  -51.277074 ZAVE =  -51.277074
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.8201578"
Evaluating: -55.8201578+3.5
 Parameter: XMAX <- "-52.3201578"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.963885"
Evaluating: 41.963885+3.5
 Parameter: YMAX <- "45.463885"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.2770743"
Evaluating: -51.2770743+3.5
 Parameter: ZMAX <- "-47.7770743"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.8201578"
Evaluating: -55.8201578-3.5
 Parameter: XMIN <- "-59.3201578"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.963885"
Evaluating: 41.963885-3.5
 Parameter: YMIN <- "38.463885"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.2770743"
Evaluating: -51.2770743-3.5
 Parameter: ZMIN <- "-54.7770743"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-52.3201578"
 Parameter: XMIN -> "-59.3201578"
 Parameter: YMAX -> "45.463885"
 Parameter: YMIN -> "38.463885"
 Parameter: ZMAX -> "-47.7770743"
 Parameter: ZMIN -> "-54.7770743"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "72" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "72" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.746507118"
Evaluating: 128.065641*(0.746507118-0.5)
 Parameter: XPOS <- "31.5690921"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.781252132"
Evaluating: 128.065641*(0.781252132-0.5)
 Parameter: YPOS <- "36.0187346"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.384372371"
Evaluating: 108.613069*(0.384372371-0.5)+-2.187274
 Parameter: ZPOS <- "-14.7459456"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.7459456" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.7459456" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "72" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.763539496"
Evaluating: 128.065641*(0.763539496-0.5)
 Parameter: XPOS <- "33.7503545"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.378037415"
Evaluating: 128.065641*(0.378037415-0.5)
 Parameter: YPOS <- "-15.6192166"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.791006677"
Evaluating: 108.613069*(0.791006677-0.5)+-2.187274
 Parameter: ZPOS <- "29.4198543"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.4198543" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.4198543" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.7503545"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.7503545-0
 Parameter: XTRAN <- "33.7503545"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.6192166"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.6192166-0
 Parameter: YTRAN <- "-15.6192166"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.4198543"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.4198543-0
 Parameter: ZTRAN <- "29.4198543"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.7503545"
 Parameter: YTRAN -> "-15.6192166"
 Parameter: ZTRAN -> "29.4198543"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    33.750355  -15.619217   29.419854
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.378344796"
Evaluating: 0.378344796*360.0
 Parameter: XPHI <- "136.204127"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491920432"
Evaluating: 0.491920432*360.0
 Parameter: YPHI <- "177.091356"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519591935"
Evaluating: 0.519591935*360.0
 Parameter: ZPHI <- "187.053097"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.7503545"
 Parameter: YPOS -> "-15.6192166"
 Parameter: ZPOS -> "29.4198543"
 Parameter: XPHI -> "136.204127"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.721810    0.692091
    0.000000   -0.692091   -0.721810

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  136.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.7503545"
 Parameter: YPOS -> "-15.6192166"
 Parameter: ZPOS -> "29.4198543"
 Parameter: YPHI -> "177.091356"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.998712    0.000000   -0.050744
    0.000000    1.000000    0.000000
    0.050744    0.000000   -0.998712

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.7503545"
 Parameter: YPOS -> "-15.6192166"
 Parameter: ZPOS -> "29.4198543"
 Parameter: ZPHI -> "187.053097"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.992433   -0.122789    0.000000
    0.122789   -0.992433    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  172.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.750355 XMAX =   33.750355 XAVE =   33.750355
    YMIN =  -15.619217 YMAX =  -15.619217 YAVE =  -15.619217
    ZMIN =   29.419854 ZMAX =   29.419854 ZAVE =   29.419854
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.7503545"
Evaluating: 33.7503545+3.5
 Parameter: XMAX <- "37.2503545"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.6192166"
Evaluating: -15.6192166+3.5
 Parameter: YMAX <- "-12.1192166"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.4198543"
Evaluating: 29.4198543+3.5
 Parameter: ZMAX <- "32.9198543"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.7503545"
Evaluating: 33.7503545-3.5
 Parameter: XMIN <- "30.2503545"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.6192166"
Evaluating: -15.6192166-3.5
 Parameter: YMIN <- "-19.1192166"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.4198543"
Evaluating: 29.4198543-3.5
 Parameter: ZMIN <- "25.9198543"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.2503545"
 Parameter: XMIN -> "30.2503545"
 Parameter: YMAX -> "-12.1192166"
 Parameter: YMIN -> "-19.1192166"
 Parameter: ZMAX -> "32.9198543"
 Parameter: ZMIN -> "25.9198543"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "73" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "73" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.771073019"
Evaluating: 128.065641*(0.771073019-0.5)
 Parameter: XPOS <- "34.7151399"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.148599833"
Evaluating: 128.065641*(0.148599833-0.5)
 Parameter: YPOS <- "-45.0022876"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.589929848"
Evaluating: 108.613069*(0.589929848-0.5)+-2.187274
 Parameter: ZPOS <- "7.58028279"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.58028279" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.58028279" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "73" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.98492423E-02"
Evaluating: 128.065641*(6.98492423E-02-0.5)
 Parameter: XPOS <- "-55.0875325"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.791799913"
Evaluating: 128.065641*(0.791799913-0.5)
 Parameter: YPOS <- "37.3695429"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.264335582E-02"
Evaluating: 108.613069*(3.264335582E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-52.9483134"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.9483134" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.0875325"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -55.0875325-0
 Parameter: XTRAN <- "-55.0875325"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.3695429"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.3695429-0
 Parameter: YTRAN <- "37.3695429"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.9483134"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.9483134-0
 Parameter: ZTRAN <- "-52.9483134"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-55.0875325"
 Parameter: YTRAN -> "37.3695429"
 Parameter: ZTRAN -> "-52.9483134"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -55.087533   37.369543  -52.948313
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870474901"
Evaluating: 0.870474901*360.0
 Parameter: XPHI <- "313.370964"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607976264"
Evaluating: 0.607976264*360.0
 Parameter: YPHI <- "218.871455"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819333597"
Evaluating: 0.819333597*360.0
 Parameter: ZPHI <- "294.960095"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.0875325"
 Parameter: YPOS -> "37.3695429"
 Parameter: ZPOS -> "-52.9483134"
 Parameter: XPHI -> "313.370964"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.686719   -0.726923
    0.000000    0.726923    0.686719

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   46.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.0875325"
 Parameter: YPOS -> "37.3695429"
 Parameter: ZPOS -> "-52.9483134"
 Parameter: YPHI -> "218.871455"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.778556    0.000000    0.627575
    0.000000    1.000000    0.000000
   -0.627575    0.000000   -0.778556

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.0875325"
 Parameter: YPOS -> "37.3695429"
 Parameter: ZPOS -> "-52.9483134"
 Parameter: ZPHI -> "294.960095"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.421987   -0.906602    0.000000
    0.906602    0.421987    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   65.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.087533 XMAX =  -55.087533 XAVE =  -55.087533
    YMIN =   37.369543 YMAX =   37.369543 YAVE =   37.369543
    ZMIN =  -52.948313 ZMAX =  -52.948313 ZAVE =  -52.948313
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.0875325"
Evaluating: -55.0875325+3.5
 Parameter: XMAX <- "-51.5875325"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.3695429"
Evaluating: 37.3695429+3.5
 Parameter: YMAX <- "40.8695429"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.9483134"
Evaluating: -52.9483134+3.5
 Parameter: ZMAX <- "-49.4483134"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.0875325"
Evaluating: -55.0875325-3.5
 Parameter: XMIN <- "-58.5875325"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.3695429"
Evaluating: 37.3695429-3.5
 Parameter: YMIN <- "33.8695429"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.9483134"
Evaluating: -52.9483134-3.5
 Parameter: ZMIN <- "-56.4483134"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.5875325"
 Parameter: XMIN -> "-58.5875325"
 Parameter: YMAX -> "40.8695429"
 Parameter: YMIN -> "33.8695429"
 Parameter: ZMAX -> "-49.4483134"
 Parameter: ZMIN -> "-56.4483134"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "74" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "74" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.810942006"
Evaluating: 128.065641*(0.810942006-0.5)
 Parameter: XPOS <- "39.8209873"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.936786201"
Evaluating: 128.065641*(0.936786201-0.5)
 Parameter: YPOS <- "55.9373048"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.220882783"
Evaluating: 108.613069*(0.220882783-0.5)+-2.187274
 Parameter: ZPOS <- "-32.5030515"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.5030515" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8209873"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8209873-0
 Parameter: XTRAN <- "39.8209873"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.9373048"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.9373048-0
 Parameter: YTRAN <- "55.9373048"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.5030515"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.5030515-0
 Parameter: ZTRAN <- "-32.5030515"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8209873"
 Parameter: YTRAN -> "55.9373048"
 Parameter: ZTRAN -> "-32.5030515"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    39.820987   55.937305  -32.503051
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.770256198E-02"
Evaluating: 9.770256198E-02*360.0
 Parameter: XPHI <- "35.1729223"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495909837"
Evaluating: 0.495909837*360.0
 Parameter: YPHI <- "178.527541"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465721653"
Evaluating: 0.465721653*360.0
 Parameter: ZPHI <- "167.659795"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8209873"
 Parameter: YPOS -> "55.9373048"
 Parameter: ZPOS -> "-32.5030515"
 Parameter: XPHI -> "35.1729223"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.817417    0.576046
    0.000000   -0.576046    0.817417

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8209873"
 Parameter: YPOS -> "55.9373048"
 Parameter: ZPOS -> "-32.5030515"
 Parameter: YPHI -> "178.527541"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999670    0.000000   -0.025696
    0.000000    1.000000    0.000000
    0.025696    0.000000   -0.999670

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8209873"
 Parameter: YPOS -> "55.9373048"
 Parameter: ZPOS -> "-32.5030515"
 Parameter: ZPHI -> "167.659795"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.976896    0.213716    0.000000
   -0.213716   -0.976896    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.820987 XMAX =   39.820987 XAVE =   39.820987
    YMIN =   55.937305 YMAX =   55.937305 YAVE =   55.937305
    ZMIN =  -32.503051 ZMAX =  -32.503051 ZAVE =  -32.503051
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8209873"
Evaluating: 39.8209873+3.5
 Parameter: XMAX <- "43.3209873"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.9373048"
Evaluating: 55.9373048+3.5
 Parameter: YMAX <- "59.4373048"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.5030515"
Evaluating: -32.5030515+3.5
 Parameter: ZMAX <- "-29.0030515"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8209873"
Evaluating: 39.8209873-3.5
 Parameter: XMIN <- "36.3209873"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.9373048"
Evaluating: 55.9373048-3.5
 Parameter: YMIN <- "52.4373048"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.5030515"
Evaluating: -32.5030515-3.5
 Parameter: ZMIN <- "-36.0030515"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3209873"
 Parameter: XMIN -> "36.3209873"
 Parameter: YMAX -> "59.4373048"
 Parameter: YMIN -> "52.4373048"
 Parameter: ZMAX -> "-29.0030515"
 Parameter: ZMIN -> "-36.0030515"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "75" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "75" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.414408091"
Evaluating: 128.065641*(0.414408091-0.5)
 Parameter: XPOS <- "-10.9613827"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.696016164"
Evaluating: 128.065641*(0.696016164-0.5)
 Parameter: YPOS <- "25.1029357"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.906940927"
Evaluating: 108.613069*(0.906940927-0.5)+-2.187274
 Parameter: ZPOS <- "42.011829"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.011829" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.011829" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.9613827"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.9613827-0
 Parameter: XTRAN <- "-10.9613827"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.1029357"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.1029357-0
 Parameter: YTRAN <- "25.1029357"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.011829"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.011829-0
 Parameter: ZTRAN <- "42.011829"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.9613827"
 Parameter: YTRAN -> "25.1029357"
 Parameter: ZTRAN -> "42.011829"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -10.961383   25.102936   42.011829
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671648064"
Evaluating: 0.671648064*360.0
 Parameter: XPHI <- "241.793303"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.534076812"
Evaluating: 0.534076812*360.0
 Parameter: YPHI <- "192.267652"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.998577124"
Evaluating: 0.998577124*360.0
 Parameter: ZPHI <- "359.487765"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.9613827"
 Parameter: YPOS -> "25.1029357"
 Parameter: ZPOS -> "42.011829"
 Parameter: XPHI -> "241.793303"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.472654   -0.881248
    0.000000    0.881248   -0.472654

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.9613827"
 Parameter: YPOS -> "25.1029357"
 Parameter: ZPOS -> "42.011829"
 Parameter: YPHI -> "192.267652"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.977166    0.000000    0.212479
    0.000000    1.000000    0.000000
   -0.212479    0.000000   -0.977166

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.9613827"
 Parameter: YPOS -> "25.1029357"
 Parameter: ZPOS -> "42.011829"
 Parameter: ZPHI -> "359.487765"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999960   -0.008940    0.000000
    0.008940    0.999960    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.961383 XMAX =  -10.961383 XAVE =  -10.961383
    YMIN =   25.102936 YMAX =   25.102936 YAVE =   25.102936
    ZMIN =   42.011829 ZMAX =   42.011829 ZAVE =   42.011829
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.9613827"
Evaluating: -10.9613827+3.5
 Parameter: XMAX <- "-7.4613827"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.1029357"
Evaluating: 25.1029357+3.5
 Parameter: YMAX <- "28.6029357"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.011829"
Evaluating: 42.011829+3.5
 Parameter: ZMAX <- "45.511829"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.9613827"
Evaluating: -10.9613827-3.5
 Parameter: XMIN <- "-14.4613827"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.1029357"
Evaluating: 25.1029357-3.5
 Parameter: YMIN <- "21.6029357"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.011829"
Evaluating: 42.011829-3.5
 Parameter: ZMIN <- "38.511829"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.4613827"
 Parameter: XMIN -> "-14.4613827"
 Parameter: YMAX -> "28.6029357"
 Parameter: YMIN -> "21.6029357"
 Parameter: ZMAX -> "45.511829"
 Parameter: ZMIN -> "38.511829"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "76" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "76" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.442416144"
Evaluating: 128.065641*(0.442416144-0.5)
 Parameter: XPOS <- "-7.37451343"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.241009177"
Evaluating: 128.065641*(0.241009177-0.5)
 Parameter: YPOS <- "-33.1678258"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.367211238"
Evaluating: 108.613069*(0.367211238-0.5)+-2.187274
 Parameter: ZPOS <- "-16.609869"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.609869" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.37451343"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.37451343-0
 Parameter: XTRAN <- "-7.37451343"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.1678258"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.1678258-0
 Parameter: YTRAN <- "-33.1678258"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.609869"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.609869-0
 Parameter: ZTRAN <- "-16.609869"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.37451343"
 Parameter: YTRAN -> "-33.1678258"
 Parameter: ZTRAN -> "-16.609869"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.374513  -33.167826  -16.609869
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283147823"
Evaluating: 0.283147823*360.0
 Parameter: XPHI <- "101.933216"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.637913224"
Evaluating: 0.637913224*360.0
 Parameter: YPHI <- "229.648761"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623869275"
Evaluating: 0.623869275*360.0
 Parameter: ZPHI <- "224.592939"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.37451343"
 Parameter: YPOS -> "-33.1678258"
 Parameter: ZPOS -> "-16.609869"
 Parameter: XPHI -> "101.933216"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.206771    0.978389
    0.000000   -0.978389   -0.206771

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  101.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.37451343"
 Parameter: YPOS -> "-33.1678258"
 Parameter: ZPOS -> "-16.609869"
 Parameter: YPHI -> "229.648761"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.647472    0.000000    0.762090
    0.000000    1.000000    0.000000
   -0.762090    0.000000   -0.647472

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  130.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.37451343"
 Parameter: YPOS -> "-33.1678258"
 Parameter: ZPOS -> "-16.609869"
 Parameter: ZPHI -> "224.592939"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.712113   -0.702065    0.000000
    0.702065   -0.712113    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  135.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.374513 XMAX =   -7.374513 XAVE =   -7.374513
    YMIN =  -33.167826 YMAX =  -33.167826 YAVE =  -33.167826
    ZMIN =  -16.609869 ZMAX =  -16.609869 ZAVE =  -16.609869
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.37451343"
Evaluating: -7.37451343+3.5
 Parameter: XMAX <- "-3.87451343"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.1678258"
Evaluating: -33.1678258+3.5
 Parameter: YMAX <- "-29.6678258"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.609869"
Evaluating: -16.609869+3.5
 Parameter: ZMAX <- "-13.109869"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.37451343"
Evaluating: -7.37451343-3.5
 Parameter: XMIN <- "-10.8745134"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.1678258"
Evaluating: -33.1678258-3.5
 Parameter: YMIN <- "-36.6678258"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.609869"
Evaluating: -16.609869-3.5
 Parameter: ZMIN <- "-20.109869"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.87451343"
 Parameter: XMIN -> "-10.8745134"
 Parameter: YMAX -> "-29.6678258"
 Parameter: YMIN -> "-36.6678258"
 Parameter: ZMAX -> "-13.109869"
 Parameter: ZMIN -> "-20.109869"
 SELRPN>     27 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     14 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      C14           3.9566
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      C12           3.2724
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      C11           2.3670
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      P             0.6906
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      O13           2.0719
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      O14           0.8991
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      O11           1.7772
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      O12           1.7892
60308 POS      POT      76       POT     -**** MEMB     DMPC     300      C1            3.0312
60308 POS      POT      76       POT     -**** MEMB     DMPC     327      C1            3.4855
60308 POS      POT      76       POT     -**** MEMB     DMPC     327      C2            3.2759
60308 POS      POT      76       POT     -**** MEMB     DMPC     327      C3            3.0535
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "76" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.158979581"
Evaluating: 128.065641*(0.158979581-0.5)
 Parameter: XPOS <- "-43.6729986"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.644857512"
Evaluating: 128.065641*(0.644857512-0.5)
 Parameter: YPOS <- "18.5512701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.986062889"
Evaluating: 108.613069*(0.986062889-0.5)+-2.187274
 Parameter: ZPOS <- "50.6055081"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.6055081" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.6055081" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.374513 XMAX =   -7.374513 XAVE =   -7.374513
    YMIN =  -33.167826 YMAX =  -33.167826 YAVE =  -33.167826
    ZMIN =  -16.609869 ZMAX =  -16.609869 ZAVE =  -16.609869
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.6729986"
 RDCMND substituted energy or value "?XAVE" to "-7.37451343"
Evaluating: -43.6729986--7.37451343
 Parameter: XTRAN <- "-36.2984852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.5512701"
 RDCMND substituted energy or value "?YAVE" to "-33.1678258"
Evaluating: 18.5512701--33.1678258
 Parameter: YTRAN <- "51.7190959"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.6055081"
 RDCMND substituted energy or value "?ZAVE" to "-16.609869"
Evaluating: 50.6055081--16.609869
 Parameter: ZTRAN <- "67.2153771"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.2984852"
 Parameter: YTRAN -> "51.7190959"
 Parameter: ZTRAN -> "67.2153771"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -36.298485   51.719096   67.215377
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278800009"
Evaluating: 0.278800009*360.0
 Parameter: XPHI <- "100.368003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675417913"
Evaluating: 0.675417913*360.0
 Parameter: YPHI <- "243.150449"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498093721"
Evaluating: 0.498093721*360.0
 Parameter: ZPHI <- "179.31374"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.6729986"
 Parameter: YPOS -> "18.5512701"
 Parameter: ZPOS -> "50.6055081"
 Parameter: XPHI -> "100.368003"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.179970    0.983672
    0.000000   -0.983672   -0.179970

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.6729986"
 Parameter: YPOS -> "18.5512701"
 Parameter: ZPOS -> "50.6055081"
 Parameter: YPHI -> "243.150449"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.451649    0.000000    0.892196
    0.000000    1.000000    0.000000
   -0.892196    0.000000   -0.451649

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.6729986"
 Parameter: YPOS -> "18.5512701"
 Parameter: ZPOS -> "50.6055081"
 Parameter: ZPHI -> "179.31374"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999928    0.011977    0.000000
   -0.011977   -0.999928    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.672999 XMAX =  -43.672999 XAVE =  -43.672999
    YMIN =   18.551270 YMAX =   18.551270 YAVE =   18.551270
    ZMIN =   50.605508 ZMAX =   50.605508 ZAVE =   50.605508
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.6729986"
Evaluating: -43.6729986+3.5
 Parameter: XMAX <- "-40.1729986"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.5512701"
Evaluating: 18.5512701+3.5
 Parameter: YMAX <- "22.0512701"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.6055081"
Evaluating: 50.6055081+3.5
 Parameter: ZMAX <- "54.1055081"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.6729986"
Evaluating: -43.6729986-3.5
 Parameter: XMIN <- "-47.1729986"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.5512701"
Evaluating: 18.5512701-3.5
 Parameter: YMIN <- "15.0512701"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.6055081"
Evaluating: 50.6055081-3.5
 Parameter: ZMIN <- "47.1055081"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.1729986"
 Parameter: XMIN -> "-47.1729986"
 Parameter: YMAX -> "22.0512701"
 Parameter: YMIN -> "15.0512701"
 Parameter: ZMAX -> "54.1055081"
 Parameter: ZMIN -> "47.1055081"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "77" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "77" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.839749391"
Evaluating: 128.065641*(0.839749391-0.5)
 Parameter: XPOS <- "43.5102235"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.490609587"
Evaluating: 128.065641*(0.490609587-0.5)
 Parameter: YPOS <- "-1.20258926"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.315420646"
Evaluating: 108.613069*(0.315420646-0.5)+-2.187274
 Parameter: ZPOS <- "-22.2350041"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.2350041" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.5102235"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.5102235-0
 Parameter: XTRAN <- "43.5102235"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.20258926"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.20258926-0
 Parameter: YTRAN <- "-1.20258926"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.2350041"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.2350041-0
 Parameter: ZTRAN <- "-22.2350041"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.5102235"
 Parameter: YTRAN -> "-1.20258926"
 Parameter: ZTRAN -> "-22.2350041"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    43.510224   -1.202589  -22.235004
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.778531711"
Evaluating: 0.778531711*360.0
 Parameter: XPHI <- "280.271416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.44211198"
Evaluating: 0.44211198*360.0
 Parameter: YPHI <- "159.160313"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537265483"
Evaluating: 0.537265483*360.0
 Parameter: ZPHI <- "193.415574"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.5102235"
 Parameter: YPOS -> "-1.20258926"
 Parameter: ZPOS -> "-22.2350041"
 Parameter: XPHI -> "280.271416"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.178311   -0.983974
    0.000000    0.983974    0.178311

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.5102235"
 Parameter: YPOS -> "-1.20258926"
 Parameter: ZPOS -> "-22.2350041"
 Parameter: YPHI -> "159.160313"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.934579    0.000000   -0.355754
    0.000000    1.000000    0.000000
    0.355754    0.000000   -0.934579

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.5102235"
 Parameter: YPOS -> "-1.20258926"
 Parameter: ZPOS -> "-22.2350041"
 Parameter: ZPHI -> "193.415574"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.972713   -0.232012    0.000000
    0.232012   -0.972713    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.510224 XMAX =   43.510224 XAVE =   43.510224
    YMIN =   -1.202589 YMAX =   -1.202589 YAVE =   -1.202589
    ZMIN =  -22.235004 ZMAX =  -22.235004 ZAVE =  -22.235004
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.5102235"
Evaluating: 43.5102235+3.5
 Parameter: XMAX <- "47.0102235"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.20258926"
Evaluating: -1.20258926+3.5
 Parameter: YMAX <- "2.29741074"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.2350041"
Evaluating: -22.2350041+3.5
 Parameter: ZMAX <- "-18.7350041"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.5102235"
Evaluating: 43.5102235-3.5
 Parameter: XMIN <- "40.0102235"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.20258926"
Evaluating: -1.20258926-3.5
 Parameter: YMIN <- "-4.70258926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.2350041"
Evaluating: -22.2350041-3.5
 Parameter: ZMIN <- "-25.7350041"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.0102235"
 Parameter: XMIN -> "40.0102235"
 Parameter: YMAX -> "2.29741074"
 Parameter: YMIN -> "-4.70258926"
 Parameter: ZMAX -> "-18.7350041"
 Parameter: ZMIN -> "-25.7350041"
 SELRPN>      2 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "78" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "78" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.33252607E-02"
Evaluating: 128.065641*(9.33252607E-02-0.5)
 Parameter: XPOS <- "-52.0810612"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.643469286"
Evaluating: 128.065641*(0.643469286-0.5)
 Parameter: YPOS <- "18.3734861"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.819848366E-02"
Evaluating: 108.613069*(4.819848366E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.2588233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.2588233" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-52.0810612"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -52.0810612-0
 Parameter: XTRAN <- "-52.0810612"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.3734861"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.3734861-0
 Parameter: YTRAN <- "18.3734861"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.2588233"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.2588233-0
 Parameter: ZTRAN <- "-51.2588233"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.0810612"
 Parameter: YTRAN -> "18.3734861"
 Parameter: ZTRAN -> "-51.2588233"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -52.081061   18.373486  -51.258823
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903099339"
Evaluating: 0.903099339*360.0
 Parameter: XPHI <- "325.115762"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668362507"
Evaluating: 0.668362507*360.0
 Parameter: YPHI <- "240.610503"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14938304"
Evaluating: 0.14938304*360.0
 Parameter: ZPHI <- "53.7778944"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-52.0810612"
 Parameter: YPOS -> "18.3734861"
 Parameter: ZPOS -> "-51.2588233"
 Parameter: XPHI -> "325.115762"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.820309   -0.571920
    0.000000    0.571920    0.820309

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-52.0810612"
 Parameter: YPOS -> "18.3734861"
 Parameter: ZPOS -> "-51.2588233"
 Parameter: YPHI -> "240.610503"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.490744    0.000000    0.871304
    0.000000    1.000000    0.000000
   -0.871304    0.000000   -0.490744

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-52.0810612"
 Parameter: YPOS -> "18.3734861"
 Parameter: ZPOS -> "-51.2588233"
 Parameter: ZPHI -> "53.7778944"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.590917    0.806732    0.000000
   -0.806732    0.590917    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   53.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.081061 XMAX =  -52.081061 XAVE =  -52.081061
    YMIN =   18.373486 YMAX =   18.373486 YAVE =   18.373486
    ZMIN =  -51.258823 ZMAX =  -51.258823 ZAVE =  -51.258823
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-52.0810612"
Evaluating: -52.0810612+3.5
 Parameter: XMAX <- "-48.5810612"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.3734861"
Evaluating: 18.3734861+3.5
 Parameter: YMAX <- "21.8734861"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.2588233"
Evaluating: -51.2588233+3.5
 Parameter: ZMAX <- "-47.7588233"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-52.0810612"
Evaluating: -52.0810612-3.5
 Parameter: XMIN <- "-55.5810612"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.3734861"
Evaluating: 18.3734861-3.5
 Parameter: YMIN <- "14.8734861"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.2588233"
Evaluating: -51.2588233-3.5
 Parameter: ZMIN <- "-54.7588233"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.5810612"
 Parameter: XMIN -> "-55.5810612"
 Parameter: YMAX -> "21.8734861"
 Parameter: YMIN -> "14.8734861"
 Parameter: ZMAX -> "-47.7588233"
 Parameter: ZMIN -> "-54.7588233"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "79" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "79" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.243292062"
Evaluating: 128.065641*(0.243292062-0.5)
 Parameter: XPOS <- "-32.8754666"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.176320036"
Evaluating: 128.065641*(0.176320036-0.5)
 Parameter: YPOS <- "-41.4522821"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.763427931"
Evaluating: 108.613069*(0.763427931-0.5)+-2.187274
 Parameter: ZPOS <- "26.424442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.424442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.424442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.8754666"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.8754666-0
 Parameter: XTRAN <- "-32.8754666"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.4522821"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.4522821-0
 Parameter: YTRAN <- "-41.4522821"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.424442"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.424442-0
 Parameter: ZTRAN <- "26.424442"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.8754666"
 Parameter: YTRAN -> "-41.4522821"
 Parameter: ZTRAN -> "26.424442"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -32.875467  -41.452282   26.424442
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60047424"
Evaluating: 0.60047424*360.0
 Parameter: XPHI <- "216.170726"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.929275801"
Evaluating: 0.929275801*360.0
 Parameter: YPHI <- "334.539288"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.326295077"
Evaluating: 0.326295077*360.0
 Parameter: ZPHI <- "117.466228"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.8754666"
 Parameter: YPOS -> "-41.4522821"
 Parameter: ZPOS -> "26.424442"
 Parameter: XPHI -> "216.170726"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.807262   -0.590193
    0.000000    0.590193   -0.807262

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  143.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.8754666"
 Parameter: YPOS -> "-41.4522821"
 Parameter: ZPOS -> "26.424442"
 Parameter: YPHI -> "334.539288"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.902880    0.000000    0.429892
    0.000000    1.000000    0.000000
   -0.429892    0.000000    0.902880

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   25.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.8754666"
 Parameter: YPOS -> "-41.4522821"
 Parameter: ZPOS -> "26.424442"
 Parameter: ZPHI -> "117.466228"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.461226    0.887283    0.000000
   -0.887283   -0.461226    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  117.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.875467 XMAX =  -32.875467 XAVE =  -32.875467
    YMIN =  -41.452282 YMAX =  -41.452282 YAVE =  -41.452282
    ZMIN =   26.424442 ZMAX =   26.424442 ZAVE =   26.424442
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.8754666"
Evaluating: -32.8754666+3.5
 Parameter: XMAX <- "-29.3754666"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.4522821"
Evaluating: -41.4522821+3.5
 Parameter: YMAX <- "-37.9522821"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.424442"
Evaluating: 26.424442+3.5
 Parameter: ZMAX <- "29.924442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.8754666"
Evaluating: -32.8754666-3.5
 Parameter: XMIN <- "-36.3754666"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.4522821"
Evaluating: -41.4522821-3.5
 Parameter: YMIN <- "-44.9522821"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.424442"
Evaluating: 26.424442-3.5
 Parameter: ZMIN <- "22.924442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.3754666"
 Parameter: XMIN -> "-36.3754666"
 Parameter: YMAX -> "-37.9522821"
 Parameter: YMIN -> "-44.9522821"
 Parameter: ZMAX -> "29.924442"
 Parameter: ZMIN -> "22.924442"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "80" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "80" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.459528982"
Evaluating: 128.065641*(0.459528982-0.5)
 Parameter: XPOS <- "-5.18294686"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.751557196"
Evaluating: 128.065641*(0.751557196-0.5)
 Parameter: YPOS <- "32.2158336"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.4008246"
Evaluating: 108.613069*(0.4008246-0.5)+-2.187274
 Parameter: ZPOS <- "-12.9590186"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.9590186" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.9590186" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "80" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.537683397"
Evaluating: 128.065641*(0.537683397-0.5)
 Parameter: XPOS <- "4.82594839"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.56775863"
Evaluating: 128.065641*(0.56775863-0.5)
 Parameter: YPOS <- "8.67755238"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.935538687"
Evaluating: 108.613069*(0.935538687-0.5)+-2.187274
 Parameter: ZPOS <- "45.1179195"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.1179195" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.1179195" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.82594839"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.82594839-0
 Parameter: XTRAN <- "4.82594839"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.67755238"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.67755238-0
 Parameter: YTRAN <- "8.67755238"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.1179195"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.1179195-0
 Parameter: ZTRAN <- "45.1179195"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.82594839"
 Parameter: YTRAN -> "8.67755238"
 Parameter: ZTRAN -> "45.1179195"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     4.825948    8.677552   45.117919
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.608110283"
Evaluating: 0.608110283*360.0
 Parameter: XPHI <- "218.919702"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.829168007"
Evaluating: 0.829168007*360.0
 Parameter: YPHI <- "298.500483"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.711305647E-03"
Evaluating: 1.711305647E-03*360.0
 Parameter: ZPHI <- "0.616070033"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.82594839"
 Parameter: YPOS -> "8.67755238"
 Parameter: ZPOS -> "45.1179195"
 Parameter: XPHI -> "218.919702"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.778027   -0.628231
    0.000000    0.628231   -0.778027

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  141.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.82594839"
 Parameter: YPOS -> "8.67755238"
 Parameter: ZPOS -> "45.1179195"
 Parameter: YPHI -> "298.500483"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.477166    0.000000    0.878813
    0.000000    1.000000    0.000000
   -0.878813    0.000000    0.477166

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   61.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.82594839"
 Parameter: YPOS -> "8.67755238"
 Parameter: ZPOS -> "45.1179195"
 Parameter: ZPHI -> "0.616070033"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999942    0.010752    0.000000
   -0.010752    0.999942    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.825948 XMAX =    4.825948 XAVE =    4.825948
    YMIN =    8.677552 YMAX =    8.677552 YAVE =    8.677552
    ZMIN =   45.117919 ZMAX =   45.117919 ZAVE =   45.117919
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.82594839"
Evaluating: 4.82594839+3.5
 Parameter: XMAX <- "8.32594839"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.67755238"
Evaluating: 8.67755238+3.5
 Parameter: YMAX <- "12.1775524"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.1179195"
Evaluating: 45.1179195+3.5
 Parameter: ZMAX <- "48.6179195"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.82594839"
Evaluating: 4.82594839-3.5
 Parameter: XMIN <- "1.32594839"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.67755238"
Evaluating: 8.67755238-3.5
 Parameter: YMIN <- "5.17755238"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.1179195"
Evaluating: 45.1179195-3.5
 Parameter: ZMIN <- "41.6179195"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.32594839"
 Parameter: XMIN -> "1.32594839"
 Parameter: YMAX -> "12.1775524"
 Parameter: YMIN -> "5.17755238"
 Parameter: ZMAX -> "48.6179195"
 Parameter: ZMIN -> "41.6179195"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "81" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "81" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.257499133E-02"
Evaluating: 128.065641*(3.257499133E-02-0.5)
 Parameter: XPOS <- "-59.8610834"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.581300647"
Evaluating: 128.065641*(0.581300647-0.5)
 Parameter: YPOS <- "10.4118195"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.207661696"
Evaluating: 108.613069*(0.207661696-0.5)+-2.187274
 Parameter: ZPOS <- "-33.9390344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.9390344" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.8610834"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.8610834-0
 Parameter: XTRAN <- "-59.8610834"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.4118195"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.4118195-0
 Parameter: YTRAN <- "10.4118195"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.9390344"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.9390344-0
 Parameter: ZTRAN <- "-33.9390344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.8610834"
 Parameter: YTRAN -> "10.4118195"
 Parameter: ZTRAN -> "-33.9390344"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -59.861083   10.411820  -33.939034
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652265939"
Evaluating: 0.652265939*360.0
 Parameter: XPHI <- "234.815738"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764547377"
Evaluating: 0.764547377*360.0
 Parameter: YPHI <- "275.237056"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.271325239E-02"
Evaluating: 3.271325239E-02*360.0
 Parameter: ZPHI <- "11.7767709"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.8610834"
 Parameter: YPOS -> "10.4118195"
 Parameter: ZPOS -> "-33.9390344"
 Parameter: XPHI -> "234.815738"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.576208   -0.817303
    0.000000    0.817303   -0.576208

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.8610834"
 Parameter: YPOS -> "10.4118195"
 Parameter: ZPOS -> "-33.9390344"
 Parameter: YPHI -> "275.237056"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.091277    0.000000    0.995826
    0.000000    1.000000    0.000000
   -0.995826    0.000000    0.091277

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.8610834"
 Parameter: YPOS -> "10.4118195"
 Parameter: ZPOS -> "-33.9390344"
 Parameter: ZPHI -> "11.7767709"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.978950    0.204099    0.000000
   -0.204099    0.978950    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   11.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.861083 XMAX =  -59.861083 XAVE =  -59.861083
    YMIN =   10.411820 YMAX =   10.411820 YAVE =   10.411820
    ZMIN =  -33.939034 ZMAX =  -33.939034 ZAVE =  -33.939034
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.8610834"
Evaluating: -59.8610834+3.5
 Parameter: XMAX <- "-56.3610834"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.4118195"
Evaluating: 10.4118195+3.5
 Parameter: YMAX <- "13.9118195"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.9390344"
Evaluating: -33.9390344+3.5
 Parameter: ZMAX <- "-30.4390344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.8610834"
Evaluating: -59.8610834-3.5
 Parameter: XMIN <- "-63.3610834"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.4118195"
Evaluating: 10.4118195-3.5
 Parameter: YMIN <- "6.9118195"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.9390344"
Evaluating: -33.9390344-3.5
 Parameter: ZMIN <- "-37.4390344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.3610834"
 Parameter: XMIN -> "-63.3610834"
 Parameter: YMAX -> "13.9118195"
 Parameter: YMIN -> "6.9118195"
 Parameter: ZMAX -> "-30.4390344"
 Parameter: ZMIN -> "-37.4390344"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "82" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "82" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.339123051E-02"
Evaluating: 128.065641*(2.339123051E-02-0.5)
 Parameter: XPOS <- "-61.0372076"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.744949071"
Evaluating: 128.065641*(0.744949071-0.5)
 Parameter: YPOS <- "31.3695598"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.956361256"
Evaluating: 108.613069*(0.956361256-0.5)+-2.187274
 Parameter: ZPOS <- "47.3795226"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.3795226" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.3795226" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-61.0372076"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -61.0372076-0
 Parameter: XTRAN <- "-61.0372076"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.3695598"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.3695598-0
 Parameter: YTRAN <- "31.3695598"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.3795226"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.3795226-0
 Parameter: ZTRAN <- "47.3795226"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.0372076"
 Parameter: YTRAN -> "31.3695598"
 Parameter: ZTRAN -> "47.3795226"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -61.037208   31.369560   47.379523
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376915493"
Evaluating: 0.376915493*360.0
 Parameter: XPHI <- "135.689577"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.42268126E-02"
Evaluating: 2.42268126E-02*360.0
 Parameter: YPHI <- "8.72165254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.217165885"
Evaluating: 0.217165885*360.0
 Parameter: ZPHI <- "78.1797186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-61.0372076"
 Parameter: YPOS -> "31.3695598"
 Parameter: ZPOS -> "47.3795226"
 Parameter: XPHI -> "135.689577"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.715566    0.698545
    0.000000   -0.698545   -0.715566

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  135.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-61.0372076"
 Parameter: YPOS -> "31.3695598"
 Parameter: ZPOS -> "47.3795226"
 Parameter: YPHI -> "8.72165254"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.988437    0.000000   -0.151634
    0.000000    1.000000    0.000000
    0.151634    0.000000    0.988437

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    8.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-61.0372076"
 Parameter: YPOS -> "31.3695598"
 Parameter: ZPOS -> "47.3795226"
 Parameter: ZPHI -> "78.1797186"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.204843    0.978795    0.000000
   -0.978795    0.204843    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   78.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.037208 XMAX =  -61.037208 XAVE =  -61.037208
    YMIN =   31.369560 YMAX =   31.369560 YAVE =   31.369560
    ZMIN =   47.379523 ZMAX =   47.379523 ZAVE =   47.379523
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-61.0372076"
Evaluating: -61.0372076+3.5
 Parameter: XMAX <- "-57.5372076"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.3695598"
Evaluating: 31.3695598+3.5
 Parameter: YMAX <- "34.8695598"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.3795226"
Evaluating: 47.3795226+3.5
 Parameter: ZMAX <- "50.8795226"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-61.0372076"
Evaluating: -61.0372076-3.5
 Parameter: XMIN <- "-64.5372076"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.3695598"
Evaluating: 31.3695598-3.5
 Parameter: YMIN <- "27.8695598"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.3795226"
Evaluating: 47.3795226-3.5
 Parameter: ZMIN <- "43.8795226"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-57.5372076"
 Parameter: XMIN -> "-64.5372076"
 Parameter: YMAX -> "34.8695598"
 Parameter: YMIN -> "27.8695598"
 Parameter: ZMAX -> "50.8795226"
 Parameter: ZMIN -> "43.8795226"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60314 POS      POT      82       POT     -**** POS      POT      39       POT           3.7126
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "82" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.248185285"
Evaluating: 128.065641*(0.248185285-0.5)
 Parameter: XPOS <- "-32.2488129"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.858593099"
Evaluating: 128.065641*(0.858593099-0.5)
 Parameter: YPOS <- "45.9234551"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.660008952"
Evaluating: 108.613069*(0.660008952-0.5)+-2.187274
 Parameter: ZPOS <- "15.1917893"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.1917893" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.1917893" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.037208 XMAX =  -61.037208 XAVE =  -61.037208
    YMIN =   31.369560 YMAX =   31.369560 YAVE =   31.369560
    ZMIN =   47.379523 ZMAX =   47.379523 ZAVE =   47.379523
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.2488129"
 RDCMND substituted energy or value "?XAVE" to "-61.0372076"
Evaluating: -32.2488129--61.0372076
 Parameter: XTRAN <- "28.7883947"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.9234551"
 RDCMND substituted energy or value "?YAVE" to "31.3695598"
Evaluating: 45.9234551-31.3695598
 Parameter: YTRAN <- "14.5538953"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.1917893"
 RDCMND substituted energy or value "?ZAVE" to "47.3795226"
Evaluating: 15.1917893-47.3795226
 Parameter: ZTRAN <- "-32.1877333"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.7883947"
 Parameter: YTRAN -> "14.5538953"
 Parameter: ZTRAN -> "-32.1877333"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    28.788395   14.553895  -32.187733
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.606632215E-02"
Evaluating: 9.606632215E-02*360.0
 Parameter: XPHI <- "34.583876"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616958507"
Evaluating: 0.616958507*360.0
 Parameter: YPHI <- "222.105063"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729871371"
Evaluating: 0.729871371*360.0
 Parameter: ZPHI <- "262.753694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.2488129"
 Parameter: YPOS -> "45.9234551"
 Parameter: ZPOS -> "15.1917893"
 Parameter: XPHI -> "34.583876"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.823296    0.567612
    0.000000   -0.567612    0.823296

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.2488129"
 Parameter: YPOS -> "45.9234551"
 Parameter: ZPOS -> "15.1917893"
 Parameter: YPHI -> "222.105063"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.741917    0.000000    0.670492
    0.000000    1.000000    0.000000
   -0.670492    0.000000   -0.741917

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  137.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.2488129"
 Parameter: YPOS -> "45.9234551"
 Parameter: ZPOS -> "15.1917893"
 Parameter: ZPHI -> "262.753694"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.126135   -0.992013    0.000000
    0.992013   -0.126135    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.248813 XMAX =  -32.248813 XAVE =  -32.248813
    YMIN =   45.923455 YMAX =   45.923455 YAVE =   45.923455
    ZMIN =   15.191789 ZMAX =   15.191789 ZAVE =   15.191789
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.2488129"
Evaluating: -32.2488129+3.5
 Parameter: XMAX <- "-28.7488129"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.9234551"
Evaluating: 45.9234551+3.5
 Parameter: YMAX <- "49.4234551"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.1917893"
Evaluating: 15.1917893+3.5
 Parameter: ZMAX <- "18.6917893"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.2488129"
Evaluating: -32.2488129-3.5
 Parameter: XMIN <- "-35.7488129"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.9234551"
Evaluating: 45.9234551-3.5
 Parameter: YMIN <- "42.4234551"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.1917893"
Evaluating: 15.1917893-3.5
 Parameter: ZMIN <- "11.6917893"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.7488129"
 Parameter: XMIN -> "-35.7488129"
 Parameter: YMAX -> "49.4234551"
 Parameter: YMIN -> "42.4234551"
 Parameter: ZMAX -> "18.6917893"
 Parameter: ZMIN -> "11.6917893"
 SELRPN>     13 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      9 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      C12           3.9389
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      C11           3.7088
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      P             2.3030
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      O13           2.8576
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      O14           1.0913
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      O11           3.1612
60314 POS      POT      82       POT     -**** MEMB     DMPC     116      O12           3.5186
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "82" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.645965785"
Evaluating: 128.065641*(0.645965785-0.5)
 Parameter: XPOS <- "18.6932018"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.665199785"
Evaluating: 128.065641*(0.665199785-0.5)
 Parameter: YPOS <- "21.1564164"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.193224132E-02"
Evaluating: 108.613069*(4.193224132E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.9394191"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.9394191" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.248813 XMAX =  -32.248813 XAVE =  -32.248813
    YMIN =   45.923455 YMAX =   45.923455 YAVE =   45.923455
    ZMIN =   15.191789 ZMAX =   15.191789 ZAVE =   15.191789
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.6932018"
 RDCMND substituted energy or value "?XAVE" to "-32.2488129"
Evaluating: 18.6932018--32.2488129
 Parameter: XTRAN <- "50.9420147"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.1564164"
 RDCMND substituted energy or value "?YAVE" to "45.9234551"
Evaluating: 21.1564164-45.9234551
 Parameter: YTRAN <- "-24.7670387"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.9394191"
 RDCMND substituted energy or value "?ZAVE" to "15.1917893"
Evaluating: -51.9394191-15.1917893
 Parameter: ZTRAN <- "-67.1312084"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.9420147"
 Parameter: YTRAN -> "-24.7670387"
 Parameter: ZTRAN -> "-67.1312084"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    50.942015  -24.767039  -67.131208
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416984809"
Evaluating: 0.416984809*360.0
 Parameter: XPHI <- "150.114531"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501313705"
Evaluating: 0.501313705*360.0
 Parameter: YPHI <- "180.472934"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.997287526E-02"
Evaluating: 8.997287526E-02*360.0
 Parameter: ZPHI <- "32.3902351"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.6932018"
 Parameter: YPOS -> "21.1564164"
 Parameter: ZPOS -> "-51.9394191"
 Parameter: XPHI -> "150.114531"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.867023    0.498268
    0.000000   -0.498268   -0.867023

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.6932018"
 Parameter: YPOS -> "21.1564164"
 Parameter: ZPOS -> "-51.9394191"
 Parameter: YPHI -> "180.472934"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999966    0.000000    0.008254
    0.000000    1.000000    0.000000
   -0.008254    0.000000   -0.999966

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.6932018"
 Parameter: YPOS -> "21.1564164"
 Parameter: ZPOS -> "-51.9394191"
 Parameter: ZPHI -> "32.3902351"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.844419    0.535683    0.000000
   -0.535683    0.844419    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.693202 XMAX =   18.693202 XAVE =   18.693202
    YMIN =   21.156416 YMAX =   21.156416 YAVE =   21.156416
    ZMIN =  -51.939419 ZMAX =  -51.939419 ZAVE =  -51.939419
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.6932018"
Evaluating: 18.6932018+3.5
 Parameter: XMAX <- "22.1932018"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.1564164"
Evaluating: 21.1564164+3.5
 Parameter: YMAX <- "24.6564164"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.9394191"
Evaluating: -51.9394191+3.5
 Parameter: ZMAX <- "-48.4394191"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.6932018"
Evaluating: 18.6932018-3.5
 Parameter: XMIN <- "15.1932018"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.1564164"
Evaluating: 21.1564164-3.5
 Parameter: YMIN <- "17.6564164"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.9394191"
Evaluating: -51.9394191-3.5
 Parameter: ZMIN <- "-55.4394191"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.1932018"
 Parameter: XMIN -> "15.1932018"
 Parameter: YMAX -> "24.6564164"
 Parameter: YMIN -> "17.6564164"
 Parameter: ZMAX -> "-48.4394191"
 Parameter: ZMIN -> "-55.4394191"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "83" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "83" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.527386517"
Evaluating: 128.065641*(0.527386517-0.5)
 Parameter: XPOS <- "3.50727185"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.640502351"
Evaluating: 128.065641*(0.640502351-0.5)
 Parameter: YPOS <- "17.9935236"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "9.925728657E-02"
Evaluating: 108.613069*(9.925728657E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-45.71317"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.71317" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.50727185"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.50727185-0
 Parameter: XTRAN <- "3.50727185"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.9935236"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.9935236-0
 Parameter: YTRAN <- "17.9935236"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.71317"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.71317-0
 Parameter: ZTRAN <- "-45.71317"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.50727185"
 Parameter: YTRAN -> "17.9935236"
 Parameter: ZTRAN -> "-45.71317"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     3.507272   17.993524  -45.713170
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.147387838"
Evaluating: 0.147387838*360.0
 Parameter: XPHI <- "53.0596217"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643854603"
Evaluating: 0.643854603*360.0
 Parameter: YPHI <- "231.787657"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.41262797E-03"
Evaluating: 6.41262797E-03*360.0
 Parameter: ZPHI <- "2.30854607"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.50727185"
 Parameter: YPOS -> "17.9935236"
 Parameter: ZPOS -> "-45.71317"
 Parameter: XPHI -> "53.0596217"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.600984    0.799261
    0.000000   -0.799261    0.600984

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.50727185"
 Parameter: YPOS -> "17.9935236"
 Parameter: ZPOS -> "-45.71317"
 Parameter: YPHI -> "231.787657"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.618578    0.000000    0.785724
    0.000000    1.000000    0.000000
   -0.785724    0.000000   -0.618578

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  128.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.50727185"
 Parameter: YPOS -> "17.9935236"
 Parameter: ZPOS -> "-45.71317"
 Parameter: ZPHI -> "2.30854607"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999188    0.040281    0.000000
   -0.040281    0.999188    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.507272 XMAX =    3.507272 XAVE =    3.507272
    YMIN =   17.993524 YMAX =   17.993524 YAVE =   17.993524
    ZMIN =  -45.713170 ZMAX =  -45.713170 ZAVE =  -45.713170
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.50727185"
Evaluating: 3.50727185+3.5
 Parameter: XMAX <- "7.00727185"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.9935236"
Evaluating: 17.9935236+3.5
 Parameter: YMAX <- "21.4935236"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.71317"
Evaluating: -45.71317+3.5
 Parameter: ZMAX <- "-42.21317"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.50727185"
Evaluating: 3.50727185-3.5
 Parameter: XMIN <- "7.27185E-03"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.9935236"
Evaluating: 17.9935236-3.5
 Parameter: YMIN <- "14.4935236"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.71317"
Evaluating: -45.71317-3.5
 Parameter: ZMIN <- "-49.21317"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.00727185"
 Parameter: XMIN -> "7.27185E-03"
 Parameter: YMAX -> "21.4935236"
 Parameter: YMIN -> "14.4935236"
 Parameter: ZMAX -> "-42.21317"
 Parameter: ZMIN -> "-49.21317"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "84" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "84" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.73309345"
Evaluating: 128.065641*(0.73309345-0.5)
 Parameter: XPOS <- "29.8512621"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "1.401648603E-02"
Evaluating: 128.065641*(1.401648603E-02-0.5)
 Parameter: YPOS <- "-62.2377902"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.959226287"
Evaluating: 108.613069*(0.959226287-0.5)+-2.187274
 Parameter: ZPOS <- "47.6907024"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.6907024" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.6907024" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.8512621"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.8512621-0
 Parameter: XTRAN <- "29.8512621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-62.2377902"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -62.2377902-0
 Parameter: YTRAN <- "-62.2377902"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.6907024"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.6907024-0
 Parameter: ZTRAN <- "47.6907024"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.8512621"
 Parameter: YTRAN -> "-62.2377902"
 Parameter: ZTRAN -> "47.6907024"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    29.851262  -62.237790   47.690702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923961318"
Evaluating: 0.923961318*360.0
 Parameter: XPHI <- "332.626074"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397474345"
Evaluating: 0.397474345*360.0
 Parameter: YPHI <- "143.090764"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342683853"
Evaluating: 0.342683853*360.0
 Parameter: ZPHI <- "123.366187"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.8512621"
 Parameter: YPOS -> "-62.2377902"
 Parameter: ZPOS -> "47.6907024"
 Parameter: XPHI -> "332.626074"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.888025   -0.459796
    0.000000    0.459796    0.888025

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.8512621"
 Parameter: YPOS -> "-62.2377902"
 Parameter: ZPOS -> "47.6907024"
 Parameter: YPHI -> "143.090764"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.799588    0.000000   -0.600549
    0.000000    1.000000    0.000000
    0.600549    0.000000   -0.799588

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  143.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.8512621"
 Parameter: YPOS -> "-62.2377902"
 Parameter: ZPOS -> "47.6907024"
 Parameter: ZPHI -> "123.366187"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.549988    0.835173    0.000000
   -0.835173   -0.549988    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.851262 XMAX =   29.851262 XAVE =   29.851262
    YMIN =  -62.237790 YMAX =  -62.237790 YAVE =  -62.237790
    ZMIN =   47.690702 ZMAX =   47.690702 ZAVE =   47.690702
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.8512621"
Evaluating: 29.8512621+3.5
 Parameter: XMAX <- "33.3512621"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-62.2377902"
Evaluating: -62.2377902+3.5
 Parameter: YMAX <- "-58.7377902"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.6907024"
Evaluating: 47.6907024+3.5
 Parameter: ZMAX <- "51.1907024"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.8512621"
Evaluating: 29.8512621-3.5
 Parameter: XMIN <- "26.3512621"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-62.2377902"
Evaluating: -62.2377902-3.5
 Parameter: YMIN <- "-65.7377902"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.6907024"
Evaluating: 47.6907024-3.5
 Parameter: ZMIN <- "44.1907024"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.3512621"
 Parameter: XMIN -> "26.3512621"
 Parameter: YMAX -> "-58.7377902"
 Parameter: YMIN -> "-65.7377902"
 Parameter: ZMAX -> "51.1907024"
 Parameter: ZMIN -> "44.1907024"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "85" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "85" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.154243101"
Evaluating: 128.065641*(0.154243101-0.5)
 Parameter: XPOS <- "-44.2795789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.624805451"
Evaluating: 128.065641*(0.624805451-0.5)
 Parameter: YPOS <- "15.9832901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.725484732"
Evaluating: 108.613069*(0.725484732-0.5)+-2.187274
 Parameter: ZPOS <- "22.3033148"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.3033148" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.3033148" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.2795789"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.2795789-0
 Parameter: XTRAN <- "-44.2795789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.9832901"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.9832901-0
 Parameter: YTRAN <- "15.9832901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.3033148"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.3033148-0
 Parameter: ZTRAN <- "22.3033148"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2795789"
 Parameter: YTRAN -> "15.9832901"
 Parameter: ZTRAN -> "22.3033148"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -44.279579   15.983290   22.303315
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617302511"
Evaluating: 0.617302511*360.0
 Parameter: XPHI <- "222.228904"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930741612"
Evaluating: 0.930741612*360.0
 Parameter: YPHI <- "335.06698"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542121731"
Evaluating: 0.542121731*360.0
 Parameter: ZPHI <- "195.163823"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.2795789"
 Parameter: YPOS -> "15.9832901"
 Parameter: ZPOS -> "22.3033148"
 Parameter: XPHI -> "222.228904"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.740466   -0.672094
    0.000000    0.672094   -0.740466

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.2795789"
 Parameter: YPOS -> "15.9832901"
 Parameter: ZPOS -> "22.3033148"
 Parameter: YPHI -> "335.06698"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.906801    0.000000    0.421558
    0.000000    1.000000    0.000000
   -0.421558    0.000000    0.906801

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.2795789"
 Parameter: YPOS -> "15.9832901"
 Parameter: ZPOS -> "22.3033148"
 Parameter: ZPHI -> "195.163823"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.965182   -0.261580    0.000000
    0.261580   -0.965182    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.279579 XMAX =  -44.279579 XAVE =  -44.279579
    YMIN =   15.983290 YMAX =   15.983290 YAVE =   15.983290
    ZMIN =   22.303315 ZMAX =   22.303315 ZAVE =   22.303315
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.2795789"
Evaluating: -44.2795789+3.5
 Parameter: XMAX <- "-40.7795789"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.9832901"
Evaluating: 15.9832901+3.5
 Parameter: YMAX <- "19.4832901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.3033148"
Evaluating: 22.3033148+3.5
 Parameter: ZMAX <- "25.8033148"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.2795789"
Evaluating: -44.2795789-3.5
 Parameter: XMIN <- "-47.7795789"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.9832901"
Evaluating: 15.9832901-3.5
 Parameter: YMIN <- "12.4832901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.3033148"
Evaluating: 22.3033148-3.5
 Parameter: ZMIN <- "18.8033148"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.7795789"
 Parameter: XMIN -> "-47.7795789"
 Parameter: YMAX -> "19.4832901"
 Parameter: YMIN -> "12.4832901"
 Parameter: ZMAX -> "25.8033148"
 Parameter: ZMIN -> "18.8033148"
 SELRPN>      6 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      2 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "86" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "86" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.500362042E-02"
Evaluating: 128.065641*(3.500362042E-02-0.5)
 Parameter: XPOS <- "-59.5500594"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.430232301"
Evaluating: 128.065641*(0.430232301-0.5)
 Parameter: YPOS <- "-8.93484509"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.795128175"
Evaluating: 108.613069*(0.795128175-0.5)+-2.187274
 Parameter: ZPOS <- "29.8675028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.8675028" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.8675028" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.5500594"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.5500594-0
 Parameter: XTRAN <- "-59.5500594"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.93484509"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.93484509-0
 Parameter: YTRAN <- "-8.93484509"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.8675028"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.8675028-0
 Parameter: ZTRAN <- "29.8675028"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.5500594"
 Parameter: YTRAN -> "-8.93484509"
 Parameter: ZTRAN -> "29.8675028"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -59.550059   -8.934845   29.867503
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.48115529"
Evaluating: 0.48115529*360.0
 Parameter: XPHI <- "173.215904"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475060263"
Evaluating: 0.475060263*360.0
 Parameter: YPHI <- "171.021695"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.296973633"
Evaluating: 0.296973633*360.0
 Parameter: ZPHI <- "106.910508"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.5500594"
 Parameter: YPOS -> "-8.93484509"
 Parameter: ZPOS -> "29.8675028"
 Parameter: XPHI -> "173.215904"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992998    0.118128
    0.000000   -0.118128   -0.992998

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.5500594"
 Parameter: YPOS -> "-8.93484509"
 Parameter: ZPOS -> "29.8675028"
 Parameter: YPHI -> "171.021695"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.987748    0.000000   -0.156060
    0.000000    1.000000    0.000000
    0.156060    0.000000   -0.987748

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.5500594"
 Parameter: YPOS -> "-8.93484509"
 Parameter: ZPOS -> "29.8675028"
 Parameter: ZPHI -> "106.910508"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.290878    0.956760    0.000000
   -0.956760   -0.290878    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.550059 XMAX =  -59.550059 XAVE =  -59.550059
    YMIN =   -8.934845 YMAX =   -8.934845 YAVE =   -8.934845
    ZMIN =   29.867503 ZMAX =   29.867503 ZAVE =   29.867503
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.5500594"
Evaluating: -59.5500594+3.5
 Parameter: XMAX <- "-56.0500594"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.93484509"
Evaluating: -8.93484509+3.5
 Parameter: YMAX <- "-5.43484509"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.8675028"
Evaluating: 29.8675028+3.5
 Parameter: ZMAX <- "33.3675028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.5500594"
Evaluating: -59.5500594-3.5
 Parameter: XMIN <- "-63.0500594"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.93484509"
Evaluating: -8.93484509-3.5
 Parameter: YMIN <- "-12.4348451"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.8675028"
Evaluating: 29.8675028-3.5
 Parameter: ZMIN <- "26.3675028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.0500594"
 Parameter: XMIN -> "-63.0500594"
 Parameter: YMAX -> "-5.43484509"
 Parameter: YMIN -> "-12.4348451"
 Parameter: ZMAX -> "33.3675028"
 Parameter: ZMIN -> "26.3675028"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "87" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "87" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.538717706"
Evaluating: 128.065641*(0.538717706-0.5)
 Parameter: XPOS <- "4.95840784"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.298673427"
Evaluating: 128.065641*(0.298673427-0.5)
 Parameter: YPOS <- "-25.7830166"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.464004495"
Evaluating: 108.613069*(0.464004495-0.5)+-2.187274
 Parameter: ZPOS <- "-6.09685627"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.09685627" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.09685627" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "87" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.282438916"
Evaluating: 128.065641*(0.282438916-0.5)
 Parameter: XPOS <- "-27.8620997"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.944532675"
Evaluating: 128.065641*(0.944532675-0.5)
 Parameter: YPOS <- "56.929362"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.377996597"
Evaluating: 108.613069*(0.377996597-0.5)+-2.187274
 Parameter: ZPOS <- "-15.438438"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.438438" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.8620997"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.8620997-0
 Parameter: XTRAN <- "-27.8620997"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.929362"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 56.929362-0
 Parameter: YTRAN <- "56.929362"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.438438"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.438438-0
 Parameter: ZTRAN <- "-15.438438"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.8620997"
 Parameter: YTRAN -> "56.929362"
 Parameter: ZTRAN -> "-15.438438"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -27.862100   56.929362  -15.438438
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678898652"
Evaluating: 0.678898652*360.0
 Parameter: XPHI <- "244.403515"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223109152"
Evaluating: 0.223109152*360.0
 Parameter: YPHI <- "80.3192947"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.282383544"
Evaluating: 0.282383544*360.0
 Parameter: ZPHI <- "101.658076"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.8620997"
 Parameter: YPOS -> "56.929362"
 Parameter: ZPOS -> "-15.438438"
 Parameter: XPHI -> "244.403515"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.432030   -0.901859
    0.000000    0.901859   -0.432030

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.8620997"
 Parameter: YPOS -> "56.929362"
 Parameter: ZPOS -> "-15.438438"
 Parameter: YPHI -> "80.3192947"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.168157    0.000000   -0.985760
    0.000000    1.000000    0.000000
    0.985760    0.000000    0.168157

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.8620997"
 Parameter: YPOS -> "56.929362"
 Parameter: ZPOS -> "-15.438438"
 Parameter: ZPHI -> "101.658076"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.202071    0.979371    0.000000
   -0.979371   -0.202071    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.862100 XMAX =  -27.862100 XAVE =  -27.862100
    YMIN =   56.929362 YMAX =   56.929362 YAVE =   56.929362
    ZMIN =  -15.438438 ZMAX =  -15.438438 ZAVE =  -15.438438
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.8620997"
Evaluating: -27.8620997+3.5
 Parameter: XMAX <- "-24.3620997"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.929362"
Evaluating: 56.929362+3.5
 Parameter: YMAX <- "60.429362"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.438438"
Evaluating: -15.438438+3.5
 Parameter: ZMAX <- "-11.938438"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.8620997"
Evaluating: -27.8620997-3.5
 Parameter: XMIN <- "-31.3620997"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.929362"
Evaluating: 56.929362-3.5
 Parameter: YMIN <- "53.429362"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.438438"
Evaluating: -15.438438-3.5
 Parameter: ZMIN <- "-18.938438"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.3620997"
 Parameter: XMIN -> "-31.3620997"
 Parameter: YMAX -> "60.429362"
 Parameter: YMIN -> "53.429362"
 Parameter: ZMAX -> "-11.938438"
 Parameter: ZMIN -> "-18.938438"
 SELRPN>     27 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     15 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60319 POS      POT      87       POT     -**** MEMB     DMPC     339      O22           3.5599
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      N             3.6286
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      C14           3.6999
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      C12           2.3802
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      C11           1.5310
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      P             3.4513
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      O13           3.3977
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      O11           3.3673
60319 POS      POT      87       POT     -**** MEMB     DMPC     353      O12           2.7976
60319 POS      POT      87       POT     -**** MEMB     DMPC     359      C3            3.5676
60319 POS      POT      87       POT     -**** MEMB     DMPC     359      O31           3.7469
60319 POS      POT      87       POT     -**** MEMB     DMPC     359      C31           3.2811
60319 POS      POT      87       POT     -**** MEMB     DMPC     359      O32           2.4668
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "87" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.671126642"
Evaluating: 128.065641*(0.671126642-0.5)
 Parameter: XPOS <- "21.9154431"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.28802732"
Evaluating: 128.065641*(0.28802732-0.5)
 Parameter: YPOS <- "-27.1464171"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.489892634"
Evaluating: 108.613069*(0.489892634-0.5)+-2.187274
 Parameter: ZPOS <- "-3.28506604"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.28506604" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.28506604" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "87" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.202403672"
Evaluating: 128.065641*(0.202403672-0.5)
 Parameter: XPOS <- "-38.1118645"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.847108389"
Evaluating: 128.065641*(0.847108389-0.5)
 Parameter: YPOS <- "44.4526583"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.16774812"
Evaluating: 108.613069*(0.16774812-0.5)+-2.187274
 Parameter: ZPOS <- "-38.2741704"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.2741704" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.862100 XMAX =  -27.862100 XAVE =  -27.862100
    YMIN =   56.929362 YMAX =   56.929362 YAVE =   56.929362
    ZMIN =  -15.438438 ZMAX =  -15.438438 ZAVE =  -15.438438
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.1118645"
 RDCMND substituted energy or value "?XAVE" to "-27.8620997"
Evaluating: -38.1118645--27.8620997
 Parameter: XTRAN <- "-10.2497648"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.4526583"
 RDCMND substituted energy or value "?YAVE" to "56.929362"
Evaluating: 44.4526583-56.929362
 Parameter: YTRAN <- "-12.4767037"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.2741704"
 RDCMND substituted energy or value "?ZAVE" to "-15.438438"
Evaluating: -38.2741704--15.438438
 Parameter: ZTRAN <- "-22.8357324"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.2497648"
 Parameter: YTRAN -> "-12.4767037"
 Parameter: ZTRAN -> "-22.8357324"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -10.249765  -12.476704  -22.835732
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197619066"
Evaluating: 0.197619066*360.0
 Parameter: XPHI <- "71.1428638"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453318386"
Evaluating: 0.453318386*360.0
 Parameter: YPHI <- "163.194619"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.282743724"
Evaluating: 0.282743724*360.0
 Parameter: ZPHI <- "101.787741"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.1118645"
 Parameter: YPOS -> "44.4526583"
 Parameter: ZPOS -> "-38.2741704"
 Parameter: XPHI -> "71.1428638"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.323210    0.946327
    0.000000   -0.946327    0.323210

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.1118645"
 Parameter: YPOS -> "44.4526583"
 Parameter: ZPOS -> "-38.2741704"
 Parameter: YPHI -> "163.194619"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.957292    0.000000   -0.289122
    0.000000    1.000000    0.000000
    0.289122    0.000000   -0.957292

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.1118645"
 Parameter: YPOS -> "44.4526583"
 Parameter: ZPOS -> "-38.2741704"
 Parameter: ZPHI -> "101.787741"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.204287    0.978911    0.000000
   -0.978911   -0.204287    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.111865 XMAX =  -38.111865 XAVE =  -38.111865
    YMIN =   44.452658 YMAX =   44.452658 YAVE =   44.452658
    ZMIN =  -38.274170 ZMAX =  -38.274170 ZAVE =  -38.274170
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.1118645"
Evaluating: -38.1118645+3.5
 Parameter: XMAX <- "-34.6118645"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.4526583"
Evaluating: 44.4526583+3.5
 Parameter: YMAX <- "47.9526583"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.2741704"
Evaluating: -38.2741704+3.5
 Parameter: ZMAX <- "-34.7741704"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.1118645"
Evaluating: -38.1118645-3.5
 Parameter: XMIN <- "-41.6118645"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.4526583"
Evaluating: 44.4526583-3.5
 Parameter: YMIN <- "40.9526583"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.2741704"
Evaluating: -38.2741704-3.5
 Parameter: ZMIN <- "-41.7741704"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.6118645"
 Parameter: XMIN -> "-41.6118645"
 Parameter: YMAX -> "47.9526583"
 Parameter: YMIN -> "40.9526583"
 Parameter: ZMAX -> "-34.7741704"
 Parameter: ZMIN -> "-41.7741704"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "88" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "88" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.672822672"
Evaluating: 128.065641*(0.672822672-0.5)
 Parameter: XPOS <- "22.1326463"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.290888779"
Evaluating: 128.065641*(0.290888779-0.5)
 Parameter: YPOS <- "-26.7799626"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.166203292"
Evaluating: 108.613069*(0.166203292-0.5)+-2.187274
 Parameter: ZPOS <- "-38.4419589"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.4419589" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.1326463"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.1326463-0
 Parameter: XTRAN <- "22.1326463"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.7799626"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.7799626-0
 Parameter: YTRAN <- "-26.7799626"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.4419589"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.4419589-0
 Parameter: ZTRAN <- "-38.4419589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.1326463"
 Parameter: YTRAN -> "-26.7799626"
 Parameter: ZTRAN -> "-38.4419589"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    22.132646  -26.779963  -38.441959
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919768269"
Evaluating: 0.919768269*360.0
 Parameter: XPHI <- "331.116577"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129765405"
Evaluating: 0.129765405*360.0
 Parameter: YPHI <- "46.7155458"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805863835"
Evaluating: 0.805863835*360.0
 Parameter: ZPHI <- "290.110981"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.1326463"
 Parameter: YPOS -> "-26.7799626"
 Parameter: ZPOS -> "-38.4419589"
 Parameter: XPHI -> "331.116577"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.875604   -0.483029
    0.000000    0.483029    0.875604

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.1326463"
 Parameter: YPOS -> "-26.7799626"
 Parameter: ZPOS -> "-38.4419589"
 Parameter: YPHI -> "46.7155458"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.685621    0.000000   -0.727959
    0.000000    1.000000    0.000000
    0.727959    0.000000    0.685621

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   46.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.1326463"
 Parameter: YPOS -> "-26.7799626"
 Parameter: ZPOS -> "-38.4419589"
 Parameter: ZPHI -> "290.110981"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.343840   -0.939028    0.000000
    0.939028    0.343840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.132646 XMAX =   22.132646 XAVE =   22.132646
    YMIN =  -26.779963 YMAX =  -26.779963 YAVE =  -26.779963
    ZMIN =  -38.441959 ZMAX =  -38.441959 ZAVE =  -38.441959
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.1326463"
Evaluating: 22.1326463+3.5
 Parameter: XMAX <- "25.6326463"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.7799626"
Evaluating: -26.7799626+3.5
 Parameter: YMAX <- "-23.2799626"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.4419589"
Evaluating: -38.4419589+3.5
 Parameter: ZMAX <- "-34.9419589"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.1326463"
Evaluating: 22.1326463-3.5
 Parameter: XMIN <- "18.6326463"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.7799626"
Evaluating: -26.7799626-3.5
 Parameter: YMIN <- "-30.2799626"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.4419589"
Evaluating: -38.4419589-3.5
 Parameter: ZMIN <- "-41.9419589"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.6326463"
 Parameter: XMIN -> "18.6326463"
 Parameter: YMAX -> "-23.2799626"
 Parameter: YMIN -> "-30.2799626"
 Parameter: ZMAX -> "-34.9419589"
 Parameter: ZMIN -> "-41.9419589"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "89" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "89" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.404964687E-02"
Evaluating: 128.065641*(5.404964687E-02-0.5)
 Parameter: XPOS <- "-57.1109178"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.718363409"
Evaluating: 128.065641*(0.718363409-0.5)
 Parameter: YPOS <- "27.9648499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.936672612"
Evaluating: 108.613069*(0.936672612-0.5)+-2.187274
 Parameter: ZPOS <- "45.2410785"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.2410785" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.2410785" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.1109178"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.1109178-0
 Parameter: XTRAN <- "-57.1109178"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.9648499"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.9648499-0
 Parameter: YTRAN <- "27.9648499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.2410785"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.2410785-0
 Parameter: ZTRAN <- "45.2410785"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.1109178"
 Parameter: YTRAN -> "27.9648499"
 Parameter: ZTRAN -> "45.2410785"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -57.110918   27.964850   45.241079
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.563765021"
Evaluating: 0.563765021*360.0
 Parameter: XPHI <- "202.955408"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926894009"
Evaluating: 0.926894009*360.0
 Parameter: YPHI <- "333.681843"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.761945433E-02"
Evaluating: 5.761945433E-02*360.0
 Parameter: ZPHI <- "20.7430036"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.1109178"
 Parameter: YPOS -> "27.9648499"
 Parameter: ZPOS -> "45.2410785"
 Parameter: XPHI -> "202.955408"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.920809   -0.390015
    0.000000    0.390015   -0.920809

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.1109178"
 Parameter: YPOS -> "27.9648499"
 Parameter: ZPOS -> "45.2410785"
 Parameter: YPHI -> "333.681843"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.896346    0.000000    0.443355
    0.000000    1.000000    0.000000
   -0.443355    0.000000    0.896346

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.1109178"
 Parameter: YPOS -> "27.9648499"
 Parameter: ZPOS -> "45.2410785"
 Parameter: ZPHI -> "20.7430036"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.935178    0.354177    0.000000
   -0.354177    0.935178    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.110918 XMAX =  -57.110918 XAVE =  -57.110918
    YMIN =   27.964850 YMAX =   27.964850 YAVE =   27.964850
    ZMIN =   45.241079 ZMAX =   45.241079 ZAVE =   45.241079
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.1109178"
Evaluating: -57.1109178+3.5
 Parameter: XMAX <- "-53.6109178"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.9648499"
Evaluating: 27.9648499+3.5
 Parameter: YMAX <- "31.4648499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.2410785"
Evaluating: 45.2410785+3.5
 Parameter: ZMAX <- "48.7410785"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.1109178"
Evaluating: -57.1109178-3.5
 Parameter: XMIN <- "-60.6109178"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.9648499"
Evaluating: 27.9648499-3.5
 Parameter: YMIN <- "24.4648499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.2410785"
Evaluating: 45.2410785-3.5
 Parameter: ZMIN <- "41.7410785"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.6109178"
 Parameter: XMIN -> "-60.6109178"
 Parameter: YMAX -> "31.4648499"
 Parameter: YMIN -> "24.4648499"
 Parameter: ZMAX -> "48.7410785"
 Parameter: ZMIN -> "41.7410785"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60321 POS      POT      89       POT     -**** POS      POT      39       POT           2.6109
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "89" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.548795841"
Evaluating: 128.065641*(0.548795841-0.5)
 Parameter: XPOS <- "6.24907066"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.661102983E-02"
Evaluating: 128.065641*(2.661102983E-02-0.5)
 Parameter: YPOS <- "-60.6248619"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.205538111E-02"
Evaluating: 108.613069*(1.205538111E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-55.1844366"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.1844366" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.110918 XMAX =  -57.110918 XAVE =  -57.110918
    YMIN =   27.964850 YMAX =   27.964850 YAVE =   27.964850
    ZMIN =   45.241079 ZMAX =   45.241079 ZAVE =   45.241079
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.24907066"
 RDCMND substituted energy or value "?XAVE" to "-57.1109178"
Evaluating: 6.24907066--57.1109178
 Parameter: XTRAN <- "63.3599885"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-60.6248619"
 RDCMND substituted energy or value "?YAVE" to "27.9648499"
Evaluating: -60.6248619-27.9648499
 Parameter: YTRAN <- "-88.5897118"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.1844366"
 RDCMND substituted energy or value "?ZAVE" to "45.2410785"
Evaluating: -55.1844366-45.2410785
 Parameter: ZTRAN <- "-100.425515"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "63.3599885"
 Parameter: YTRAN -> "-88.5897118"
 Parameter: ZTRAN -> "-100.425515"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    63.359989  -88.589712 -100.425515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.914083275"
Evaluating: 0.914083275*360.0
 Parameter: XPHI <- "329.069979"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244341232"
Evaluating: 0.244341232*360.0
 Parameter: YPHI <- "87.9628435"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.659328026E-02"
Evaluating: 9.659328026E-02*360.0
 Parameter: ZPHI <- "34.7735809"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.24907066"
 Parameter: YPOS -> "-60.6248619"
 Parameter: ZPOS -> "-55.1844366"
 Parameter: XPHI -> "329.069979"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.857796   -0.513991
    0.000000    0.513991    0.857796

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   30.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.24907066"
 Parameter: YPOS -> "-60.6248619"
 Parameter: ZPOS -> "-55.1844366"
 Parameter: YPHI -> "87.9628435"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.035548    0.000000   -0.999368
    0.000000    1.000000    0.000000
    0.999368    0.000000    0.035548

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.24907066"
 Parameter: YPOS -> "-60.6248619"
 Parameter: ZPOS -> "-55.1844366"
 Parameter: ZPHI -> "34.7735809"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.821412    0.570335    0.000000
   -0.570335    0.821412    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.249071 XMAX =    6.249071 XAVE =    6.249071
    YMIN =  -60.624862 YMAX =  -60.624862 YAVE =  -60.624862
    ZMIN =  -55.184437 ZMAX =  -55.184437 ZAVE =  -55.184437
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.24907056"
Evaluating: 6.24907056+3.5
 Parameter: XMAX <- "9.74907056"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-60.6248619"
Evaluating: -60.6248619+3.5
 Parameter: YMAX <- "-57.1248619"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.1844366"
Evaluating: -55.1844366+3.5
 Parameter: ZMAX <- "-51.6844366"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.24907056"
Evaluating: 6.24907056-3.5
 Parameter: XMIN <- "2.74907056"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-60.6248619"
Evaluating: -60.6248619-3.5
 Parameter: YMIN <- "-64.1248619"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.1844366"
Evaluating: -55.1844366-3.5
 Parameter: ZMIN <- "-58.6844366"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.74907056"
 Parameter: XMIN -> "2.74907056"
 Parameter: YMAX -> "-57.1248619"
 Parameter: YMIN -> "-64.1248619"
 Parameter: ZMAX -> "-51.6844366"
 Parameter: ZMIN -> "-58.6844366"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "90" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "90" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.43103164"
Evaluating: 128.065641*(0.43103164-0.5)
 Parameter: XPOS <- "-8.83247723"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.743665435E-02"
Evaluating: 128.065641*(5.743665435E-02-0.5)
 Parameter: YPOS <- "-56.6771585"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.190934278"
Evaluating: 108.613069*(0.190934278-0.5)+-2.187274
 Parameter: ZPOS <- "-35.7558506"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.7558506" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.83247723"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.83247723-0
 Parameter: XTRAN <- "-8.83247723"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.6771585"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.6771585-0
 Parameter: YTRAN <- "-56.6771585"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.7558506"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.7558506-0
 Parameter: ZTRAN <- "-35.7558506"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.83247723"
 Parameter: YTRAN -> "-56.6771585"
 Parameter: ZTRAN -> "-35.7558506"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -8.832477  -56.677158  -35.755851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547643816"
Evaluating: 0.547643816*360.0
 Parameter: XPHI <- "197.151774"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.089760679E-03"
Evaluating: 7.089760679E-03*360.0
 Parameter: YPHI <- "2.55231384"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771621281"
Evaluating: 0.771621281*360.0
 Parameter: ZPHI <- "277.783661"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.83247723"
 Parameter: YPOS -> "-56.6771585"
 Parameter: ZPOS -> "-35.7558506"
 Parameter: XPHI -> "197.151774"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.955527   -0.294904
    0.000000    0.294904   -0.955527

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.83247723"
 Parameter: YPOS -> "-56.6771585"
 Parameter: ZPOS -> "-35.7558506"
 Parameter: YPHI -> "2.55231384"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999008    0.000000   -0.044532
    0.000000    1.000000    0.000000
    0.044532    0.000000    0.999008

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.83247723"
 Parameter: YPOS -> "-56.6771585"
 Parameter: ZPOS -> "-35.7558506"
 Parameter: ZPHI -> "277.783661"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.135433   -0.990787    0.000000
    0.990787    0.135433    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.832477 XMAX =   -8.832477 XAVE =   -8.832477
    YMIN =  -56.677158 YMAX =  -56.677158 YAVE =  -56.677158
    ZMIN =  -35.755851 ZMAX =  -35.755851 ZAVE =  -35.755851
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.83247723"
Evaluating: -8.83247723+3.5
 Parameter: XMAX <- "-5.33247723"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.6771585"
Evaluating: -56.6771585+3.5
 Parameter: YMAX <- "-53.1771585"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.7558506"
Evaluating: -35.7558506+3.5
 Parameter: ZMAX <- "-32.2558506"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.83247723"
Evaluating: -8.83247723-3.5
 Parameter: XMIN <- "-12.3324772"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.6771585"
Evaluating: -56.6771585-3.5
 Parameter: YMIN <- "-60.1771585"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.7558506"
Evaluating: -35.7558506-3.5
 Parameter: ZMIN <- "-39.2558506"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.33247723"
 Parameter: XMIN -> "-12.3324772"
 Parameter: YMAX -> "-53.1771585"
 Parameter: YMIN -> "-60.1771585"
 Parameter: ZMAX -> "-32.2558506"
 Parameter: ZMIN -> "-39.2558506"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "91" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "91" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.917896543"
Evaluating: 128.065641*(0.917896543-0.5)
 Parameter: XPOS <- "53.5181887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.208823734"
Evaluating: 128.065641*(0.208823734-0.5)
 Parameter: YPOS <- "-37.2896751"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.274887314"
Evaluating: 108.613069*(0.274887314-0.5)+-2.187274
 Parameter: ZPOS <- "-26.6374537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.6374537" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.5181887"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.5181887-0
 Parameter: XTRAN <- "53.5181887"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.2896751"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.2896751-0
 Parameter: YTRAN <- "-37.2896751"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.6374537"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.6374537-0
 Parameter: ZTRAN <- "-26.6374537"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.5181887"
 Parameter: YTRAN -> "-37.2896751"
 Parameter: ZTRAN -> "-26.6374537"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    53.518189  -37.289675  -26.637454
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954146863"
Evaluating: 0.954146863*360.0
 Parameter: XPHI <- "343.492871"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.224285909"
Evaluating: 0.224285909*360.0
 Parameter: YPHI <- "80.7429272"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.00284724E-02"
Evaluating: 1.00284724E-02*360.0
 Parameter: ZPHI <- "3.61025006"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.5181887"
 Parameter: YPOS -> "-37.2896751"
 Parameter: ZPOS -> "-26.6374537"
 Parameter: XPHI -> "343.492871"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.958784   -0.284135
    0.000000    0.284135    0.958784

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.5181887"
 Parameter: YPOS -> "-37.2896751"
 Parameter: ZPOS -> "-26.6374537"
 Parameter: YPHI -> "80.7429272"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.160864    0.000000   -0.986977
    0.000000    1.000000    0.000000
    0.986977    0.000000    0.160864

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.5181887"
 Parameter: YPOS -> "-37.2896751"
 Parameter: ZPOS -> "-26.6374537"
 Parameter: ZPHI -> "3.61025006"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.998015    0.062969    0.000000
   -0.062969    0.998015    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.518189 XMAX =   53.518189 XAVE =   53.518189
    YMIN =  -37.289675 YMAX =  -37.289675 YAVE =  -37.289675
    ZMIN =  -26.637454 ZMAX =  -26.637454 ZAVE =  -26.637454
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.5181887"
Evaluating: 53.5181887+3.5
 Parameter: XMAX <- "57.0181887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.2896751"
Evaluating: -37.2896751+3.5
 Parameter: YMAX <- "-33.7896751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.6374537"
Evaluating: -26.6374537+3.5
 Parameter: ZMAX <- "-23.1374537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.5181887"
Evaluating: 53.5181887-3.5
 Parameter: XMIN <- "50.0181887"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.2896751"
Evaluating: -37.2896751-3.5
 Parameter: YMIN <- "-40.7896751"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.6374537"
Evaluating: -26.6374537-3.5
 Parameter: ZMIN <- "-30.1374537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.0181887"
 Parameter: XMIN -> "50.0181887"
 Parameter: YMAX -> "-33.7896751"
 Parameter: YMIN -> "-40.7896751"
 Parameter: ZMAX -> "-23.1374537"
 Parameter: ZMIN -> "-30.1374537"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "92" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "92" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.477542347"
Evaluating: 128.065641*(0.477542347-0.5)
 Parameter: XPOS <- "-2.87605373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.23868598"
Evaluating: 128.065641*(0.23868598-0.5)
 Parameter: YPOS <- "-33.4653475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.191258065E-02"
Evaluating: 108.613069*(1.191258065E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-55.1999466"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.1999466" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.87605373"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.87605373-0
 Parameter: XTRAN <- "-2.87605373"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.4653475"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.4653475-0
 Parameter: YTRAN <- "-33.4653475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.1999466"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.1999466-0
 Parameter: ZTRAN <- "-55.1999466"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.87605373"
 Parameter: YTRAN -> "-33.4653475"
 Parameter: ZTRAN -> "-55.1999466"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -2.876054  -33.465348  -55.199947
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.648952804"
Evaluating: 0.648952804*360.0
 Parameter: XPHI <- "233.623009"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307130188"
Evaluating: 0.307130188*360.0
 Parameter: YPHI <- "110.566868"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.823193851"
Evaluating: 0.823193851*360.0
 Parameter: ZPHI <- "296.349786"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.87605373"
 Parameter: YPOS -> "-33.4653475"
 Parameter: ZPOS -> "-55.1999466"
 Parameter: XPHI -> "233.623009"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.593096   -0.805132
    0.000000    0.805132   -0.593096

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.87605373"
 Parameter: YPOS -> "-33.4653475"
 Parameter: ZPOS -> "-55.1999466"
 Parameter: YPHI -> "110.566868"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.351300    0.000000   -0.936263
    0.000000    1.000000    0.000000
    0.936263    0.000000   -0.351300

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.87605373"
 Parameter: YPOS -> "-33.4653475"
 Parameter: ZPOS -> "-55.1999466"
 Parameter: ZPHI -> "296.349786"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.443850   -0.896101    0.000000
    0.896101    0.443850    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.876054 XMAX =   -2.876054 XAVE =   -2.876054
    YMIN =  -33.465348 YMAX =  -33.465348 YAVE =  -33.465348
    ZMIN =  -55.199947 ZMAX =  -55.199947 ZAVE =  -55.199947
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.87605373"
Evaluating: -2.87605373+3.5
 Parameter: XMAX <- "0.62394627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.4653475"
Evaluating: -33.4653475+3.5
 Parameter: YMAX <- "-29.9653475"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.1999466"
Evaluating: -55.1999466+3.5
 Parameter: ZMAX <- "-51.6999466"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.87605373"
Evaluating: -2.87605373-3.5
 Parameter: XMIN <- "-6.37605373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.4653475"
Evaluating: -33.4653475-3.5
 Parameter: YMIN <- "-36.9653475"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.1999466"
Evaluating: -55.1999466-3.5
 Parameter: ZMIN <- "-58.6999466"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.62394627"
 Parameter: XMIN -> "-6.37605373"
 Parameter: YMAX -> "-29.9653475"
 Parameter: YMIN -> "-36.9653475"
 Parameter: ZMAX -> "-51.6999466"
 Parameter: ZMIN -> "-58.6999466"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "93" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "93" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.202147242"
Evaluating: 128.065641*(0.202147242-0.5)
 Parameter: XPOS <- "-38.1447044"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.135013858"
Evaluating: 128.065641*(0.135013858-0.5)
 Parameter: YPOS <- "-46.7421842"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.331611798"
Evaluating: 108.613069*(0.331611798-0.5)+-2.187274
 Parameter: ZPOS <- "-20.4764334"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.4764334" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.1447044"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.1447044-0
 Parameter: XTRAN <- "-38.1447044"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.7421842"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.7421842-0
 Parameter: YTRAN <- "-46.7421842"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.4764334"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.4764334-0
 Parameter: ZTRAN <- "-20.4764334"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.1447044"
 Parameter: YTRAN -> "-46.7421842"
 Parameter: ZTRAN -> "-20.4764334"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -38.144704  -46.742184  -20.476433
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620556034"
Evaluating: 0.620556034*360.0
 Parameter: XPHI <- "223.400172"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166303417"
Evaluating: 0.166303417*360.0
 Parameter: YPHI <- "59.8692301"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.288167544E-02"
Evaluating: 7.288167544E-02*360.0
 Parameter: ZPHI <- "26.2374032"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.1447044"
 Parameter: YPOS -> "-46.7421842"
 Parameter: ZPOS -> "-20.4764334"
 Parameter: XPHI -> "223.400172"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.726573   -0.687090
    0.000000    0.687090   -0.726573

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.1447044"
 Parameter: YPOS -> "-46.7421842"
 Parameter: ZPOS -> "-20.4764334"
 Parameter: YPHI -> "59.8692301"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.501975    0.000000   -0.864882
    0.000000    1.000000    0.000000
    0.864882    0.000000    0.501975

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.1447044"
 Parameter: YPOS -> "-46.7421842"
 Parameter: ZPOS -> "-20.4764334"
 Parameter: ZPHI -> "26.2374032"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.896970    0.442091    0.000000
   -0.442091    0.896970    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.144704 XMAX =  -38.144704 XAVE =  -38.144704
    YMIN =  -46.742184 YMAX =  -46.742184 YAVE =  -46.742184
    ZMIN =  -20.476433 ZMAX =  -20.476433 ZAVE =  -20.476433
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.1447044"
Evaluating: -38.1447044+3.5
 Parameter: XMAX <- "-34.6447044"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.7421842"
Evaluating: -46.7421842+3.5
 Parameter: YMAX <- "-43.2421842"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.4764334"
Evaluating: -20.4764334+3.5
 Parameter: ZMAX <- "-16.9764334"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.1447044"
Evaluating: -38.1447044-3.5
 Parameter: XMIN <- "-41.6447044"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.7421842"
Evaluating: -46.7421842-3.5
 Parameter: YMIN <- "-50.2421842"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.4764334"
Evaluating: -20.4764334-3.5
 Parameter: ZMIN <- "-23.9764334"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.6447044"
 Parameter: XMIN -> "-41.6447044"
 Parameter: YMAX -> "-43.2421842"
 Parameter: YMIN -> "-50.2421842"
 Parameter: ZMAX -> "-16.9764334"
 Parameter: ZMIN -> "-23.9764334"
 SELRPN>     16 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      5 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60325 POS      POT      93       POT     -**** MEMB     DMPC     314      C14           3.8735
60325 POS      POT      93       POT     -**** MEMB     DMPC     338      C13           3.7264
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "93" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.226092275"
Evaluating: 128.065641*(0.226092275-0.5)
 Parameter: XPOS <- "-35.0781684"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.903765318"
Evaluating: 128.065641*(0.903765318-0.5)
 Parameter: YPOS <- "51.7084643"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.122626746"
Evaluating: 108.613069*(0.122626746-0.5)+-2.187274
 Parameter: ZPOS <- "-43.1749413"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.1749413" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.144704 XMAX =  -38.144704 XAVE =  -38.144704
    YMIN =  -46.742184 YMAX =  -46.742184 YAVE =  -46.742184
    ZMIN =  -20.476433 ZMAX =  -20.476433 ZAVE =  -20.476433
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.0781684"
 RDCMND substituted energy or value "?XAVE" to "-38.1447044"
Evaluating: -35.0781684--38.1447044
 Parameter: XTRAN <- "3.066536"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.7084643"
 RDCMND substituted energy or value "?YAVE" to "-46.7421842"
Evaluating: 51.7084643--46.7421842
 Parameter: YTRAN <- "98.4506485"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.1749413"
 RDCMND substituted energy or value "?ZAVE" to "-20.4764334"
Evaluating: -43.1749413--20.4764334
 Parameter: ZTRAN <- "-22.6985079"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.066536"
 Parameter: YTRAN -> "98.4506485"
 Parameter: ZTRAN -> "-22.6985079"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     3.066536   98.450648  -22.698508
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.781590679"
Evaluating: 0.781590679*360.0
 Parameter: XPHI <- "281.372644"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.332330105"
Evaluating: 0.332330105*360.0
 Parameter: YPHI <- "119.638838"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.183436265"
Evaluating: 0.183436265*360.0
 Parameter: ZPHI <- "66.0370554"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.0781684"
 Parameter: YPOS -> "51.7084643"
 Parameter: ZPOS -> "-43.1749413"
 Parameter: XPHI -> "281.372644"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.197189   -0.980365
    0.000000    0.980365    0.197189

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   78.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.0781684"
 Parameter: YPOS -> "51.7084643"
 Parameter: ZPOS -> "-43.1749413"
 Parameter: YPHI -> "119.638838"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.494531    0.000000   -0.869160
    0.000000    1.000000    0.000000
    0.869160    0.000000   -0.494531

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.0781684"
 Parameter: YPOS -> "51.7084643"
 Parameter: ZPOS -> "-43.1749413"
 Parameter: ZPHI -> "66.0370554"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.406146    0.913808    0.000000
   -0.913808    0.406146    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.078168 XMAX =  -35.078168 XAVE =  -35.078168
    YMIN =   51.708464 YMAX =   51.708464 YAVE =   51.708464
    ZMIN =  -43.174941 ZMAX =  -43.174941 ZAVE =  -43.174941
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.0781684"
Evaluating: -35.0781684+3.5
 Parameter: XMAX <- "-31.5781684"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.7084643"
Evaluating: 51.7084643+3.5
 Parameter: YMAX <- "55.2084643"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.1749413"
Evaluating: -43.1749413+3.5
 Parameter: ZMAX <- "-39.6749413"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.0781684"
Evaluating: -35.0781684-3.5
 Parameter: XMIN <- "-38.5781684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.7084643"
Evaluating: 51.7084643-3.5
 Parameter: YMIN <- "48.2084643"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.1749413"
Evaluating: -43.1749413-3.5
 Parameter: ZMIN <- "-46.6749413"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.5781684"
 Parameter: XMIN -> "-38.5781684"
 Parameter: YMAX -> "55.2084643"
 Parameter: YMIN -> "48.2084643"
 Parameter: ZMAX -> "-39.6749413"
 Parameter: ZMIN -> "-46.6749413"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "94" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "94" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.910861254"
Evaluating: 128.065641*(0.910861254-0.5)
 Parameter: XPOS <- "52.6172099"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.993555818"
Evaluating: 128.065641*(0.993555818-0.5)
 Parameter: YPOS <- "63.2075422"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.203307078"
Evaluating: 108.613069*(0.203307078-0.5)+-2.187274
 Parameter: ZPOS <- "-34.4120028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.4120028" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.6172099"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.6172099-0
 Parameter: XTRAN <- "52.6172099"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "63.2075422"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 63.2075422-0
 Parameter: YTRAN <- "63.2075422"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.4120028"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.4120028-0
 Parameter: ZTRAN <- "-34.4120028"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.6172099"
 Parameter: YTRAN -> "63.2075422"
 Parameter: ZTRAN -> "-34.4120028"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    52.617210   63.207542  -34.412003
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.38728983E-02"
Evaluating: 5.38728983E-02*360.0
 Parameter: XPHI <- "19.3942434"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225515886"
Evaluating: 0.225515886*360.0
 Parameter: YPHI <- "81.185719"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831401275"
Evaluating: 0.831401275*360.0
 Parameter: ZPHI <- "299.304459"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.6172099"
 Parameter: YPOS -> "63.2075422"
 Parameter: ZPOS -> "-34.4120028"
 Parameter: XPHI -> "19.3942434"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.943256    0.332066
    0.000000   -0.332066    0.943256

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   19.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.6172099"
 Parameter: YPOS -> "63.2075422"
 Parameter: ZPOS -> "-34.4120028"
 Parameter: YPHI -> "81.185719"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.153232    0.000000   -0.988190
    0.000000    1.000000    0.000000
    0.988190    0.000000    0.153232

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.6172099"
 Parameter: YPOS -> "63.2075422"
 Parameter: ZPOS -> "-34.4120028"
 Parameter: ZPHI -> "299.304459"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.489450   -0.872031    0.000000
    0.872031    0.489450    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.617210 XMAX =   52.617210 XAVE =   52.617210
    YMIN =   63.207542 YMAX =   63.207542 YAVE =   63.207542
    ZMIN =  -34.412003 ZMAX =  -34.412003 ZAVE =  -34.412003
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.6172099"
Evaluating: 52.6172099+3.5
 Parameter: XMAX <- "56.1172099"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "63.2075422"
Evaluating: 63.2075422+3.5
 Parameter: YMAX <- "66.7075422"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.4120028"
Evaluating: -34.4120028+3.5
 Parameter: ZMAX <- "-30.9120028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.6172099"
Evaluating: 52.6172099-3.5
 Parameter: XMIN <- "49.1172099"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "63.2075422"
Evaluating: 63.2075422-3.5
 Parameter: YMIN <- "59.7075422"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.4120028"
Evaluating: -34.4120028-3.5
 Parameter: ZMIN <- "-37.9120028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.1172099"
 Parameter: XMIN -> "49.1172099"
 Parameter: YMAX -> "66.7075422"
 Parameter: YMIN -> "59.7075422"
 Parameter: ZMAX -> "-30.9120028"
 Parameter: ZMIN -> "-37.9120028"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "95" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "95" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.824539577E-02"
Evaluating: 128.065641*(9.824539577E-02-0.5)
 Parameter: XPOS <- "-51.4509609"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.510370643"
Evaluating: 128.065641*(0.510370643-0.5)
 Parameter: YPOS <- "1.32812304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.435224949"
Evaluating: 108.613069*(0.435224949-0.5)+-2.187274
 Parameter: ZPOS <- "-9.22269108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.22269108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.22269108" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "95" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.596549089"
Evaluating: 128.065641*(0.596549089-0.5)
 Parameter: XPOS <- "12.364621"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.897739558"
Evaluating: 128.065641*(0.897739558-0.5)
 Parameter: YPOS <- "50.9367714"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.558798923"
Evaluating: 108.613069*(0.558798923-0.5)+-2.187274
 Parameter: ZPOS <- "4.19905748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.19905748" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.19905748" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "95" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.35638946"
Evaluating: 128.065641*(0.35638946-0.5)
 Parameter: XPOS <- "-18.3915759"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.129703533"
Evaluating: 128.065641*(0.129703533-0.5)
 Parameter: YPOS <- "-47.4222544"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.995897223"
Evaluating: 108.613069*(0.995897223-0.5)+-2.187274
 Parameter: ZPOS <- "51.6736453"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.6736453" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.6736453" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.3915759"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.3915759-0
 Parameter: XTRAN <- "-18.3915759"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.4222544"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.4222544-0
 Parameter: YTRAN <- "-47.4222544"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.6736453"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.6736453-0
 Parameter: ZTRAN <- "51.6736453"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.3915759"
 Parameter: YTRAN -> "-47.4222544"
 Parameter: ZTRAN -> "51.6736453"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -18.391576  -47.422254   51.673645
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.737195327E-02"
Evaluating: 3.737195327E-02*360.0
 Parameter: XPHI <- "13.4539032"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549869975"
Evaluating: 0.549869975*360.0
 Parameter: YPHI <- "197.953191"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523204197"
Evaluating: 0.523204197*360.0
 Parameter: ZPHI <- "188.353511"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.3915759"
 Parameter: YPOS -> "-47.4222544"
 Parameter: ZPOS -> "51.6736453"
 Parameter: XPHI -> "13.4539032"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.972557    0.232663
    0.000000   -0.232663    0.972557

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   13.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.3915759"
 Parameter: YPOS -> "-47.4222544"
 Parameter: ZPOS -> "51.6736453"
 Parameter: YPHI -> "197.953191"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.951309    0.000000    0.308240
    0.000000    1.000000    0.000000
   -0.308240    0.000000   -0.951309

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.3915759"
 Parameter: YPOS -> "-47.4222544"
 Parameter: ZPOS -> "51.6736453"
 Parameter: ZPHI -> "188.353511"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.989391   -0.145280    0.000000
    0.145280   -0.989391    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.391576 XMAX =  -18.391576 XAVE =  -18.391576
    YMIN =  -47.422254 YMAX =  -47.422254 YAVE =  -47.422254
    ZMIN =   51.673645 ZMAX =   51.673645 ZAVE =   51.673645
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.3915759"
Evaluating: -18.3915759+3.5
 Parameter: XMAX <- "-14.8915759"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.4222544"
Evaluating: -47.4222544+3.5
 Parameter: YMAX <- "-43.9222544"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.6736453"
Evaluating: 51.6736453+3.5
 Parameter: ZMAX <- "55.1736453"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.3915759"
Evaluating: -18.3915759-3.5
 Parameter: XMIN <- "-21.8915759"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.4222544"
Evaluating: -47.4222544-3.5
 Parameter: YMIN <- "-50.9222544"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.6736453"
Evaluating: 51.6736453-3.5
 Parameter: ZMIN <- "48.1736453"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.8915759"
 Parameter: XMIN -> "-21.8915759"
 Parameter: YMAX -> "-43.9222544"
 Parameter: YMIN -> "-50.9222544"
 Parameter: ZMAX -> "55.1736453"
 Parameter: ZMIN -> "48.1736453"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "96" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "96" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.523564804"
Evaluating: 128.065641*(0.523564804-0.5)
 Parameter: XPOS <- "3.01784173"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.530816705"
Evaluating: 128.065641*(0.530816705-0.5)
 Parameter: YPOS <- "3.94656108"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.385515849"
Evaluating: 108.613069*(0.385515849-0.5)+-2.187274
 Parameter: ZPOS <- "-14.621749"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.621749" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.621749" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "96" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.791883363"
Evaluating: 128.065641*(0.791883363-0.5)
 Parameter: XPOS <- "37.38023"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.474327086"
Evaluating: 128.065641*(0.474327086-0.5)
 Parameter: YPOS <- "-3.28781819"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.84035932"
Evaluating: 108.613069*(0.84035932-0.5)+-2.187274
 Parameter: ZPOS <- "34.7801963"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.7801963" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.7801963" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.38023"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.38023-0
 Parameter: XTRAN <- "37.38023"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.28781819"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.28781819-0
 Parameter: YTRAN <- "-3.28781819"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.7801963"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.7801963-0
 Parameter: ZTRAN <- "34.7801963"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.38023"
 Parameter: YTRAN -> "-3.28781819"
 Parameter: ZTRAN -> "34.7801963"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    37.380230   -3.287818   34.780196
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272694208"
Evaluating: 0.272694208*360.0
 Parameter: XPHI <- "98.1699149"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100415873"
Evaluating: 0.100415873*360.0
 Parameter: YPHI <- "36.1497143"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112802912"
Evaluating: 0.112802912*360.0
 Parameter: ZPHI <- "40.6090483"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.38023"
 Parameter: YPOS -> "-3.28781819"
 Parameter: ZPOS -> "34.7801963"
 Parameter: XPHI -> "98.1699149"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.142109    0.989851
    0.000000   -0.989851   -0.142109

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.38023"
 Parameter: YPOS -> "-3.28781819"
 Parameter: ZPOS -> "34.7801963"
 Parameter: YPHI -> "36.1497143"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.807478    0.000000   -0.589897
    0.000000    1.000000    0.000000
    0.589897    0.000000    0.807478

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.38023"
 Parameter: YPOS -> "-3.28781819"
 Parameter: ZPOS -> "34.7801963"
 Parameter: ZPHI -> "40.6090483"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.759169    0.650894    0.000000
   -0.650894    0.759169    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   40.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.380230 XMAX =   37.380230 XAVE =   37.380230
    YMIN =   -3.287818 YMAX =   -3.287818 YAVE =   -3.287818
    ZMIN =   34.780196 ZMAX =   34.780196 ZAVE =   34.780196
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.38023"
Evaluating: 37.38023+3.5
 Parameter: XMAX <- "40.88023"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.28781819"
Evaluating: -3.28781819+3.5
 Parameter: YMAX <- "0.21218181"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.7801963"
Evaluating: 34.7801963+3.5
 Parameter: ZMAX <- "38.2801963"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.38023"
Evaluating: 37.38023-3.5
 Parameter: XMIN <- "33.88023"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.28781819"
Evaluating: -3.28781819-3.5
 Parameter: YMIN <- "-6.78781819"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.7801963"
Evaluating: 34.7801963-3.5
 Parameter: ZMIN <- "31.2801963"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.88023"
 Parameter: XMIN -> "33.88023"
 Parameter: YMAX -> "0.21218181"
 Parameter: YMIN -> "-6.78781819"
 Parameter: ZMAX -> "38.2801963"
 Parameter: ZMIN -> "31.2801963"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "97" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "97" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.961372066"
Evaluating: 128.065641*(0.961372066-0.5)
 Parameter: XPOS <- "59.0859094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.763806799"
Evaluating: 128.065641*(0.763806799-0.5)
 Parameter: YPOS <- "33.7845868"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.301364109"
Evaluating: 108.613069*(0.301364109-0.5)+-2.187274
 Parameter: ZPOS <- "-23.7617277"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.7617277" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "59.0859094"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 59.0859094-0
 Parameter: XTRAN <- "59.0859094"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.7845868"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.7845868-0
 Parameter: YTRAN <- "33.7845868"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.7617277"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.7617277-0
 Parameter: ZTRAN <- "-23.7617277"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.0859094"
 Parameter: YTRAN -> "33.7845868"
 Parameter: ZTRAN -> "-23.7617277"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    59.085909   33.784587  -23.761728
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13169151"
Evaluating: 0.13169151*360.0
 Parameter: XPHI <- "47.4089436"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762025459"
Evaluating: 0.762025459*360.0
 Parameter: YPHI <- "274.329165"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616764049"
Evaluating: 0.616764049*360.0
 Parameter: ZPHI <- "222.035058"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "59.0859094"
 Parameter: YPOS -> "33.7845868"
 Parameter: ZPOS -> "-23.7617277"
 Parameter: XPHI -> "47.4089436"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.676761    0.736203
    0.000000   -0.736203    0.676761

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "59.0859094"
 Parameter: YPOS -> "33.7845868"
 Parameter: ZPOS -> "-23.7617277"
 Parameter: YPHI -> "274.329165"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.075486    0.000000    0.997147
    0.000000    1.000000    0.000000
   -0.997147    0.000000    0.075486

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "59.0859094"
 Parameter: YPOS -> "33.7845868"
 Parameter: ZPOS -> "-23.7617277"
 Parameter: ZPHI -> "222.035058"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.742735   -0.669585    0.000000
    0.669585   -0.742735    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  137.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   59.085909 XMAX =   59.085909 XAVE =   59.085909
    YMIN =   33.784587 YMAX =   33.784587 YAVE =   33.784587
    ZMIN =  -23.761728 ZMAX =  -23.761728 ZAVE =  -23.761728
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "59.0859094"
Evaluating: 59.0859094+3.5
 Parameter: XMAX <- "62.5859094"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.7845868"
Evaluating: 33.7845868+3.5
 Parameter: YMAX <- "37.2845868"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.7617277"
Evaluating: -23.7617277+3.5
 Parameter: ZMAX <- "-20.2617277"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "59.0859094"
Evaluating: 59.0859094-3.5
 Parameter: XMIN <- "55.5859094"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.7845868"
Evaluating: 33.7845868-3.5
 Parameter: YMIN <- "30.2845868"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.7617277"
Evaluating: -23.7617277-3.5
 Parameter: ZMIN <- "-27.2617277"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.5859094"
 Parameter: XMIN -> "55.5859094"
 Parameter: YMAX -> "37.2845868"
 Parameter: YMIN -> "30.2845868"
 Parameter: ZMAX -> "-20.2617277"
 Parameter: ZMIN -> "-27.2617277"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "98" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "98" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.932838898"
Evaluating: 128.065641*(0.932838898-0.5)
 Parameter: XPOS <- "55.4317909"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.628023987"
Evaluating: 128.065641*(0.628023987-0.5)
 Parameter: YPOS <- "16.395474"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.837934763"
Evaluating: 108.613069*(0.837934763-0.5)+-2.187274
 Parameter: ZPOS <- "34.5168577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.5168577" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.5168577" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.4317909"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 55.4317909-0
 Parameter: XTRAN <- "55.4317909"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.395474"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.395474-0
 Parameter: YTRAN <- "16.395474"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.5168577"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.5168577-0
 Parameter: ZTRAN <- "34.5168577"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.4317909"
 Parameter: YTRAN -> "16.395474"
 Parameter: ZTRAN -> "34.5168577"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    55.431791   16.395474   34.516858
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.291388764E-02"
Evaluating: 1.291388764E-02*360.0
 Parameter: XPHI <- "4.64899955"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455307413"
Evaluating: 0.455307413*360.0
 Parameter: YPHI <- "163.910669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.695672027E-02"
Evaluating: 3.695672027E-02*360.0
 Parameter: ZPHI <- "13.3044193"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.4317909"
 Parameter: YPOS -> "16.395474"
 Parameter: ZPOS -> "34.5168577"
 Parameter: XPHI -> "4.64899955"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996710    0.081051
    0.000000   -0.081051    0.996710

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.4317909"
 Parameter: YPOS -> "16.395474"
 Parameter: ZPOS -> "34.5168577"
 Parameter: YPHI -> "163.910669"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.960831    0.000000   -0.277136
    0.000000    1.000000    0.000000
    0.277136    0.000000   -0.960831

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.4317909"
 Parameter: YPOS -> "16.395474"
 Parameter: ZPOS -> "34.5168577"
 Parameter: ZPHI -> "13.3044193"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.973161    0.230125    0.000000
   -0.230125    0.973161    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.431791 XMAX =   55.431791 XAVE =   55.431791
    YMIN =   16.395474 YMAX =   16.395474 YAVE =   16.395474
    ZMIN =   34.516858 ZMAX =   34.516858 ZAVE =   34.516858
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.4317909"
Evaluating: 55.4317909+3.5
 Parameter: XMAX <- "58.9317909"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.395474"
Evaluating: 16.395474+3.5
 Parameter: YMAX <- "19.895474"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.5168577"
Evaluating: 34.5168577+3.5
 Parameter: ZMAX <- "38.0168577"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.4317909"
Evaluating: 55.4317909-3.5
 Parameter: XMIN <- "51.9317909"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.395474"
Evaluating: 16.395474-3.5
 Parameter: YMIN <- "12.895474"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.5168577"
Evaluating: 34.5168577-3.5
 Parameter: ZMIN <- "31.0168577"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.9317909"
 Parameter: XMIN -> "51.9317909"
 Parameter: YMAX -> "19.895474"
 Parameter: YMIN -> "12.895474"
 Parameter: ZMAX -> "38.0168577"
 Parameter: ZMIN -> "31.0168577"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "99" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "99" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.15538782"
Evaluating: 128.065641*(0.15538782-0.5)
 Parameter: XPOS <- "-44.1329797"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.401319942"
Evaluating: 128.065641*(0.401319942-0.5)
 Parameter: YPOS <- "-12.6375249"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.471634877"
Evaluating: 108.613069*(0.471634877-0.5)+-2.187274
 Parameter: ZPOS <- "-5.26809706"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.26809706" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.26809706" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "99" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.959182165"
Evaluating: 128.065641*(0.959182165-0.5)
 Parameter: XPOS <- "58.8054583"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.540316922"
Evaluating: 128.065641*(0.540316922-0.5)
 Parameter: YPOS <- "5.16321246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.36055805"
Evaluating: 108.613069*(0.36055805-0.5)+-2.187274
 Parameter: ZPOS <- "-17.3324921"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.3324921" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.8054583"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.8054583-0
 Parameter: XTRAN <- "58.8054583"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.16321246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.16321246-0
 Parameter: YTRAN <- "5.16321246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.3324921"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.3324921-0
 Parameter: ZTRAN <- "-17.3324921"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.8054583"
 Parameter: YTRAN -> "5.16321246"
 Parameter: ZTRAN -> "-17.3324921"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    58.805458    5.163212  -17.332492
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653619061"
Evaluating: 0.653619061*360.0
 Parameter: XPHI <- "235.302862"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888979337"
Evaluating: 0.888979337*360.0
 Parameter: YPHI <- "320.032561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203917031"
Evaluating: 0.203917031*360.0
 Parameter: ZPHI <- "73.4101312"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.8054583"
 Parameter: YPOS -> "5.16321246"
 Parameter: ZPOS -> "-17.3324921"
 Parameter: XPHI -> "235.302862"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.569238   -0.822172
    0.000000    0.822172   -0.569238

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.8054583"
 Parameter: YPOS -> "5.16321246"
 Parameter: ZPOS -> "-17.3324921"
 Parameter: YPHI -> "320.032561"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.766410    0.000000    0.642352
    0.000000    1.000000    0.000000
   -0.642352    0.000000    0.766410

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.8054583"
 Parameter: YPOS -> "5.16321246"
 Parameter: ZPOS -> "-17.3324921"
 Parameter: ZPHI -> "73.4101312"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.285519    0.958373    0.000000
   -0.958373    0.285519    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.805458 XMAX =   58.805458 XAVE =   58.805458
    YMIN =    5.163212 YMAX =    5.163212 YAVE =    5.163212
    ZMIN =  -17.332492 ZMAX =  -17.332492 ZAVE =  -17.332492
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.8054583"
Evaluating: 58.8054583+3.5
 Parameter: XMAX <- "62.3054583"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.16321246"
Evaluating: 5.16321246+3.5
 Parameter: YMAX <- "8.66321246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.3324921"
Evaluating: -17.3324921+3.5
 Parameter: ZMAX <- "-13.8324921"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.8054583"
Evaluating: 58.8054583-3.5
 Parameter: XMIN <- "55.3054583"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.16321246"
Evaluating: 5.16321246-3.5
 Parameter: YMIN <- "1.66321246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.3324921"
Evaluating: -17.3324921-3.5
 Parameter: ZMIN <- "-20.8324921"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.3054583"
 Parameter: XMIN -> "55.3054583"
 Parameter: YMAX -> "8.66321246"
 Parameter: YMIN -> "1.66321246"
 Parameter: ZMAX -> "-13.8324921"
 Parameter: ZMIN -> "-20.8324921"
 SELRPN>     24 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     13 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60331 POS      POT      99       POT     -**** MEMB     DMPC     264      C23           3.7930
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      C11           3.9426
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      P             1.5681
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      O13           2.3787
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      O14           2.0414
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      O11           0.7838
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      O12           2.8406
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      C1            2.1782
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      C2            3.0748
60331 POS      POT      99       POT     -**** MEMB     DMPC     291      O21           3.1087
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "99" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.823184589"
Evaluating: 128.065641*(0.823184589-0.5)
 Parameter: XPOS <- "41.3888416"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.574093392"
Evaluating: 128.065641*(0.574093392-0.5)
 Parameter: YPOS <- "9.48881774"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.78330503"
Evaluating: 108.613069*(0.78330503-0.5)+-2.187274
 Parameter: ZPOS <- "28.5833548"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.5833548" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.5833548" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.805458 XMAX =   58.805458 XAVE =   58.805458
    YMIN =    5.163212 YMAX =    5.163212 YAVE =    5.163212
    ZMIN =  -17.332492 ZMAX =  -17.332492 ZAVE =  -17.332492
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.3888416"
 RDCMND substituted energy or value "?XAVE" to "58.8054583"
Evaluating: 41.3888416-58.8054583
 Parameter: XTRAN <- "-17.4166167"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.48881774"
 RDCMND substituted energy or value "?YAVE" to "5.16321246"
Evaluating: 9.48881774-5.16321246
 Parameter: YTRAN <- "4.32560528"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.5833548"
 RDCMND substituted energy or value "?ZAVE" to "-17.3324921"
Evaluating: 28.5833548--17.3324921
 Parameter: ZTRAN <- "45.9158469"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.4166167"
 Parameter: YTRAN -> "4.32560528"
 Parameter: ZTRAN -> "45.9158469"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -17.416617    4.325605   45.915847
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.337012367"
Evaluating: 0.337012367*360.0
 Parameter: XPHI <- "121.324452"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499583837"
Evaluating: 0.499583837*360.0
 Parameter: YPHI <- "179.850181"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.663780046"
Evaluating: 0.663780046*360.0
 Parameter: ZPHI <- "238.960817"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.3888416"
 Parameter: YPOS -> "9.48881774"
 Parameter: ZPOS -> "28.5833548"
 Parameter: XPHI -> "121.324452"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.519884    0.854237
    0.000000   -0.854237   -0.519884

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.3888416"
 Parameter: YPOS -> "9.48881774"
 Parameter: ZPOS -> "28.5833548"
 Parameter: YPHI -> "179.850181"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999997    0.000000   -0.002615
    0.000000    1.000000    0.000000
    0.002615    0.000000   -0.999997

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.3888416"
 Parameter: YPOS -> "9.48881774"
 Parameter: ZPOS -> "28.5833548"
 Parameter: ZPHI -> "238.960817"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.515624   -0.856815    0.000000
    0.856815   -0.515624    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.388842 XMAX =   41.388842 XAVE =   41.388842
    YMIN =    9.488818 YMAX =    9.488818 YAVE =    9.488818
    ZMIN =   28.583355 ZMAX =   28.583355 ZAVE =   28.583355
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.3888416"
Evaluating: 41.3888416+3.5
 Parameter: XMAX <- "44.8888416"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.48881774"
Evaluating: 9.48881774+3.5
 Parameter: YMAX <- "12.9888177"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.5833548"
Evaluating: 28.5833548+3.5
 Parameter: ZMAX <- "32.0833548"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.3888416"
Evaluating: 41.3888416-3.5
 Parameter: XMIN <- "37.8888416"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.48881774"
Evaluating: 9.48881774-3.5
 Parameter: YMIN <- "5.98881774"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.5833548"
Evaluating: 28.5833548-3.5
 Parameter: ZMIN <- "25.0833548"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.8888416"
 Parameter: XMIN -> "37.8888416"
 Parameter: YMAX -> "12.9888177"
 Parameter: YMIN -> "5.98881774"
 Parameter: ZMAX -> "32.0833548"
 Parameter: ZMIN -> "25.0833548"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "100" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "100" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.519237461"
Evaluating: 128.065641*(0.519237461-0.5)
 Parameter: XPOS <- "2.46365777"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.510774252"
Evaluating: 128.065641*(0.510774252-0.5)
 Parameter: YPOS <- "1.37981149"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.464053235"
Evaluating: 108.613069*(0.464053235-0.5)+-2.187274
 Parameter: ZPOS <- "-6.09156247"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.09156247" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.09156247" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "100" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.943339038"
Evaluating: 128.065641*(0.943339038-0.5)
 Parameter: XPOS <- "56.7764981"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.409157397"
Evaluating: 128.065641*(0.409157397-0.5)
 Parameter: YPOS <- "-11.6338162"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.153979193"
Evaluating: 108.613069*(0.153979193-0.5)+-2.187274
 Parameter: ZPOS <- "-39.7696558"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.7696558" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "56.7764981"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 56.7764981-0
 Parameter: XTRAN <- "56.7764981"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.6338162"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.6338162-0
 Parameter: YTRAN <- "-11.6338162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.7696558"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.7696558-0
 Parameter: ZTRAN <- "-39.7696558"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "56.7764981"
 Parameter: YTRAN -> "-11.6338162"
 Parameter: ZTRAN -> "-39.7696558"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    56.776498  -11.633816  -39.769656
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.417134086"
Evaluating: 0.417134086*360.0
 Parameter: XPHI <- "150.168271"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533459848"
Evaluating: 0.533459848*360.0
 Parameter: YPHI <- "192.045545"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.181466517"
Evaluating: 0.181466517*360.0
 Parameter: ZPHI <- "65.3279461"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "56.7764981"
 Parameter: YPOS -> "-11.6338162"
 Parameter: ZPOS -> "-39.7696558"
 Parameter: XPHI -> "150.168271"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.867490    0.497454
    0.000000   -0.497454   -0.867490

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "56.7764981"
 Parameter: YPOS -> "-11.6338162"
 Parameter: ZPOS -> "-39.7696558"
 Parameter: YPHI -> "192.045545"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.977982    0.000000    0.208689
    0.000000    1.000000    0.000000
   -0.208689    0.000000   -0.977982

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "56.7764981"
 Parameter: YPOS -> "-11.6338162"
 Parameter: ZPOS -> "-39.7696558"
 Parameter: ZPHI -> "65.3279461"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.417424    0.908712    0.000000
   -0.908712    0.417424    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.776498 XMAX =   56.776498 XAVE =   56.776498
    YMIN =  -11.633816 YMAX =  -11.633816 YAVE =  -11.633816
    ZMIN =  -39.769656 ZMAX =  -39.769656 ZAVE =  -39.769656
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "56.7764981"
Evaluating: 56.7764981+3.5
 Parameter: XMAX <- "60.2764981"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.6338162"
Evaluating: -11.6338162+3.5
 Parameter: YMAX <- "-8.1338162"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.7696558"
Evaluating: -39.7696558+3.5
 Parameter: ZMAX <- "-36.2696558"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "56.7764981"
Evaluating: 56.7764981-3.5
 Parameter: XMIN <- "53.2764981"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.6338162"
Evaluating: -11.6338162-3.5
 Parameter: YMIN <- "-15.1338162"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.7696558"
Evaluating: -39.7696558-3.5
 Parameter: ZMIN <- "-43.2696558"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.2764981"
 Parameter: XMIN -> "53.2764981"
 Parameter: YMAX -> "-8.1338162"
 Parameter: YMIN -> "-15.1338162"
 Parameter: ZMAX -> "-36.2696558"
 Parameter: ZMIN -> "-43.2696558"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "101" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "101" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.498480877"
Evaluating: 128.065641*(0.498480877-0.5)
 Parameter: XPOS <- "-0.194547461"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.345729618"
Evaluating: 128.065641*(0.345729618-0.5)
 Parameter: YPOS <- "-19.7567354"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.443613669"
Evaluating: 108.613069*(0.443613669-0.5)+-2.187274
 Parameter: ZPOS <- "-8.31156646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.31156646" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.31156646" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "101" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.69570173"
Evaluating: 128.065641*(0.69570173-0.5)
 Parameter: XPOS <- "25.0626675"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.40315594"
Evaluating: 128.065641*(0.40315594-0.5)
 Parameter: YPOS <- "-12.4023966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.729733205"
Evaluating: 108.613069*(0.729733205-0.5)+-2.187274
 Parameter: ZPOS <- "22.7647544"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.7647544" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.7647544" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.0626675"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.0626675-0
 Parameter: XTRAN <- "25.0626675"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4023966"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.4023966-0
 Parameter: YTRAN <- "-12.4023966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.7647544"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.7647544-0
 Parameter: ZTRAN <- "22.7647544"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.0626675"
 Parameter: YTRAN -> "-12.4023966"
 Parameter: ZTRAN -> "22.7647544"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    25.062667  -12.402397   22.764754
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.370803155"
Evaluating: 0.370803155*360.0
 Parameter: XPHI <- "133.489136"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.617170105E-02"
Evaluating: 2.617170105E-02*360.0
 Parameter: YPHI <- "9.42181238"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211195747"
Evaluating: 0.211195747*360.0
 Parameter: ZPHI <- "76.0304689"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.0626675"
 Parameter: YPOS -> "-12.4023966"
 Parameter: ZPOS -> "22.7647544"
 Parameter: XPHI -> "133.489136"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.688217    0.725505
    0.000000   -0.725505   -0.688217

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.0626675"
 Parameter: YPOS -> "-12.4023966"
 Parameter: ZPOS -> "22.7647544"
 Parameter: YPHI -> "9.42181238"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.986510    0.000000   -0.163702
    0.000000    1.000000    0.000000
    0.163702    0.000000    0.986510

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.0626675"
 Parameter: YPOS -> "-12.4023966"
 Parameter: ZPOS -> "22.7647544"
 Parameter: ZPHI -> "76.0304689"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.241406    0.970424    0.000000
   -0.970424    0.241406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.062667 XMAX =   25.062667 XAVE =   25.062667
    YMIN =  -12.402397 YMAX =  -12.402397 YAVE =  -12.402397
    ZMIN =   22.764754 ZMAX =   22.764754 ZAVE =   22.764754
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.0626675"
Evaluating: 25.0626675+3.5
 Parameter: XMAX <- "28.5626675"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4023966"
Evaluating: -12.4023966+3.5
 Parameter: YMAX <- "-8.9023966"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.7647544"
Evaluating: 22.7647544+3.5
 Parameter: ZMAX <- "26.2647544"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.0626675"
Evaluating: 25.0626675-3.5
 Parameter: XMIN <- "21.5626675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4023966"
Evaluating: -12.4023966-3.5
 Parameter: YMIN <- "-15.9023966"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.7647544"
Evaluating: 22.7647544-3.5
 Parameter: ZMIN <- "19.2647544"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.5626675"
 Parameter: XMIN -> "21.5626675"
 Parameter: YMAX -> "-8.9023966"
 Parameter: YMIN -> "-15.9023966"
 Parameter: ZMAX -> "26.2647544"
 Parameter: ZMIN -> "19.2647544"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "102" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "102" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.738553358"
Evaluating: 128.065641*(0.738553358-0.5)
 Parameter: XPOS <- "30.5504887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.453310661"
Evaluating: 128.065641*(0.453310661-0.5)
 Parameter: YPOS <- "-5.97930013"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.315555664"
Evaluating: 108.613069*(0.315555664-0.5)+-2.187274
 Parameter: ZPOS <- "-22.2203394"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.2203394" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.5504887"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.5504887-0
 Parameter: XTRAN <- "30.5504887"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.97930013"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.97930013-0
 Parameter: YTRAN <- "-5.97930013"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.2203394"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.2203394-0
 Parameter: ZTRAN <- "-22.2203394"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.5504887"
 Parameter: YTRAN -> "-5.97930013"
 Parameter: ZTRAN -> "-22.2203394"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    30.550489   -5.979300  -22.220339
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158261462"
Evaluating: 0.158261462*360.0
 Parameter: XPHI <- "56.9741263"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832425854"
Evaluating: 0.832425854*360.0
 Parameter: YPHI <- "299.673307"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691375899"
Evaluating: 0.691375899*360.0
 Parameter: ZPHI <- "248.895324"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.5504887"
 Parameter: YPOS -> "-5.97930013"
 Parameter: ZPOS -> "-22.2203394"
 Parameter: XPHI -> "56.9741263"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.545018    0.838425
    0.000000   -0.838425    0.545018

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   56.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.5504887"
 Parameter: YPOS -> "-5.97930013"
 Parameter: ZPOS -> "-22.2203394"
 Parameter: YPHI -> "299.673307"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.495054    0.000000    0.868862
    0.000000    1.000000    0.000000
   -0.868862    0.000000    0.495054

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.5504887"
 Parameter: YPOS -> "-5.97930013"
 Parameter: ZPOS -> "-22.2203394"
 Parameter: ZPHI -> "248.895324"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.360073   -0.932924    0.000000
    0.932924   -0.360073    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.550489 XMAX =   30.550489 XAVE =   30.550489
    YMIN =   -5.979300 YMAX =   -5.979300 YAVE =   -5.979300
    ZMIN =  -22.220339 ZMAX =  -22.220339 ZAVE =  -22.220339
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.5504887"
Evaluating: 30.5504887+3.5
 Parameter: XMAX <- "34.0504887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.97930013"
Evaluating: -5.97930013+3.5
 Parameter: YMAX <- "-2.47930013"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.2203394"
Evaluating: -22.2203394+3.5
 Parameter: ZMAX <- "-18.7203394"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.5504887"
Evaluating: 30.5504887-3.5
 Parameter: XMIN <- "27.0504887"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.97930013"
Evaluating: -5.97930013-3.5
 Parameter: YMIN <- "-9.47930013"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.2203394"
Evaluating: -22.2203394-3.5
 Parameter: ZMIN <- "-25.7203394"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.0504887"
 Parameter: XMIN -> "27.0504887"
 Parameter: YMAX -> "-2.47930013"
 Parameter: YMIN -> "-9.47930013"
 Parameter: ZMAX -> "-18.7203394"
 Parameter: ZMIN -> "-25.7203394"
 SELRPN>      6 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      4 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60334 POS      POT      102      POT     -**** PROH     GLU      504      CG            3.3481
60334 POS      POT      102      POT     -**** PROH     GLU      504      CD            2.5299
60334 POS      POT      102      POT     -**** PROH     GLU      504      OE1           3.3701
60334 POS      POT      102      POT     -**** PROH     GLU      504      OE2           1.6196
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "102" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.743915911"
Evaluating: 128.065641*(0.743915911-0.5)
 Parameter: XPOS <- "31.2372475"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.902086119"
Evaluating: 128.065641*(0.902086119-0.5)
 Parameter: YPOS <- "51.4934166"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.832857231"
Evaluating: 108.613069*(0.832857231-0.5)+-2.187274
 Parameter: ZPOS <- "33.9653714"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.9653714" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.9653714" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.550489 XMAX =   30.550489 XAVE =   30.550489
    YMIN =   -5.979300 YMAX =   -5.979300 YAVE =   -5.979300
    ZMIN =  -22.220339 ZMAX =  -22.220339 ZAVE =  -22.220339
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.2372475"
 RDCMND substituted energy or value "?XAVE" to "30.5504887"
Evaluating: 31.2372475-30.5504887
 Parameter: XTRAN <- "0.6867588"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.4934166"
 RDCMND substituted energy or value "?YAVE" to "-5.97930013"
Evaluating: 51.4934166--5.97930013
 Parameter: YTRAN <- "57.4727167"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.9653714"
 RDCMND substituted energy or value "?ZAVE" to "-22.2203394"
Evaluating: 33.9653714--22.2203394
 Parameter: ZTRAN <- "56.1857108"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.6867588"
 Parameter: YTRAN -> "57.4727167"
 Parameter: ZTRAN -> "56.1857108"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     0.686759   57.472717   56.185711
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64963778"
Evaluating: 0.64963778*360.0
 Parameter: XPHI <- "233.869601"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180557575"
Evaluating: 0.180557575*360.0
 Parameter: YPHI <- "65.000727"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751498417"
Evaluating: 0.751498417*360.0
 Parameter: ZPHI <- "270.53943"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.2372475"
 Parameter: YPOS -> "51.4934166"
 Parameter: ZPOS -> "33.9653714"
 Parameter: XPHI -> "233.869601"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.589625   -0.807677
    0.000000    0.807677   -0.589625

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.2372475"
 Parameter: YPOS -> "51.4934166"
 Parameter: ZPOS -> "33.9653714"
 Parameter: YPHI -> "65.000727"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.422607    0.000000   -0.906313
    0.000000    1.000000    0.000000
    0.906313    0.000000    0.422607

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   65.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.2372475"
 Parameter: YPOS -> "51.4934166"
 Parameter: ZPOS -> "33.9653714"
 Parameter: ZPHI -> "270.53943"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.009415   -0.999956    0.000000
    0.999956    0.009415    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.237247 XMAX =   31.237247 XAVE =   31.237247
    YMIN =   51.493417 YMAX =   51.493417 YAVE =   51.493417
    ZMIN =   33.965371 ZMAX =   33.965371 ZAVE =   33.965371
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.2372475"
Evaluating: 31.2372475+3.5
 Parameter: XMAX <- "34.7372475"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.4934166"
Evaluating: 51.4934166+3.5
 Parameter: YMAX <- "54.9934166"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.9653714"
Evaluating: 33.9653714+3.5
 Parameter: ZMAX <- "37.4653714"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.2372475"
Evaluating: 31.2372475-3.5
 Parameter: XMIN <- "27.7372475"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.4934166"
Evaluating: 51.4934166-3.5
 Parameter: YMIN <- "47.9934166"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.9653714"
Evaluating: 33.9653714-3.5
 Parameter: ZMIN <- "30.4653714"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.7372475"
 Parameter: XMIN -> "27.7372475"
 Parameter: YMAX -> "54.9934166"
 Parameter: YMIN -> "47.9934166"
 Parameter: ZMAX -> "37.4653714"
 Parameter: ZMIN -> "30.4653714"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "103" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "103" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.859532969"
Evaluating: 128.065641*(0.859532969-0.5)
 Parameter: XPOS <- "46.0438201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.918736305"
Evaluating: 128.065641*(0.918736305-0.5)
 Parameter: YPOS <- "53.6257333"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.149404252"
Evaluating: 108.613069*(0.149404252-0.5)+-2.187274
 Parameter: ZPOS <- "-40.2665542"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.2665542" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0438201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.0438201-0
 Parameter: XTRAN <- "46.0438201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.6257333"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.6257333-0
 Parameter: YTRAN <- "53.6257333"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.2665542"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.2665542-0
 Parameter: ZTRAN <- "-40.2665542"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.0438201"
 Parameter: YTRAN -> "53.6257333"
 Parameter: ZTRAN -> "-40.2665542"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    46.043820   53.625733  -40.266554
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320933828"
Evaluating: 0.320933828*360.0
 Parameter: XPHI <- "115.536178"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312033929"
Evaluating: 0.312033929*360.0
 Parameter: YPHI <- "112.332214"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770446958"
Evaluating: 0.770446958*360.0
 Parameter: ZPHI <- "277.360905"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0438201"
 Parameter: YPOS -> "53.6257333"
 Parameter: ZPOS -> "-40.2665542"
 Parameter: XPHI -> "115.536178"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.431081    0.902313
    0.000000   -0.902313   -0.431081

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0438201"
 Parameter: YPOS -> "53.6257333"
 Parameter: ZPOS -> "-40.2665542"
 Parameter: YPHI -> "112.332214"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.379976    0.000000   -0.924996
    0.000000    1.000000    0.000000
    0.924996    0.000000   -0.379976

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0438201"
 Parameter: YPOS -> "53.6257333"
 Parameter: ZPOS -> "-40.2665542"
 Parameter: ZPHI -> "277.360905"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.128119   -0.991759    0.000000
    0.991759    0.128119    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.043820 XMAX =   46.043820 XAVE =   46.043820
    YMIN =   53.625733 YMAX =   53.625733 YAVE =   53.625733
    ZMIN =  -40.266554 ZMAX =  -40.266554 ZAVE =  -40.266554
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0438201"
Evaluating: 46.0438201+3.5
 Parameter: XMAX <- "49.5438201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.6257333"
Evaluating: 53.6257333+3.5
 Parameter: YMAX <- "57.1257333"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.2665542"
Evaluating: -40.2665542+3.5
 Parameter: ZMAX <- "-36.7665542"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0438201"
Evaluating: 46.0438201-3.5
 Parameter: XMIN <- "42.5438201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.6257333"
Evaluating: 53.6257333-3.5
 Parameter: YMIN <- "50.1257333"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.2665542"
Evaluating: -40.2665542-3.5
 Parameter: ZMIN <- "-43.7665542"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5438201"
 Parameter: XMIN -> "42.5438201"
 Parameter: YMAX -> "57.1257333"
 Parameter: YMIN -> "50.1257333"
 Parameter: ZMAX -> "-36.7665542"
 Parameter: ZMIN -> "-43.7665542"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "104" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "104" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.866120223"
Evaluating: 128.065641*(0.866120223-0.5)
 Parameter: XPOS <- "46.887421"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.101444926"
Evaluating: 128.065641*(0.101444926-0.5)
 Parameter: YPOS <- "-51.041211"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.89821049"
Evaluating: 108.613069*(0.89821049-0.5)+-2.187274
 Parameter: ZPOS <- "41.0635894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.0635894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.0635894" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.887421"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.887421-0
 Parameter: XTRAN <- "46.887421"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.041211"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.041211-0
 Parameter: YTRAN <- "-51.041211"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.0635894"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.0635894-0
 Parameter: ZTRAN <- "41.0635894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.887421"
 Parameter: YTRAN -> "-51.041211"
 Parameter: ZTRAN -> "41.0635894"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    46.887421  -51.041211   41.063589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360001152"
Evaluating: 0.360001152*360.0
 Parameter: XPHI <- "129.600415"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525233443"
Evaluating: 0.525233443*360.0
 Parameter: YPHI <- "189.084039"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.48706295E-03"
Evaluating: 5.48706295E-03*360.0
 Parameter: ZPHI <- "1.97534266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.887421"
 Parameter: YPOS -> "-51.041211"
 Parameter: ZPOS -> "41.0635894"
 Parameter: XPHI -> "129.600415"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.637430    0.770509
    0.000000   -0.770509   -0.637430

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.887421"
 Parameter: YPOS -> "-51.041211"
 Parameter: ZPOS -> "41.0635894"
 Parameter: YPHI -> "189.084039"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.987458    0.000000    0.157883
    0.000000    1.000000    0.000000
   -0.157883    0.000000   -0.987458

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.887421"
 Parameter: YPOS -> "-51.041211"
 Parameter: ZPOS -> "41.0635894"
 Parameter: ZPHI -> "1.97534266"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999406    0.034469    0.000000
   -0.034469    0.999406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    1.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.887421 XMAX =   46.887421 XAVE =   46.887421
    YMIN =  -51.041211 YMAX =  -51.041211 YAVE =  -51.041211
    ZMIN =   41.063589 ZMAX =   41.063589 ZAVE =   41.063589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.887421"
Evaluating: 46.887421+3.5
 Parameter: XMAX <- "50.387421"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.041211"
Evaluating: -51.041211+3.5
 Parameter: YMAX <- "-47.541211"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.0635894"
Evaluating: 41.0635894+3.5
 Parameter: ZMAX <- "44.5635894"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.887421"
Evaluating: 46.887421-3.5
 Parameter: XMIN <- "43.387421"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.041211"
Evaluating: -51.041211-3.5
 Parameter: YMIN <- "-54.541211"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.0635894"
Evaluating: 41.0635894-3.5
 Parameter: ZMIN <- "37.5635894"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.387421"
 Parameter: XMIN -> "43.387421"
 Parameter: YMAX -> "-47.541211"
 Parameter: YMIN -> "-54.541211"
 Parameter: ZMAX -> "44.5635894"
 Parameter: ZMIN -> "37.5635894"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "105" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "105" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.689344442"
Evaluating: 128.065641*(0.689344442-0.5)
 Parameter: XPOS <- "24.2485173"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.270702894"
Evaluating: 128.065641*(0.270702894-0.5)
 Parameter: YPOS <- "-29.3650809"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.339555362"
Evaluating: 108.613069*(0.339555362-0.5)+-2.187274
 Parameter: ZPOS <- "-19.6136585"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.6136585" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.2485173"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.2485173-0
 Parameter: XTRAN <- "24.2485173"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.3650809"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.3650809-0
 Parameter: YTRAN <- "-29.3650809"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.6136585"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.6136585-0
 Parameter: ZTRAN <- "-19.6136585"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.2485173"
 Parameter: YTRAN -> "-29.3650809"
 Parameter: ZTRAN -> "-19.6136585"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    24.248517  -29.365081  -19.613658
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923146427"
Evaluating: 0.923146427*360.0
 Parameter: XPHI <- "332.332714"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369183395"
Evaluating: 0.369183395*360.0
 Parameter: YPHI <- "132.906022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22458827"
Evaluating: 0.22458827*360.0
 Parameter: ZPHI <- "80.8517772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.2485173"
 Parameter: YPOS -> "-29.3650809"
 Parameter: ZPOS -> "-19.6136585"
 Parameter: XPHI -> "332.332714"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.885659   -0.464336
    0.000000    0.464336    0.885659

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.2485173"
 Parameter: YPOS -> "-29.3650809"
 Parameter: ZPOS -> "-19.6136585"
 Parameter: YPHI -> "132.906022"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.680798    0.000000   -0.732471
    0.000000    1.000000    0.000000
    0.732471    0.000000   -0.680798

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.2485173"
 Parameter: YPOS -> "-29.3650809"
 Parameter: ZPOS -> "-19.6136585"
 Parameter: ZPHI -> "80.8517772"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.158989    0.987280    0.000000
   -0.987280    0.158989    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.248517 XMAX =   24.248517 XAVE =   24.248517
    YMIN =  -29.365081 YMAX =  -29.365081 YAVE =  -29.365081
    ZMIN =  -19.613658 ZMAX =  -19.613658 ZAVE =  -19.613658
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.2485173"
Evaluating: 24.2485173+3.5
 Parameter: XMAX <- "27.7485173"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.3650809"
Evaluating: -29.3650809+3.5
 Parameter: YMAX <- "-25.8650809"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.6136585"
Evaluating: -19.6136585+3.5
 Parameter: ZMAX <- "-16.1136585"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.2485173"
Evaluating: 24.2485173-3.5
 Parameter: XMIN <- "20.7485173"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.3650809"
Evaluating: -29.3650809-3.5
 Parameter: YMIN <- "-32.8650809"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.6136585"
Evaluating: -19.6136585-3.5
 Parameter: ZMIN <- "-23.1136585"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.7485173"
 Parameter: XMIN -> "20.7485173"
 Parameter: YMAX -> "-25.8650809"
 Parameter: YMIN -> "-32.8650809"
 Parameter: ZMAX -> "-16.1136585"
 Parameter: ZMIN -> "-23.1136585"
 SELRPN>      9 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      2 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60337 POS      POT      105      POT     -**** PROG     LYS      411      CE            3.7602
60337 POS      POT      105      POT     -**** PROG     LYS      411      NZ            3.5536
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "105" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.194277602"
Evaluating: 128.065641*(0.194277602-0.5)
 Parameter: XPOS <- "-39.1525349"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.601607319"
Evaluating: 128.065641*(0.601607319-0.5)
 Parameter: YPOS <- "13.0124064"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.304042093"
Evaluating: 108.613069*(0.304042093-0.5)+-2.187274
 Parameter: ZPOS <- "-23.4708637"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.4708637" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.248517 XMAX =   24.248517 XAVE =   24.248517
    YMIN =  -29.365081 YMAX =  -29.365081 YAVE =  -29.365081
    ZMIN =  -19.613658 ZMAX =  -19.613658 ZAVE =  -19.613658
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.1525349"
 RDCMND substituted energy or value "?XAVE" to "24.2485173"
Evaluating: -39.1525349-24.2485173
 Parameter: XTRAN <- "-63.4010522"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.0124064"
 RDCMND substituted energy or value "?YAVE" to "-29.3650809"
Evaluating: 13.0124064--29.3650809
 Parameter: YTRAN <- "42.3774873"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.4708637"
 RDCMND substituted energy or value "?ZAVE" to "-19.6136585"
Evaluating: -23.4708637--19.6136585
 Parameter: ZTRAN <- "-3.8572052"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.4010522"
 Parameter: YTRAN -> "42.3774873"
 Parameter: ZTRAN -> "-3.8572052"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -63.401052   42.377487   -3.857205
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249008941"
Evaluating: 0.249008941*360.0
 Parameter: XPHI <- "89.6432188"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.707371671"
Evaluating: 0.707371671*360.0
 Parameter: YPHI <- "254.653802"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.253409599"
Evaluating: 0.253409599*360.0
 Parameter: ZPHI <- "91.2274556"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.1525349"
 Parameter: YPOS -> "13.0124064"
 Parameter: ZPOS -> "-23.4708637"
 Parameter: XPHI -> "89.6432188"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.006227    0.999981
    0.000000   -0.999981    0.006227

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   89.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.1525349"
 Parameter: YPOS -> "13.0124064"
 Parameter: ZPOS -> "-23.4708637"
 Parameter: YPHI -> "254.653802"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.264651    0.000000    0.964344
    0.000000    1.000000    0.000000
   -0.964344    0.000000   -0.264651

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.1525349"
 Parameter: YPOS -> "13.0124064"
 Parameter: ZPOS -> "-23.4708637"
 Parameter: ZPHI -> "91.2274556"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.021422    0.999771    0.000000
   -0.999771   -0.021422    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.152535 XMAX =  -39.152535 XAVE =  -39.152535
    YMIN =   13.012406 YMAX =   13.012406 YAVE =   13.012406
    ZMIN =  -23.470864 ZMAX =  -23.470864 ZAVE =  -23.470864
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.1525349"
Evaluating: -39.1525349+3.5
 Parameter: XMAX <- "-35.6525349"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.0124064"
Evaluating: 13.0124064+3.5
 Parameter: YMAX <- "16.5124064"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.4708637"
Evaluating: -23.4708637+3.5
 Parameter: ZMAX <- "-19.9708637"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.1525349"
Evaluating: -39.1525349-3.5
 Parameter: XMIN <- "-42.6525349"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.0124064"
Evaluating: 13.0124064-3.5
 Parameter: YMIN <- "9.5124064"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.4708637"
Evaluating: -23.4708637-3.5
 Parameter: ZMIN <- "-26.9708637"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.6525349"
 Parameter: XMIN -> "-42.6525349"
 Parameter: YMAX -> "16.5124064"
 Parameter: YMIN -> "9.5124064"
 Parameter: ZMAX -> "-19.9708637"
 Parameter: ZMIN -> "-26.9708637"
 SELRPN>     14 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      5 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60337 POS      POT      105      POT     -**** PROF     LEU      636      CD2           4.5400
60337 POS      POT      105      POT     -**** PROF     LEU      636      C             3.5848
60337 POS      POT      105      POT     -**** PROF     LEU      636      O             2.6822
60337 POS      POT      105      POT     -**** PROF     ARG      637      CD            5.0835
60337 POS      POT      105      POT     -**** PROF     ARG      637      NH2           3.3424
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "105" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.339370055"
Evaluating: 128.065641*(0.339370055-0.5)
 Parameter: XPOS <- "-20.5711769"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.435818606"
Evaluating: 128.065641*(0.435818606-0.5)
 Parameter: YPOS <- "-8.21943136"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.528906973"
Evaluating: 108.613069*(0.528906973-0.5)+-2.187274
 Parameter: ZPOS <- "0.952401053"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.952401053" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.952401053" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "105" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.935991801"
Evaluating: 128.065641*(0.935991801-0.5)
 Parameter: XPOS <- "55.8355695"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.489216789"
Evaluating: 128.065641*(0.489216789-0.5)
 Parameter: YPOS <- "-1.38095883"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.568331479"
Evaluating: 108.613069*(0.568331479-0.5)+-2.187274
 Parameter: ZPOS <- "5.23441764"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.23441764" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.23441764" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "105" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.521591846"
Evaluating: 128.065641*(0.521591846-0.5)
 Parameter: XPOS <- "2.7651736"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.789928515"
Evaluating: 128.065641*(0.789928515-0.5)
 Parameter: YPOS <- "37.1298811"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.750104669"
Evaluating: 108.613069*(0.750104669-0.5)+-2.187274
 Parameter: ZPOS <- "24.9773617"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.9773617" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.9773617" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.152535 XMAX =  -39.152535 XAVE =  -39.152535
    YMIN =   13.012406 YMAX =   13.012406 YAVE =   13.012406
    ZMIN =  -23.470864 ZMAX =  -23.470864 ZAVE =  -23.470864
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.7651736"
 RDCMND substituted energy or value "?XAVE" to "-39.1525349"
Evaluating: 2.7651736--39.1525349
 Parameter: XTRAN <- "41.9177085"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.1298811"
 RDCMND substituted energy or value "?YAVE" to "13.0124064"
Evaluating: 37.1298811-13.0124064
 Parameter: YTRAN <- "24.1174747"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.9773617"
 RDCMND substituted energy or value "?ZAVE" to "-23.4708637"
Evaluating: 24.9773617--23.4708637
 Parameter: ZTRAN <- "48.4482254"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.9177085"
 Parameter: YTRAN -> "24.1174747"
 Parameter: ZTRAN -> "48.4482254"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    41.917709   24.117475   48.448225
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.354859684"
Evaluating: 0.354859684*360.0
 Parameter: XPHI <- "127.749486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746593202"
Evaluating: 0.746593202*360.0
 Parameter: YPHI <- "268.773553"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571216284"
Evaluating: 0.571216284*360.0
 Parameter: ZPHI <- "205.637862"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.7651736"
 Parameter: YPOS -> "37.1298811"
 Parameter: ZPOS -> "24.9773617"
 Parameter: XPHI -> "127.749486"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.612210    0.790695
    0.000000   -0.790695   -0.612210

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.7651736"
 Parameter: YPOS -> "37.1298811"
 Parameter: ZPOS -> "24.9773617"
 Parameter: YPHI -> "268.773553"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.021404    0.000000    0.999771
    0.000000    1.000000    0.000000
   -0.999771    0.000000   -0.021404

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.7651736"
 Parameter: YPOS -> "37.1298811"
 Parameter: ZPOS -> "24.9773617"
 Parameter: ZPHI -> "205.637862"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.901547   -0.432682    0.000000
    0.432682   -0.901547    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.765174 XMAX =    2.765174 XAVE =    2.765174
    YMIN =   37.129881 YMAX =   37.129881 YAVE =   37.129881
    ZMIN =   24.977362 ZMAX =   24.977362 ZAVE =   24.977362
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.7651736"
Evaluating: 2.7651736+3.5
 Parameter: XMAX <- "6.2651736"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.1298811"
Evaluating: 37.1298811+3.5
 Parameter: YMAX <- "40.6298811"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.9773617"
Evaluating: 24.9773617+3.5
 Parameter: ZMAX <- "28.4773617"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.7651736"
Evaluating: 2.7651736-3.5
 Parameter: XMIN <- "-0.7348264"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.1298811"
Evaluating: 37.1298811-3.5
 Parameter: YMIN <- "33.6298811"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.9773617"
Evaluating: 24.9773617-3.5
 Parameter: ZMIN <- "21.4773617"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.2651736"
 Parameter: XMIN -> "-0.7348264"
 Parameter: YMAX -> "40.6298811"
 Parameter: YMIN -> "33.6298811"
 Parameter: ZMAX -> "28.4773617"
 Parameter: ZMIN -> "21.4773617"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "106" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "106" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.599465409"
Evaluating: 128.065641*(0.599465409-0.5)
 Parameter: XPOS <- "12.7381014"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.55311574"
Evaluating: 128.065641*(0.55311574-0.5)
 Parameter: YPOS <- "6.80230129"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.114357203"
Evaluating: 108.613069*(0.114357203-0.5)+-2.187274
 Parameter: ZPOS <- "-44.0731217"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.0731217" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.7381014"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.7381014-0
 Parameter: XTRAN <- "12.7381014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.80230129"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.80230129-0
 Parameter: YTRAN <- "6.80230129"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.0731217"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.0731217-0
 Parameter: ZTRAN <- "-44.0731217"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.7381014"
 Parameter: YTRAN -> "6.80230129"
 Parameter: ZTRAN -> "-44.0731217"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    12.738101    6.802301  -44.073122
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.562928459"
Evaluating: 0.562928459*360.0
 Parameter: XPHI <- "202.654245"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.528621149"
Evaluating: 0.528621149*360.0
 Parameter: YPHI <- "190.303614"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320316228"
Evaluating: 0.320316228*360.0
 Parameter: ZPHI <- "115.313842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.7381014"
 Parameter: YPOS -> "6.80230129"
 Parameter: ZPOS -> "-44.0731217"
 Parameter: XPHI -> "202.654245"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.922846   -0.385169
    0.000000    0.385169   -0.922846

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.7381014"
 Parameter: YPOS -> "6.80230129"
 Parameter: ZPOS -> "-44.0731217"
 Parameter: YPHI -> "190.303614"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.983874    0.000000    0.178864
    0.000000    1.000000    0.000000
   -0.178864    0.000000   -0.983874

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  169.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.7381014"
 Parameter: YPOS -> "6.80230129"
 Parameter: ZPOS -> "-44.0731217"
 Parameter: ZPHI -> "115.313842"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.427576    0.903979    0.000000
   -0.903979   -0.427576    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.738101 XMAX =   12.738101 XAVE =   12.738101
    YMIN =    6.802301 YMAX =    6.802301 YAVE =    6.802301
    ZMIN =  -44.073122 ZMAX =  -44.073122 ZAVE =  -44.073122
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.7381014"
Evaluating: 12.7381014+3.5
 Parameter: XMAX <- "16.2381014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.80230129"
Evaluating: 6.80230129+3.5
 Parameter: YMAX <- "10.3023013"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.0731217"
Evaluating: -44.0731217+3.5
 Parameter: ZMAX <- "-40.5731217"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.7381014"
Evaluating: 12.7381014-3.5
 Parameter: XMIN <- "9.2381014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.80230129"
Evaluating: 6.80230129-3.5
 Parameter: YMIN <- "3.30230129"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.0731217"
Evaluating: -44.0731217-3.5
 Parameter: ZMIN <- "-47.5731217"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.2381014"
 Parameter: XMIN -> "9.2381014"
 Parameter: YMAX -> "10.3023013"
 Parameter: YMIN -> "3.30230129"
 Parameter: ZMAX -> "-40.5731217"
 Parameter: ZMIN -> "-47.5731217"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "107" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "107" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.55605382"
Evaluating: 128.065641*(0.55605382-0.5)
 Parameter: XPOS <- "7.17856839"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.657938492"
Evaluating: 128.065641*(0.657938492-0.5)
 Parameter: YPOS <- "20.2264942"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.451478051"
Evaluating: 108.613069*(0.451478051-0.5)+-2.187274
 Parameter: ZPOS <- "-7.45739179"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.45739179" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.45739179" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "107" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.772934505"
Evaluating: 128.065641*(0.772934505-0.5)
 Parameter: XPOS <- "34.9535323"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.641362255"
Evaluating: 128.065641*(0.641362255-0.5)
 Parameter: YPOS <- "18.1036478"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.968213698"
Evaluating: 108.613069*(0.968213698-0.5)+-2.187274
 Parameter: ZPOS <- "48.6668527"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.6668527" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.6668527" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.9535323"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.9535323-0
 Parameter: XTRAN <- "34.9535323"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.1036478"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.1036478-0
 Parameter: YTRAN <- "18.1036478"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.6668527"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.6668527-0
 Parameter: ZTRAN <- "48.6668527"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.9535323"
 Parameter: YTRAN -> "18.1036478"
 Parameter: ZTRAN -> "48.6668527"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    34.953532   18.103648   48.666853
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.901069197"
Evaluating: 0.901069197*360.0
 Parameter: XPHI <- "324.384911"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.677118775"
Evaluating: 0.677118775*360.0
 Parameter: YPHI <- "243.762759"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.234253639"
Evaluating: 0.234253639*360.0
 Parameter: ZPHI <- "84.33131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.9535323"
 Parameter: YPOS -> "18.1036478"
 Parameter: ZPOS -> "48.6668527"
 Parameter: XPHI -> "324.384911"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.812947   -0.582337
    0.000000    0.582337    0.812947

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   35.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.9535323"
 Parameter: YPOS -> "18.1036478"
 Parameter: ZPOS -> "48.6668527"
 Parameter: YPHI -> "243.762759"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.442089    0.000000    0.896971
    0.000000    1.000000    0.000000
   -0.896971    0.000000   -0.442089

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.9535323"
 Parameter: YPOS -> "18.1036478"
 Parameter: ZPOS -> "48.6668527"
 Parameter: ZPHI -> "84.33131"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.098776    0.995110    0.000000
   -0.995110    0.098776    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.953532 XMAX =   34.953532 XAVE =   34.953532
    YMIN =   18.103648 YMAX =   18.103648 YAVE =   18.103648
    ZMIN =   48.666853 ZMAX =   48.666853 ZAVE =   48.666853
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.9535323"
Evaluating: 34.9535323+3.5
 Parameter: XMAX <- "38.4535323"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.1036478"
Evaluating: 18.1036478+3.5
 Parameter: YMAX <- "21.6036478"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.6668527"
Evaluating: 48.6668527+3.5
 Parameter: ZMAX <- "52.1668527"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.9535323"
Evaluating: 34.9535323-3.5
 Parameter: XMIN <- "31.4535323"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.1036478"
Evaluating: 18.1036478-3.5
 Parameter: YMIN <- "14.6036478"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.6668527"
Evaluating: 48.6668527-3.5
 Parameter: ZMIN <- "45.1668527"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.4535323"
 Parameter: XMIN -> "31.4535323"
 Parameter: YMAX -> "21.6036478"
 Parameter: YMIN -> "14.6036478"
 Parameter: ZMAX -> "52.1668527"
 Parameter: ZMIN -> "45.1668527"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "108" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "108" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.317536898"
Evaluating: 128.065641*(0.317536898-0.5)
 Parameter: XPOS <- "-23.3672541"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.968602163"
Evaluating: 128.065641*(0.968602163-0.5)
 Parameter: YPOS <- "60.0118364"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.119026657"
Evaluating: 108.613069*(0.119026657-0.5)+-2.187274
 Parameter: ZPOS <- "-43.565958"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.565958" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.3672541"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.3672541-0
 Parameter: XTRAN <- "-23.3672541"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "60.0118364"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 60.0118364-0
 Parameter: YTRAN <- "60.0118364"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.565958"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.565958-0
 Parameter: ZTRAN <- "-43.565958"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.3672541"
 Parameter: YTRAN -> "60.0118364"
 Parameter: ZTRAN -> "-43.565958"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -23.367254   60.011836  -43.565958
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.560356988E-02"
Evaluating: 1.560356988E-02*360.0
 Parameter: XPHI <- "5.61728516"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.558718119"
Evaluating: 0.558718119*360.0
 Parameter: YPHI <- "201.138523"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.408178693"
Evaluating: 0.408178693*360.0
 Parameter: ZPHI <- "146.944329"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.3672541"
 Parameter: YPOS -> "60.0118364"
 Parameter: ZPOS -> "-43.565958"
 Parameter: XPHI -> "5.61728516"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995198    0.097883
    0.000000   -0.097883    0.995198

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.3672541"
 Parameter: YPOS -> "60.0118364"
 Parameter: ZPOS -> "-43.565958"
 Parameter: YPHI -> "201.138523"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.932711    0.000000    0.360624
    0.000000    1.000000    0.000000
   -0.360624    0.000000   -0.932711

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  158.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.3672541"
 Parameter: YPOS -> "60.0118364"
 Parameter: ZPOS -> "-43.565958"
 Parameter: ZPHI -> "146.944329"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.838141    0.545454    0.000000
   -0.545454   -0.838141    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.367254 XMAX =  -23.367254 XAVE =  -23.367254
    YMIN =   60.011836 YMAX =   60.011836 YAVE =   60.011836
    ZMIN =  -43.565958 ZMAX =  -43.565958 ZAVE =  -43.565958
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.3672541"
Evaluating: -23.3672541+3.5
 Parameter: XMAX <- "-19.8672541"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "60.0118364"
Evaluating: 60.0118364+3.5
 Parameter: YMAX <- "63.5118364"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.565958"
Evaluating: -43.565958+3.5
 Parameter: ZMAX <- "-40.065958"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.3672541"
Evaluating: -23.3672541-3.5
 Parameter: XMIN <- "-26.8672541"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "60.0118364"
Evaluating: 60.0118364-3.5
 Parameter: YMIN <- "56.5118364"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.565958"
Evaluating: -43.565958-3.5
 Parameter: ZMIN <- "-47.065958"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.8672541"
 Parameter: XMIN -> "-26.8672541"
 Parameter: YMAX -> "63.5118364"
 Parameter: YMIN -> "56.5118364"
 Parameter: ZMAX -> "-40.065958"
 Parameter: ZMIN -> "-47.065958"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "109" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "109" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.260198769"
Evaluating: 128.065641*(0.260198769-0.5)
 Parameter: XPOS <- "-30.7102984"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.405162321"
Evaluating: 128.065641*(0.405162321-0.5)
 Parameter: YPOS <- "-12.1454482"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.442958766"
Evaluating: 108.613069*(0.442958766-0.5)+-2.187274
 Parameter: ZPOS <- "-8.38269748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.38269748" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.38269748" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "109" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.216799605"
Evaluating: 128.065641*(0.216799605-0.5)
 Parameter: XPOS <- "-36.2682401"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.592765242"
Evaluating: 128.065641*(0.592765242-0.5)
 Parameter: YPOS <- "11.8800402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.879055061"
Evaluating: 108.613069*(0.879055061-0.5)+-2.187274
 Parameter: ZPOS <- "38.9830595"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.9830595" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.9830595" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.2682401"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.2682401-0
 Parameter: XTRAN <- "-36.2682401"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.8800402"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.8800402-0
 Parameter: YTRAN <- "11.8800402"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.9830595"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.9830595-0
 Parameter: ZTRAN <- "38.9830595"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.2682401"
 Parameter: YTRAN -> "11.8800402"
 Parameter: ZTRAN -> "38.9830595"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -36.268240   11.880040   38.983060
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84137279"
Evaluating: 0.84137279*360.0
 Parameter: XPHI <- "302.894204"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697635782"
Evaluating: 0.697635782*360.0
 Parameter: YPHI <- "251.148882"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.547777092E-02"
Evaluating: 3.547777092E-02*360.0
 Parameter: ZPHI <- "12.7719975"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.2682401"
 Parameter: YPOS -> "11.8800402"
 Parameter: ZPOS -> "38.9830595"
 Parameter: XPHI -> "302.894204"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.543090   -0.839675
    0.000000    0.839675    0.543090

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.2682401"
 Parameter: YPOS -> "11.8800402"
 Parameter: ZPOS -> "38.9830595"
 Parameter: YPHI -> "251.148882"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.323110    0.000000    0.946361
    0.000000    1.000000    0.000000
   -0.946361    0.000000   -0.323110

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.2682401"
 Parameter: YPOS -> "11.8800402"
 Parameter: ZPOS -> "38.9830595"
 Parameter: ZPHI -> "12.7719975"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.975258    0.221072    0.000000
   -0.221072    0.975258    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.268240 XMAX =  -36.268240 XAVE =  -36.268240
    YMIN =   11.880040 YMAX =   11.880040 YAVE =   11.880040
    ZMIN =   38.983060 ZMAX =   38.983060 ZAVE =   38.983060
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.2682401"
Evaluating: -36.2682401+3.5
 Parameter: XMAX <- "-32.7682401"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.8800402"
Evaluating: 11.8800402+3.5
 Parameter: YMAX <- "15.3800402"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.9830595"
Evaluating: 38.9830595+3.5
 Parameter: ZMAX <- "42.4830595"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.2682401"
Evaluating: -36.2682401-3.5
 Parameter: XMIN <- "-39.7682401"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.8800402"
Evaluating: 11.8800402-3.5
 Parameter: YMIN <- "8.3800402"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.9830595"
Evaluating: 38.9830595-3.5
 Parameter: ZMIN <- "35.4830595"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.7682401"
 Parameter: XMIN -> "-39.7682401"
 Parameter: YMAX -> "15.3800402"
 Parameter: YMIN -> "8.3800402"
 Parameter: ZMAX -> "42.4830595"
 Parameter: ZMIN -> "35.4830595"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "110" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "110" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.81317987"
Evaluating: 128.065641*(0.81317987-0.5)
 Parameter: XPOS <- "40.1075808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.55080736"
Evaluating: 128.065641*(0.55080736-0.5)
 Parameter: YPOS <- "6.50667713"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.436216783"
Evaluating: 108.613069*(0.436216783-0.5)+-2.187274
 Parameter: ZPOS <- "-9.11496495"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.11496495" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.11496495" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "110" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.190765475"
Evaluating: 128.065641*(0.190765475-0.5)
 Parameter: XPOS <- "-39.6023177"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.450684849"
Evaluating: 128.065641*(0.450684849-0.5)
 Parameter: YPOS <- "-6.31557642"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.506207966"
Evaluating: 108.613069*(0.506207966-0.5)+-2.187274
 Parameter: ZPOS <- "-1.51300776"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.51300776" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.51300776" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "110" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.579324326"
Evaluating: 128.065641*(0.579324326-0.5)
 Parameter: XPOS <- "10.1587207"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.947424967"
Evaluating: 128.065641*(0.947424967-0.5)
 Parameter: YPOS <- "57.2997652"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "5.96901993E-02"
Evaluating: 108.613069*(5.96901993E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-50.0106728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.0106728" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.1587207"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.1587207-0
 Parameter: XTRAN <- "10.1587207"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.2997652"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.2997652-0
 Parameter: YTRAN <- "57.2997652"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.0106728"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.0106728-0
 Parameter: ZTRAN <- "-50.0106728"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.1587207"
 Parameter: YTRAN -> "57.2997652"
 Parameter: ZTRAN -> "-50.0106728"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    10.158721   57.299765  -50.010673
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349508783"
Evaluating: 0.349508783*360.0
 Parameter: XPHI <- "125.823162"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.535357546"
Evaluating: 0.535357546*360.0
 Parameter: YPHI <- "192.728717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607301264"
Evaluating: 0.607301264*360.0
 Parameter: ZPHI <- "218.628455"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.1587207"
 Parameter: YPOS -> "57.2997652"
 Parameter: ZPOS -> "-50.0106728"
 Parameter: XPHI -> "125.823162"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.585286    0.810827
    0.000000   -0.810827   -0.585286

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  125.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.1587207"
 Parameter: YPOS -> "57.2997652"
 Parameter: ZPOS -> "-50.0106728"
 Parameter: YPHI -> "192.728717"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.975424    0.000000    0.220335
    0.000000    1.000000    0.000000
   -0.220335    0.000000   -0.975424

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.1587207"
 Parameter: YPOS -> "57.2997652"
 Parameter: ZPOS -> "-50.0106728"
 Parameter: ZPHI -> "218.628455"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.781211   -0.624268    0.000000
    0.624268   -0.781211    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.158721 XMAX =   10.158721 XAVE =   10.158721
    YMIN =   57.299765 YMAX =   57.299765 YAVE =   57.299765
    ZMIN =  -50.010673 ZMAX =  -50.010673 ZAVE =  -50.010673
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.1587207"
Evaluating: 10.1587207+3.5
 Parameter: XMAX <- "13.6587207"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.2997652"
Evaluating: 57.2997652+3.5
 Parameter: YMAX <- "60.7997652"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.0106728"
Evaluating: -50.0106728+3.5
 Parameter: ZMAX <- "-46.5106728"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.1587207"
Evaluating: 10.1587207-3.5
 Parameter: XMIN <- "6.6587207"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.2997652"
Evaluating: 57.2997652-3.5
 Parameter: YMIN <- "53.7997652"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.0106728"
Evaluating: -50.0106728-3.5
 Parameter: ZMIN <- "-53.5106728"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.6587207"
 Parameter: XMIN -> "6.6587207"
 Parameter: YMAX -> "60.7997652"
 Parameter: YMIN -> "53.7997652"
 Parameter: ZMAX -> "-46.5106728"
 Parameter: ZMIN -> "-53.5106728"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "111" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "111" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.641192239"
Evaluating: 128.065641*(0.641192239-0.5)
 Parameter: XPOS <- "18.0818746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.349721762"
Evaluating: 128.065641*(0.349721762-0.5)
 Parameter: YPOS <- "-19.2454789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.161779058"
Evaluating: 108.613069*(0.161779058-0.5)+-2.187274
 Parameter: ZPOS <- "-38.9224885"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.9224885" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.0818746"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.0818746-0
 Parameter: XTRAN <- "18.0818746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.2454789"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.2454789-0
 Parameter: YTRAN <- "-19.2454789"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.9224885"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.9224885-0
 Parameter: ZTRAN <- "-38.9224885"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.0818746"
 Parameter: YTRAN -> "-19.2454789"
 Parameter: ZTRAN -> "-38.9224885"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    18.081875  -19.245479  -38.922489
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908134083"
Evaluating: 0.908134083*360.0
 Parameter: XPHI <- "326.92827"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863454405"
Evaluating: 0.863454405*360.0
 Parameter: YPHI <- "310.843586"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.69354916"
Evaluating: 0.69354916*360.0
 Parameter: ZPHI <- "249.677698"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.0818746"
 Parameter: YPOS -> "-19.2454789"
 Parameter: ZPOS -> "-38.9224885"
 Parameter: XPHI -> "326.92827"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.837988   -0.545689
    0.000000    0.545689    0.837988

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.0818746"
 Parameter: YPOS -> "-19.2454789"
 Parameter: ZPOS -> "-38.9224885"
 Parameter: YPHI -> "310.843586"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.653996    0.000000    0.756498
    0.000000    1.000000    0.000000
   -0.756498    0.000000    0.653996

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   49.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.0818746"
 Parameter: YPOS -> "-19.2454789"
 Parameter: ZPOS -> "-38.9224885"
 Parameter: ZPHI -> "249.677698"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.347301   -0.937754    0.000000
    0.937754   -0.347301    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.081875 XMAX =   18.081875 XAVE =   18.081875
    YMIN =  -19.245479 YMAX =  -19.245479 YAVE =  -19.245479
    ZMIN =  -38.922489 ZMAX =  -38.922489 ZAVE =  -38.922489
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.0818746"
Evaluating: 18.0818746+3.5
 Parameter: XMAX <- "21.5818746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.2454789"
Evaluating: -19.2454789+3.5
 Parameter: YMAX <- "-15.7454789"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.9224885"
Evaluating: -38.9224885+3.5
 Parameter: ZMAX <- "-35.4224885"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.0818746"
Evaluating: 18.0818746-3.5
 Parameter: XMIN <- "14.5818746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.2454789"
Evaluating: -19.2454789-3.5
 Parameter: YMIN <- "-22.7454789"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.9224885"
Evaluating: -38.9224885-3.5
 Parameter: ZMIN <- "-42.4224885"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.5818746"
 Parameter: XMIN -> "14.5818746"
 Parameter: YMAX -> "-15.7454789"
 Parameter: YMIN -> "-22.7454789"
 Parameter: ZMAX -> "-35.4224885"
 Parameter: ZMIN -> "-42.4224885"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "112" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "112" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.946684076"
Evaluating: 128.065641*(0.946684076-0.5)
 Parameter: XPOS <- "57.2048825"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.668570302"
Evaluating: 128.065641*(0.668570302-0.5)
 Parameter: YPOS <- "21.5880638"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.320894668E-02"
Evaluating: 108.613069*(4.320894668E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.8007522"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.8007522" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "57.2048825"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 57.2048825-0
 Parameter: XTRAN <- "57.2048825"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.5880638"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.5880638-0
 Parameter: YTRAN <- "21.5880638"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.8007522"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.8007522-0
 Parameter: ZTRAN <- "-51.8007522"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "57.2048825"
 Parameter: YTRAN -> "21.5880638"
 Parameter: ZTRAN -> "-51.8007522"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    57.204882   21.588064  -51.800752
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.358900791"
Evaluating: 0.358900791*360.0
 Parameter: XPHI <- "129.204285"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.583998737"
Evaluating: 0.583998737*360.0
 Parameter: YPHI <- "210.239545"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722520668"
Evaluating: 0.722520668*360.0
 Parameter: ZPHI <- "260.10744"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "57.2048825"
 Parameter: YPOS -> "21.5880638"
 Parameter: ZPOS -> "-51.8007522"
 Parameter: XPHI -> "129.204285"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.632087    0.774897
    0.000000   -0.774897   -0.632087

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "57.2048825"
 Parameter: YPOS -> "21.5880638"
 Parameter: ZPOS -> "-51.8007522"
 Parameter: YPHI -> "210.239545"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.863927    0.000000    0.503616
    0.000000    1.000000    0.000000
   -0.503616    0.000000   -0.863927

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  149.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "57.2048825"
 Parameter: YPOS -> "21.5880638"
 Parameter: ZPOS -> "-51.8007522"
 Parameter: ZPHI -> "260.10744"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.171801   -0.985132    0.000000
    0.985132   -0.171801    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   57.204882 XMAX =   57.204882 XAVE =   57.204882
    YMIN =   21.588064 YMAX =   21.588064 YAVE =   21.588064
    ZMIN =  -51.800752 ZMAX =  -51.800752 ZAVE =  -51.800752
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "57.2048825"
Evaluating: 57.2048825+3.5
 Parameter: XMAX <- "60.7048825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.5880638"
Evaluating: 21.5880638+3.5
 Parameter: YMAX <- "25.0880638"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.8007522"
Evaluating: -51.8007522+3.5
 Parameter: ZMAX <- "-48.3007522"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "57.2048825"
Evaluating: 57.2048825-3.5
 Parameter: XMIN <- "53.7048825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.5880638"
Evaluating: 21.5880638-3.5
 Parameter: YMIN <- "18.0880638"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.8007522"
Evaluating: -51.8007522-3.5
 Parameter: ZMIN <- "-55.3007522"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.7048825"
 Parameter: XMIN -> "53.7048825"
 Parameter: YMAX -> "25.0880638"
 Parameter: YMIN -> "18.0880638"
 Parameter: ZMAX -> "-48.3007522"
 Parameter: ZMIN -> "-55.3007522"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "113" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "113" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "113"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.592357969"
Evaluating: 128.065641*(0.592357969-0.5)
 Parameter: XPOS <- "11.8278825"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.925666669"
Evaluating: 128.065641*(0.925666669-0.5)
 Parameter: YPOS <- "54.5132748"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "1.685028897E-02"
Evaluating: 108.613069*(1.685028897E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-54.6636469"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.6636469" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.8278825"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.8278825-0
 Parameter: XTRAN <- "11.8278825"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.5132748"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 54.5132748-0
 Parameter: YTRAN <- "54.5132748"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.6636469"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.6636469-0
 Parameter: ZTRAN <- "-54.6636469"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.8278825"
 Parameter: YTRAN -> "54.5132748"
 Parameter: ZTRAN -> "-54.6636469"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    11.827882   54.513275  -54.663647
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.040084064E-02"
Evaluating: 4.040084064E-02*360.0
 Parameter: XPHI <- "14.5443026"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.493203832"
Evaluating: 0.493203832*360.0
 Parameter: YPHI <- "177.55338"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992260998"
Evaluating: 0.992260998*360.0
 Parameter: ZPHI <- "357.213959"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.8278825"
 Parameter: YPOS -> "54.5132748"
 Parameter: ZPOS -> "-54.6636469"
 Parameter: XPHI -> "14.5443026"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.967954    0.251129
    0.000000   -0.251129    0.967954

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.8278825"
 Parameter: YPOS -> "54.5132748"
 Parameter: ZPOS -> "-54.6636469"
 Parameter: YPHI -> "177.55338"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999088    0.000000   -0.042689
    0.000000    1.000000    0.000000
    0.042689    0.000000   -0.999088

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.8278825"
 Parameter: YPOS -> "54.5132748"
 Parameter: ZPOS -> "-54.6636469"
 Parameter: ZPHI -> "357.213959"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.998818   -0.048606    0.000000
    0.048606    0.998818    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.827882 XMAX =   11.827882 XAVE =   11.827882
    YMIN =   54.513275 YMAX =   54.513275 YAVE =   54.513275
    ZMIN =  -54.663647 ZMAX =  -54.663647 ZAVE =  -54.663647
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.8278825"
Evaluating: 11.8278825+3.5
 Parameter: XMAX <- "15.3278825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.5132748"
Evaluating: 54.5132748+3.5
 Parameter: YMAX <- "58.0132748"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.6636469"
Evaluating: -54.6636469+3.5
 Parameter: ZMAX <- "-51.1636469"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.8278825"
Evaluating: 11.8278825-3.5
 Parameter: XMIN <- "8.3278825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.5132748"
Evaluating: 54.5132748-3.5
 Parameter: YMIN <- "51.0132748"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.6636469"
Evaluating: -54.6636469-3.5
 Parameter: ZMIN <- "-58.1636469"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.3278825"
 Parameter: XMIN -> "8.3278825"
 Parameter: YMAX -> "58.0132748"
 Parameter: YMIN -> "51.0132748"
 Parameter: ZMAX -> "-51.1636469"
 Parameter: ZMIN -> "-58.1636469"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "114" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "114" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.391172478"
Evaluating: 128.065641*(0.391172478-0.5)
 Parameter: XPOS <- "-13.9370664"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.54657206"
Evaluating: 128.065641*(0.54657206-0.5)
 Parameter: YPOS <- "5.96428072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.302727287"
Evaluating: 108.613069*(0.302727287-0.5)+-2.187274
 Parameter: ZPOS <- "-23.6136688"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.6136688" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.9370664"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.9370664-0
 Parameter: XTRAN <- "-13.9370664"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.96428072"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.96428072-0
 Parameter: YTRAN <- "5.96428072"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.6136688"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.6136688-0
 Parameter: ZTRAN <- "-23.6136688"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.9370664"
 Parameter: YTRAN -> "5.96428072"
 Parameter: ZTRAN -> "-23.6136688"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -13.937066    5.964281  -23.613669
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318808887"
Evaluating: 0.318808887*360.0
 Parameter: XPHI <- "114.771199"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420446225"
Evaluating: 0.420446225*360.0
 Parameter: YPHI <- "151.360641"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132959847"
Evaluating: 0.132959847*360.0
 Parameter: ZPHI <- "47.8655449"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.9370664"
 Parameter: YPOS -> "5.96428072"
 Parameter: ZPOS -> "-23.6136688"
 Parameter: XPHI -> "114.771199"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.418996    0.907988
    0.000000   -0.907988   -0.418996

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.9370664"
 Parameter: YPOS -> "5.96428072"
 Parameter: ZPOS -> "-23.6136688"
 Parameter: YPHI -> "151.360641"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.877654    0.000000   -0.479295
    0.000000    1.000000    0.000000
    0.479295    0.000000   -0.877654

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.9370664"
 Parameter: YPOS -> "5.96428072"
 Parameter: ZPOS -> "-23.6136688"
 Parameter: ZPHI -> "47.8655449"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.670873    0.741573    0.000000
   -0.741573    0.670873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.937066 XMAX =  -13.937066 XAVE =  -13.937066
    YMIN =    5.964281 YMAX =    5.964281 YAVE =    5.964281
    ZMIN =  -23.613669 ZMAX =  -23.613669 ZAVE =  -23.613669
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.9370664"
Evaluating: -13.9370664+3.5
 Parameter: XMAX <- "-10.4370664"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.96428072"
Evaluating: 5.96428072+3.5
 Parameter: YMAX <- "9.46428072"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.6136688"
Evaluating: -23.6136688+3.5
 Parameter: ZMAX <- "-20.1136688"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.9370664"
Evaluating: -13.9370664-3.5
 Parameter: XMIN <- "-17.4370664"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.96428072"
Evaluating: 5.96428072-3.5
 Parameter: YMIN <- "2.46428072"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.6136688"
Evaluating: -23.6136688-3.5
 Parameter: ZMIN <- "-27.1136688"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.4370664"
 Parameter: XMIN -> "-17.4370664"
 Parameter: YMAX -> "9.46428072"
 Parameter: YMIN -> "2.46428072"
 Parameter: ZMAX -> "-20.1136688"
 Parameter: ZMIN -> "-27.1136688"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "115" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "115" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.076362379E-03"
Evaluating: 128.065641*(7.076362379E-03-0.5)
 Parameter: XPOS <- "-63.1265816"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.652655801"
Evaluating: 128.065641*(0.652655801-0.5)
 Parameter: YPOS <- "19.549963"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.658631679"
Evaluating: 108.613069*(0.658631679-0.5)+-2.187274
 Parameter: ZPOS <- "15.0421995"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.0421995" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.0421995" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-63.1265816"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -63.1265816-0
 Parameter: XTRAN <- "-63.1265816"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.549963"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.549963-0
 Parameter: YTRAN <- "19.549963"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.0421995"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.0421995-0
 Parameter: ZTRAN <- "15.0421995"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.1265816"
 Parameter: YTRAN -> "19.549963"
 Parameter: ZTRAN -> "15.0421995"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -63.126582   19.549963   15.042200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455040462"
Evaluating: 0.455040462*360.0
 Parameter: XPHI <- "163.814566"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660366411"
Evaluating: 0.660366411*360.0
 Parameter: YPHI <- "237.731908"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299012308"
Evaluating: 0.299012308*360.0
 Parameter: ZPHI <- "107.644431"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-63.1265816"
 Parameter: YPOS -> "19.549963"
 Parameter: ZPOS -> "15.0421995"
 Parameter: XPHI -> "163.814566"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.960365    0.278747
    0.000000   -0.278747   -0.960365

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-63.1265816"
 Parameter: YPOS -> "19.549963"
 Parameter: ZPOS -> "15.0421995"
 Parameter: YPHI -> "237.731908"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.533882    0.000000    0.845559
    0.000000    1.000000    0.000000
   -0.845559    0.000000   -0.533882

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-63.1265816"
 Parameter: YPOS -> "19.549963"
 Parameter: ZPOS -> "15.0421995"
 Parameter: ZPHI -> "107.644431"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.303109    0.952956    0.000000
   -0.952956   -0.303109    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -63.126582 XMAX =  -63.126582 XAVE =  -63.126582
    YMIN =   19.549963 YMAX =   19.549963 YAVE =   19.549963
    ZMIN =   15.042200 ZMAX =   15.042200 ZAVE =   15.042200
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-63.1265816"
Evaluating: -63.1265816+3.5
 Parameter: XMAX <- "-59.6265816"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.549963"
Evaluating: 19.549963+3.5
 Parameter: YMAX <- "23.049963"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.0421995"
Evaluating: 15.0421995+3.5
 Parameter: ZMAX <- "18.5421995"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-63.1265816"
Evaluating: -63.1265816-3.5
 Parameter: XMIN <- "-66.6265816"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.549963"
Evaluating: 19.549963-3.5
 Parameter: YMIN <- "16.049963"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.0421995"
Evaluating: 15.0421995-3.5
 Parameter: ZMIN <- "11.5421995"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-59.6265816"
 Parameter: XMIN -> "-66.6265816"
 Parameter: YMAX -> "23.049963"
 Parameter: YMIN -> "16.049963"
 Parameter: ZMAX -> "18.5421995"
 Parameter: ZMIN -> "11.5421995"
 SELRPN>      8 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      4 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60347 POS      POT      115      POT     -**** MEMB     DMPC     127      C21           3.7080
60347 POS      POT      115      POT     -**** MEMB     DMPC     127      C22           3.0366
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "115" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.773554195"
Evaluating: 128.065641*(0.773554195-0.5)
 Parameter: XPOS <- "35.0328933"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "2.334027171E-02"
Evaluating: 128.065641*(2.334027171E-02-0.5)
 Parameter: YPOS <- "-61.0437336"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.441440024"
Evaluating: 108.613069*(0.441440024-0.5)+-2.187274
 Parameter: ZPOS <- "-8.54765271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.54765271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.54765271" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "115" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.3597435"
Evaluating: 128.065641*(0.3597435-0.5)
 Parameter: XPOS <- "-17.9620386"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.472976085E-02"
Evaluating: 128.065641*(9.472976085E-02-0.5)
 Parameter: YPOS <- "-51.901193"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.110691835"
Evaluating: 108.613069*(0.110691835-0.5)+-2.187274
 Parameter: ZPOS <- "-44.4712286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.4712286" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -63.126582 XMAX =  -63.126582 XAVE =  -63.126582
    YMIN =   19.549963 YMAX =   19.549963 YAVE =   19.549963
    ZMIN =   15.042200 ZMAX =   15.042200 ZAVE =   15.042200
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.9620386"
 RDCMND substituted energy or value "?XAVE" to "-63.1265816"
Evaluating: -17.9620386--63.1265816
 Parameter: XTRAN <- "45.164543"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.901193"
 RDCMND substituted energy or value "?YAVE" to "19.549963"
Evaluating: -51.901193-19.549963
 Parameter: YTRAN <- "-71.451156"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.4712286"
 RDCMND substituted energy or value "?ZAVE" to "15.0421995"
Evaluating: -44.4712286-15.0421995
 Parameter: ZTRAN <- "-59.5134281"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.164543"
 Parameter: YTRAN -> "-71.451156"
 Parameter: ZTRAN -> "-59.5134281"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    45.164543  -71.451156  -59.513428
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412133609"
Evaluating: 0.412133609*360.0
 Parameter: XPHI <- "148.368099"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60805286"
Evaluating: 0.60805286*360.0
 Parameter: YPHI <- "218.89903"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60341497"
Evaluating: 0.60341497*360.0
 Parameter: ZPHI <- "217.229389"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.9620386"
 Parameter: YPOS -> "-51.901193"
 Parameter: ZPOS -> "-44.4712286"
 Parameter: XPHI -> "148.368099"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.851435    0.524460
    0.000000   -0.524460   -0.851435

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.9620386"
 Parameter: YPOS -> "-51.901193"
 Parameter: ZPOS -> "-44.4712286"
 Parameter: YPHI -> "218.89903"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.778254    0.000000    0.627950
    0.000000    1.000000    0.000000
   -0.627950    0.000000   -0.778254

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.9620386"
 Parameter: YPOS -> "-51.901193"
 Parameter: ZPOS -> "-44.4712286"
 Parameter: ZPHI -> "217.229389"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.796220   -0.605008    0.000000
    0.605008   -0.796220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.962039 XMAX =  -17.962039 XAVE =  -17.962039
    YMIN =  -51.901193 YMAX =  -51.901193 YAVE =  -51.901193
    ZMIN =  -44.471229 ZMAX =  -44.471229 ZAVE =  -44.471229
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.9620386"
Evaluating: -17.9620386+3.5
 Parameter: XMAX <- "-14.4620386"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.901193"
Evaluating: -51.901193+3.5
 Parameter: YMAX <- "-48.401193"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.4712286"
Evaluating: -44.4712286+3.5
 Parameter: ZMAX <- "-40.9712286"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.9620386"
Evaluating: -17.9620386-3.5
 Parameter: XMIN <- "-21.4620386"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.901193"
Evaluating: -51.901193-3.5
 Parameter: YMIN <- "-55.401193"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.4712286"
Evaluating: -44.4712286-3.5
 Parameter: ZMIN <- "-47.9712286"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.4620386"
 Parameter: XMIN -> "-21.4620386"
 Parameter: YMAX -> "-48.401193"
 Parameter: YMIN -> "-55.401193"
 Parameter: ZMAX -> "-40.9712286"
 Parameter: ZMIN -> "-47.9712286"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "116" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "116" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "116"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.942256052"
Evaluating: 128.065641*(0.942256052-0.5)
 Parameter: XPOS <- "56.6378048"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.166069906"
Evaluating: 128.065641*(0.166069906-0.5)
 Parameter: YPOS <- "-42.7649715"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "5.94297926E-02"
Evaluating: 108.613069*(5.94297926E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-50.0389563"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.0389563" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "56.6378048"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 56.6378048-0
 Parameter: XTRAN <- "56.6378048"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.7649715"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.7649715-0
 Parameter: YTRAN <- "-42.7649715"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.0389563"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.0389563-0
 Parameter: ZTRAN <- "-50.0389563"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "56.6378048"
 Parameter: YTRAN -> "-42.7649715"
 Parameter: ZTRAN -> "-50.0389563"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    56.637805  -42.764972  -50.038956
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.680708563"
Evaluating: 0.680708563*360.0
 Parameter: XPHI <- "245.055083"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623290937"
Evaluating: 0.623290937*360.0
 Parameter: YPHI <- "224.384737"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.167895298"
Evaluating: 0.167895298*360.0
 Parameter: ZPHI <- "60.4423073"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "56.6378048"
 Parameter: YPOS -> "-42.7649715"
 Parameter: ZPOS -> "-50.0389563"
 Parameter: XPHI -> "245.055083"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.421747   -0.906714
    0.000000    0.906714   -0.421747

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "56.6378048"
 Parameter: YPOS -> "-42.7649715"
 Parameter: ZPOS -> "-50.0389563"
 Parameter: YPHI -> "224.384737"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.714659    0.000000    0.699473
    0.000000    1.000000    0.000000
   -0.699473    0.000000   -0.714659

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "56.6378048"
 Parameter: YPOS -> "-42.7649715"
 Parameter: ZPOS -> "-50.0389563"
 Parameter: ZPHI -> "60.4423073"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.493300    0.869859    0.000000
   -0.869859    0.493300    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.637805 XMAX =   56.637805 XAVE =   56.637805
    YMIN =  -42.764972 YMAX =  -42.764972 YAVE =  -42.764972
    ZMIN =  -50.038956 ZMAX =  -50.038956 ZAVE =  -50.038956
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "56.6378048"
Evaluating: 56.6378048+3.5
 Parameter: XMAX <- "60.1378048"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.7649715"
Evaluating: -42.7649715+3.5
 Parameter: YMAX <- "-39.2649715"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.0389563"
Evaluating: -50.0389563+3.5
 Parameter: ZMAX <- "-46.5389563"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "56.6378048"
Evaluating: 56.6378048-3.5
 Parameter: XMIN <- "53.1378048"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.7649715"
Evaluating: -42.7649715-3.5
 Parameter: YMIN <- "-46.2649715"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.0389563"
Evaluating: -50.0389563-3.5
 Parameter: ZMIN <- "-53.5389563"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.1378048"
 Parameter: XMIN -> "53.1378048"
 Parameter: YMAX -> "-39.2649715"
 Parameter: YMIN -> "-46.2649715"
 Parameter: ZMAX -> "-46.5389563"
 Parameter: ZMIN -> "-53.5389563"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "117" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "117" and "117".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.907892497"
Evaluating: 128.065641*(0.907892497-0.5)
 Parameter: XPOS <- "52.2370141"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.145668503"
Evaluating: 128.065641*(0.145668503-0.5)
 Parameter: YPOS <- "-45.3776903"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.121768348"
Evaluating: 108.613069*(0.121768348-0.5)+-2.187274
 Parameter: ZPOS <- "-43.2681745"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.2681745" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.2370141"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.2370141-0
 Parameter: XTRAN <- "52.2370141"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.3776903"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.3776903-0
 Parameter: YTRAN <- "-45.3776903"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.2681745"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.2681745-0
 Parameter: ZTRAN <- "-43.2681745"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.2370141"
 Parameter: YTRAN -> "-45.3776903"
 Parameter: ZTRAN -> "-43.2681745"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    52.237014  -45.377690  -43.268175
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428087494"
Evaluating: 0.428087494*360.0
 Parameter: XPHI <- "154.111498"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891592181"
Evaluating: 0.891592181*360.0
 Parameter: YPHI <- "320.973185"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767258274"
Evaluating: 0.767258274*360.0
 Parameter: ZPHI <- "276.212979"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.2370141"
 Parameter: YPOS -> "-45.3776903"
 Parameter: ZPOS -> "-43.2681745"
 Parameter: XPHI -> "154.111498"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.899645    0.436621
    0.000000   -0.436621   -0.899645

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.2370141"
 Parameter: YPOS -> "-45.3776903"
 Parameter: ZPOS -> "-43.2681745"
 Parameter: YPHI -> "320.973185"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.776851    0.000000    0.629684
    0.000000    1.000000    0.000000
   -0.629684    0.000000    0.776851

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.2370141"
 Parameter: YPOS -> "-45.3776903"
 Parameter: ZPOS -> "-43.2681745"
 Parameter: ZPHI -> "276.212979"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.108225   -0.994126    0.000000
    0.994126    0.108225    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.237014 XMAX =   52.237014 XAVE =   52.237014
    YMIN =  -45.377690 YMAX =  -45.377690 YAVE =  -45.377690
    ZMIN =  -43.268175 ZMAX =  -43.268175 ZAVE =  -43.268175
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.2370141"
Evaluating: 52.2370141+3.5
 Parameter: XMAX <- "55.7370141"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.3776903"
Evaluating: -45.3776903+3.5
 Parameter: YMAX <- "-41.8776903"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.2681745"
Evaluating: -43.2681745+3.5
 Parameter: ZMAX <- "-39.7681745"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.2370141"
Evaluating: 52.2370141-3.5
 Parameter: XMIN <- "48.7370141"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.3776903"
Evaluating: -45.3776903-3.5
 Parameter: YMIN <- "-48.8776903"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.2681745"
Evaluating: -43.2681745-3.5
 Parameter: ZMIN <- "-46.7681745"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.7370141"
 Parameter: XMIN -> "48.7370141"
 Parameter: YMAX -> "-41.8776903"
 Parameter: YMIN -> "-48.8776903"
 Parameter: ZMAX -> "-39.7681745"
 Parameter: ZMIN -> "-46.7681745"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "118" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "118" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "117"
Evaluating: 118-117
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.953230039"
Evaluating: 128.065641*(0.953230039-0.5)
 Parameter: XPOS <- "58.0431955"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.848595411"
Evaluating: 128.065641*(0.848595411-0.5)
 Parameter: YPOS <- "44.6430948"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.722822237"
Evaluating: 108.613069*(0.722822237-0.5)+-2.187274
 Parameter: ZPOS <- "22.014133"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.014133" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.014133" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.0431955"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.0431955-0
 Parameter: XTRAN <- "58.0431955"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.6430948"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.6430948-0
 Parameter: YTRAN <- "44.6430948"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.014133"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.014133-0
 Parameter: ZTRAN <- "22.014133"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.0431955"
 Parameter: YTRAN -> "44.6430948"
 Parameter: ZTRAN -> "22.014133"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    58.043196   44.643095   22.014133
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484274577"
Evaluating: 0.484274577*360.0
 Parameter: XPHI <- "174.338848"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.937069684"
Evaluating: 0.937069684*360.0
 Parameter: YPHI <- "337.345086"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65197361"
Evaluating: 0.65197361*360.0
 Parameter: ZPHI <- "234.7105"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.0431955"
 Parameter: YPOS -> "44.6430948"
 Parameter: ZPOS -> "22.014133"
 Parameter: XPHI -> "174.338848"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995123    0.098645
    0.000000   -0.098645   -0.995123

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  174.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.0431955"
 Parameter: YPOS -> "44.6430948"
 Parameter: ZPOS -> "22.014133"
 Parameter: YPHI -> "337.345086"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.922841    0.000000    0.385180
    0.000000    1.000000    0.000000
   -0.385180    0.000000    0.922841

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.0431955"
 Parameter: YPOS -> "44.6430948"
 Parameter: ZPOS -> "22.014133"
 Parameter: ZPHI -> "234.7105"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.577708   -0.816243    0.000000
    0.816243   -0.577708    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.043196 XMAX =   58.043196 XAVE =   58.043196
    YMIN =   44.643095 YMAX =   44.643095 YAVE =   44.643095
    ZMIN =   22.014133 ZMAX =   22.014133 ZAVE =   22.014133
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.0431955"
Evaluating: 58.0431955+3.5
 Parameter: XMAX <- "61.5431955"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.6430948"
Evaluating: 44.6430948+3.5
 Parameter: YMAX <- "48.1430948"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.014133"
Evaluating: 22.014133+3.5
 Parameter: ZMAX <- "25.514133"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.0431955"
Evaluating: 58.0431955-3.5
 Parameter: XMIN <- "54.5431955"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.6430948"
Evaluating: 44.6430948-3.5
 Parameter: YMIN <- "41.1430948"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.014133"
Evaluating: 22.014133-3.5
 Parameter: ZMIN <- "18.514133"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "61.5431955"
 Parameter: XMIN -> "54.5431955"
 Parameter: YMAX -> "48.1430948"
 Parameter: YMIN -> "41.1430948"
 Parameter: ZMAX -> "25.514133"
 Parameter: ZMIN -> "18.514133"
 SELRPN>      8 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      3 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     112      C14           3.7923
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     112      C15           3.3059
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "118" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "117"
Evaluating: 118-117
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.465614242"
Evaluating: 128.065641*(0.465614242-0.5)
 Parameter: XPOS <- "-4.40363414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.29017004"
Evaluating: 128.065641*(0.29017004-0.5)
 Parameter: YPOS <- "-26.8720083"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.431965707"
Evaluating: 108.613069*(0.431965707-0.5)+-2.187274
 Parameter: ZPOS <- "-9.57668736"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.57668736" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.57668736" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "118" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "117"
Evaluating: 118-117
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.284778767"
Evaluating: 128.065641*(0.284778767-0.5)
 Parameter: XPOS <- "-27.5624452"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.592234554"
Evaluating: 128.065641*(0.592234554-0.5)
 Parameter: YPOS <- "11.8120773"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.34848965"
Evaluating: 108.613069*(0.34848965-0.5)+-2.187274
 Parameter: ZPOS <- "-18.6432781"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6432781" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.043196 XMAX =   58.043196 XAVE =   58.043196
    YMIN =   44.643095 YMAX =   44.643095 YAVE =   44.643095
    ZMIN =   22.014133 ZMAX =   22.014133 ZAVE =   22.014133
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.5624452"
 RDCMND substituted energy or value "?XAVE" to "58.0431955"
Evaluating: -27.5624452-58.0431955
 Parameter: XTRAN <- "-85.6056407"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.8120773"
 RDCMND substituted energy or value "?YAVE" to "44.6430948"
Evaluating: 11.8120773-44.6430948
 Parameter: YTRAN <- "-32.8310175"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6432781"
 RDCMND substituted energy or value "?ZAVE" to "22.014133"
Evaluating: -18.6432781-22.014133
 Parameter: ZTRAN <- "-40.6574111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-85.6056407"
 Parameter: YTRAN -> "-32.8310175"
 Parameter: ZTRAN -> "-40.6574111"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -85.605641  -32.831018  -40.657411
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.403414715"
Evaluating: 0.403414715*360.0
 Parameter: XPHI <- "145.229297"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.625024673"
Evaluating: 0.625024673*360.0
 Parameter: YPHI <- "225.008882"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.782853806"
Evaluating: 0.782853806*360.0
 Parameter: ZPHI <- "281.82737"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.5624452"
 Parameter: YPOS -> "11.8120773"
 Parameter: ZPOS -> "-18.6432781"
 Parameter: XPHI -> "145.229297"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.821441    0.570294
    0.000000   -0.570294   -0.821441

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.5624452"
 Parameter: YPOS -> "11.8120773"
 Parameter: ZPOS -> "-18.6432781"
 Parameter: YPHI -> "225.008882"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.706997    0.000000    0.707216
    0.000000    1.000000    0.000000
   -0.707216    0.000000   -0.706997

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.5624452"
 Parameter: YPOS -> "11.8120773"
 Parameter: ZPOS -> "-18.6432781"
 Parameter: ZPHI -> "281.82737"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.204964   -0.978770    0.000000
    0.978770    0.204964    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.562445 XMAX =  -27.562445 XAVE =  -27.562445
    YMIN =   11.812077 YMAX =   11.812077 YAVE =   11.812077
    ZMIN =  -18.643278 ZMAX =  -18.643278 ZAVE =  -18.643278
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.5624452"
Evaluating: -27.5624452+3.5
 Parameter: XMAX <- "-24.0624452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.8120773"
Evaluating: 11.8120773+3.5
 Parameter: YMAX <- "15.3120773"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6432781"
Evaluating: -18.6432781+3.5
 Parameter: ZMAX <- "-15.1432781"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.5624452"
Evaluating: -27.5624452-3.5
 Parameter: XMIN <- "-31.0624452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.8120773"
Evaluating: 11.8120773-3.5
 Parameter: YMIN <- "8.3120773"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6432781"
Evaluating: -18.6432781-3.5
 Parameter: ZMIN <- "-22.1432781"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.0624452"
 Parameter: XMIN -> "-31.0624452"
 Parameter: YMAX -> "15.3120773"
 Parameter: YMIN -> "8.3120773"
 Parameter: ZMAX -> "-15.1432781"
 Parameter: ZMIN -> "-22.1432781"
 SELRPN>     20 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      7 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     226      N             2.9258
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     226      C13           2.5895
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     226      C14           2.9011
60350 NEG      CLA      1        CLA     -**** MEMB     DMPC     226      C15           3.0598
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "118" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "117"
Evaluating: 118-117
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.626776699"
Evaluating: 128.065641*(0.626776699-0.5)
 Parameter: XPOS <- "16.2357392"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.567433479"
Evaluating: 128.065641*(0.567433479-0.5)
 Parameter: YPOS <- "8.63591171"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.419359662"
Evaluating: 108.613069*(0.419359662-0.5)+-2.187274
 Parameter: ZPOS <- "-10.9458686"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.9458686" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.9458686" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "118" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "117"
Evaluating: 118-117
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.226949055"
Evaluating: 128.065641*(0.226949055-0.5)
 Parameter: XPOS <- "-34.9684443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.631889893"
Evaluating: 128.065641*(0.631889893-0.5)
 Parameter: YPOS <- "16.8905637"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.916757038"
Evaluating: 108.613069*(0.916757038-0.5)+-2.187274
 Parameter: ZPOS <- "43.0779869"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.0779869" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.0779869" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.562445 XMAX =  -27.562445 XAVE =  -27.562445
    YMIN =   11.812077 YMAX =   11.812077 YAVE =   11.812077
    ZMIN =  -18.643278 ZMAX =  -18.643278 ZAVE =  -18.643278
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.9684443"
 RDCMND substituted energy or value "?XAVE" to "-27.5624452"
Evaluating: -34.9684443--27.5624452
 Parameter: XTRAN <- "-7.4059991"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.8905637"
 RDCMND substituted energy or value "?YAVE" to "11.8120773"
Evaluating: 16.8905637-11.8120773
 Parameter: YTRAN <- "5.0784864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.0779869"
 RDCMND substituted energy or value "?ZAVE" to "-18.6432781"
Evaluating: 43.0779869--18.6432781
 Parameter: ZTRAN <- "61.721265"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.4059991"
 Parameter: YTRAN -> "5.0784864"
 Parameter: ZTRAN -> "61.721265"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.405999    5.078486   61.721265
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.705547761"
Evaluating: 0.705547761*360.0
 Parameter: XPHI <- "253.997194"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306866833"
Evaluating: 0.306866833*360.0
 Parameter: YPHI <- "110.47206"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70627305"
Evaluating: 0.70627305*360.0
 Parameter: ZPHI <- "254.258298"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.9684443"
 Parameter: YPOS -> "16.8905637"
 Parameter: ZPOS -> "43.0779869"
 Parameter: XPHI -> "253.997194"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.275684   -0.961248
    0.000000    0.961248   -0.275684

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.9684443"
 Parameter: YPOS -> "16.8905637"
 Parameter: ZPOS -> "43.0779869"
 Parameter: YPHI -> "110.47206"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.349751    0.000000   -0.936843
    0.000000    1.000000    0.000000
    0.936843    0.000000   -0.349751

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.9684443"
 Parameter: YPOS -> "16.8905637"
 Parameter: ZPOS -> "43.0779869"
 Parameter: ZPHI -> "254.258298"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.271301   -0.962495    0.000000
    0.962495   -0.271301    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  105.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.968444 XMAX =  -34.968444 XAVE =  -34.968444
    YMIN =   16.890564 YMAX =   16.890564 YAVE =   16.890564
    ZMIN =   43.077987 ZMAX =   43.077987 ZAVE =   43.077987
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.9684443"
Evaluating: -34.9684443+3.5
 Parameter: XMAX <- "-31.4684443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.8905637"
Evaluating: 16.8905637+3.5
 Parameter: YMAX <- "20.3905637"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.0779869"
Evaluating: 43.0779869+3.5
 Parameter: ZMAX <- "46.5779869"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.9684443"
Evaluating: -34.9684443-3.5
 Parameter: XMIN <- "-38.4684443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.8905637"
Evaluating: 16.8905637-3.5
 Parameter: YMIN <- "13.3905637"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.0779869"
Evaluating: 43.0779869-3.5
 Parameter: ZMIN <- "39.5779869"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.4684443"
 Parameter: XMIN -> "-38.4684443"
 Parameter: YMAX -> "20.3905637"
 Parameter: YMIN -> "13.3905637"
 Parameter: ZMAX -> "46.5779869"
 Parameter: ZMIN -> "39.5779869"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "119" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "119" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "119"
 Parameter: NPOS -> "117"
Evaluating: 119-117
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.894758653"
Evaluating: 128.065641*(0.894758653-0.5)
 Parameter: XPOS <- "50.5550199"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.681443472E-02"
Evaluating: 128.065641*(5.681443472E-02-0.5)
 Parameter: YPOS <- "-56.7568435"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.270386833"
Evaluating: 108.613069*(0.270386833-0.5)+-2.187274
 Parameter: ZPOS <- "-27.1262648"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.1262648" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.5550199"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.5550199-0
 Parameter: XTRAN <- "50.5550199"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.7568435"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.7568435-0
 Parameter: YTRAN <- "-56.7568435"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.1262648"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.1262648-0
 Parameter: ZTRAN <- "-27.1262648"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.5550199"
 Parameter: YTRAN -> "-56.7568435"
 Parameter: ZTRAN -> "-27.1262648"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    50.555020  -56.756844  -27.126265
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479762166"
Evaluating: 0.479762166*360.0
 Parameter: XPHI <- "172.71438"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519625011"
Evaluating: 0.519625011*360.0
 Parameter: YPHI <- "187.065004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915344381"
Evaluating: 0.915344381*360.0
 Parameter: ZPHI <- "329.523977"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.5550199"
 Parameter: YPOS -> "-56.7568435"
 Parameter: ZPOS -> "-27.1262648"
 Parameter: XPHI -> "172.71438"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.991926    0.126816
    0.000000   -0.126816   -0.991926

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.5550199"
 Parameter: YPOS -> "-56.7568435"
 Parameter: ZPOS -> "-27.1262648"
 Parameter: YPHI -> "187.065004"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.992407    0.000000    0.122995
    0.000000    1.000000    0.000000
   -0.122995    0.000000   -0.992407

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.5550199"
 Parameter: YPOS -> "-56.7568435"
 Parameter: ZPOS -> "-27.1262648"
 Parameter: ZPHI -> "329.523977"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.861841   -0.507178    0.000000
    0.507178    0.861841    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.555020 XMAX =   50.555020 XAVE =   50.555020
    YMIN =  -56.756844 YMAX =  -56.756844 YAVE =  -56.756844
    ZMIN =  -27.126265 ZMAX =  -27.126265 ZAVE =  -27.126265
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.5550199"
Evaluating: 50.5550199+3.5
 Parameter: XMAX <- "54.0550199"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.7568435"
Evaluating: -56.7568435+3.5
 Parameter: YMAX <- "-53.2568435"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.1262648"
Evaluating: -27.1262648+3.5
 Parameter: ZMAX <- "-23.6262648"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.5550199"
Evaluating: 50.5550199-3.5
 Parameter: XMIN <- "47.0550199"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.7568435"
Evaluating: -56.7568435-3.5
 Parameter: YMIN <- "-60.2568435"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.1262648"
Evaluating: -27.1262648-3.5
 Parameter: ZMIN <- "-30.6262648"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.0550199"
 Parameter: XMIN -> "47.0550199"
 Parameter: YMAX -> "-53.2568435"
 Parameter: YMIN -> "-60.2568435"
 Parameter: ZMAX -> "-23.6262648"
 Parameter: ZMIN -> "-30.6262648"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "120" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "120" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "120"
 Parameter: NPOS -> "117"
Evaluating: 120-117
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.495064624"
Evaluating: 128.065641*(0.495064624-0.5)
 Parameter: XPOS <- "-0.632052091"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.590005651"
Evaluating: 128.065641*(0.590005651-0.5)
 Parameter: YPOS <- "11.5266314"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.306621932"
Evaluating: 108.613069*(0.306621932-0.5)+-2.187274
 Parameter: ZPOS <- "-23.1906594"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.1906594" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.632052091"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.632052091-0
 Parameter: XTRAN <- "-0.632052091"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.5266314"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.5266314-0
 Parameter: YTRAN <- "11.5266314"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.1906594"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.1906594-0
 Parameter: ZTRAN <- "-23.1906594"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.632052091"
 Parameter: YTRAN -> "11.5266314"
 Parameter: ZTRAN -> "-23.1906594"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -0.632052   11.526631  -23.190659
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.965044077E-02"
Evaluating: 9.965044077E-02*360.0
 Parameter: XPHI <- "35.8741587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.823964994E-03"
Evaluating: 7.823964994E-03*360.0
 Parameter: YPHI <- "2.8166274"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746674372"
Evaluating: 0.746674372*360.0
 Parameter: ZPHI <- "268.802774"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.632052091"
 Parameter: YPOS -> "11.5266314"
 Parameter: ZPOS -> "-23.1906594"
 Parameter: XPHI -> "35.8741587"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.810306    0.586007
    0.000000   -0.586007    0.810306

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.632052091"
 Parameter: YPOS -> "11.5266314"
 Parameter: ZPOS -> "-23.1906594"
 Parameter: YPHI -> "2.8166274"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.998792    0.000000   -0.049140
    0.000000    1.000000    0.000000
    0.049140    0.000000    0.998792

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.632052091"
 Parameter: YPOS -> "11.5266314"
 Parameter: ZPOS -> "-23.1906594"
 Parameter: ZPHI -> "268.802774"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.020894   -0.999782    0.000000
    0.999782   -0.020894    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.632052 XMAX =   -0.632052 XAVE =   -0.632052
    YMIN =   11.526631 YMAX =   11.526631 YAVE =   11.526631
    ZMIN =  -23.190659 ZMAX =  -23.190659 ZAVE =  -23.190659
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.632052091"
Evaluating: -0.632052091+3.5
 Parameter: XMAX <- "2.86794791"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.5266314"
Evaluating: 11.5266314+3.5
 Parameter: YMAX <- "15.0266314"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.1906594"
Evaluating: -23.1906594+3.5
 Parameter: ZMAX <- "-19.6906594"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.632052091"
Evaluating: -0.632052091-3.5
 Parameter: XMIN <- "-4.13205209"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.5266314"
Evaluating: 11.5266314-3.5
 Parameter: YMIN <- "8.0266314"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.1906594"
Evaluating: -23.1906594-3.5
 Parameter: ZMIN <- "-26.6906594"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.86794791"
 Parameter: XMIN -> "-4.13205209"
 Parameter: YMAX -> "15.0266314"
 Parameter: YMIN -> "8.0266314"
 Parameter: ZMAX -> "-19.6906594"
 Parameter: ZMIN -> "-26.6906594"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "121" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "121" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "117"
Evaluating: 121-117
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.458267386"
Evaluating: 128.065641*(0.458267386-0.5)
 Parameter: XPOS <- "-5.34451396"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.171700291"
Evaluating: 128.065641*(0.171700291-0.5)
 Parameter: YPOS <- "-42.0439127"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.564213487"
Evaluating: 108.613069*(0.564213487-0.5)+-2.187274
 Parameter: ZPOS <- "4.78714989"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.78714989" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.78714989" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "121" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "117"
Evaluating: 121-117
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.720438728"
Evaluating: 128.065641*(0.720438728-0.5)
 Parameter: XPOS <- "28.230627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.728418965"
Evaluating: 128.065641*(0.728418965-0.5)
 Parameter: YPOS <- "29.2526212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.11485678"
Evaluating: 108.613069*(0.11485678-0.5)+-2.187274
 Parameter: ZPOS <- "-44.0188611"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.0188611" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.230627"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.230627-0
 Parameter: XTRAN <- "28.230627"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.2526212"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.2526212-0
 Parameter: YTRAN <- "29.2526212"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.0188611"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.0188611-0
 Parameter: ZTRAN <- "-44.0188611"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.230627"
 Parameter: YTRAN -> "29.2526212"
 Parameter: ZTRAN -> "-44.0188611"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    28.230627   29.252621  -44.018861
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758348588"
Evaluating: 0.758348588*360.0
 Parameter: XPHI <- "273.005492"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452756123"
Evaluating: 0.452756123*360.0
 Parameter: YPHI <- "162.992204"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.769728692"
Evaluating: 0.769728692*360.0
 Parameter: ZPHI <- "277.102329"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.230627"
 Parameter: YPOS -> "29.2526212"
 Parameter: ZPOS -> "-44.0188611"
 Parameter: XPHI -> "273.005492"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.052432   -0.998625
    0.000000    0.998625    0.052432

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.230627"
 Parameter: YPOS -> "29.2526212"
 Parameter: ZPOS -> "-44.0188611"
 Parameter: YPHI -> "162.992204"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.956265    0.000000   -0.292502
    0.000000    1.000000    0.000000
    0.292502    0.000000   -0.956265

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.230627"
 Parameter: YPOS -> "29.2526212"
 Parameter: ZPOS -> "-44.0188611"
 Parameter: ZPHI -> "277.102329"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.123642   -0.992327    0.000000
    0.992327    0.123642    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.230627 XMAX =   28.230627 XAVE =   28.230627
    YMIN =   29.252621 YMAX =   29.252621 YAVE =   29.252621
    ZMIN =  -44.018861 ZMAX =  -44.018861 ZAVE =  -44.018861
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.230627"
Evaluating: 28.230627+3.5
 Parameter: XMAX <- "31.730627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.2526212"
Evaluating: 29.2526212+3.5
 Parameter: YMAX <- "32.7526212"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.0188611"
Evaluating: -44.0188611+3.5
 Parameter: ZMAX <- "-40.5188611"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.230627"
Evaluating: 28.230627-3.5
 Parameter: XMIN <- "24.730627"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.2526212"
Evaluating: 29.2526212-3.5
 Parameter: YMIN <- "25.7526212"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.0188611"
Evaluating: -44.0188611-3.5
 Parameter: ZMIN <- "-47.5188611"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.730627"
 Parameter: XMIN -> "24.730627"
 Parameter: YMAX -> "32.7526212"
 Parameter: YMIN -> "25.7526212"
 Parameter: ZMAX -> "-40.5188611"
 Parameter: ZMIN -> "-47.5188611"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "122" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "122" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "117"
Evaluating: 122-117
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.822633009"
Evaluating: 128.065641*(0.822633009-0.5)
 Parameter: XPOS <- "41.3182031"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.669974011"
Evaluating: 128.065641*(0.669974011-0.5)
 Parameter: YPOS <- "21.7678307"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.671886976"
Evaluating: 108.613069*(0.671886976-0.5)+-2.187274
 Parameter: ZPOS <- "16.481898"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.481898" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.481898" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.3182031"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.3182031-0
 Parameter: XTRAN <- "41.3182031"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.7678307"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.7678307-0
 Parameter: YTRAN <- "21.7678307"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.481898"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.481898-0
 Parameter: ZTRAN <- "16.481898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.3182031"
 Parameter: YTRAN -> "21.7678307"
 Parameter: ZTRAN -> "16.481898"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    41.318203   21.767831   16.481898
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638880773"
Evaluating: 0.638880773*360.0
 Parameter: XPHI <- "229.997078"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729534747"
Evaluating: 0.729534747*360.0
 Parameter: YPHI <- "262.632509"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513704507"
Evaluating: 0.513704507*360.0
 Parameter: ZPHI <- "184.933623"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.3182031"
 Parameter: YPOS -> "21.7678307"
 Parameter: ZPOS -> "16.481898"
 Parameter: XPHI -> "229.997078"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.642827   -0.766012
    0.000000    0.766012   -0.642827

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.3182031"
 Parameter: YPOS -> "21.7678307"
 Parameter: ZPOS -> "16.481898"
 Parameter: YPHI -> "262.632509"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.128233    0.000000    0.991744
    0.000000    1.000000    0.000000
   -0.991744    0.000000   -0.128233

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   97.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.3182031"
 Parameter: YPOS -> "21.7678307"
 Parameter: ZPOS -> "16.481898"
 Parameter: ZPHI -> "184.933623"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.996295   -0.086002    0.000000
    0.086002   -0.996295    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.318203 XMAX =   41.318203 XAVE =   41.318203
    YMIN =   21.767831 YMAX =   21.767831 YAVE =   21.767831
    ZMIN =   16.481898 ZMAX =   16.481898 ZAVE =   16.481898
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.3182031"
Evaluating: 41.3182031+3.5
 Parameter: XMAX <- "44.8182031"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.7678307"
Evaluating: 21.7678307+3.5
 Parameter: YMAX <- "25.2678307"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.481898"
Evaluating: 16.481898+3.5
 Parameter: ZMAX <- "19.981898"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.3182031"
Evaluating: 41.3182031-3.5
 Parameter: XMIN <- "37.8182031"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.7678307"
Evaluating: 21.7678307-3.5
 Parameter: YMIN <- "18.2678307"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.481898"
Evaluating: 16.481898-3.5
 Parameter: ZMIN <- "12.981898"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.8182031"
 Parameter: XMIN -> "37.8182031"
 Parameter: YMAX -> "25.2678307"
 Parameter: YMIN -> "18.2678307"
 Parameter: ZMAX -> "19.981898"
 Parameter: ZMIN -> "12.981898"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "123" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "123" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "117"
Evaluating: 123-117
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.603700289"
Evaluating: 128.065641*(0.603700289-0.5)
 Parameter: XPOS <- "13.280444"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.127653016"
Evaluating: 128.065641*(0.127653016-0.5)
 Parameter: YPOS <- "-47.6848552"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.253955542"
Evaluating: 108.613069*(0.253955542-0.5)+-2.187274
 Parameter: ZPOS <- "-28.9109177"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.9109177" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.280444"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.280444-0
 Parameter: XTRAN <- "13.280444"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.6848552"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.6848552-0
 Parameter: YTRAN <- "-47.6848552"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.9109177"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.9109177-0
 Parameter: ZTRAN <- "-28.9109177"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.280444"
 Parameter: YTRAN -> "-47.6848552"
 Parameter: ZTRAN -> "-28.9109177"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    13.280444  -47.684855  -28.910918
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920722711"
Evaluating: 0.920722711*360.0
 Parameter: XPHI <- "331.460176"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.788259368"
Evaluating: 0.788259368*360.0
 Parameter: YPHI <- "283.773372"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.275479493"
Evaluating: 0.275479493*360.0
 Parameter: ZPHI <- "99.1726175"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.280444"
 Parameter: YPOS -> "-47.6848552"
 Parameter: ZPOS -> "-28.9109177"
 Parameter: XPHI -> "331.460176"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.878485   -0.477769
    0.000000    0.477769    0.878485

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.280444"
 Parameter: YPOS -> "-47.6848552"
 Parameter: ZPOS -> "-28.9109177"
 Parameter: YPHI -> "283.773372"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.238082    0.000000    0.971245
    0.000000    1.000000    0.000000
   -0.971245    0.000000    0.238082

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   76.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.280444"
 Parameter: YPOS -> "-47.6848552"
 Parameter: ZPOS -> "-28.9109177"
 Parameter: ZPHI -> "99.1726175"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.159409    0.987213    0.000000
   -0.987213   -0.159409    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.280444 XMAX =   13.280444 XAVE =   13.280444
    YMIN =  -47.684855 YMAX =  -47.684855 YAVE =  -47.684855
    ZMIN =  -28.910918 ZMAX =  -28.910918 ZAVE =  -28.910918
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.280444"
Evaluating: 13.280444+3.5
 Parameter: XMAX <- "16.780444"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.6848552"
Evaluating: -47.6848552+3.5
 Parameter: YMAX <- "-44.1848552"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.9109177"
Evaluating: -28.9109177+3.5
 Parameter: ZMAX <- "-25.4109177"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.280444"
Evaluating: 13.280444-3.5
 Parameter: XMIN <- "9.780444"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.6848552"
Evaluating: -47.6848552-3.5
 Parameter: YMIN <- "-51.1848552"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.9109177"
Evaluating: -28.9109177-3.5
 Parameter: ZMIN <- "-32.4109177"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.780444"
 Parameter: XMIN -> "9.780444"
 Parameter: YMAX -> "-44.1848552"
 Parameter: YMIN -> "-51.1848552"
 Parameter: ZMAX -> "-25.4109177"
 Parameter: ZMIN -> "-32.4109177"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "124" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "124" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "117"
Evaluating: 124-117
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.334796949"
Evaluating: 128.065641*(0.334796949-0.5)
 Parameter: XPOS <- "-21.1568346"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.496414617"
Evaluating: 128.065641*(0.496414617-0.5)
 Parameter: YPOS <- "-0.459164372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.816074587"
Evaluating: 108.613069*(0.816074587-0.5)+-2.187274
 Parameter: ZPOS <- "32.1425569"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.1425569" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.1425569" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.1568346"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.1568346-0
 Parameter: XTRAN <- "-21.1568346"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.459164372"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.459164372-0
 Parameter: YTRAN <- "-0.459164372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.1425569"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.1425569-0
 Parameter: ZTRAN <- "32.1425569"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.1568346"
 Parameter: YTRAN -> "-0.459164372"
 Parameter: ZTRAN -> "32.1425569"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -21.156835   -0.459164   32.142557
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.585831823"
Evaluating: 0.585831823*360.0
 Parameter: XPHI <- "210.899456"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.372021781"
Evaluating: 0.372021781*360.0
 Parameter: YPHI <- "133.927841"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78883373"
Evaluating: 0.78883373*360.0
 Parameter: ZPHI <- "283.980143"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.1568346"
 Parameter: YPOS -> "-0.459164372"
 Parameter: ZPOS -> "32.1425569"
 Parameter: XPHI -> "210.899456"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.858070   -0.513533
    0.000000    0.513533   -0.858070

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  149.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.1568346"
 Parameter: YPOS -> "-0.459164372"
 Parameter: ZPOS -> "32.1425569"
 Parameter: YPHI -> "133.927841"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.693752    0.000000   -0.720214
    0.000000    1.000000    0.000000
    0.720214    0.000000   -0.693752

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.1568346"
 Parameter: YPOS -> "-0.459164372"
 Parameter: ZPOS -> "32.1425569"
 Parameter: ZPHI -> "283.980143"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.241586   -0.970380    0.000000
    0.970380    0.241586    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   76.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.156835 XMAX =  -21.156835 XAVE =  -21.156835
    YMIN =   -0.459164 YMAX =   -0.459164 YAVE =   -0.459164
    ZMIN =   32.142557 ZMAX =   32.142557 ZAVE =   32.142557
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.1568346"
Evaluating: -21.1568346+3.5
 Parameter: XMAX <- "-17.6568346"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.459164372"
Evaluating: -0.459164372+3.5
 Parameter: YMAX <- "3.04083563"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.1425569"
Evaluating: 32.1425569+3.5
 Parameter: ZMAX <- "35.6425569"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.1568346"
Evaluating: -21.1568346-3.5
 Parameter: XMIN <- "-24.6568346"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.459164372"
Evaluating: -0.459164372-3.5
 Parameter: YMIN <- "-3.95916437"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.1425569"
Evaluating: 32.1425569-3.5
 Parameter: ZMIN <- "28.6425569"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.6568346"
 Parameter: XMIN -> "-24.6568346"
 Parameter: YMAX -> "3.04083563"
 Parameter: YMIN -> "-3.95916437"
 Parameter: ZMAX -> "35.6425569"
 Parameter: ZMIN -> "28.6425569"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "125" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "125" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "117"
Evaluating: 125-117
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.282152606"
Evaluating: 128.065641*(0.282152606-0.5)
 Parameter: XPOS <- "-27.8987662"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.224736015E-02"
Evaluating: 128.065641*(6.224736015E-02-0.5)
 Parameter: YPOS <- "-56.0610724"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.695305921"
Evaluating: 108.613069*(0.695305921-0.5)+-2.187274
 Parameter: ZPOS <- "19.0255015"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.0255015" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.0255015" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.8987662"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.8987662-0
 Parameter: XTRAN <- "-27.8987662"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.0610724"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.0610724-0
 Parameter: YTRAN <- "-56.0610724"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.0255015"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.0255015-0
 Parameter: ZTRAN <- "19.0255015"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.8987662"
 Parameter: YTRAN -> "-56.0610724"
 Parameter: ZTRAN -> "19.0255015"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -27.898766  -56.061072   19.025502
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.391187921"
Evaluating: 0.391187921*360.0
 Parameter: XPHI <- "140.827652"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836814197"
Evaluating: 0.836814197*360.0
 Parameter: YPHI <- "301.253111"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.802854244E-02"
Evaluating: 1.802854244E-02*360.0
 Parameter: ZPHI <- "6.49027528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.8987662"
 Parameter: YPOS -> "-56.0610724"
 Parameter: ZPOS -> "19.0255015"
 Parameter: XPHI -> "140.827652"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.775249    0.631655
    0.000000   -0.631655   -0.775249

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.8987662"
 Parameter: YPOS -> "-56.0610724"
 Parameter: ZPOS -> "19.0255015"
 Parameter: YPHI -> "301.253111"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.518820    0.000000    0.854884
    0.000000    1.000000    0.000000
   -0.854884    0.000000    0.518820

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.8987662"
 Parameter: YPOS -> "-56.0610724"
 Parameter: ZPOS -> "19.0255015"
 Parameter: ZPHI -> "6.49027528"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.993591    0.113035    0.000000
   -0.113035    0.993591    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.898766 XMAX =  -27.898766 XAVE =  -27.898766
    YMIN =  -56.061072 YMAX =  -56.061072 YAVE =  -56.061072
    ZMIN =   19.025502 ZMAX =   19.025502 ZAVE =   19.025502
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.8987662"
Evaluating: -27.8987662+3.5
 Parameter: XMAX <- "-24.3987662"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.0610724"
Evaluating: -56.0610724+3.5
 Parameter: YMAX <- "-52.5610724"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.0255015"
Evaluating: 19.0255015+3.5
 Parameter: ZMAX <- "22.5255015"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.8987662"
Evaluating: -27.8987662-3.5
 Parameter: XMIN <- "-31.3987662"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.0610724"
Evaluating: -56.0610724-3.5
 Parameter: YMIN <- "-59.5610724"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.0255015"
Evaluating: 19.0255015-3.5
 Parameter: ZMIN <- "15.5255015"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.3987662"
 Parameter: XMIN -> "-31.3987662"
 Parameter: YMAX -> "-52.5610724"
 Parameter: YMIN -> "-59.5610724"
 Parameter: ZMAX -> "22.5255015"
 Parameter: ZMIN -> "15.5255015"
 SELRPN>     17 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      7 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     180      N             2.2166
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     180      C13           2.3848
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     180      C14           2.8211
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     180      C15           1.6411
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     180      C12           3.6526
60357 NEG      CLA      8        CLA     -**** MEMB     DMPC     181      O13           3.4459
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "125" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "117"
Evaluating: 125-117
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.587118759"
Evaluating: 128.065641*(0.587118759-0.5)
 Parameter: XPOS <- "11.1569197"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.45478017"
Evaluating: 128.065641*(0.45478017-0.5)
 Parameter: YPOS <- "-5.79110651"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.963243892"
Evaluating: 108.613069*(0.963243892-0.5)+-2.187274
 Parameter: ZPOS <- "48.1270668"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.1270668" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.1270668" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.898766 XMAX =  -27.898766 XAVE =  -27.898766
    YMIN =  -56.061072 YMAX =  -56.061072 YAVE =  -56.061072
    ZMIN =   19.025502 ZMAX =   19.025502 ZAVE =   19.025502
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1569197"
 RDCMND substituted energy or value "?XAVE" to "-27.8987662"
Evaluating: 11.1569197--27.8987662
 Parameter: XTRAN <- "39.0556859"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.79110651"
 RDCMND substituted energy or value "?YAVE" to "-56.0610724"
Evaluating: -5.79110651--56.0610724
 Parameter: YTRAN <- "50.2699659"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.1270668"
 RDCMND substituted energy or value "?ZAVE" to "19.0255015"
Evaluating: 48.1270668-19.0255015
 Parameter: ZTRAN <- "29.1015653"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.0556859"
 Parameter: YTRAN -> "50.2699659"
 Parameter: ZTRAN -> "29.1015653"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    39.055686   50.269966   29.101565
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492705346"
Evaluating: 0.492705346*360.0
 Parameter: XPHI <- "177.373925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684080251"
Evaluating: 0.684080251*360.0
 Parameter: YPHI <- "246.26889"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.724282705"
Evaluating: 0.724282705*360.0
 Parameter: ZPHI <- "260.741774"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1569197"
 Parameter: YPOS -> "-5.79110651"
 Parameter: ZPOS -> "48.1270668"
 Parameter: XPHI -> "177.373925"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998950    0.045818
    0.000000   -0.045818   -0.998950

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  177.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1569197"
 Parameter: YPOS -> "-5.79110651"
 Parameter: ZPOS -> "48.1270668"
 Parameter: YPHI -> "246.26889"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.402445    0.000000    0.915444
    0.000000    1.000000    0.000000
   -0.915444    0.000000   -0.402445

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1569197"
 Parameter: YPOS -> "-5.79110651"
 Parameter: ZPOS -> "48.1270668"
 Parameter: ZPHI -> "260.741774"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.160884   -0.986973    0.000000
    0.986973   -0.160884    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.156920 XMAX =   11.156920 XAVE =   11.156920
    YMIN =   -5.791107 YMAX =   -5.791107 YAVE =   -5.791107
    ZMIN =   48.127067 ZMAX =   48.127067 ZAVE =   48.127067
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1569197"
Evaluating: 11.1569197+3.5
 Parameter: XMAX <- "14.6569197"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.79110651"
Evaluating: -5.79110651+3.5
 Parameter: YMAX <- "-2.29110651"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.1270668"
Evaluating: 48.1270668+3.5
 Parameter: ZMAX <- "51.6270668"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1569197"
Evaluating: 11.1569197-3.5
 Parameter: XMIN <- "7.6569197"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.79110651"
Evaluating: -5.79110651-3.5
 Parameter: YMIN <- "-9.29110651"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.1270668"
Evaluating: 48.1270668-3.5
 Parameter: ZMIN <- "44.6270668"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6569197"
 Parameter: XMIN -> "7.6569197"
 Parameter: YMAX -> "-2.29110651"
 Parameter: YMIN -> "-9.29110651"
 Parameter: ZMAX -> "51.6270668"
 Parameter: ZMIN -> "44.6270668"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "126" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "126" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "117"
Evaluating: 126-117
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.253353265"
Evaluating: 128.065641*(0.253353265-0.5)
 Parameter: XPOS <- "-31.5869722"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.565503766"
Evaluating: 128.065641*(0.565503766-0.5)
 Parameter: YPOS <- "8.38878178"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.259580559"
Evaluating: 108.613069*(0.259580559-0.5)+-2.187274
 Parameter: ZPOS <- "-28.2999673"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.2999673" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.5869722"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.5869722-0
 Parameter: XTRAN <- "-31.5869722"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.38878178"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.38878178-0
 Parameter: YTRAN <- "8.38878178"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.2999673"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.2999673-0
 Parameter: ZTRAN <- "-28.2999673"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.5869722"
 Parameter: YTRAN -> "8.38878178"
 Parameter: ZTRAN -> "-28.2999673"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -31.586972    8.388782  -28.299967
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431119235"
Evaluating: 0.431119235*360.0
 Parameter: XPHI <- "155.202925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101675994"
Evaluating: 0.101675994*360.0
 Parameter: YPHI <- "36.6033578"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.79547059"
Evaluating: 0.79547059*360.0
 Parameter: ZPHI <- "286.369412"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.5869722"
 Parameter: YPOS -> "8.38878178"
 Parameter: ZPOS -> "-28.2999673"
 Parameter: XPHI -> "155.202925"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.907799    0.419406
    0.000000   -0.419406   -0.907799

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.5869722"
 Parameter: YPOS -> "8.38878178"
 Parameter: ZPOS -> "-28.2999673"
 Parameter: YPHI -> "36.6033578"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.802783    0.000000   -0.596272
    0.000000    1.000000    0.000000
    0.596272    0.000000    0.802783

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.5869722"
 Parameter: YPOS -> "8.38878178"
 Parameter: ZPOS -> "-28.2999673"
 Parameter: ZPHI -> "286.369412"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.281829   -0.959465    0.000000
    0.959465    0.281829    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.586972 XMAX =  -31.586972 XAVE =  -31.586972
    YMIN =    8.388782 YMAX =    8.388782 YAVE =    8.388782
    ZMIN =  -28.299967 ZMAX =  -28.299967 ZAVE =  -28.299967
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.5869722"
Evaluating: -31.5869722+3.5
 Parameter: XMAX <- "-28.0869722"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.38878178"
Evaluating: 8.38878178+3.5
 Parameter: YMAX <- "11.8887818"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.2999673"
Evaluating: -28.2999673+3.5
 Parameter: ZMAX <- "-24.7999673"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.5869722"
Evaluating: -31.5869722-3.5
 Parameter: XMIN <- "-35.0869722"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.38878178"
Evaluating: 8.38878178-3.5
 Parameter: YMIN <- "4.88878178"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.2999673"
Evaluating: -28.2999673-3.5
 Parameter: ZMIN <- "-31.7999673"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.0869722"
 Parameter: XMIN -> "-35.0869722"
 Parameter: YMAX -> "11.8887818"
 Parameter: YMIN -> "4.88878178"
 Parameter: ZMAX -> "-24.7999673"
 Parameter: ZMIN -> "-31.7999673"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "127" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "127" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "117"
Evaluating: 127-117
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.329681049"
Evaluating: 128.065641*(0.329681049-0.5)
 Parameter: XPOS <- "-21.8120056"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.858011241"
Evaluating: 128.065641*(0.858011241-0.5)
 Parameter: YPOS <- "45.8489391"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.762601163"
Evaluating: 108.613069*(0.762601163-0.5)+-2.187274
 Parameter: ZPOS <- "26.3346442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.3346442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.3346442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.8120056"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.8120056-0
 Parameter: XTRAN <- "-21.8120056"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.8489391"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.8489391-0
 Parameter: YTRAN <- "45.8489391"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.3346442"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.3346442-0
 Parameter: ZTRAN <- "26.3346442"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.8120056"
 Parameter: YTRAN -> "45.8489391"
 Parameter: ZTRAN -> "26.3346442"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -21.812006   45.848939   26.334644
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.589156891"
Evaluating: 0.589156891*360.0
 Parameter: XPHI <- "212.096481"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993714858"
Evaluating: 0.993714858*360.0
 Parameter: YPHI <- "357.737349"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.350681264"
Evaluating: 0.350681264*360.0
 Parameter: ZPHI <- "126.245255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.8120056"
 Parameter: YPOS -> "45.8489391"
 Parameter: ZPOS -> "26.3346442"
 Parameter: XPHI -> "212.096481"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.847155   -0.531347
    0.000000    0.531347   -0.847155

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.8120056"
 Parameter: YPOS -> "45.8489391"
 Parameter: ZPOS -> "26.3346442"
 Parameter: YPHI -> "357.737349"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999220    0.000000    0.039480
    0.000000    1.000000    0.000000
   -0.039480    0.000000    0.999220

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.8120056"
 Parameter: YPOS -> "45.8489391"
 Parameter: ZPOS -> "26.3346442"
 Parameter: ZPHI -> "126.245255"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.591243    0.806494    0.000000
   -0.806494   -0.591243    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  126.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.812006 XMAX =  -21.812006 XAVE =  -21.812006
    YMIN =   45.848939 YMAX =   45.848939 YAVE =   45.848939
    ZMIN =   26.334644 ZMAX =   26.334644 ZAVE =   26.334644
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.8120056"
Evaluating: -21.8120056+3.5
 Parameter: XMAX <- "-18.3120056"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.8489391"
Evaluating: 45.8489391+3.5
 Parameter: YMAX <- "49.3489391"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.3346442"
Evaluating: 26.3346442+3.5
 Parameter: ZMAX <- "29.8346442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.8120056"
Evaluating: -21.8120056-3.5
 Parameter: XMIN <- "-25.3120056"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.8489391"
Evaluating: 45.8489391-3.5
 Parameter: YMIN <- "42.3489391"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.3346442"
Evaluating: 26.3346442-3.5
 Parameter: ZMIN <- "22.8346442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.3120056"
 Parameter: XMIN -> "-25.3120056"
 Parameter: YMAX -> "49.3489391"
 Parameter: YMIN -> "42.3489391"
 Parameter: ZMAX -> "29.8346442"
 Parameter: ZMIN -> "22.8346442"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "128" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "128" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "117"
Evaluating: 128-117
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.425813126"
Evaluating: 128.065641*(0.425813126-0.5)
 Parameter: XPOS <- "-9.50078957"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.304389756E-02"
Evaluating: 128.065641*(4.304389756E-02-0.5)
 Parameter: YPOS <- "-58.5203762"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "7.749614855E-02"
Evaluating: 108.613069*(7.749614855E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-48.076714"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.076714" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.50078957"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.50078957-0
 Parameter: XTRAN <- "-9.50078957"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-58.5203762"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -58.5203762-0
 Parameter: YTRAN <- "-58.5203762"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.076714"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.076714-0
 Parameter: ZTRAN <- "-48.076714"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.50078957"
 Parameter: YTRAN -> "-58.5203762"
 Parameter: ZTRAN -> "-48.076714"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -9.500790  -58.520376  -48.076714
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.859917323"
Evaluating: 0.859917323*360.0
 Parameter: XPHI <- "309.570236"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270567999"
Evaluating: 0.270567999*360.0
 Parameter: YPHI <- "97.4044796"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.339247942"
Evaluating: 0.339247942*360.0
 Parameter: ZPHI <- "122.129259"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.50078957"
 Parameter: YPOS -> "-58.5203762"
 Parameter: ZPOS -> "-48.076714"
 Parameter: XPHI -> "309.570236"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.637024   -0.770844
    0.000000    0.770844    0.637024

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   50.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.50078957"
 Parameter: YPOS -> "-58.5203762"
 Parameter: ZPOS -> "-48.076714"
 Parameter: YPHI -> "97.4044796"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.128873    0.000000   -0.991661
    0.000000    1.000000    0.000000
    0.991661    0.000000   -0.128873

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.50078957"
 Parameter: YPOS -> "-58.5203762"
 Parameter: ZPOS -> "-48.076714"
 Parameter: ZPHI -> "122.129259"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.531831    0.846850    0.000000
   -0.846850   -0.531831    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.500790 XMAX =   -9.500790 XAVE =   -9.500790
    YMIN =  -58.520376 YMAX =  -58.520376 YAVE =  -58.520376
    ZMIN =  -48.076714 ZMAX =  -48.076714 ZAVE =  -48.076714
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.50078957"
Evaluating: -9.50078957+3.5
 Parameter: XMAX <- "-6.00078957"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-58.5203762"
Evaluating: -58.5203762+3.5
 Parameter: YMAX <- "-55.0203762"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.076714"
Evaluating: -48.076714+3.5
 Parameter: ZMAX <- "-44.576714"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.50078957"
Evaluating: -9.50078957-3.5
 Parameter: XMIN <- "-13.0007896"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-58.5203762"
Evaluating: -58.5203762-3.5
 Parameter: YMIN <- "-62.0203762"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.076714"
Evaluating: -48.076714-3.5
 Parameter: ZMIN <- "-51.576714"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.00078957"
 Parameter: XMIN -> "-13.0007896"
 Parameter: YMAX -> "-55.0203762"
 Parameter: YMIN -> "-62.0203762"
 Parameter: ZMAX -> "-44.576714"
 Parameter: ZMIN -> "-51.576714"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "129" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "129" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "117"
Evaluating: 129-117
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.734546615"
Evaluating: 128.065641*(0.734546615-0.5)
 Parameter: XPOS <- "30.0373626"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.122044858"
Evaluating: 128.065641*(0.122044858-0.5)
 Parameter: YPOS <- "-48.4030675"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.832867163"
Evaluating: 108.613069*(0.832867163-0.5)+-2.187274
 Parameter: ZPOS <- "33.9664501"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.9664501" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.9664501" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.0373626"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.0373626-0
 Parameter: XTRAN <- "30.0373626"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.4030675"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.4030675-0
 Parameter: YTRAN <- "-48.4030675"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.9664501"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.9664501-0
 Parameter: ZTRAN <- "33.9664501"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.0373626"
 Parameter: YTRAN -> "-48.4030675"
 Parameter: ZTRAN -> "33.9664501"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    30.037363  -48.403067   33.966450
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.133313341E-02"
Evaluating: 4.133313341E-02*360.0
 Parameter: XPHI <- "14.879928"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416431446"
Evaluating: 0.416431446*360.0
 Parameter: YPHI <- "149.915321"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218313127"
Evaluating: 0.218313127*360.0
 Parameter: ZPHI <- "78.5927257"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.0373626"
 Parameter: YPOS -> "-48.4030675"
 Parameter: ZPOS -> "33.9664501"
 Parameter: XPHI -> "14.879928"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.966466    0.256794
    0.000000   -0.256794    0.966466

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.0373626"
 Parameter: YPOS -> "-48.4030675"
 Parameter: ZPOS -> "33.9664501"
 Parameter: YPHI -> "149.915321"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.865285    0.000000   -0.501279
    0.000000    1.000000    0.000000
    0.501279    0.000000   -0.865285

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  149.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.0373626"
 Parameter: YPOS -> "-48.4030675"
 Parameter: ZPOS -> "33.9664501"
 Parameter: ZPHI -> "78.5927257"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.197782    0.980246    0.000000
   -0.980246    0.197782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   78.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.037363 XMAX =   30.037363 XAVE =   30.037363
    YMIN =  -48.403067 YMAX =  -48.403067 YAVE =  -48.403067
    ZMIN =   33.966450 ZMAX =   33.966450 ZAVE =   33.966450
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.0373626"
Evaluating: 30.0373626+3.5
 Parameter: XMAX <- "33.5373626"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.4030675"
Evaluating: -48.4030675+3.5
 Parameter: YMAX <- "-44.9030675"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.9664501"
Evaluating: 33.9664501+3.5
 Parameter: ZMAX <- "37.4664501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.0373626"
Evaluating: 30.0373626-3.5
 Parameter: XMIN <- "26.5373626"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.4030675"
Evaluating: -48.4030675-3.5
 Parameter: YMIN <- "-51.9030675"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.9664501"
Evaluating: 33.9664501-3.5
 Parameter: ZMIN <- "30.4664501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.5373626"
 Parameter: XMIN -> "26.5373626"
 Parameter: YMAX -> "-44.9030675"
 Parameter: YMIN -> "-51.9030675"
 Parameter: ZMAX -> "37.4664501"
 Parameter: ZMIN -> "30.4664501"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "130" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "130" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "130"
 Parameter: NPOS -> "117"
Evaluating: 130-117
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.510106897"
Evaluating: 128.065641*(0.510106897-0.5)
 Parameter: XPOS <- "1.29434624"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.227455932"
Evaluating: 128.065641*(0.227455932-0.5)
 Parameter: YPOS <- "-34.9035308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.869067506"
Evaluating: 108.613069*(0.869067506-0.5)+-2.187274
 Parameter: ZPOS <- "37.8982805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.8982805" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.8982805" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.29434624"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.29434624-0
 Parameter: XTRAN <- "1.29434624"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.9035308"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.9035308-0
 Parameter: YTRAN <- "-34.9035308"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.8982805"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.8982805-0
 Parameter: ZTRAN <- "37.8982805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.29434624"
 Parameter: YTRAN -> "-34.9035308"
 Parameter: ZTRAN -> "37.8982805"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     1.294346  -34.903531   37.898280
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874634553"
Evaluating: 0.874634553*360.0
 Parameter: XPHI <- "314.868439"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460036889"
Evaluating: 0.460036889*360.0
 Parameter: YPHI <- "165.61328"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376755494"
Evaluating: 0.376755494*360.0
 Parameter: ZPHI <- "135.631978"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.29434624"
 Parameter: YPOS -> "-34.9035308"
 Parameter: ZPOS -> "37.8982805"
 Parameter: XPHI -> "314.868439"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.705481   -0.708729
    0.000000    0.708729    0.705481

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.29434624"
 Parameter: YPOS -> "-34.9035308"
 Parameter: ZPOS -> "37.8982805"
 Parameter: YPHI -> "165.61328"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.968641    0.000000   -0.248465
    0.000000    1.000000    0.000000
    0.248465    0.000000   -0.968641

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.29434624"
 Parameter: YPOS -> "-34.9035308"
 Parameter: ZPOS -> "37.8982805"
 Parameter: ZPHI -> "135.631978"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.714863    0.699264    0.000000
   -0.699264   -0.714863    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.294346 XMAX =    1.294346 XAVE =    1.294346
    YMIN =  -34.903531 YMAX =  -34.903531 YAVE =  -34.903531
    ZMIN =   37.898280 ZMAX =   37.898280 ZAVE =   37.898280
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.29434624"
Evaluating: 1.29434624+3.5
 Parameter: XMAX <- "4.79434624"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.9035308"
Evaluating: -34.9035308+3.5
 Parameter: YMAX <- "-31.4035308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.8982805"
Evaluating: 37.8982805+3.5
 Parameter: ZMAX <- "41.3982805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.29434624"
Evaluating: 1.29434624-3.5
 Parameter: XMIN <- "-2.20565376"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.9035308"
Evaluating: -34.9035308-3.5
 Parameter: YMIN <- "-38.4035308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.8982805"
Evaluating: 37.8982805-3.5
 Parameter: ZMIN <- "34.3982805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.79434624"
 Parameter: XMIN -> "-2.20565376"
 Parameter: YMAX -> "-31.4035308"
 Parameter: YMIN -> "-38.4035308"
 Parameter: ZMAX -> "41.3982805"
 Parameter: ZMIN -> "34.3982805"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "131" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "131" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "117"
Evaluating: 131-117
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.684677869"
Evaluating: 128.065641*(0.684677869-0.5)
 Parameter: XPOS <- "23.6508897"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "1.215783182E-02"
Evaluating: 128.065641*(1.215783182E-02-0.5)
 Parameter: YPOS <- "-62.47582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.786132686"
Evaluating: 108.613069*(0.786132686-0.5)+-2.187274
 Parameter: ZPOS <- "28.8904752"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.8904752" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.8904752" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.6508897"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.6508897-0
 Parameter: XTRAN <- "23.6508897"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-62.47582"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -62.47582-0
 Parameter: YTRAN <- "-62.47582"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.8904752"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.8904752-0
 Parameter: ZTRAN <- "28.8904752"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.6508897"
 Parameter: YTRAN -> "-62.47582"
 Parameter: ZTRAN -> "28.8904752"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    23.650890  -62.475820   28.890475
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289559584"
Evaluating: 0.289559584*360.0
 Parameter: XPHI <- "104.24145"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102456924"
Evaluating: 0.102456924*360.0
 Parameter: YPHI <- "36.8844926"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.51476468"
Evaluating: 0.51476468*360.0
 Parameter: ZPHI <- "185.315285"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.6508897"
 Parameter: YPOS -> "-62.47582"
 Parameter: ZPOS -> "28.8904752"
 Parameter: XPHI -> "104.24145"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.246009    0.969268
    0.000000   -0.969268   -0.246009

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.6508897"
 Parameter: YPOS -> "-62.47582"
 Parameter: ZPOS -> "28.8904752"
 Parameter: YPHI -> "36.8844926"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.799847    0.000000   -0.600204
    0.000000    1.000000    0.000000
    0.600204    0.000000    0.799847

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.6508897"
 Parameter: YPOS -> "-62.47582"
 Parameter: ZPOS -> "28.8904752"
 Parameter: ZPHI -> "185.315285"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.995700   -0.092636    0.000000
    0.092636   -0.995700    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  174.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.650890 XMAX =   23.650890 XAVE =   23.650890
    YMIN =  -62.475820 YMAX =  -62.475820 YAVE =  -62.475820
    ZMIN =   28.890475 ZMAX =   28.890475 ZAVE =   28.890475
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.6508897"
Evaluating: 23.6508897+3.5
 Parameter: XMAX <- "27.1508897"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-62.47582"
Evaluating: -62.47582+3.5
 Parameter: YMAX <- "-58.97582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.8904752"
Evaluating: 28.8904752+3.5
 Parameter: ZMAX <- "32.3904752"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.6508897"
Evaluating: 23.6508897-3.5
 Parameter: XMIN <- "20.1508897"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-62.47582"
Evaluating: -62.47582-3.5
 Parameter: YMIN <- "-65.97582"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.8904752"
Evaluating: 28.8904752-3.5
 Parameter: ZMIN <- "25.3904752"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.1508897"
 Parameter: XMIN -> "20.1508897"
 Parameter: YMAX -> "-58.97582"
 Parameter: YMIN -> "-65.97582"
 Parameter: ZMAX -> "32.3904752"
 Parameter: ZMIN -> "25.3904752"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "132" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "132" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "117"
Evaluating: 132-117
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.273660996"
Evaluating: 128.065641*(0.273660996-0.5)
 Parameter: XPOS <- "-28.9862496"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.259154978"
Evaluating: 128.065641*(0.259154978-0.5)
 Parameter: YPOS <- "-30.8439721"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.317267233"
Evaluating: 108.613069*(0.317267233-0.5)+-2.187274
 Parameter: ZPOS <- "-22.0344406"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.0344406" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.9862496"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.9862496-0
 Parameter: XTRAN <- "-28.9862496"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.8439721"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.8439721-0
 Parameter: YTRAN <- "-30.8439721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.0344406"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.0344406-0
 Parameter: ZTRAN <- "-22.0344406"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.9862496"
 Parameter: YTRAN -> "-30.8439721"
 Parameter: ZTRAN -> "-22.0344406"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -28.986250  -30.843972  -22.034441
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487089157"
Evaluating: 0.487089157*360.0
 Parameter: XPHI <- "175.352097"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398043153"
Evaluating: 0.398043153*360.0
 Parameter: YPHI <- "143.295535"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249698998"
Evaluating: 0.249698998*360.0
 Parameter: ZPHI <- "89.8916393"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.9862496"
 Parameter: YPOS -> "-30.8439721"
 Parameter: ZPOS -> "-22.0344406"
 Parameter: XPHI -> "175.352097"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996711    0.081032
    0.000000   -0.081032   -0.996711

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.9862496"
 Parameter: YPOS -> "-30.8439721"
 Parameter: ZPOS -> "-22.0344406"
 Parameter: YPHI -> "143.295535"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.801729    0.000000   -0.597688
    0.000000    1.000000    0.000000
    0.597688    0.000000   -0.801729

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  143.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.9862496"
 Parameter: YPOS -> "-30.8439721"
 Parameter: ZPOS -> "-22.0344406"
 Parameter: ZPHI -> "89.8916393"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.001891    0.999998    0.000000
   -0.999998    0.001891    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.986250 XMAX =  -28.986250 XAVE =  -28.986250
    YMIN =  -30.843972 YMAX =  -30.843972 YAVE =  -30.843972
    ZMIN =  -22.034441 ZMAX =  -22.034441 ZAVE =  -22.034441
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.9862496"
Evaluating: -28.9862496+3.5
 Parameter: XMAX <- "-25.4862496"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.8439721"
Evaluating: -30.8439721+3.5
 Parameter: YMAX <- "-27.3439721"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.0344406"
Evaluating: -22.0344406+3.5
 Parameter: ZMAX <- "-18.5344406"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.9862496"
Evaluating: -28.9862496-3.5
 Parameter: XMIN <- "-32.4862496"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.8439721"
Evaluating: -30.8439721-3.5
 Parameter: YMIN <- "-34.3439721"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.0344406"
Evaluating: -22.0344406-3.5
 Parameter: ZMIN <- "-25.5344406"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.4862496"
 Parameter: XMIN -> "-32.4862496"
 Parameter: YMAX -> "-27.3439721"
 Parameter: YMIN -> "-34.3439721"
 Parameter: ZMAX -> "-18.5344406"
 Parameter: ZMIN -> "-25.5344406"
 SELRPN>      2 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      2 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "133" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "133" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "117"
Evaluating: 133-117
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.637887395"
Evaluating: 128.065641*(0.637887395-0.5)
 Parameter: XPOS <- "17.6586376"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.291821819"
Evaluating: 128.065641*(0.291821819-0.5)
 Parameter: YPOS <- "-26.6604722"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.87310293"
Evaluating: 108.613069*(0.87310293-0.5)+-2.187274
 Parameter: ZPOS <- "38.3365803"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.3365803" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.3365803" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.6586376"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.6586376-0
 Parameter: XTRAN <- "17.6586376"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.6604722"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.6604722-0
 Parameter: YTRAN <- "-26.6604722"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.3365803"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.3365803-0
 Parameter: ZTRAN <- "38.3365803"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.6586376"
 Parameter: YTRAN -> "-26.6604722"
 Parameter: ZTRAN -> "38.3365803"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    17.658638  -26.660472   38.336580
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46694627"
Evaluating: 0.46694627*360.0
 Parameter: XPHI <- "168.100657"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.812933307"
Evaluating: 0.812933307*360.0
 Parameter: YPHI <- "292.655991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.194894029"
Evaluating: 0.194894029*360.0
 Parameter: ZPHI <- "70.1618504"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.6586376"
 Parameter: YPOS -> "-26.6604722"
 Parameter: ZPOS -> "38.3365803"
 Parameter: XPHI -> "168.100657"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978511    0.206193
    0.000000   -0.206193   -0.978511

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.6586376"
 Parameter: YPOS -> "-26.6604722"
 Parameter: ZPOS -> "38.3365803"
 Parameter: YPHI -> "292.655991"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.385197    0.000000    0.922834
    0.000000    1.000000    0.000000
   -0.922834    0.000000    0.385197

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.6586376"
 Parameter: YPOS -> "-26.6604722"
 Parameter: ZPOS -> "38.3365803"
 Parameter: ZPHI -> "70.1618504"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.339364    0.940655    0.000000
   -0.940655    0.339364    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.658638 XMAX =   17.658638 XAVE =   17.658638
    YMIN =  -26.660472 YMAX =  -26.660472 YAVE =  -26.660472
    ZMIN =   38.336580 ZMAX =   38.336580 ZAVE =   38.336580
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.6586376"
Evaluating: 17.6586376+3.5
 Parameter: XMAX <- "21.1586376"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.6604722"
Evaluating: -26.6604722+3.5
 Parameter: YMAX <- "-23.1604722"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.3365803"
Evaluating: 38.3365803+3.5
 Parameter: ZMAX <- "41.8365803"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.6586376"
Evaluating: 17.6586376-3.5
 Parameter: XMIN <- "14.1586376"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.6604722"
Evaluating: -26.6604722-3.5
 Parameter: YMIN <- "-30.1604722"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.3365803"
Evaluating: 38.3365803-3.5
 Parameter: ZMIN <- "34.8365803"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.1586376"
 Parameter: XMIN -> "14.1586376"
 Parameter: YMAX -> "-23.1604722"
 Parameter: YMIN -> "-30.1604722"
 Parameter: ZMAX -> "41.8365803"
 Parameter: ZMIN -> "34.8365803"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "134" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "134" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "117"
Evaluating: 134-117
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.318530571"
Evaluating: 128.065641*(0.318530571-0.5)
 Parameter: XPOS <- "-23.2399987"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.821375463"
Evaluating: 128.065641*(0.821375463-0.5)
 Parameter: YPOS <- "41.1571547"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.320533525"
Evaluating: 108.613069*(0.320533525-0.5)+-2.187274
 Parameter: ZPOS <- "-21.6796786"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.6796786" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.2399987"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.2399987-0
 Parameter: XTRAN <- "-23.2399987"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.1571547"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.1571547-0
 Parameter: YTRAN <- "41.1571547"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.6796786"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.6796786-0
 Parameter: ZTRAN <- "-21.6796786"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.2399987"
 Parameter: YTRAN -> "41.1571547"
 Parameter: ZTRAN -> "-21.6796786"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -23.239999   41.157155  -21.679679
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.965066299E-02"
Evaluating: 5.965066299E-02*360.0
 Parameter: XPHI <- "21.4742387"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132821043"
Evaluating: 0.132821043*360.0
 Parameter: YPHI <- "47.8155755"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271421974"
Evaluating: 0.271421974*360.0
 Parameter: ZPHI <- "97.7119106"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.2399987"
 Parameter: YPOS -> "41.1571547"
 Parameter: ZPOS -> "-21.6796786"
 Parameter: XPHI -> "21.4742387"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.930582    0.366083
    0.000000   -0.366083    0.930582

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   21.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.2399987"
 Parameter: YPOS -> "41.1571547"
 Parameter: ZPOS -> "-21.6796786"
 Parameter: YPHI -> "47.8155755"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.671519    0.000000   -0.740987
    0.000000    1.000000    0.000000
    0.740987    0.000000    0.671519

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.2399987"
 Parameter: YPOS -> "41.1571547"
 Parameter: ZPOS -> "-21.6796786"
 Parameter: ZPHI -> "97.7119106"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.134192    0.990955    0.000000
   -0.990955   -0.134192    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   97.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.239999 XMAX =  -23.239999 XAVE =  -23.239999
    YMIN =   41.157155 YMAX =   41.157155 YAVE =   41.157155
    ZMIN =  -21.679679 ZMAX =  -21.679679 ZAVE =  -21.679679
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.2399987"
Evaluating: -23.2399987+3.5
 Parameter: XMAX <- "-19.7399987"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.1571547"
Evaluating: 41.1571547+3.5
 Parameter: YMAX <- "44.6571547"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.6796786"
Evaluating: -21.6796786+3.5
 Parameter: ZMAX <- "-18.1796786"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.2399987"
Evaluating: -23.2399987-3.5
 Parameter: XMIN <- "-26.7399987"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.1571547"
Evaluating: 41.1571547-3.5
 Parameter: YMIN <- "37.6571547"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.6796786"
Evaluating: -21.6796786-3.5
 Parameter: ZMIN <- "-25.1796786"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.7399987"
 Parameter: XMIN -> "-26.7399987"
 Parameter: YMAX -> "44.6571547"
 Parameter: YMIN -> "37.6571547"
 Parameter: ZMAX -> "-18.1796786"
 Parameter: ZMIN -> "-25.1796786"
 SELRPN>      3 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "135" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "135" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "117"
Evaluating: 135-117
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.466683292"
Evaluating: 128.065641*(0.466683292-0.5)
 Parameter: XPOS <- "-4.26672557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.443483411"
Evaluating: 128.065641*(0.443483411-0.5)
 Parameter: YPOS <- "-7.2378332"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "9.212140169E-02"
Evaluating: 108.613069*(9.212140169E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-46.4882203"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.4882203" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.26672557"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.26672557-0
 Parameter: XTRAN <- "-4.26672557"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.2378332"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.2378332-0
 Parameter: YTRAN <- "-7.2378332"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.4882203"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.4882203-0
 Parameter: ZTRAN <- "-46.4882203"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.26672557"
 Parameter: YTRAN -> "-7.2378332"
 Parameter: ZTRAN -> "-46.4882203"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -4.266726   -7.237833  -46.488220
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856335618"
Evaluating: 0.856335618*360.0
 Parameter: XPHI <- "308.280822"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766730058"
Evaluating: 0.766730058*360.0
 Parameter: YPHI <- "276.022821"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.545094518"
Evaluating: 0.545094518*360.0
 Parameter: ZPHI <- "196.234026"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.26672557"
 Parameter: YPOS -> "-7.2378332"
 Parameter: ZPOS -> "-46.4882203"
 Parameter: XPHI -> "308.280822"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.619516   -0.784984
    0.000000    0.784984    0.619516

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.26672557"
 Parameter: YPOS -> "-7.2378332"
 Parameter: ZPOS -> "-46.4882203"
 Parameter: YPHI -> "276.022821"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.104925    0.000000    0.994480
    0.000000    1.000000    0.000000
   -0.994480    0.000000    0.104925

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.26672557"
 Parameter: YPOS -> "-7.2378332"
 Parameter: ZPOS -> "-46.4882203"
 Parameter: ZPHI -> "196.234026"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.960128   -0.279561    0.000000
    0.279561   -0.960128    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  163.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.266726 XMAX =   -4.266726 XAVE =   -4.266726
    YMIN =   -7.237833 YMAX =   -7.237833 YAVE =   -7.237833
    ZMIN =  -46.488220 ZMAX =  -46.488220 ZAVE =  -46.488220
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.26672557"
Evaluating: -4.26672557+3.5
 Parameter: XMAX <- "-0.76672557"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.2378332"
Evaluating: -7.2378332+3.5
 Parameter: YMAX <- "-3.7378332"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.4882203"
Evaluating: -46.4882203+3.5
 Parameter: ZMAX <- "-42.9882203"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.26672557"
Evaluating: -4.26672557-3.5
 Parameter: XMIN <- "-7.76672557"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.2378332"
Evaluating: -7.2378332-3.5
 Parameter: YMIN <- "-10.7378332"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.4882203"
Evaluating: -46.4882203-3.5
 Parameter: ZMIN <- "-49.9882203"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.76672557"
 Parameter: XMIN -> "-7.76672557"
 Parameter: YMAX -> "-3.7378332"
 Parameter: YMIN -> "-10.7378332"
 Parameter: ZMAX -> "-42.9882203"
 Parameter: ZMIN -> "-49.9882203"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "136" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "136" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "117"
Evaluating: 136-117
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.355665075"
Evaluating: 128.065641*(0.355665075-0.5)
 Parameter: XPOS <- "-18.4843447"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.171113266E-03"
Evaluating: 128.065641*(7.171113266E-03-0.5)
 Parameter: YPOS <- "-63.1144473"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.261795486"
Evaluating: 108.613069*(0.261795486-0.5)+-2.187274
 Parameter: ZPOS <- "-28.0593973"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.0593973" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.4843447"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.4843447-0
 Parameter: XTRAN <- "-18.4843447"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-63.1144473"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -63.1144473-0
 Parameter: YTRAN <- "-63.1144473"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.0593973"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.0593973-0
 Parameter: ZTRAN <- "-28.0593973"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.4843447"
 Parameter: YTRAN -> "-63.1144473"
 Parameter: ZTRAN -> "-28.0593973"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -18.484345  -63.114447  -28.059397
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546613041"
Evaluating: 0.546613041*360.0
 Parameter: XPHI <- "196.780695"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.117799027"
Evaluating: 0.117799027*360.0
 Parameter: YPHI <- "42.4076497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.414287612"
Evaluating: 0.414287612*360.0
 Parameter: ZPHI <- "149.14354"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.4843447"
 Parameter: YPOS -> "-63.1144473"
 Parameter: ZPOS -> "-28.0593973"
 Parameter: XPHI -> "196.780695"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.957417   -0.288709
    0.000000    0.288709   -0.957417

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  163.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.4843447"
 Parameter: YPOS -> "-63.1144473"
 Parameter: ZPOS -> "-28.0593973"
 Parameter: YPHI -> "42.4076497"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.738365    0.000000   -0.674401
    0.000000    1.000000    0.000000
    0.674401    0.000000    0.738365

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   42.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.4843447"
 Parameter: YPOS -> "-63.1144473"
 Parameter: ZPOS -> "-28.0593973"
 Parameter: ZPHI -> "149.14354"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.858455    0.512889    0.000000
   -0.512889   -0.858455    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  149.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.484345 XMAX =  -18.484345 XAVE =  -18.484345
    YMIN =  -63.114447 YMAX =  -63.114447 YAVE =  -63.114447
    ZMIN =  -28.059397 ZMAX =  -28.059397 ZAVE =  -28.059397
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.4843447"
Evaluating: -18.4843447+3.5
 Parameter: XMAX <- "-14.9843447"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-63.1144473"
Evaluating: -63.1144473+3.5
 Parameter: YMAX <- "-59.6144473"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.0593973"
Evaluating: -28.0593973+3.5
 Parameter: ZMAX <- "-24.5593973"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.4843447"
Evaluating: -18.4843447-3.5
 Parameter: XMIN <- "-21.9843447"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-63.1144473"
Evaluating: -63.1144473-3.5
 Parameter: YMIN <- "-66.6144473"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.0593973"
Evaluating: -28.0593973-3.5
 Parameter: ZMIN <- "-31.5593973"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.9843447"
 Parameter: XMIN -> "-21.9843447"
 Parameter: YMAX -> "-59.6144473"
 Parameter: YMIN -> "-66.6144473"
 Parameter: ZMAX -> "-24.5593973"
 Parameter: ZMIN -> "-31.5593973"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "137" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "137" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "117"
Evaluating: 137-117
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.860065369"
Evaluating: 128.065641*(0.860065369-0.5)
 Parameter: XPOS <- "46.1120023"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.342832169"
Evaluating: 128.065641*(0.342832169-0.5)
 Parameter: YPOS <- "-20.127799"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.389833189"
Evaluating: 108.613069*(0.389833189-0.5)+-2.187274
 Parameter: ZPOS <- "-14.1528294"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.1528294" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.1528294" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "137" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "117"
Evaluating: 137-117
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.280067223"
Evaluating: 128.065641*(0.280067223-0.5)
 Parameter: XPOS <- "-28.1658321"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.90388745"
Evaluating: 128.065641*(0.90388745-0.5)
 Parameter: YPOS <- "51.7241052"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.316291128"
Evaluating: 108.613069*(0.316291128-0.5)+-2.187274
 Parameter: ZPOS <- "-22.1404584"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.1404584" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.1658321"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.1658321-0
 Parameter: XTRAN <- "-28.1658321"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.7241052"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.7241052-0
 Parameter: YTRAN <- "51.7241052"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.1404584"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.1404584-0
 Parameter: ZTRAN <- "-22.1404584"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.1658321"
 Parameter: YTRAN -> "51.7241052"
 Parameter: ZTRAN -> "-22.1404584"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -28.165832   51.724105  -22.140458
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.55595302"
Evaluating: 0.55595302*360.0
 Parameter: XPHI <- "200.143087"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995645096"
Evaluating: 0.995645096*360.0
 Parameter: YPHI <- "358.432235"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554885378"
Evaluating: 0.554885378*360.0
 Parameter: ZPHI <- "199.758736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.1658321"
 Parameter: YPOS -> "51.7241052"
 Parameter: ZPOS -> "-22.1404584"
 Parameter: XPHI -> "200.143087"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.938836   -0.344366
    0.000000    0.344366   -0.938836

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.1658321"
 Parameter: YPOS -> "51.7241052"
 Parameter: ZPOS -> "-22.1404584"
 Parameter: YPHI -> "358.432235"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999626    0.000000    0.027359
    0.000000    1.000000    0.000000
   -0.027359    0.000000    0.999626

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.1658321"
 Parameter: YPOS -> "51.7241052"
 Parameter: ZPOS -> "-22.1404584"
 Parameter: ZPHI -> "199.758736"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.941124   -0.338060    0.000000
    0.338060   -0.941124    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.165832 XMAX =  -28.165832 XAVE =  -28.165832
    YMIN =   51.724105 YMAX =   51.724105 YAVE =   51.724105
    ZMIN =  -22.140458 ZMAX =  -22.140458 ZAVE =  -22.140458
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.1658321"
Evaluating: -28.1658321+3.5
 Parameter: XMAX <- "-24.6658321"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.7241052"
Evaluating: 51.7241052+3.5
 Parameter: YMAX <- "55.2241052"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.1404584"
Evaluating: -22.1404584+3.5
 Parameter: ZMAX <- "-18.6404584"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.1658321"
Evaluating: -28.1658321-3.5
 Parameter: XMIN <- "-31.6658321"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.7241052"
Evaluating: 51.7241052-3.5
 Parameter: YMIN <- "48.2241052"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.1404584"
Evaluating: -22.1404584-3.5
 Parameter: ZMIN <- "-25.6404584"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.6658321"
 Parameter: XMIN -> "-31.6658321"
 Parameter: YMAX -> "55.2241052"
 Parameter: YMIN -> "48.2241052"
 Parameter: ZMAX -> "-18.6404584"
 Parameter: ZMIN -> "-25.6404584"
 SELRPN>      2 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "138" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "138" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "117"
Evaluating: 138-117
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.318333588"
Evaluating: 128.065641*(0.318333588-0.5)
 Parameter: XPOS <- "-23.2652255"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.956917832"
Evaluating: 128.065641*(0.956917832-0.5)
 Parameter: YPOS <- "58.515475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.516348155"
Evaluating: 108.613069*(0.516348155-0.5)+-2.187274
 Parameter: ZPOS <- "-0.411650713"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.411650713" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.411650713" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "138" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "117"
Evaluating: 138-117
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.53939767"
Evaluating: 128.065641*(0.53939767-0.5)
 Parameter: XPOS <- "5.04548786"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.604842651E-02"
Evaluating: 128.065641*(5.604842651E-02-0.5)
 Parameter: YPOS <- "-56.8549428"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.361660067"
Evaluating: 108.613069*(0.361660067-0.5)+-2.187274
 Parameter: ZPOS <- "-17.2127987"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.2127987" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.04548786"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.04548786-0
 Parameter: XTRAN <- "5.04548786"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.8549428"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.8549428-0
 Parameter: YTRAN <- "-56.8549428"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.2127987"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.2127987-0
 Parameter: ZTRAN <- "-17.2127987"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.04548786"
 Parameter: YTRAN -> "-56.8549428"
 Parameter: ZTRAN -> "-17.2127987"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     5.045488  -56.854943  -17.212799
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854446158"
Evaluating: 0.854446158*360.0
 Parameter: XPHI <- "307.600617"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685875298"
Evaluating: 0.685875298*360.0
 Parameter: YPHI <- "246.915107"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694470568"
Evaluating: 0.694470568*360.0
 Parameter: ZPHI <- "250.009404"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.04548786"
 Parameter: YPOS -> "-56.8549428"
 Parameter: ZPOS -> "-17.2127987"
 Parameter: XPHI -> "307.600617"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.610154   -0.792283
    0.000000    0.792283    0.610154

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.04548786"
 Parameter: YPOS -> "-56.8549428"
 Parameter: ZPOS -> "-17.2127987"
 Parameter: YPHI -> "246.915107"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.392095    0.000000    0.919925
    0.000000    1.000000    0.000000
   -0.919925    0.000000   -0.392095

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.04548786"
 Parameter: YPOS -> "-56.8549428"
 Parameter: ZPOS -> "-17.2127987"
 Parameter: ZPHI -> "250.009404"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.341866   -0.939749    0.000000
    0.939749   -0.341866    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.045488 XMAX =    5.045488 XAVE =    5.045488
    YMIN =  -56.854943 YMAX =  -56.854943 YAVE =  -56.854943
    ZMIN =  -17.212799 ZMAX =  -17.212799 ZAVE =  -17.212799
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.04548786"
Evaluating: 5.04548786+3.5
 Parameter: XMAX <- "8.54548786"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.8549428"
Evaluating: -56.8549428+3.5
 Parameter: YMAX <- "-53.3549428"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.2127987"
Evaluating: -17.2127987+3.5
 Parameter: ZMAX <- "-13.7127987"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.04548786"
Evaluating: 5.04548786-3.5
 Parameter: XMIN <- "1.54548786"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.8549428"
Evaluating: -56.8549428-3.5
 Parameter: YMIN <- "-60.3549428"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.2127987"
Evaluating: -17.2127987-3.5
 Parameter: ZMIN <- "-20.7127987"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.54548786"
 Parameter: XMIN -> "1.54548786"
 Parameter: YMAX -> "-53.3549428"
 Parameter: YMIN -> "-60.3549428"
 Parameter: ZMAX -> "-13.7127987"
 Parameter: ZMIN -> "-20.7127987"
 SELRPN>     26 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     12 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      P             2.4421
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      O13           1.5685
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      O14           3.4633
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      O11           2.4984
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      O12           3.5511
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      C1            2.2210
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      C2            3.4476
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     279      O22           2.8397
60370 NEG      CLA      21       CLA     -**** MEMB     DMPC     311      C14           3.6743
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "138" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "117"
Evaluating: 138-117
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.235093953"
Evaluating: 128.065641*(0.235093953-0.5)
 Parameter: XPOS <- "-33.9253627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.208934368"
Evaluating: 128.065641*(0.208934368-0.5)
 Parameter: YPOS <- "-37.2755067"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.760723305"
Evaluating: 108.613069*(0.760723305-0.5)+-2.187274
 Parameter: ZPOS <- "26.1306843"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.1306843" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.1306843" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.045488 XMAX =    5.045488 XAVE =    5.045488
    YMIN =  -56.854943 YMAX =  -56.854943 YAVE =  -56.854943
    ZMIN =  -17.212799 ZMAX =  -17.212799 ZAVE =  -17.212799
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.9253627"
 RDCMND substituted energy or value "?XAVE" to "5.04548786"
Evaluating: -33.9253627-5.04548786
 Parameter: XTRAN <- "-38.9708506"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.2755067"
 RDCMND substituted energy or value "?YAVE" to "-56.8549428"
Evaluating: -37.2755067--56.8549428
 Parameter: YTRAN <- "19.5794361"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.1306843"
 RDCMND substituted energy or value "?ZAVE" to "-17.2127987"
Evaluating: 26.1306843--17.2127987
 Parameter: ZTRAN <- "43.343483"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.9708506"
 Parameter: YTRAN -> "19.5794361"
 Parameter: ZTRAN -> "43.343483"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -38.970851   19.579436   43.343483
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249981042"
Evaluating: 0.249981042*360.0
 Parameter: XPHI <- "89.9931751"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336211245"
Evaluating: 0.336211245*360.0
 Parameter: YPHI <- "121.036048"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698717953"
Evaluating: 0.698717953*360.0
 Parameter: ZPHI <- "251.538463"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.9253627"
 Parameter: YPOS -> "-37.2755067"
 Parameter: ZPOS -> "26.1306843"
 Parameter: XPHI -> "89.9931751"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.000119    1.000000
    0.000000   -1.000000    0.000119

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   89.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.9253627"
 Parameter: YPOS -> "-37.2755067"
 Parameter: ZPOS -> "26.1306843"
 Parameter: YPHI -> "121.036048"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.515577    0.000000   -0.856843
    0.000000    1.000000    0.000000
    0.856843    0.000000   -0.515577

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.9253627"
 Parameter: YPOS -> "-37.2755067"
 Parameter: ZPOS -> "26.1306843"
 Parameter: ZPHI -> "251.538463"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.316668   -0.948536    0.000000
    0.948536   -0.316668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.925363 XMAX =  -33.925363 XAVE =  -33.925363
    YMIN =  -37.275507 YMAX =  -37.275507 YAVE =  -37.275507
    ZMIN =   26.130684 ZMAX =   26.130684 ZAVE =   26.130684
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.9253627"
Evaluating: -33.9253627+3.5
 Parameter: XMAX <- "-30.4253627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.2755067"
Evaluating: -37.2755067+3.5
 Parameter: YMAX <- "-33.7755067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.1306843"
Evaluating: 26.1306843+3.5
 Parameter: ZMAX <- "29.6306843"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.9253627"
Evaluating: -33.9253627-3.5
 Parameter: XMIN <- "-37.4253627"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.2755067"
Evaluating: -37.2755067-3.5
 Parameter: YMIN <- "-40.7755067"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.1306843"
Evaluating: 26.1306843-3.5
 Parameter: ZMIN <- "22.6306843"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.4253627"
 Parameter: XMIN -> "-37.4253627"
 Parameter: YMAX -> "-33.7755067"
 Parameter: YMIN -> "-40.7755067"
 Parameter: ZMAX -> "29.6306843"
 Parameter: ZMIN -> "22.6306843"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "139" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "139" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "117"
Evaluating: 139-117
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.684009679"
Evaluating: 128.065641*(0.684009679-0.5)
 Parameter: XPOS <- "23.5653175"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.341994105"
Evaluating: 128.065641*(0.341994105-0.5)
 Parameter: YPOS <- "-20.2351262"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.429135127"
Evaluating: 108.613069*(0.429135127-0.5)+-2.187274
 Parameter: ZPOS <- "-9.88412534"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.88412534" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.88412534" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "139" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "117"
Evaluating: 139-117
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.176564382"
Evaluating: 128.065641*(0.176564382-0.5)
 Parameter: XPOS <- "-41.4209897"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.41171947"
Evaluating: 128.065641*(0.41171947-0.5)
 Parameter: YPOS <- "-11.3057027"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.970540252"
Evaluating: 108.613069*(0.970540252-0.5)+-2.187274
 Parameter: ZPOS <- "48.9195469"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.9195469" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.9195469" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.4209897"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.4209897-0
 Parameter: XTRAN <- "-41.4209897"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.3057027"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.3057027-0
 Parameter: YTRAN <- "-11.3057027"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.9195469"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.9195469-0
 Parameter: ZTRAN <- "48.9195469"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.4209897"
 Parameter: YTRAN -> "-11.3057027"
 Parameter: ZTRAN -> "48.9195469"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -41.420990  -11.305703   48.919547
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906726672"
Evaluating: 0.906726672*360.0
 Parameter: XPHI <- "326.421602"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489071337"
Evaluating: 0.489071337*360.0
 Parameter: YPHI <- "176.065681"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712931596"
Evaluating: 0.712931596*360.0
 Parameter: ZPHI <- "256.655375"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.4209897"
 Parameter: YPOS -> "-11.3057027"
 Parameter: ZPOS -> "48.9195469"
 Parameter: XPHI -> "326.421602"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.833130   -0.553077
    0.000000    0.553077    0.833130

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.4209897"
 Parameter: YPOS -> "-11.3057027"
 Parameter: ZPOS -> "48.9195469"
 Parameter: YPHI -> "176.065681"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.997643    0.000000   -0.068613
    0.000000    1.000000    0.000000
    0.068613    0.000000   -0.997643

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.4209897"
 Parameter: YPOS -> "-11.3057027"
 Parameter: ZPOS -> "48.9195469"
 Parameter: ZPHI -> "256.655375"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.230808   -0.972999    0.000000
    0.972999   -0.230808    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  103.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.420990 XMAX =  -41.420990 XAVE =  -41.420990
    YMIN =  -11.305703 YMAX =  -11.305703 YAVE =  -11.305703
    ZMIN =   48.919547 ZMAX =   48.919547 ZAVE =   48.919547
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.4209897"
Evaluating: -41.4209897+3.5
 Parameter: XMAX <- "-37.9209897"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.3057027"
Evaluating: -11.3057027+3.5
 Parameter: YMAX <- "-7.8057027"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.9195469"
Evaluating: 48.9195469+3.5
 Parameter: ZMAX <- "52.4195469"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.4209897"
Evaluating: -41.4209897-3.5
 Parameter: XMIN <- "-44.9209897"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.3057027"
Evaluating: -11.3057027-3.5
 Parameter: YMIN <- "-14.8057027"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.9195469"
Evaluating: 48.9195469-3.5
 Parameter: ZMIN <- "45.4195469"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.9209897"
 Parameter: XMIN -> "-44.9209897"
 Parameter: YMAX -> "-7.8057027"
 Parameter: YMIN -> "-14.8057027"
 Parameter: ZMAX -> "52.4195469"
 Parameter: ZMIN -> "45.4195469"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "140" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "140" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "117"
Evaluating: 140-117
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.584165516E-02"
Evaluating: 128.065641*(3.584165516E-02-0.5)
 Parameter: XPOS <- "-59.442736"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.719002524E-02"
Evaluating: 128.065641*(3.719002524E-02-0.5)
 Parameter: YPOS <- "-59.2700561"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.564057485"
Evaluating: 108.613069*(0.564057485-0.5)+-2.187274
 Parameter: ZPOS <- "4.77020604"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.77020604" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.77020604" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "140" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "117"
Evaluating: 140-117
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.370322189"
Evaluating: 128.065641*(0.370322189-0.5)
 Parameter: XPOS <- "-16.607272"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.556451695"
Evaluating: 128.065641*(0.556451695-0.5)
 Parameter: YPOS <- "7.22952251"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.942232545"
Evaluating: 108.613069*(0.942232545-0.5)+-2.187274
 Parameter: ZPOS <- "45.8449599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8449599" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8449599" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.607272"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.607272-0
 Parameter: XTRAN <- "-16.607272"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.22952251"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.22952251-0
 Parameter: YTRAN <- "7.22952251"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8449599"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.8449599-0
 Parameter: ZTRAN <- "45.8449599"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.607272"
 Parameter: YTRAN -> "7.22952251"
 Parameter: ZTRAN -> "45.8449599"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -16.607272    7.229523   45.844960
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440613757"
Evaluating: 0.440613757*360.0
 Parameter: XPHI <- "158.620953"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572926424"
Evaluating: 0.572926424*360.0
 Parameter: YPHI <- "206.253513"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121948655"
Evaluating: 0.121948655*360.0
 Parameter: ZPHI <- "43.9015158"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.607272"
 Parameter: YPOS -> "7.22952251"
 Parameter: ZPOS -> "45.8449599"
 Parameter: XPHI -> "158.620953"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.931189    0.364536
    0.000000   -0.364536   -0.931189

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  158.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.607272"
 Parameter: YPOS -> "7.22952251"
 Parameter: ZPOS -> "45.8449599"
 Parameter: YPHI -> "206.253513"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.896846    0.000000    0.442344
    0.000000    1.000000    0.000000
   -0.442344    0.000000   -0.896846

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.607272"
 Parameter: YPOS -> "7.22952251"
 Parameter: ZPOS -> "45.8449599"
 Parameter: ZPHI -> "43.9015158"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.720533    0.693421    0.000000
   -0.693421    0.720533    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.607272 XMAX =  -16.607272 XAVE =  -16.607272
    YMIN =    7.229523 YMAX =    7.229523 YAVE =    7.229523
    ZMIN =   45.844960 ZMAX =   45.844960 ZAVE =   45.844960
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.607272"
Evaluating: -16.607272+3.5
 Parameter: XMAX <- "-13.107272"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.22952251"
Evaluating: 7.22952251+3.5
 Parameter: YMAX <- "10.7295225"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8449599"
Evaluating: 45.8449599+3.5
 Parameter: ZMAX <- "49.3449599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.607272"
Evaluating: -16.607272-3.5
 Parameter: XMIN <- "-20.107272"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.22952251"
Evaluating: 7.22952251-3.5
 Parameter: YMIN <- "3.72952251"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8449599"
Evaluating: 45.8449599-3.5
 Parameter: ZMIN <- "42.3449599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.107272"
 Parameter: XMIN -> "-20.107272"
 Parameter: YMAX -> "10.7295225"
 Parameter: YMIN -> "3.72952251"
 Parameter: ZMAX -> "49.3449599"
 Parameter: ZMIN -> "42.3449599"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "141" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "141" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "117"
Evaluating: 141-117
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.775079199"
Evaluating: 128.065641*(0.775079199-0.5)
 Parameter: XPOS <- "35.2281939"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.839952062"
Evaluating: 128.065641*(0.839952062-0.5)
 Parameter: YPOS <- "43.5361787"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.323227156"
Evaluating: 108.613069*(0.323227156-0.5)+-2.187274
 Parameter: ZPOS <- "-21.3871151"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.3871151" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.2281939"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.2281939-0
 Parameter: XTRAN <- "35.2281939"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.5361787"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.5361787-0
 Parameter: YTRAN <- "43.5361787"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.3871151"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.3871151-0
 Parameter: ZTRAN <- "-21.3871151"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.2281939"
 Parameter: YTRAN -> "43.5361787"
 Parameter: ZTRAN -> "-21.3871151"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    35.228194   43.536179  -21.387115
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658610586"
Evaluating: 0.658610586*360.0
 Parameter: XPHI <- "237.099811"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542861782"
Evaluating: 0.542861782*360.0
 Parameter: YPHI <- "195.430242"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.941348914"
Evaluating: 0.941348914*360.0
 Parameter: ZPHI <- "338.885609"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.2281939"
 Parameter: YPOS -> "43.5361787"
 Parameter: ZPOS -> "-21.3871151"
 Parameter: XPHI -> "237.099811"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.543177   -0.839618
    0.000000    0.839618   -0.543177

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.2281939"
 Parameter: YPOS -> "43.5361787"
 Parameter: ZPOS -> "-21.3871151"
 Parameter: YPHI -> "195.430242"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.963955    0.000000    0.266065
    0.000000    1.000000    0.000000
   -0.266065    0.000000   -0.963955

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  164.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.2281939"
 Parameter: YPOS -> "43.5361787"
 Parameter: ZPOS -> "-21.3871151"
 Parameter: ZPHI -> "338.885609"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.932863   -0.360231    0.000000
    0.360231    0.932863    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.228194 XMAX =   35.228194 XAVE =   35.228194
    YMIN =   43.536179 YMAX =   43.536179 YAVE =   43.536179
    ZMIN =  -21.387115 ZMAX =  -21.387115 ZAVE =  -21.387115
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.2281939"
Evaluating: 35.2281939+3.5
 Parameter: XMAX <- "38.7281939"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.5361787"
Evaluating: 43.5361787+3.5
 Parameter: YMAX <- "47.0361787"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.3871151"
Evaluating: -21.3871151+3.5
 Parameter: ZMAX <- "-17.8871151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.2281939"
Evaluating: 35.2281939-3.5
 Parameter: XMIN <- "31.7281939"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.5361787"
Evaluating: 43.5361787-3.5
 Parameter: YMIN <- "40.0361787"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.3871151"
Evaluating: -21.3871151-3.5
 Parameter: ZMIN <- "-24.8871151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.7281939"
 Parameter: XMIN -> "31.7281939"
 Parameter: YMAX -> "47.0361787"
 Parameter: YMIN -> "40.0361787"
 Parameter: ZMAX -> "-17.8871151"
 Parameter: ZMIN -> "-24.8871151"
 SELRPN>      3 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      3 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60373 NEG      CLA      24       CLA     -**** MEMB     DMPC     201      P             3.6396
60373 NEG      CLA      24       CLA     -**** MEMB     DMPC     201      O13           3.6308
60373 NEG      CLA      24       CLA     -**** MEMB     DMPC     201      O14           2.6976
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "141" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "117"
Evaluating: 141-117
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.203092587"
Evaluating: 128.065641*(0.203092587-0.5)
 Parameter: XPOS <- "-38.0236382"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.983972658"
Evaluating: 128.065641*(0.983972658-0.5)
 Parameter: YPOS <- "61.9802687"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.509705929"
Evaluating: 108.613069*(0.509705929-0.5)+-2.187274
 Parameter: ZPOS <- "-1.13308326"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.13308326" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.13308326" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "141" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "117"
Evaluating: 141-117
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.651651763"
Evaluating: 128.065641*(0.651651763-0.5)
 Parameter: XPOS <- "19.4213802"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.294798527"
Evaluating: 128.065641*(0.294798527-0.5)
 Parameter: YPOS <- "-26.2792582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "6.181604013E-02"
Evaluating: 108.613069*(6.181604013E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-49.7797787"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.7797787" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.228194 XMAX =   35.228194 XAVE =   35.228194
    YMIN =   43.536179 YMAX =   43.536179 YAVE =   43.536179
    ZMIN =  -21.387115 ZMAX =  -21.387115 ZAVE =  -21.387115
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.4213802"
 RDCMND substituted energy or value "?XAVE" to "35.2281939"
Evaluating: 19.4213802-35.2281939
 Parameter: XTRAN <- "-15.8068137"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.2792582"
 RDCMND substituted energy or value "?YAVE" to "43.5361787"
Evaluating: -26.2792582-43.5361787
 Parameter: YTRAN <- "-69.8154369"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.7797787"
 RDCMND substituted energy or value "?ZAVE" to "-21.3871151"
Evaluating: -49.7797787--21.3871151
 Parameter: ZTRAN <- "-28.3926636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.8068137"
 Parameter: YTRAN -> "-69.8154369"
 Parameter: ZTRAN -> "-28.3926636"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -15.806814  -69.815437  -28.392664
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736802773"
Evaluating: 0.736802773*360.0
 Parameter: XPHI <- "265.248998"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755251492"
Evaluating: 0.755251492*360.0
 Parameter: YPHI <- "271.890537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.519763303E-02"
Evaluating: 4.519763303E-02*360.0
 Parameter: ZPHI <- "16.2711479"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.4213802"
 Parameter: YPOS -> "-26.2792582"
 Parameter: ZPOS -> "-49.7797787"
 Parameter: XPHI -> "265.248998"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.082826   -0.996564
    0.000000    0.996564   -0.082826

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.4213802"
 Parameter: YPOS -> "-26.2792582"
 Parameter: ZPOS -> "-49.7797787"
 Parameter: YPHI -> "271.890537"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.032990    0.000000    0.999456
    0.000000    1.000000    0.000000
   -0.999456    0.000000    0.032990

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.4213802"
 Parameter: YPOS -> "-26.2792582"
 Parameter: ZPOS -> "-49.7797787"
 Parameter: ZPHI -> "16.2711479"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.959947    0.280183    0.000000
   -0.280183    0.959947    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.421380 XMAX =   19.421380 XAVE =   19.421380
    YMIN =  -26.279258 YMAX =  -26.279258 YAVE =  -26.279258
    ZMIN =  -49.779779 ZMAX =  -49.779779 ZAVE =  -49.779779
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.4213802"
Evaluating: 19.4213802+3.5
 Parameter: XMAX <- "22.9213802"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.2792582"
Evaluating: -26.2792582+3.5
 Parameter: YMAX <- "-22.7792582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.7797787"
Evaluating: -49.7797787+3.5
 Parameter: ZMAX <- "-46.2797787"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.4213802"
Evaluating: 19.4213802-3.5
 Parameter: XMIN <- "15.9213802"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.2792582"
Evaluating: -26.2792582-3.5
 Parameter: YMIN <- "-29.7792582"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.7797787"
Evaluating: -49.7797787-3.5
 Parameter: ZMIN <- "-53.2797787"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.9213802"
 Parameter: XMIN -> "15.9213802"
 Parameter: YMAX -> "-22.7792582"
 Parameter: YMIN -> "-29.7792582"
 Parameter: ZMAX -> "-46.2797787"
 Parameter: ZMIN -> "-53.2797787"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "142" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "142" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "117"
Evaluating: 142-117
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.446885387"
Evaluating: 128.065641*(0.446885387-0.5)
 Parameter: XPOS <- "-6.80215696"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.6424343"
Evaluating: 128.065641*(0.6424343-0.5)
 Parameter: YPOS <- "18.2409399"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.348511811E-02"
Evaluating: 108.613069*(3.348511811E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-52.8568871"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.8568871" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.80215696"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.80215696-0
 Parameter: XTRAN <- "-6.80215696"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.2409399"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.2409399-0
 Parameter: YTRAN <- "18.2409399"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.8568871"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.8568871-0
 Parameter: ZTRAN <- "-52.8568871"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.80215696"
 Parameter: YTRAN -> "18.2409399"
 Parameter: ZTRAN -> "-52.8568871"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -6.802157   18.240940  -52.856887
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499409935"
Evaluating: 0.499409935*360.0
 Parameter: XPHI <- "179.787577"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720803824"
Evaluating: 0.720803824*360.0
 Parameter: YPHI <- "259.489377"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.378368113"
Evaluating: 0.378368113*360.0
 Parameter: ZPHI <- "136.212521"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.80215696"
 Parameter: YPOS -> "18.2409399"
 Parameter: ZPOS -> "-52.8568871"
 Parameter: XPHI -> "179.787577"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999993    0.003707
    0.000000   -0.003707   -0.999993

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.80215696"
 Parameter: YPOS -> "18.2409399"
 Parameter: ZPOS -> "-52.8568871"
 Parameter: YPHI -> "259.489377"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.182418    0.000000    0.983221
    0.000000    1.000000    0.000000
   -0.983221    0.000000   -0.182418

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.80215696"
 Parameter: YPOS -> "18.2409399"
 Parameter: ZPOS -> "-52.8568871"
 Parameter: ZPHI -> "136.212521"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.721911    0.691985    0.000000
   -0.691985   -0.721911    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.802157 XMAX =   -6.802157 XAVE =   -6.802157
    YMIN =   18.240940 YMAX =   18.240940 YAVE =   18.240940
    ZMIN =  -52.856887 ZMAX =  -52.856887 ZAVE =  -52.856887
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.80215696"
Evaluating: -6.80215696+3.5
 Parameter: XMAX <- "-3.30215696"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.2409399"
Evaluating: 18.2409399+3.5
 Parameter: YMAX <- "21.7409399"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.8568871"
Evaluating: -52.8568871+3.5
 Parameter: ZMAX <- "-49.3568871"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.80215696"
Evaluating: -6.80215696-3.5
 Parameter: XMIN <- "-10.302157"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.2409399"
Evaluating: 18.2409399-3.5
 Parameter: YMIN <- "14.7409399"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.8568871"
Evaluating: -52.8568871-3.5
 Parameter: ZMIN <- "-56.3568871"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.30215696"
 Parameter: XMIN -> "-10.302157"
 Parameter: YMAX -> "21.7409399"
 Parameter: YMIN -> "14.7409399"
 Parameter: ZMAX -> "-49.3568871"
 Parameter: ZMIN -> "-56.3568871"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60374 NEG      CLA      25       CLA     -**** POS      POT      11       POT           3.9251
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "142" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "117"
Evaluating: 142-117
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.284549525"
Evaluating: 128.065641*(0.284549525-0.5)
 Parameter: XPOS <- "-27.5918032"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.975573233"
Evaluating: 128.065641*(0.975573233-0.5)
 Parameter: YPOS <- "60.9045909"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.686559217"
Evaluating: 108.613069*(0.686559217-0.5)+-2.187274
 Parameter: ZPOS <- "18.0754951"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.0754951" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.0754951" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.802157 XMAX =   -6.802157 XAVE =   -6.802157
    YMIN =   18.240940 YMAX =   18.240940 YAVE =   18.240940
    ZMIN =  -52.856887 ZMAX =  -52.856887 ZAVE =  -52.856887
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.5918032"
 RDCMND substituted energy or value "?XAVE" to "-6.80215696"
Evaluating: -27.5918032--6.80215696
 Parameter: XTRAN <- "-20.7896462"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "60.9045909"
 RDCMND substituted energy or value "?YAVE" to "18.2409399"
Evaluating: 60.9045909-18.2409399
 Parameter: YTRAN <- "42.663651"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.0754951"
 RDCMND substituted energy or value "?ZAVE" to "-52.8568871"
Evaluating: 18.0754951--52.8568871
 Parameter: ZTRAN <- "70.9323822"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.7896462"
 Parameter: YTRAN -> "42.663651"
 Parameter: ZTRAN -> "70.9323822"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -20.789646   42.663651   70.932382
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.410206228E-02"
Evaluating: 9.410206228E-02*360.0
 Parameter: XPHI <- "33.8767424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293371942"
Evaluating: 0.293371942*360.0
 Parameter: YPHI <- "105.613899"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662548352"
Evaluating: 0.662548352*360.0
 Parameter: ZPHI <- "238.517407"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.5918032"
 Parameter: YPOS -> "60.9045909"
 Parameter: ZPOS -> "18.0754951"
 Parameter: XPHI -> "33.8767424"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.830239    0.557408
    0.000000   -0.557408    0.830239

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.5918032"
 Parameter: YPOS -> "60.9045909"
 Parameter: ZPOS -> "18.0754951"
 Parameter: YPHI -> "105.613899"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.269153    0.000000   -0.963097
    0.000000    1.000000    0.000000
    0.963097    0.000000   -0.269153

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.5918032"
 Parameter: YPOS -> "60.9045909"
 Parameter: ZPOS -> "18.0754951"
 Parameter: ZPHI -> "238.517407"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.522240   -0.852799    0.000000
    0.852799   -0.522240    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.591803 XMAX =  -27.591803 XAVE =  -27.591803
    YMIN =   60.904591 YMAX =   60.904591 YAVE =   60.904591
    ZMIN =   18.075495 ZMAX =   18.075495 ZAVE =   18.075495
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.5918032"
Evaluating: -27.5918032+3.5
 Parameter: XMAX <- "-24.0918032"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "60.9045909"
Evaluating: 60.9045909+3.5
 Parameter: YMAX <- "64.4045909"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.0754951"
Evaluating: 18.0754951+3.5
 Parameter: ZMAX <- "21.5754951"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.5918032"
Evaluating: -27.5918032-3.5
 Parameter: XMIN <- "-31.0918032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "60.9045909"
Evaluating: 60.9045909-3.5
 Parameter: YMIN <- "57.4045909"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.0754951"
Evaluating: 18.0754951-3.5
 Parameter: ZMIN <- "14.5754951"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.0918032"
 Parameter: XMIN -> "-31.0918032"
 Parameter: YMAX -> "64.4045909"
 Parameter: YMIN -> "57.4045909"
 Parameter: ZMAX -> "21.5754951"
 Parameter: ZMIN -> "14.5754951"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "143" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "143" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "117"
Evaluating: 143-117
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.859003054"
Evaluating: 128.065641*(0.859003054-0.5)
 Parameter: XPOS <- "45.9759562"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.117678804E-02"
Evaluating: 128.065641*(7.117678804E-02-0.5)
 Parameter: YPOS <- "-54.9175195"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.602156746"
Evaluating: 108.613069*(0.602156746-0.5)+-2.187274
 Parameter: ZPOS <- "8.9082837"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.9082837" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.9082837" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "143" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "117"
Evaluating: 143-117
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.397550286"
Evaluating: 128.065641*(0.397550286-0.5)
 Parameter: XPOS <- "-13.1202883"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.954319332"
Evaluating: 128.065641*(0.954319332-0.5)
 Parameter: YPOS <- "58.1826965"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "7.791725906E-02"
Evaluating: 108.613069*(7.791725906E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-48.0309759"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.0309759" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.1202883"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.1202883-0
 Parameter: XTRAN <- "-13.1202883"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.1826965"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 58.1826965-0
 Parameter: YTRAN <- "58.1826965"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.0309759"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.0309759-0
 Parameter: ZTRAN <- "-48.0309759"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.1202883"
 Parameter: YTRAN -> "58.1826965"
 Parameter: ZTRAN -> "-48.0309759"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -13.120288   58.182696  -48.030976
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404742713"
Evaluating: 0.404742713*360.0
 Parameter: XPHI <- "145.707377"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.655213224"
Evaluating: 0.655213224*360.0
 Parameter: YPHI <- "235.876761"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.2265895E-03"
Evaluating: 7.2265895E-03*360.0
 Parameter: ZPHI <- "2.60157222"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.1202883"
 Parameter: YPOS -> "58.1826965"
 Parameter: ZPOS -> "-48.0309759"
 Parameter: XPHI -> "145.707377"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.826171    0.563420
    0.000000   -0.563420   -0.826171

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.1202883"
 Parameter: YPOS -> "58.1826965"
 Parameter: ZPOS -> "-48.0309759"
 Parameter: YPHI -> "235.876761"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.560975    0.000000    0.827833
    0.000000    1.000000    0.000000
   -0.827833    0.000000   -0.560975

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.1202883"
 Parameter: YPOS -> "58.1826965"
 Parameter: ZPOS -> "-48.0309759"
 Parameter: ZPHI -> "2.60157222"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.998969    0.045390    0.000000
   -0.045390    0.998969    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.120288 XMAX =  -13.120288 XAVE =  -13.120288
    YMIN =   58.182696 YMAX =   58.182696 YAVE =   58.182696
    ZMIN =  -48.030976 ZMAX =  -48.030976 ZAVE =  -48.030976
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.1202883"
Evaluating: -13.1202883+3.5
 Parameter: XMAX <- "-9.6202883"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.1826965"
Evaluating: 58.1826965+3.5
 Parameter: YMAX <- "61.6826965"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.0309759"
Evaluating: -48.0309759+3.5
 Parameter: ZMAX <- "-44.5309759"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.1202883"
Evaluating: -13.1202883-3.5
 Parameter: XMIN <- "-16.6202883"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.1826965"
Evaluating: 58.1826965-3.5
 Parameter: YMIN <- "54.6826965"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.0309759"
Evaluating: -48.0309759-3.5
 Parameter: ZMIN <- "-51.5309759"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.6202883"
 Parameter: XMIN -> "-16.6202883"
 Parameter: YMAX -> "61.6826965"
 Parameter: YMIN -> "54.6826965"
 Parameter: ZMAX -> "-44.5309759"
 Parameter: ZMIN -> "-51.5309759"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "144" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "144" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "117"
Evaluating: 144-117
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.16293928"
Evaluating: 128.065641*(0.16293928-0.5)
 Parameter: XPOS <- "-43.1658972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.179340533"
Evaluating: 128.065641*(0.179340533-0.5)
 Parameter: YPOS <- "-41.0654602"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.764644998"
Evaluating: 108.613069*(0.764644998-0.5)+-2.187274
 Parameter: ZPOS <- "26.5566314"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.5566314" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.5566314" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.1658972"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.1658972-0
 Parameter: XTRAN <- "-43.1658972"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.0654602"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.0654602-0
 Parameter: YTRAN <- "-41.0654602"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.5566314"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.5566314-0
 Parameter: ZTRAN <- "26.5566314"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.1658972"
 Parameter: YTRAN -> "-41.0654602"
 Parameter: ZTRAN -> "26.5566314"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -43.165897  -41.065460   26.556631
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313787732"
Evaluating: 0.313787732*360.0
 Parameter: XPHI <- "112.963584"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993881334"
Evaluating: 0.993881334*360.0
 Parameter: YPHI <- "357.79728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209682482"
Evaluating: 0.209682482*360.0
 Parameter: ZPHI <- "75.4856935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.1658972"
 Parameter: YPOS -> "-41.0654602"
 Parameter: ZPOS -> "26.5566314"
 Parameter: XPHI -> "112.963584"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.390146    0.920753
    0.000000   -0.920753   -0.390146

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.1658972"
 Parameter: YPOS -> "-41.0654602"
 Parameter: ZPOS -> "26.5566314"
 Parameter: YPHI -> "357.79728"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999261    0.000000    0.038435
    0.000000    1.000000    0.000000
   -0.038435    0.000000    0.999261

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.1658972"
 Parameter: YPOS -> "-41.0654602"
 Parameter: ZPOS -> "26.5566314"
 Parameter: ZPHI -> "75.4856935"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.250622    0.968085    0.000000
   -0.968085    0.250622    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.165897 XMAX =  -43.165897 XAVE =  -43.165897
    YMIN =  -41.065460 YMAX =  -41.065460 YAVE =  -41.065460
    ZMIN =   26.556631 ZMAX =   26.556631 ZAVE =   26.556631
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.1658972"
Evaluating: -43.1658972+3.5
 Parameter: XMAX <- "-39.6658972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.0654602"
Evaluating: -41.0654602+3.5
 Parameter: YMAX <- "-37.5654602"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.5566314"
Evaluating: 26.5566314+3.5
 Parameter: ZMAX <- "30.0566314"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.1658972"
Evaluating: -43.1658972-3.5
 Parameter: XMIN <- "-46.6658972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.0654602"
Evaluating: -41.0654602-3.5
 Parameter: YMIN <- "-44.5654602"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.5566314"
Evaluating: 26.5566314-3.5
 Parameter: ZMIN <- "23.0566314"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.6658972"
 Parameter: XMIN -> "-46.6658972"
 Parameter: YMAX -> "-37.5654602"
 Parameter: YMIN -> "-44.5654602"
 Parameter: ZMAX -> "30.0566314"
 Parameter: ZMIN -> "23.0566314"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "145" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "145" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "117"
Evaluating: 145-117
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.108173837"
Evaluating: 128.065641*(0.108173837-0.5)
 Parameter: XPOS <- "-50.1794687"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.58484406"
Evaluating: 128.065641*(0.58484406-0.5)
 Parameter: YPOS <- "10.8656089"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.145858988"
Evaluating: 108.613069*(0.145858988-0.5)+-2.187274
 Parameter: ZPOS <- "-40.6516162"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.6516162" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.1794687"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.1794687-0
 Parameter: XTRAN <- "-50.1794687"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.8656089"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.8656089-0
 Parameter: YTRAN <- "10.8656089"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.6516162"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.6516162-0
 Parameter: ZTRAN <- "-40.6516162"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.1794687"
 Parameter: YTRAN -> "10.8656089"
 Parameter: ZTRAN -> "-40.6516162"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -50.179469   10.865609  -40.651616
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987117691"
Evaluating: 0.987117691*360.0
 Parameter: XPHI <- "355.362369"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.628205704"
Evaluating: 0.628205704*360.0
 Parameter: YPHI <- "226.154053"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.109356368"
Evaluating: 0.109356368*360.0
 Parameter: ZPHI <- "39.3682925"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.1794687"
 Parameter: YPOS -> "10.8656089"
 Parameter: ZPOS -> "-40.6516162"
 Parameter: XPHI -> "355.362369"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996726   -0.080854
    0.000000    0.080854    0.996726

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    4.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.1794687"
 Parameter: YPOS -> "10.8656089"
 Parameter: ZPOS -> "-40.6516162"
 Parameter: YPHI -> "226.154053"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.692722    0.000000    0.721205
    0.000000    1.000000    0.000000
   -0.721205    0.000000   -0.692722

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  133.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.1794687"
 Parameter: YPOS -> "10.8656089"
 Parameter: ZPOS -> "-40.6516162"
 Parameter: ZPHI -> "39.3682925"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.773085    0.634303    0.000000
   -0.634303    0.773085    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.179469 XMAX =  -50.179469 XAVE =  -50.179469
    YMIN =   10.865609 YMAX =   10.865609 YAVE =   10.865609
    ZMIN =  -40.651616 ZMAX =  -40.651616 ZAVE =  -40.651616
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.1794687"
Evaluating: -50.1794687+3.5
 Parameter: XMAX <- "-46.6794687"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.8656089"
Evaluating: 10.8656089+3.5
 Parameter: YMAX <- "14.3656089"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.6516162"
Evaluating: -40.6516162+3.5
 Parameter: ZMAX <- "-37.1516162"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.1794687"
Evaluating: -50.1794687-3.5
 Parameter: XMIN <- "-53.6794687"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.8656089"
Evaluating: 10.8656089-3.5
 Parameter: YMIN <- "7.3656089"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.6516162"
Evaluating: -40.6516162-3.5
 Parameter: ZMIN <- "-44.1516162"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.6794687"
 Parameter: XMIN -> "-53.6794687"
 Parameter: YMAX -> "14.3656089"
 Parameter: YMIN -> "7.3656089"
 Parameter: ZMAX -> "-37.1516162"
 Parameter: ZMIN -> "-44.1516162"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "146" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "146" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "117"
Evaluating: 146-117
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.241221848"
Evaluating: 128.065641*(0.241221848-0.5)
 Parameter: XPOS <- "-33.1405899"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.219080453"
Evaluating: 128.065641*(0.219080453-0.5)
 Parameter: YPOS <- "-35.9761419"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.466704874"
Evaluating: 108.613069*(0.466704874-0.5)+-2.187274
 Parameter: ZPOS <- "-5.80355982"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.80355982" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.80355982" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "146" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "117"
Evaluating: 146-117
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.127302546E-02"
Evaluating: 128.065641*(8.127302546E-02-0.5)
 Parameter: XPOS <- "-53.6245384"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.894478048"
Evaluating: 128.065641*(0.894478048-0.5)
 Parameter: YPOS <- "50.5190841"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.390912079"
Evaluating: 108.613069*(0.390912079-0.5)+-2.187274
 Parameter: ZPOS <- "-14.0356479"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.0356479" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.0356479" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "146" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "117"
Evaluating: 146-117
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.75817352"
Evaluating: 128.065641*(0.75817352-0.5)
 Parameter: XPOS <- "33.0631573"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.137803909"
Evaluating: 128.065641*(0.137803909-0.5)
 Parameter: YPOS <- "-46.3848746"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.841410458"
Evaluating: 108.613069*(0.841410458-0.5)+-2.187274
 Parameter: ZPOS <- "34.8943636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.8943636" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.8943636" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.0631573"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.0631573-0
 Parameter: XTRAN <- "33.0631573"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.3848746"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.3848746-0
 Parameter: YTRAN <- "-46.3848746"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.8943636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.8943636-0
 Parameter: ZTRAN <- "34.8943636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.0631573"
 Parameter: YTRAN -> "-46.3848746"
 Parameter: ZTRAN -> "34.8943636"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    33.063157  -46.384875   34.894364
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199356907"
Evaluating: 0.199356907*360.0
 Parameter: XPHI <- "71.7684865"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887564192"
Evaluating: 0.887564192*360.0
 Parameter: YPHI <- "319.523109"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307128676"
Evaluating: 0.307128676*360.0
 Parameter: ZPHI <- "110.566323"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.0631573"
 Parameter: YPOS -> "-46.3848746"
 Parameter: ZPOS -> "34.8943636"
 Parameter: XPHI -> "71.7684865"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.312857    0.949800
    0.000000   -0.949800    0.312857

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.0631573"
 Parameter: YPOS -> "-46.3848746"
 Parameter: ZPOS -> "34.8943636"
 Parameter: YPHI -> "319.523109"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.760668    0.000000    0.649141
    0.000000    1.000000    0.000000
   -0.649141    0.000000    0.760668

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.0631573"
 Parameter: YPOS -> "-46.3848746"
 Parameter: ZPOS -> "34.8943636"
 Parameter: ZPHI -> "110.566323"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.351291    0.936266    0.000000
   -0.936266   -0.351291    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.063157 XMAX =   33.063157 XAVE =   33.063157
    YMIN =  -46.384875 YMAX =  -46.384875 YAVE =  -46.384875
    ZMIN =   34.894364 ZMAX =   34.894364 ZAVE =   34.894364
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.0631573"
Evaluating: 33.0631573+3.5
 Parameter: XMAX <- "36.5631573"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.3848746"
Evaluating: -46.3848746+3.5
 Parameter: YMAX <- "-42.8848746"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.8943636"
Evaluating: 34.8943636+3.5
 Parameter: ZMAX <- "38.3943636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.0631573"
Evaluating: 33.0631573-3.5
 Parameter: XMIN <- "29.5631573"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.3848746"
Evaluating: -46.3848746-3.5
 Parameter: YMIN <- "-49.8848746"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.8943636"
Evaluating: 34.8943636-3.5
 Parameter: ZMIN <- "31.3943636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.5631573"
 Parameter: XMIN -> "29.5631573"
 Parameter: YMAX -> "-42.8848746"
 Parameter: YMIN -> "-49.8848746"
 Parameter: ZMAX -> "38.3943636"
 Parameter: ZMIN -> "31.3943636"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60378 NEG      CLA      29       CLA     -**** NEG      CLA      12       CLA           3.7536
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "146" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "117"
Evaluating: 146-117
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.661742976"
Evaluating: 128.065641*(0.661742976-0.5)
 Parameter: XPOS <- "20.7137179"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.99579761"
Evaluating: 128.065641*(0.99579761-0.5)
 Parameter: YPOS <- "63.4946387"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.434591624"
Evaluating: 108.613069*(0.434591624-0.5)+-2.187274
 Parameter: ZPOS <- "-9.29147846"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.29147846" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.29147846" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "146" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "117"
Evaluating: 146-117
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.776233886"
Evaluating: 128.065641*(0.776233886-0.5)
 Parameter: XPOS <- "35.3760697"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.725483643"
Evaluating: 128.065641*(0.725483643-0.5)
 Parameter: YPOS <- "28.8767073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.882650169"
Evaluating: 108.613069*(0.882650169-0.5)+-2.187274
 Parameter: ZPOS <- "39.3735352"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.3735352" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.3735352" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.063157 XMAX =   33.063157 XAVE =   33.063157
    YMIN =  -46.384875 YMAX =  -46.384875 YAVE =  -46.384875
    ZMIN =   34.894364 ZMAX =   34.894364 ZAVE =   34.894364
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.3760697"
 RDCMND substituted energy or value "?XAVE" to "33.0631573"
Evaluating: 35.3760697-33.0631573
 Parameter: XTRAN <- "2.3129124"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.8767073"
 RDCMND substituted energy or value "?YAVE" to "-46.3848746"
Evaluating: 28.8767073--46.3848746
 Parameter: YTRAN <- "75.2615819"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.3735352"
 RDCMND substituted energy or value "?ZAVE" to "34.8943636"
Evaluating: 39.3735352-34.8943636
 Parameter: ZTRAN <- "4.4791716"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.3129124"
 Parameter: YTRAN -> "75.2615819"
 Parameter: ZTRAN -> "4.4791716"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     2.312912   75.261582    4.479172
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466814857"
Evaluating: 0.466814857*360.0
 Parameter: XPHI <- "168.053349"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968458154"
Evaluating: 0.968458154*360.0
 Parameter: YPHI <- "348.644935"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737381131"
Evaluating: 0.737381131*360.0
 Parameter: ZPHI <- "265.457207"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.3760697"
 Parameter: YPOS -> "28.8767073"
 Parameter: ZPOS -> "39.3735352"
 Parameter: XPHI -> "168.053349"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978341    0.207001
    0.000000   -0.207001   -0.978341

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.3760697"
 Parameter: YPOS -> "28.8767073"
 Parameter: ZPOS -> "39.3735352"
 Parameter: YPHI -> "348.644935"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.980426    0.000000    0.196888
    0.000000    1.000000    0.000000
   -0.196888    0.000000    0.980426

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   11.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.3760697"
 Parameter: YPOS -> "28.8767073"
 Parameter: ZPOS -> "39.3735352"
 Parameter: ZPHI -> "265.457207"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.079204   -0.996858    0.000000
    0.996858   -0.079204    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.376070 XMAX =   35.376070 XAVE =   35.376070
    YMIN =   28.876707 YMAX =   28.876707 YAVE =   28.876707
    ZMIN =   39.373535 ZMAX =   39.373535 ZAVE =   39.373535
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.3760697"
Evaluating: 35.3760697+3.5
 Parameter: XMAX <- "38.8760697"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.8767073"
Evaluating: 28.8767073+3.5
 Parameter: YMAX <- "32.3767073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.3735352"
Evaluating: 39.3735352+3.5
 Parameter: ZMAX <- "42.8735352"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.3760697"
Evaluating: 35.3760697-3.5
 Parameter: XMIN <- "31.8760697"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.8767073"
Evaluating: 28.8767073-3.5
 Parameter: YMIN <- "25.3767073"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.3735352"
Evaluating: 39.3735352-3.5
 Parameter: ZMIN <- "35.8735352"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.8760697"
 Parameter: XMIN -> "31.8760697"
 Parameter: YMAX -> "32.3767073"
 Parameter: YMIN -> "25.3767073"
 Parameter: ZMAX -> "42.8735352"
 Parameter: ZMIN -> "35.8735352"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "147" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "147" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "117"
Evaluating: 147-117
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.499986711"
Evaluating: 128.065641*(0.499986711-0.5)
 Parameter: XPOS <- "-1.701864303E-03"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.839536269"
Evaluating: 128.065641*(0.839536269-0.5)
 Parameter: YPOS <- "43.4829299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.44529943"
Evaluating: 108.613069*(0.44529943-0.5)+-2.187274
 Parameter: ZPOS <- "-8.12847078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.12847078" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.12847078" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "147" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "117"
Evaluating: 147-117
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.721584148"
Evaluating: 128.065641*(0.721584148-0.5)
 Parameter: XPOS <- "28.3773159"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.605410561"
Evaluating: 128.065641*(0.605410561-0.5)
 Parameter: YPOS <- "13.4994711"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.799934658"
Evaluating: 108.613069*(0.799934658-0.5)+-2.187274
 Parameter: ZPOS <- "30.3895497"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.3895497" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.3895497" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.3773159"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.3773159-0
 Parameter: XTRAN <- "28.3773159"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.4994711"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.4994711-0
 Parameter: YTRAN <- "13.4994711"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.3895497"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.3895497-0
 Parameter: ZTRAN <- "30.3895497"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.3773159"
 Parameter: YTRAN -> "13.4994711"
 Parameter: ZTRAN -> "30.3895497"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    28.377316   13.499471   30.389550
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678124822"
Evaluating: 0.678124822*360.0
 Parameter: XPHI <- "244.124936"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.466908537E-02"
Evaluating: 4.466908537E-02*360.0
 Parameter: YPHI <- "16.0808707"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129056197"
Evaluating: 0.129056197*360.0
 Parameter: ZPHI <- "46.4602309"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.3773159"
 Parameter: YPOS -> "13.4994711"
 Parameter: ZPOS -> "30.3895497"
 Parameter: XPHI -> "244.124936"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.436410   -0.899748
    0.000000    0.899748   -0.436410

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.3773159"
 Parameter: YPOS -> "13.4994711"
 Parameter: ZPOS -> "30.3895497"
 Parameter: YPHI -> "16.0808707"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.960872    0.000000   -0.276994
    0.000000    1.000000    0.000000
    0.276994    0.000000    0.960872

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   16.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.3773159"
 Parameter: YPOS -> "13.4994711"
 Parameter: ZPOS -> "30.3895497"
 Parameter: ZPHI -> "46.4602309"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.688858    0.724896    0.000000
   -0.724896    0.688858    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.377316 XMAX =   28.377316 XAVE =   28.377316
    YMIN =   13.499471 YMAX =   13.499471 YAVE =   13.499471
    ZMIN =   30.389550 ZMAX =   30.389550 ZAVE =   30.389550
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.3773159"
Evaluating: 28.3773159+3.5
 Parameter: XMAX <- "31.8773159"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.4994711"
Evaluating: 13.4994711+3.5
 Parameter: YMAX <- "16.9994711"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.3895497"
Evaluating: 30.3895497+3.5
 Parameter: ZMAX <- "33.8895497"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.3773159"
Evaluating: 28.3773159-3.5
 Parameter: XMIN <- "24.8773159"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.4994711"
Evaluating: 13.4994711-3.5
 Parameter: YMIN <- "9.9994711"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.3895497"
Evaluating: 30.3895497-3.5
 Parameter: ZMIN <- "26.8895497"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.8773159"
 Parameter: XMIN -> "24.8773159"
 Parameter: YMAX -> "16.9994711"
 Parameter: YMIN -> "9.9994711"
 Parameter: ZMAX -> "33.8895497"
 Parameter: ZMIN -> "26.8895497"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "148" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "148" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "117"
Evaluating: 148-117
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.981892371"
Evaluating: 128.065641*(0.981892371-0.5)
 Parameter: XPOS <- "61.7138554"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.293385424"
Evaluating: 128.065641*(0.293385424-0.5)
 Parameter: YPOS <- "-26.4602281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.906113616"
Evaluating: 108.613069*(0.906113616-0.5)+-2.187274
 Parameter: ZPOS <- "41.9219722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.9219722" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.9219722" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.7138554"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.7138554-0
 Parameter: XTRAN <- "61.7138554"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.4602281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.4602281-0
 Parameter: YTRAN <- "-26.4602281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.9219722"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.9219722-0
 Parameter: ZTRAN <- "41.9219722"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.7138554"
 Parameter: YTRAN -> "-26.4602281"
 Parameter: ZTRAN -> "41.9219722"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    61.713855  -26.460228   41.921972
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.301120381"
Evaluating: 0.301120381*360.0
 Parameter: XPHI <- "108.403337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123466096"
Evaluating: 0.123466096*360.0
 Parameter: YPHI <- "44.4477946"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.976936268E-04"
Evaluating: 5.976936268E-04*360.0
 Parameter: ZPHI <- "0.215169706"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.7138554"
 Parameter: YPOS -> "-26.4602281"
 Parameter: ZPOS -> "41.9219722"
 Parameter: XPHI -> "108.403337"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.315704    0.948858
    0.000000   -0.948858   -0.315704

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.7138554"
 Parameter: YPOS -> "-26.4602281"
 Parameter: ZPOS -> "41.9219722"
 Parameter: YPHI -> "44.4477946"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.713889    0.000000   -0.700259
    0.000000    1.000000    0.000000
    0.700259    0.000000    0.713889

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.7138554"
 Parameter: YPOS -> "-26.4602281"
 Parameter: ZPOS -> "41.9219722"
 Parameter: ZPHI -> "0.215169706"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999993    0.003755    0.000000
   -0.003755    0.999993    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.713855 XMAX =   61.713855 XAVE =   61.713855
    YMIN =  -26.460228 YMAX =  -26.460228 YAVE =  -26.460228
    ZMIN =   41.921972 ZMAX =   41.921972 ZAVE =   41.921972
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.7138554"
Evaluating: 61.7138554+3.5
 Parameter: XMAX <- "65.2138554"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.4602281"
Evaluating: -26.4602281+3.5
 Parameter: YMAX <- "-22.9602281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.9219722"
Evaluating: 41.9219722+3.5
 Parameter: ZMAX <- "45.4219722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.7138554"
Evaluating: 61.7138554-3.5
 Parameter: XMIN <- "58.2138554"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.4602281"
Evaluating: -26.4602281-3.5
 Parameter: YMIN <- "-29.9602281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.9219722"
Evaluating: 41.9219722-3.5
 Parameter: ZMIN <- "38.4219722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.2138554"
 Parameter: XMIN -> "58.2138554"
 Parameter: YMAX -> "-22.9602281"
 Parameter: YMIN -> "-29.9602281"
 Parameter: ZMAX -> "45.4219722"
 Parameter: ZMIN -> "38.4219722"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "149" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "149" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "117"
Evaluating: 149-117
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.451022223"
Evaluating: 128.065641*(0.451022223-0.5)
 Parameter: XPOS <- "-6.27237041"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.405477467"
Evaluating: 128.065641*(0.405477467-0.5)
 Parameter: YPOS <- "-12.1050888"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.800795551"
Evaluating: 108.613069*(0.800795551-0.5)+-2.187274
 Parameter: ZPOS <- "30.4830539"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.4830539" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.4830539" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.27237041"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.27237041-0
 Parameter: XTRAN <- "-6.27237041"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.1050888"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.1050888-0
 Parameter: YTRAN <- "-12.1050888"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.4830539"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.4830539-0
 Parameter: ZTRAN <- "30.4830539"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.27237041"
 Parameter: YTRAN -> "-12.1050888"
 Parameter: ZTRAN -> "30.4830539"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -6.272370  -12.105089   30.483054
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336643148"
Evaluating: 0.336643148*360.0
 Parameter: XPHI <- "121.191533"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.960891298"
Evaluating: 0.960891298*360.0
 Parameter: YPHI <- "345.920867"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.653140923E-02"
Evaluating: 3.653140923E-02*360.0
 Parameter: ZPHI <- "13.1513073"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.27237041"
 Parameter: YPOS -> "-12.1050888"
 Parameter: ZPOS -> "30.4830539"
 Parameter: XPHI -> "121.191533"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.517901    0.855441
    0.000000   -0.855441   -0.517901

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.27237041"
 Parameter: YPOS -> "-12.1050888"
 Parameter: ZPOS -> "30.4830539"
 Parameter: YPHI -> "345.920867"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.969961    0.000000    0.243262
    0.000000    1.000000    0.000000
   -0.243262    0.000000    0.969961

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   14.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.27237041"
 Parameter: YPOS -> "-12.1050888"
 Parameter: ZPOS -> "30.4830539"
 Parameter: ZPHI -> "13.1513073"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.973773    0.227523    0.000000
   -0.227523    0.973773    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.272370 XMAX =   -6.272370 XAVE =   -6.272370
    YMIN =  -12.105089 YMAX =  -12.105089 YAVE =  -12.105089
    ZMIN =   30.483054 ZMAX =   30.483054 ZAVE =   30.483054
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.27237041"
Evaluating: -6.27237041+3.5
 Parameter: XMAX <- "-2.77237041"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.1050888"
Evaluating: -12.1050888+3.5
 Parameter: YMAX <- "-8.6050888"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.4830539"
Evaluating: 30.4830539+3.5
 Parameter: ZMAX <- "33.9830539"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.27237041"
Evaluating: -6.27237041-3.5
 Parameter: XMIN <- "-9.77237041"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.1050888"
Evaluating: -12.1050888-3.5
 Parameter: YMIN <- "-15.6050888"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.4830539"
Evaluating: 30.4830539-3.5
 Parameter: ZMIN <- "26.9830539"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.77237041"
 Parameter: XMIN -> "-9.77237041"
 Parameter: YMAX -> "-8.6050888"
 Parameter: YMIN -> "-15.6050888"
 Parameter: ZMAX -> "33.9830539"
 Parameter: ZMIN -> "26.9830539"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "150"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "150" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "150" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "117"
Evaluating: 150-117
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.709586093"
Evaluating: 128.065641*(0.709586093-0.5)
 Parameter: XPOS <- "26.8407773"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.592006214"
Evaluating: 128.065641*(0.592006214-0.5)
 Parameter: YPOS <- "11.7828348"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.147851733"
Evaluating: 108.613069*(0.147851733-0.5)+-2.187274
 Parameter: ZPOS <- "-40.435178"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.435178" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.8407773"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.8407773-0
 Parameter: XTRAN <- "26.8407773"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.7828348"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.7828348-0
 Parameter: YTRAN <- "11.7828348"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.435178"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.435178-0
 Parameter: ZTRAN <- "-40.435178"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.8407773"
 Parameter: YTRAN -> "11.7828348"
 Parameter: ZTRAN -> "-40.435178"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    26.840777   11.782835  -40.435178
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450909728"
Evaluating: 0.450909728*360.0
 Parameter: XPHI <- "162.327502"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.127792127E-02"
Evaluating: 2.127792127E-02*360.0
 Parameter: YPHI <- "7.66005166"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821038762"
Evaluating: 0.821038762*360.0
 Parameter: ZPHI <- "295.573954"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.8407773"
 Parameter: YPOS -> "11.7828348"
 Parameter: ZPOS -> "-40.435178"
 Parameter: XPHI -> "162.327502"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952807    0.303576
    0.000000   -0.303576   -0.952807

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  162.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.8407773"
 Parameter: YPOS -> "11.7828348"
 Parameter: ZPOS -> "-40.435178"
 Parameter: YPHI -> "7.66005166"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.991076    0.000000   -0.133295
    0.000000    1.000000    0.000000
    0.133295    0.000000    0.991076

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    7.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.8407773"
 Parameter: YPOS -> "11.7828348"
 Parameter: ZPOS -> "-40.435178"
 Parameter: ZPHI -> "295.573954"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.431676   -0.902029    0.000000
    0.902029    0.431676    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.840777 XMAX =   26.840777 XAVE =   26.840777
    YMIN =   11.782835 YMAX =   11.782835 YAVE =   11.782835
    ZMIN =  -40.435178 ZMAX =  -40.435178 ZAVE =  -40.435178
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.8407773"
Evaluating: 26.8407773+3.5
 Parameter: XMAX <- "30.3407773"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.7828348"
Evaluating: 11.7828348+3.5
 Parameter: YMAX <- "15.2828348"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.435178"
Evaluating: -40.435178+3.5
 Parameter: ZMAX <- "-36.935178"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.8407773"
Evaluating: 26.8407773-3.5
 Parameter: XMIN <- "23.3407773"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.7828348"
Evaluating: 11.7828348-3.5
 Parameter: YMIN <- "8.2828348"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.435178"
Evaluating: -40.435178-3.5
 Parameter: ZMIN <- "-43.935178"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.3407773"
 Parameter: XMIN -> "23.3407773"
 Parameter: YMAX -> "15.2828348"
 Parameter: YMIN -> "8.2828348"
 Parameter: ZMAX -> "-36.935178"
 Parameter: ZMIN -> "-43.935178"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "151"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "151" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "151" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "117"
Evaluating: 151-117
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.508526046"
Evaluating: 128.065641*(0.508526046-0.5)
 Parameter: XPOS <- "1.09189355"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.472012561"
Evaluating: 128.065641*(0.472012561-0.5)
 Parameter: YPOS <- "-3.58422932"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.521244813"
Evaluating: 108.613069*(0.521244813-0.5)+-2.187274
 Parameter: ZPOS <- "0.12019034"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.12019034" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.12019034" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "151" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "117"
Evaluating: 151-117
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.49355855"
Evaluating: 128.065641*(0.49355855-0.5)
 Parameter: XPOS <- "-0.824928423"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.786409704"
Evaluating: 128.065641*(0.786409704-0.5)
 Parameter: YPOS <- "36.6792423"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.463899096"
Evaluating: 108.613069*(0.463899096-0.5)+-2.187274
 Parameter: ZPOS <- "-6.10830398"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.10830398" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.10830398" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "151" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "117"
Evaluating: 151-117
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.797748117"
Evaluating: 128.065641*(0.797748117-0.5)
 Parameter: XPOS <- "38.1313035"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.983001762"
Evaluating: 128.065641*(0.983001762-0.5)
 Parameter: YPOS <- "61.8559303"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.368296514"
Evaluating: 108.613069*(0.368296514-0.5)+-2.187274
 Parameter: ZPOS <- "-16.4919938"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.4919938" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.1313035"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.1313035-0
 Parameter: XTRAN <- "38.1313035"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "61.8559303"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 61.8559303-0
 Parameter: YTRAN <- "61.8559303"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4919938"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.4919938-0
 Parameter: ZTRAN <- "-16.4919938"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.1313035"
 Parameter: YTRAN -> "61.8559303"
 Parameter: ZTRAN -> "-16.4919938"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    38.131304   61.855930  -16.491994
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96343945"
Evaluating: 0.96343945*360.0
 Parameter: XPHI <- "346.838202"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.637160278"
Evaluating: 0.637160278*360.0
 Parameter: YPHI <- "229.3777"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.490213931"
Evaluating: 0.490213931*360.0
 Parameter: ZPHI <- "176.477015"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.1313035"
 Parameter: YPOS -> "61.8559303"
 Parameter: ZPOS -> "-16.4919938"
 Parameter: XPHI -> "346.838202"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.973731   -0.227702
    0.000000    0.227702    0.973731

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.1313035"
 Parameter: YPOS -> "61.8559303"
 Parameter: ZPOS -> "-16.4919938"
 Parameter: YPHI -> "229.3777"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.651070    0.000000    0.759018
    0.000000    1.000000    0.000000
   -0.759018    0.000000   -0.651070

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  130.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.1313035"
 Parameter: YPOS -> "61.8559303"
 Parameter: ZPOS -> "-16.4919938"
 Parameter: ZPHI -> "176.477015"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.998110    0.061449    0.000000
   -0.061449   -0.998110    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.131304 XMAX =   38.131304 XAVE =   38.131304
    YMIN =   61.855930 YMAX =   61.855930 YAVE =   61.855930
    ZMIN =  -16.491994 ZMAX =  -16.491994 ZAVE =  -16.491994
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.1313035"
Evaluating: 38.1313035+3.5
 Parameter: XMAX <- "41.6313035"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "61.8559303"
Evaluating: 61.8559303+3.5
 Parameter: YMAX <- "65.3559303"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4919938"
Evaluating: -16.4919938+3.5
 Parameter: ZMAX <- "-12.9919938"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.1313035"
Evaluating: 38.1313035-3.5
 Parameter: XMIN <- "34.6313035"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "61.8559303"
Evaluating: 61.8559303-3.5
 Parameter: YMIN <- "58.3559303"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4919938"
Evaluating: -16.4919938-3.5
 Parameter: ZMIN <- "-19.9919938"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.6313035"
 Parameter: XMIN -> "34.6313035"
 Parameter: YMAX -> "65.3559303"
 Parameter: YMIN -> "58.3559303"
 Parameter: ZMAX -> "-12.9919938"
 Parameter: ZMIN -> "-19.9919938"
 SELRPN>     18 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     11 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      N             3.6826
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      C13           3.9719
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      C15           2.8729
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      C12           3.6816
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      C11           2.9194
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      P             1.3305
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      O13           1.3474
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      O14           2.2125
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      O11           2.8201
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      O12           1.5664
60383 NEG      CLA      34       CLA     -**** MEMB     DMPC     308      C1            3.5205
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "151" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "117"
Evaluating: 151-117
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.340849685"
Evaluating: 128.065641*(0.340849685-0.5)
 Parameter: XPOS <- "-20.3816871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.469123893"
Evaluating: 128.065641*(0.469123893-0.5)
 Parameter: YPOS <- "-3.95416843"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.790527765"
Evaluating: 108.613069*(0.790527765-0.5)+-2.187274
 Parameter: ZPOS <- "29.3678382"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.3678382" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.3678382" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.131304 XMAX =   38.131304 XAVE =   38.131304
    YMIN =   61.855930 YMAX =   61.855930 YAVE =   61.855930
    ZMIN =  -16.491994 ZMAX =  -16.491994 ZAVE =  -16.491994
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.3816871"
 RDCMND substituted energy or value "?XAVE" to "38.1313035"
Evaluating: -20.3816871-38.1313035
 Parameter: XTRAN <- "-58.5129906"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.95416843"
 RDCMND substituted energy or value "?YAVE" to "61.8559303"
Evaluating: -3.95416843-61.8559303
 Parameter: YTRAN <- "-65.8100987"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.3678382"
 RDCMND substituted energy or value "?ZAVE" to "-16.4919938"
Evaluating: 29.3678382--16.4919938
 Parameter: ZTRAN <- "45.859832"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.5129906"
 Parameter: YTRAN -> "-65.8100987"
 Parameter: ZTRAN -> "45.859832"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -58.512991  -65.810099   45.859832
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349100822"
Evaluating: 0.349100822*360.0
 Parameter: XPHI <- "125.676296"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746711477"
Evaluating: 0.746711477*360.0
 Parameter: YPHI <- "268.816132"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639605252"
Evaluating: 0.639605252*360.0
 Parameter: ZPHI <- "230.257891"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.3816871"
 Parameter: YPOS -> "-3.95416843"
 Parameter: ZPOS -> "29.3678382"
 Parameter: XPHI -> "125.676296"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.583205    0.812325
    0.000000   -0.812325   -0.583205

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  125.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.3816871"
 Parameter: YPOS -> "-3.95416843"
 Parameter: ZPOS -> "29.3678382"
 Parameter: YPHI -> "268.816132"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.020661    0.000000    0.999787
    0.000000    1.000000    0.000000
   -0.999787    0.000000   -0.020661

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.3816871"
 Parameter: YPOS -> "-3.95416843"
 Parameter: ZPOS -> "29.3678382"
 Parameter: ZPHI -> "230.257891"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.639333   -0.768930    0.000000
    0.768930   -0.639333    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.381687 XMAX =  -20.381687 XAVE =  -20.381687
    YMIN =   -3.954168 YMAX =   -3.954168 YAVE =   -3.954168
    ZMIN =   29.367838 ZMAX =   29.367838 ZAVE =   29.367838
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.3816871"
Evaluating: -20.3816871+3.5
 Parameter: XMAX <- "-16.8816871"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.95416844"
Evaluating: -3.95416844+3.5
 Parameter: YMAX <- "-0.45416844"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.3678382"
Evaluating: 29.3678382+3.5
 Parameter: ZMAX <- "32.8678382"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.3816871"
Evaluating: -20.3816871-3.5
 Parameter: XMIN <- "-23.8816871"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.95416844"
Evaluating: -3.95416844-3.5
 Parameter: YMIN <- "-7.45416844"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.3678382"
Evaluating: 29.3678382-3.5
 Parameter: ZMIN <- "25.8678382"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.8816871"
 Parameter: XMIN -> "-23.8816871"
 Parameter: YMAX -> "-0.45416844"
 Parameter: YMIN -> "-7.45416844"
 Parameter: ZMAX -> "32.8678382"
 Parameter: ZMIN -> "25.8678382"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "152"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "152" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "152" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "117"
Evaluating: 152-117
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.688322554"
Evaluating: 128.065641*(0.688322554-0.5)
 Parameter: XPOS <- "24.1176486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.73156351"
Evaluating: 128.065641*(0.73156351-0.5)
 Parameter: YPOS <- "29.6553293"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.529608862"
Evaluating: 108.613069*(0.529608862-0.5)+-2.187274
 Parameter: ZPOS <- "1.02863537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.02863537" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.02863537" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "152" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "117"
Evaluating: 152-117
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.765490342"
Evaluating: 128.065641*(0.765490342-0.5)
 Parameter: XPOS <- "34.0001908"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.759286082"
Evaluating: 128.065641*(0.759286082-0.5)
 Parameter: YPOS <- "33.2056383"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.726323266"
Evaluating: 108.613069*(0.726323266-0.5)+-2.187274
 Parameter: ZPOS <- "22.3943905"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.3943905" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.3943905" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.0001908"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.0001908-0
 Parameter: XTRAN <- "34.0001908"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.2056383"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.2056383-0
 Parameter: YTRAN <- "33.2056383"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.3943905"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.3943905-0
 Parameter: ZTRAN <- "22.3943905"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.0001908"
 Parameter: YTRAN -> "33.2056383"
 Parameter: ZTRAN -> "22.3943905"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    34.000191   33.205638   22.394391
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476493185"
Evaluating: 0.476493185*360.0
 Parameter: XPHI <- "171.537547"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.340738955"
Evaluating: 0.340738955*360.0
 Parameter: YPHI <- "122.666024"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791115783"
Evaluating: 0.791115783*360.0
 Parameter: ZPHI <- "284.801682"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.0001908"
 Parameter: YPOS -> "33.2056383"
 Parameter: ZPOS -> "22.3943905"
 Parameter: XPHI -> "171.537547"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.989113    0.147161
    0.000000   -0.147161   -0.989113

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.0001908"
 Parameter: YPOS -> "33.2056383"
 Parameter: ZPOS -> "22.3943905"
 Parameter: YPHI -> "122.666024"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.539741    0.000000   -0.841831
    0.000000    1.000000    0.000000
    0.841831    0.000000   -0.539741

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  122.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.0001908"
 Parameter: YPOS -> "33.2056383"
 Parameter: ZPOS -> "22.3943905"
 Parameter: ZPHI -> "284.801682"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.255474   -0.966816    0.000000
    0.966816    0.255474    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   75.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.000191 XMAX =   34.000191 XAVE =   34.000191
    YMIN =   33.205638 YMAX =   33.205638 YAVE =   33.205638
    ZMIN =   22.394391 ZMAX =   22.394391 ZAVE =   22.394391
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.0001908"
Evaluating: 34.0001908+3.5
 Parameter: XMAX <- "37.5001908"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.2056383"
Evaluating: 33.2056383+3.5
 Parameter: YMAX <- "36.7056383"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.3943905"
Evaluating: 22.3943905+3.5
 Parameter: ZMAX <- "25.8943905"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.0001908"
Evaluating: 34.0001908-3.5
 Parameter: XMIN <- "30.5001908"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.2056383"
Evaluating: 33.2056383-3.5
 Parameter: YMIN <- "29.7056383"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.3943905"
Evaluating: 22.3943905-3.5
 Parameter: ZMIN <- "18.8943905"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.5001908"
 Parameter: XMIN -> "30.5001908"
 Parameter: YMAX -> "36.7056383"
 Parameter: YMIN -> "29.7056383"
 Parameter: ZMAX -> "25.8943905"
 Parameter: ZMIN -> "18.8943905"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "153"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "153" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "153" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "117"
Evaluating: 153-117
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.268602366"
Evaluating: 128.065641*(0.268602366-0.5)
 Parameter: XPOS <- "-29.6340863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.555587546"
Evaluating: 128.065641*(0.555587546-0.5)
 Parameter: YPOS <- "7.11885471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.785892711"
Evaluating: 108.613069*(0.785892711-0.5)+-2.187274
 Parameter: ZPOS <- "28.8644107"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.8644107" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.8644107" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.6340863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.6340863-0
 Parameter: XTRAN <- "-29.6340863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.11885471"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.11885471-0
 Parameter: YTRAN <- "7.11885471"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.8644107"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.8644107-0
 Parameter: ZTRAN <- "28.8644107"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.6340863"
 Parameter: YTRAN -> "7.11885471"
 Parameter: ZTRAN -> "28.8644107"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -29.634086    7.118855   28.864411
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658201233"
Evaluating: 0.658201233*360.0
 Parameter: XPHI <- "236.952444"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26214172"
Evaluating: 0.26214172*360.0
 Parameter: YPHI <- "94.3710192"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395414736"
Evaluating: 0.395414736*360.0
 Parameter: ZPHI <- "142.349305"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.6340863"
 Parameter: YPOS -> "7.11885471"
 Parameter: ZPOS -> "28.8644107"
 Parameter: XPHI -> "236.952444"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.545335   -0.838218
    0.000000    0.838218   -0.545335

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.6340863"
 Parameter: YPOS -> "7.11885471"
 Parameter: ZPOS -> "28.8644107"
 Parameter: YPHI -> "94.3710192"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.076215    0.000000   -0.997091
    0.000000    1.000000    0.000000
    0.997091    0.000000   -0.076215

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.6340863"
 Parameter: YPOS -> "7.11885471"
 Parameter: ZPOS -> "28.8644107"
 Parameter: ZPHI -> "142.349305"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.791749    0.610846    0.000000
   -0.610846   -0.791749    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.634086 XMAX =  -29.634086 XAVE =  -29.634086
    YMIN =    7.118855 YMAX =    7.118855 YAVE =    7.118855
    ZMIN =   28.864411 ZMAX =   28.864411 ZAVE =   28.864411
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.6340863"
Evaluating: -29.6340863+3.5
 Parameter: XMAX <- "-26.1340863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.11885471"
Evaluating: 7.11885471+3.5
 Parameter: YMAX <- "10.6188547"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.8644107"
Evaluating: 28.8644107+3.5
 Parameter: ZMAX <- "32.3644107"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.6340863"
Evaluating: -29.6340863-3.5
 Parameter: XMIN <- "-33.1340863"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.11885471"
Evaluating: 7.11885471-3.5
 Parameter: YMIN <- "3.61885471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.8644107"
Evaluating: 28.8644107-3.5
 Parameter: ZMIN <- "25.3644107"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.1340863"
 Parameter: XMIN -> "-33.1340863"
 Parameter: YMAX -> "10.6188547"
 Parameter: YMIN -> "3.61885471"
 Parameter: ZMAX -> "32.3644107"
 Parameter: ZMIN -> "25.3644107"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "154"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "154" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "154" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "117"
Evaluating: 154-117
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.845460685"
Evaluating: 128.065641*(0.845460685-0.5)
 Parameter: XPOS <- "44.2416441"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.585191844"
Evaluating: 128.065641*(0.585191844-0.5)
 Parameter: YPOS <- "10.9101481"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.354816152"
Evaluating: 108.613069*(0.354816152-0.5)+-2.187274
 Parameter: ZPOS <- "-17.9561373"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.9561373" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.2416441"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.2416441-0
 Parameter: XTRAN <- "44.2416441"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.9101481"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.9101481-0
 Parameter: YTRAN <- "10.9101481"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.9561373"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.9561373-0
 Parameter: ZTRAN <- "-17.9561373"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.2416441"
 Parameter: YTRAN -> "10.9101481"
 Parameter: ZTRAN -> "-17.9561373"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    44.241644   10.910148  -17.956137
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934471052"
Evaluating: 0.934471052*360.0
 Parameter: XPHI <- "336.409579"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112110378"
Evaluating: 0.112110378*360.0
 Parameter: YPHI <- "40.3597361"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454484931"
Evaluating: 0.454484931*360.0
 Parameter: ZPHI <- "163.614575"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.2416441"
 Parameter: YPOS -> "10.9101481"
 Parameter: ZPOS -> "-17.9561373"
 Parameter: XPHI -> "336.409579"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.916430   -0.400196
    0.000000    0.400196    0.916430

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.2416441"
 Parameter: YPOS -> "10.9101481"
 Parameter: ZPOS -> "-17.9561373"
 Parameter: YPHI -> "40.3597361"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.761994    0.000000   -0.647585
    0.000000    1.000000    0.000000
    0.647585    0.000000    0.761994

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.2416441"
 Parameter: YPOS -> "10.9101481"
 Parameter: ZPOS -> "-17.9561373"
 Parameter: ZPHI -> "163.614575"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.959386    0.282097    0.000000
   -0.282097   -0.959386    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.241644 XMAX =   44.241644 XAVE =   44.241644
    YMIN =   10.910148 YMAX =   10.910148 YAVE =   10.910148
    ZMIN =  -17.956137 ZMAX =  -17.956137 ZAVE =  -17.956137
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.2416441"
Evaluating: 44.2416441+3.5
 Parameter: XMAX <- "47.7416441"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.9101481"
Evaluating: 10.9101481+3.5
 Parameter: YMAX <- "14.4101481"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.9561373"
Evaluating: -17.9561373+3.5
 Parameter: ZMAX <- "-14.4561373"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.2416441"
Evaluating: 44.2416441-3.5
 Parameter: XMIN <- "40.7416441"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.9101481"
Evaluating: 10.9101481-3.5
 Parameter: YMIN <- "7.4101481"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.9561373"
Evaluating: -17.9561373-3.5
 Parameter: ZMIN <- "-21.4561373"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.7416441"
 Parameter: XMIN -> "40.7416441"
 Parameter: YMAX -> "14.4101481"
 Parameter: YMIN -> "7.4101481"
 Parameter: ZMAX -> "-14.4561373"
 Parameter: ZMIN -> "-21.4561373"
 SELRPN>     18 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      9 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60386 NEG      CLA      37       CLA     -**** MEMB     DMPC     230      C13           3.2844
60386 NEG      CLA      37       CLA     -**** MEMB     DMPC     230      C12           2.8253
60386 NEG      CLA      37       CLA     -**** MEMB     DMPC     230      C11           2.3351
60386 NEG      CLA      37       CLA     -**** MEMB     DMPC     230      O12           3.7197
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "154" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "117"
Evaluating: 154-117
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.988117516"
Evaluating: 128.065641*(0.988117516-0.5)
 Parameter: XPOS <- "62.5110826"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.286842985"
Evaluating: 128.065641*(0.286842985-0.5)
 Parameter: YPOS <- "-27.2980898"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.648634974"
Evaluating: 108.613069*(0.648634974-0.5)+-2.187274
 Parameter: ZPOS <- "13.9564267"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.9564267" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.9564267" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "154" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "117"
Evaluating: 154-117
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.864069135"
Evaluating: 128.065641*(0.864069135-0.5)
 Parameter: XPOS <- "46.6247471"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.462885917"
Evaluating: 128.065641*(0.462885917-0.5)
 Parameter: YPOS <- "-4.75303883"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.931507175"
Evaluating: 108.613069*(0.931507175-0.5)+-2.187274
 Parameter: ZPOS <- "44.6800446"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.6800446" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.6800446" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.241644 XMAX =   44.241644 XAVE =   44.241644
    YMIN =   10.910148 YMAX =   10.910148 YAVE =   10.910148
    ZMIN =  -17.956137 ZMAX =  -17.956137 ZAVE =  -17.956137
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.6247471"
 RDCMND substituted energy or value "?XAVE" to "44.2416441"
Evaluating: 46.6247471-44.2416441
 Parameter: XTRAN <- "2.383103"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.75303883"
 RDCMND substituted energy or value "?YAVE" to "10.9101481"
Evaluating: -4.75303883-10.9101481
 Parameter: YTRAN <- "-15.6631869"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.6800446"
 RDCMND substituted energy or value "?ZAVE" to "-17.9561373"
Evaluating: 44.6800446--17.9561373
 Parameter: ZTRAN <- "62.6361819"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.383103"
 Parameter: YTRAN -> "-15.6631869"
 Parameter: ZTRAN -> "62.6361819"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     2.383103  -15.663187   62.636182
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.176798773"
Evaluating: 0.176798773*360.0
 Parameter: XPHI <- "63.6475583"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852833164"
Evaluating: 0.852833164*360.0
 Parameter: YPHI <- "307.019939"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31692098"
Evaluating: 0.31692098*360.0
 Parameter: ZPHI <- "114.091553"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.6247471"
 Parameter: YPOS -> "-4.75303883"
 Parameter: ZPOS -> "44.6800446"
 Parameter: XPHI -> "63.6475583"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.443892    0.896081
    0.000000   -0.896081    0.443892

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.6247471"
 Parameter: YPOS -> "-4.75303883"
 Parameter: ZPOS -> "44.6800446"
 Parameter: YPHI -> "307.019939"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.602093    0.000000    0.798426
    0.000000    1.000000    0.000000
   -0.798426    0.000000    0.602093

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.6247471"
 Parameter: YPOS -> "-4.75303883"
 Parameter: ZPOS -> "44.6800446"
 Parameter: ZPHI -> "114.091553"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.408196    0.912894    0.000000
   -0.912894   -0.408196    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.624747 XMAX =   46.624747 XAVE =   46.624747
    YMIN =   -4.753039 YMAX =   -4.753039 YAVE =   -4.753039
    ZMIN =   44.680045 ZMAX =   44.680045 ZAVE =   44.680045
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.6247471"
Evaluating: 46.6247471+3.5
 Parameter: XMAX <- "50.1247471"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.75303882"
Evaluating: -4.75303882+3.5
 Parameter: YMAX <- "-1.25303882"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.6800446"
Evaluating: 44.6800446+3.5
 Parameter: ZMAX <- "48.1800446"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.6247471"
Evaluating: 46.6247471-3.5
 Parameter: XMIN <- "43.1247471"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.75303882"
Evaluating: -4.75303882-3.5
 Parameter: YMIN <- "-8.25303882"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.6800446"
Evaluating: 44.6800446-3.5
 Parameter: ZMIN <- "41.1800446"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.1247471"
 Parameter: XMIN -> "43.1247471"
 Parameter: YMAX -> "-1.25303882"
 Parameter: YMIN -> "-8.25303882"
 Parameter: ZMAX -> "48.1800446"
 Parameter: ZMIN -> "41.1800446"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "155"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "155" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "155" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "117"
Evaluating: 155-117
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.920524487"
Evaluating: 128.065641*(0.920524487-0.5)
 Parameter: XPOS <- "53.854738"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.418927791"
Evaluating: 128.065641*(0.418927791-0.5)
 Parameter: YPOS <- "-10.3825644"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.588797868"
Evaluating: 108.613069*(0.588797868-0.5)+-2.187274
 Parameter: ZPOS <- "7.45733496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.45733496" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.45733496" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "155" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "117"
Evaluating: 155-117
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.62440777"
Evaluating: 128.065641*(0.62440777-0.5)
 Parameter: XPOS <- "15.9323608"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.571644648"
Evaluating: 128.065641*(0.571644648-0.5)
 Parameter: YPOS <- "9.17521777"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.511889515"
Evaluating: 108.613069*(0.511889515-0.5)+-2.187274
 Parameter: ZPOS <- "-0.895917287"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.895917287" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.895917287" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "155" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "117"
Evaluating: 155-117
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.549793983"
Evaluating: 128.065641*(0.549793983-0.5)
 Parameter: XPOS <- "6.37689835"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.724118129"
Evaluating: 128.065641*(0.724118129-0.5)
 Parameter: YPOS <- "28.7018319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.92879066"
Evaluating: 108.613069*(0.92879066-0.5)+-2.187274
 Parameter: ZPOS <- "44.3849955"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.3849955" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.3849955" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.37689835"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.37689835-0
 Parameter: XTRAN <- "6.37689835"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.7018319"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.7018319-0
 Parameter: YTRAN <- "28.7018319"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.3849955"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.3849955-0
 Parameter: ZTRAN <- "44.3849955"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.37689835"
 Parameter: YTRAN -> "28.7018319"
 Parameter: ZTRAN -> "44.3849955"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     6.376898   28.701832   44.384996
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.932543628"
Evaluating: 0.932543628*360.0
 Parameter: XPHI <- "335.715706"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672645658"
Evaluating: 0.672645658*360.0
 Parameter: YPHI <- "242.152437"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732985198"
Evaluating: 0.732985198*360.0
 Parameter: ZPHI <- "263.874671"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.37689835"
 Parameter: YPOS -> "28.7018319"
 Parameter: ZPOS -> "44.3849955"
 Parameter: XPHI -> "335.715706"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.911516   -0.411265
    0.000000    0.411265    0.911516

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   24.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.37689835"
 Parameter: YPOS -> "28.7018319"
 Parameter: ZPOS -> "44.3849955"
 Parameter: YPHI -> "242.152437"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.467121    0.000000    0.884194
    0.000000    1.000000    0.000000
   -0.884194    0.000000   -0.467121

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.37689835"
 Parameter: YPOS -> "28.7018319"
 Parameter: ZPOS -> "44.3849955"
 Parameter: ZPHI -> "263.874671"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.106704   -0.994291    0.000000
    0.994291   -0.106704    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   96.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.376898 XMAX =    6.376898 XAVE =    6.376898
    YMIN =   28.701832 YMAX =   28.701832 YAVE =   28.701832
    ZMIN =   44.384996 ZMAX =   44.384996 ZAVE =   44.384996
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.37689835"
Evaluating: 6.37689835+3.5
 Parameter: XMAX <- "9.87689835"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.7018319"
Evaluating: 28.7018319+3.5
 Parameter: YMAX <- "32.2018319"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.3849955"
Evaluating: 44.3849955+3.5
 Parameter: ZMAX <- "47.8849955"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.37689835"
Evaluating: 6.37689835-3.5
 Parameter: XMIN <- "2.87689835"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.7018319"
Evaluating: 28.7018319-3.5
 Parameter: YMIN <- "25.2018319"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.3849955"
Evaluating: 44.3849955-3.5
 Parameter: ZMIN <- "40.8849955"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.87689835"
 Parameter: XMIN -> "2.87689835"
 Parameter: YMAX -> "32.2018319"
 Parameter: YMIN -> "25.2018319"
 Parameter: ZMAX -> "47.8849955"
 Parameter: ZMIN -> "40.8849955"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "156"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "156" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "156" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "117"
Evaluating: 156-117
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.549920649"
Evaluating: 128.065641*(0.549920649-0.5)
 Parameter: XPOS <- "6.39311991"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.80988072"
Evaluating: 128.065641*(0.80988072-0.5)
 Parameter: YPOS <- "39.685073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.549511071"
Evaluating: 108.613069*(0.549511071-0.5)+-2.187274
 Parameter: ZPOS <- "3.19027537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.19027537" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.19027537" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "156" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "117"
Evaluating: 156-117
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.939323144"
Evaluating: 128.065641*(0.939323144-0.5)
 Parameter: XPOS <- "56.2622"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.732156018"
Evaluating: 128.065641*(0.732156018-0.5)
 Parameter: YPOS <- "29.7312093"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.383357619"
Evaluating: 108.613069*(0.383357619-0.5)+-2.187274
 Parameter: ZPOS <- "-14.856161"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.856161" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.856161" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "156" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "117"
Evaluating: 156-117
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.706707788"
Evaluating: 128.065641*(0.706707788-0.5)
 Parameter: XPOS <- "26.4721654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.576498531"
Evaluating: 128.065641*(0.576498531-0.5)
 Parameter: YPOS <- "9.79683341"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.727639376"
Evaluating: 108.613069*(0.727639376-0.5)+-2.187274
 Parameter: ZPOS <- "22.5373373"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.5373373" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.5373373" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.4721654"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.4721654-0
 Parameter: XTRAN <- "26.4721654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.79683341"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.79683341-0
 Parameter: YTRAN <- "9.79683341"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.5373373"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.5373373-0
 Parameter: ZTRAN <- "22.5373373"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.4721654"
 Parameter: YTRAN -> "9.79683341"
 Parameter: ZTRAN -> "22.5373373"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    26.472165    9.796833   22.537337
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78088598"
Evaluating: 0.78088598*360.0
 Parameter: XPHI <- "281.118953"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254424006"
Evaluating: 0.254424006*360.0
 Parameter: YPHI <- "91.5926422"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657515399"
Evaluating: 0.657515399*360.0
 Parameter: ZPHI <- "236.705544"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.4721654"
 Parameter: YPOS -> "9.79683341"
 Parameter: ZPOS -> "22.5373373"
 Parameter: XPHI -> "281.118953"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.192847   -0.981229
    0.000000    0.981229    0.192847

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   78.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.4721654"
 Parameter: YPOS -> "9.79683341"
 Parameter: ZPOS -> "22.5373373"
 Parameter: YPHI -> "91.5926422"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.027793    0.000000   -0.999614
    0.000000    1.000000    0.000000
    0.999614    0.000000   -0.027793

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.4721654"
 Parameter: YPOS -> "9.79683341"
 Parameter: ZPOS -> "22.5373373"
 Parameter: ZPHI -> "236.705544"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.548942   -0.835860    0.000000
    0.835860   -0.548942    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  123.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.472165 XMAX =   26.472165 XAVE =   26.472165
    YMIN =    9.796833 YMAX =    9.796833 YAVE =    9.796833
    ZMIN =   22.537337 ZMAX =   22.537337 ZAVE =   22.537337
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.4721654"
Evaluating: 26.4721654+3.5
 Parameter: XMAX <- "29.9721654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.79683341"
Evaluating: 9.79683341+3.5
 Parameter: YMAX <- "13.2968334"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.5373373"
Evaluating: 22.5373373+3.5
 Parameter: ZMAX <- "26.0373373"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.4721654"
Evaluating: 26.4721654-3.5
 Parameter: XMIN <- "22.9721654"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.79683341"
Evaluating: 9.79683341-3.5
 Parameter: YMIN <- "6.29683341"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.5373373"
Evaluating: 22.5373373-3.5
 Parameter: ZMIN <- "19.0373373"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.9721654"
 Parameter: XMIN -> "22.9721654"
 Parameter: YMAX -> "13.2968334"
 Parameter: YMIN -> "6.29683341"
 Parameter: ZMAX -> "26.0373373"
 Parameter: ZMIN -> "19.0373373"
 SELRPN>     14 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      4 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60388 NEG      CLA      39       CLA     -1984 PROB     LYS      532      CB            3.1963
60388 NEG      CLA      39       CLA     -1987 PROB     LYS      532      CG            3.3473
60388 NEG      CLA      39       CLA     -1990 PROB     LYS      532      CD            2.8197
60388 NEG      CLA      39       CLA     -1993 PROB     LYS      532      CE            3.7236
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "156" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "117"
Evaluating: 156-117
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.431428113"
Evaluating: 128.065641*(0.431428113-0.5)
 Parameter: XPOS <- "-8.78170266"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.747872517"
Evaluating: 128.065641*(0.747872517-0.5)
 Parameter: YPOS <- "31.7439528"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.764962449"
Evaluating: 108.613069*(0.764962449-0.5)+-2.187274
 Parameter: ZPOS <- "26.5911108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.5911108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.5911108" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.472165 XMAX =   26.472165 XAVE =   26.472165
    YMIN =    9.796833 YMAX =    9.796833 YAVE =    9.796833
    ZMIN =   22.537337 ZMAX =   22.537337 ZAVE =   22.537337
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.78170266"
 RDCMND substituted energy or value "?XAVE" to "26.4721654"
Evaluating: -8.78170266-26.4721654
 Parameter: XTRAN <- "-35.2538681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.7439528"
 RDCMND substituted energy or value "?YAVE" to "9.79683341"
Evaluating: 31.7439528-9.79683341
 Parameter: YTRAN <- "21.9471194"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.5911108"
 RDCMND substituted energy or value "?ZAVE" to "22.5373373"
Evaluating: 26.5911108-22.5373373
 Parameter: ZTRAN <- "4.0537735"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.2538681"
 Parameter: YTRAN -> "21.9471194"
 Parameter: ZTRAN -> "4.0537735"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -35.253868   21.947119    4.053774
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418513473"
Evaluating: 0.418513473*360.0
 Parameter: XPHI <- "150.66485"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.706280197"
Evaluating: 0.706280197*360.0
 Parameter: YPHI <- "254.260871"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554926833"
Evaluating: 0.554926833*360.0
 Parameter: ZPHI <- "199.77366"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.78170266"
 Parameter: YPOS -> "31.7439528"
 Parameter: ZPOS -> "26.5911108"
 Parameter: XPHI -> "150.66485"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.871769    0.489917
    0.000000   -0.489917   -0.871769

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.78170266"
 Parameter: YPOS -> "31.7439528"
 Parameter: ZPOS -> "26.5911108"
 Parameter: YPHI -> "254.260871"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.271258    0.000000    0.962507
    0.000000    1.000000    0.000000
   -0.962507    0.000000   -0.271258

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.78170266"
 Parameter: YPOS -> "31.7439528"
 Parameter: ZPOS -> "26.5911108"
 Parameter: ZPHI -> "199.77366"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.941036   -0.338305    0.000000
    0.338305   -0.941036    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.781703 XMAX =   -8.781703 XAVE =   -8.781703
    YMIN =   31.743953 YMAX =   31.743953 YAVE =   31.743953
    ZMIN =   26.591111 ZMAX =   26.591111 ZAVE =   26.591111
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.78170266"
Evaluating: -8.78170266+3.5
 Parameter: XMAX <- "-5.28170266"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.7439528"
Evaluating: 31.7439528+3.5
 Parameter: YMAX <- "35.2439528"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.5911108"
Evaluating: 26.5911108+3.5
 Parameter: ZMAX <- "30.0911108"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.78170266"
Evaluating: -8.78170266-3.5
 Parameter: XMIN <- "-12.2817027"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.7439528"
Evaluating: 31.7439528-3.5
 Parameter: YMIN <- "28.2439528"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.5911108"
Evaluating: 26.5911108-3.5
 Parameter: ZMIN <- "23.0911108"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.28170266"
 Parameter: XMIN -> "-12.2817027"
 Parameter: YMAX -> "35.2439528"
 Parameter: YMIN -> "28.2439528"
 Parameter: ZMAX -> "30.0911108"
 Parameter: ZMIN -> "23.0911108"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "157"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "157" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "157"
Evaluating: 157
 Parameter: J <- "157"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "157" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "157"
 Parameter: NPOS -> "117"
Evaluating: 157-117
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.37887513"
Evaluating: 128.065641*(0.37887513-0.5)
 Parameter: XPOS <- "-15.5119341"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.877513381"
Evaluating: 128.065641*(0.877513381-0.5)
 Parameter: YPOS <- "48.3464931"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.598523576"
Evaluating: 108.613069*(0.598523576-0.5)+-2.187274
 Parameter: ZPOS <- "8.51367396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.51367396" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.51367396" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "157"
Evaluating: 157
 Parameter: J <- "157"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "157" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "157"
 Parameter: NPOS -> "117"
Evaluating: 157-117
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.281163537"
Evaluating: 128.065641*(0.281163537-0.5)
 Parameter: XPOS <- "-28.0254319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.731994328"
Evaluating: 128.065641*(0.731994328-0.5)
 Parameter: YPOS <- "29.7105023"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.119788012"
Evaluating: 108.613069*(0.119788012-0.5)+-2.187274
 Parameter: ZPOS <- "-43.4832649"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.4832649" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.0254319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.0254319-0
 Parameter: XTRAN <- "-28.0254319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.7105023"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.7105023-0
 Parameter: YTRAN <- "29.7105023"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.4832649"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.4832649-0
 Parameter: ZTRAN <- "-43.4832649"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.0254319"
 Parameter: YTRAN -> "29.7105023"
 Parameter: ZTRAN -> "-43.4832649"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -28.025432   29.710502  -43.483265
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873461464"
Evaluating: 0.873461464*360.0
 Parameter: XPHI <- "314.446127"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.786799533"
Evaluating: 0.786799533*360.0
 Parameter: YPHI <- "283.247832"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.183383549"
Evaluating: 0.183383549*360.0
 Parameter: ZPHI <- "66.0180776"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.0254319"
 Parameter: YPOS -> "29.7105023"
 Parameter: ZPOS -> "-43.4832649"
 Parameter: XPHI -> "314.446127"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.700238   -0.713909
    0.000000    0.713909    0.700238

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.0254319"
 Parameter: YPOS -> "29.7105023"
 Parameter: ZPOS -> "-43.4832649"
 Parameter: YPHI -> "283.247832"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.229164    0.000000    0.973388
    0.000000    1.000000    0.000000
   -0.973388    0.000000    0.229164

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   76.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.0254319"
 Parameter: YPOS -> "29.7105023"
 Parameter: ZPOS -> "-43.4832649"
 Parameter: ZPHI -> "66.0180776"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.406448    0.913674    0.000000
   -0.913674    0.406448    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.025432 XMAX =  -28.025432 XAVE =  -28.025432
    YMIN =   29.710502 YMAX =   29.710502 YAVE =   29.710502
    ZMIN =  -43.483265 ZMAX =  -43.483265 ZAVE =  -43.483265
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.0254319"
Evaluating: -28.0254319+3.5
 Parameter: XMAX <- "-24.5254319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.7105023"
Evaluating: 29.7105023+3.5
 Parameter: YMAX <- "33.2105023"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.4832649"
Evaluating: -43.4832649+3.5
 Parameter: ZMAX <- "-39.9832649"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.0254319"
Evaluating: -28.0254319-3.5
 Parameter: XMIN <- "-31.5254319"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.7105023"
Evaluating: 29.7105023-3.5
 Parameter: YMIN <- "26.2105023"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.4832649"
Evaluating: -43.4832649-3.5
 Parameter: ZMIN <- "-46.9832649"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.5254319"
 Parameter: XMIN -> "-31.5254319"
 Parameter: YMAX -> "33.2105023"
 Parameter: YMIN -> "26.2105023"
 Parameter: ZMAX -> "-39.9832649"
 Parameter: ZMIN -> "-46.9832649"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "158"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "158" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "158"
Evaluating: 158
 Parameter: J <- "158"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "158" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "158"
 Parameter: NPOS -> "117"
Evaluating: 158-117
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.643474224"
Evaluating: 128.065641*(0.643474224-0.5)
 Parameter: XPOS <- "18.3741185"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.594957093"
Evaluating: 128.065641*(0.594957093-0.5)
 Parameter: YPOS <- "12.160741"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.778845823"
Evaluating: 108.613069*(0.778845823-0.5)+-2.187274
 Parameter: ZPOS <- "28.0990266"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.0990266" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.0990266" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.3741185"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.3741185-0
 Parameter: XTRAN <- "18.3741185"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.160741"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.160741-0
 Parameter: YTRAN <- "12.160741"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.0990266"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.0990266-0
 Parameter: ZTRAN <- "28.0990266"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.3741185"
 Parameter: YTRAN -> "12.160741"
 Parameter: ZTRAN -> "28.0990266"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    18.374119   12.160741   28.099027
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720901876"
Evaluating: 0.720901876*360.0
 Parameter: XPHI <- "259.524675"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.419902907"
Evaluating: 0.419902907*360.0
 Parameter: YPHI <- "151.165047"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.461875846"
Evaluating: 0.461875846*360.0
 Parameter: ZPHI <- "166.275305"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.3741185"
 Parameter: YPOS -> "12.160741"
 Parameter: ZPOS -> "28.0990266"
 Parameter: XPHI -> "259.524675"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.181812   -0.983333
    0.000000    0.983333   -0.181812

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.3741185"
 Parameter: YPOS -> "12.160741"
 Parameter: ZPOS -> "28.0990266"
 Parameter: YPHI -> "151.165047"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.876013    0.000000   -0.482288
    0.000000    1.000000    0.000000
    0.482288    0.000000   -0.876013

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.3741185"
 Parameter: YPOS -> "12.160741"
 Parameter: ZPOS -> "28.0990266"
 Parameter: ZPHI -> "166.275305"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.971447    0.237257    0.000000
   -0.237257   -0.971447    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  166.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.374119 XMAX =   18.374119 XAVE =   18.374119
    YMIN =   12.160741 YMAX =   12.160741 YAVE =   12.160741
    ZMIN =   28.099027 ZMAX =   28.099027 ZAVE =   28.099027
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.3741185"
Evaluating: 18.3741185+3.5
 Parameter: XMAX <- "21.8741185"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.160741"
Evaluating: 12.160741+3.5
 Parameter: YMAX <- "15.660741"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.0990266"
Evaluating: 28.0990266+3.5
 Parameter: ZMAX <- "31.5990266"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.3741185"
Evaluating: 18.3741185-3.5
 Parameter: XMIN <- "14.8741185"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.160741"
Evaluating: 12.160741-3.5
 Parameter: YMIN <- "8.660741"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.0990266"
Evaluating: 28.0990266-3.5
 Parameter: ZMIN <- "24.5990266"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.8741185"
 Parameter: XMIN -> "14.8741185"
 Parameter: YMAX -> "15.660741"
 Parameter: YMIN -> "8.660741"
 Parameter: ZMAX -> "31.5990266"
 Parameter: ZMIN -> "24.5990266"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "159"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "159" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "159"
Evaluating: 159
 Parameter: J <- "159"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "159" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "159"
 Parameter: NPOS -> "117"
Evaluating: 159-117
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.980719694"
Evaluating: 128.065641*(0.980719694-0.5)
 Parameter: XPOS <- "61.5636758"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.321182859"
Evaluating: 128.065641*(0.321182859-0.5)
 Parameter: YPOS <- "-22.9003318"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.974680613"
Evaluating: 108.613069*(0.974680613-0.5)+-2.187274
 Parameter: ZPOS <- "49.3692442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.3692442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.3692442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.5636758"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.5636758-0
 Parameter: XTRAN <- "61.5636758"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.9003318"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.9003318-0
 Parameter: YTRAN <- "-22.9003318"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.3692442"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.3692442-0
 Parameter: ZTRAN <- "49.3692442"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.5636758"
 Parameter: YTRAN -> "-22.9003318"
 Parameter: ZTRAN -> "49.3692442"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    61.563676  -22.900332   49.369244
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122189674"
Evaluating: 0.122189674*360.0
 Parameter: XPHI <- "43.9882826"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.187105904"
Evaluating: 0.187105904*360.0
 Parameter: YPHI <- "67.3581254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336353485"
Evaluating: 0.336353485*360.0
 Parameter: ZPHI <- "121.087255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.5636758"
 Parameter: YPOS -> "-22.9003318"
 Parameter: ZPOS -> "49.3692442"
 Parameter: XPHI -> "43.9882826"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.719482    0.694511
    0.000000   -0.694511    0.719482

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.5636758"
 Parameter: YPOS -> "-22.9003318"
 Parameter: ZPOS -> "49.3692442"
 Parameter: YPHI -> "67.3581254"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.384970    0.000000   -0.922929
    0.000000    1.000000    0.000000
    0.922929    0.000000    0.384970

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.5636758"
 Parameter: YPOS -> "-22.9003318"
 Parameter: ZPOS -> "49.3692442"
 Parameter: ZPHI -> "121.087255"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.516343    0.856382    0.000000
   -0.856382   -0.516343    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.563676 XMAX =   61.563676 XAVE =   61.563676
    YMIN =  -22.900332 YMAX =  -22.900332 YAVE =  -22.900332
    ZMIN =   49.369244 ZMAX =   49.369244 ZAVE =   49.369244
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.5636758"
Evaluating: 61.5636758+3.5
 Parameter: XMAX <- "65.0636758"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.9003318"
Evaluating: -22.9003318+3.5
 Parameter: YMAX <- "-19.4003318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.3692442"
Evaluating: 49.3692442+3.5
 Parameter: ZMAX <- "52.8692442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.5636758"
Evaluating: 61.5636758-3.5
 Parameter: XMIN <- "58.0636758"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.9003318"
Evaluating: -22.9003318-3.5
 Parameter: YMIN <- "-26.4003318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.3692442"
Evaluating: 49.3692442-3.5
 Parameter: ZMIN <- "45.8692442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.0636758"
 Parameter: XMIN -> "58.0636758"
 Parameter: YMAX -> "-19.4003318"
 Parameter: YMIN -> "-26.4003318"
 Parameter: ZMAX -> "52.8692442"
 Parameter: ZMIN -> "45.8692442"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "160"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "160" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "160"
Evaluating: 160
 Parameter: J <- "160"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "160" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "160"
 Parameter: NPOS -> "117"
Evaluating: 160-117
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.755207429"
Evaluating: 128.065641*(0.755207429-0.5)
 Parameter: XPOS <- "32.683303"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.394625837"
Evaluating: 128.065641*(0.394625837-0.5)
 Parameter: YPOS <- "-13.4948097"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.880256992"
Evaluating: 108.613069*(0.880256992-0.5)+-2.187274
 Parameter: ZPOS <- "39.1136049"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.1136049" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.1136049" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.683303"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.683303-0
 Parameter: XTRAN <- "32.683303"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.4948097"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.4948097-0
 Parameter: YTRAN <- "-13.4948097"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.1136049"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.1136049-0
 Parameter: ZTRAN <- "39.1136049"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.683303"
 Parameter: YTRAN -> "-13.4948097"
 Parameter: ZTRAN -> "39.1136049"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    32.683303  -13.494810   39.113605
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.270096874E-02"
Evaluating: 7.270096874E-02*360.0
 Parameter: XPHI <- "26.1723487"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.595375968"
Evaluating: 0.595375968*360.0
 Parameter: YPHI <- "214.335348"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302391891"
Evaluating: 0.302391891*360.0
 Parameter: ZPHI <- "108.861081"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.683303"
 Parameter: YPOS -> "-13.4948097"
 Parameter: ZPOS -> "39.1136049"
 Parameter: XPHI -> "26.1723487"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.897471    0.441073
    0.000000   -0.441073    0.897471

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.683303"
 Parameter: YPOS -> "-13.4948097"
 Parameter: ZPOS -> "39.1136049"
 Parameter: YPHI -> "214.335348"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.825750    0.000000    0.564036
    0.000000    1.000000    0.000000
   -0.564036    0.000000   -0.825750

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  145.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.683303"
 Parameter: YPOS -> "-13.4948097"
 Parameter: ZPOS -> "39.1136049"
 Parameter: ZPHI -> "108.861081"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.323275    0.946305    0.000000
   -0.946305   -0.323275    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.683303 XMAX =   32.683303 XAVE =   32.683303
    YMIN =  -13.494810 YMAX =  -13.494810 YAVE =  -13.494810
    ZMIN =   39.113605 ZMAX =   39.113605 ZAVE =   39.113605
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.683303"
Evaluating: 32.683303+3.5
 Parameter: XMAX <- "36.183303"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.4948097"
Evaluating: -13.4948097+3.5
 Parameter: YMAX <- "-9.9948097"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.1136049"
Evaluating: 39.1136049+3.5
 Parameter: ZMAX <- "42.6136049"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.683303"
Evaluating: 32.683303-3.5
 Parameter: XMIN <- "29.183303"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.4948097"
Evaluating: -13.4948097-3.5
 Parameter: YMIN <- "-16.9948097"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.1136049"
Evaluating: 39.1136049-3.5
 Parameter: ZMIN <- "35.6136049"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.183303"
 Parameter: XMIN -> "29.183303"
 Parameter: YMAX -> "-9.9948097"
 Parameter: YMIN -> "-16.9948097"
 Parameter: ZMAX -> "42.6136049"
 Parameter: ZMIN -> "35.6136049"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "161"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "161" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "161" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "117"
Evaluating: 161-117
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.317913008"
Evaluating: 128.065641*(0.317913008-0.5)
 Parameter: XPOS <- "-23.3190873"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.720278038E-02"
Evaluating: 128.065641*(8.720278038E-02-0.5)
 Parameter: YPOS <- "-52.8651405"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.34889873"
Evaluating: 108.613069*(0.34889873-0.5)+-2.187274
 Parameter: ZPOS <- "-18.5988467"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.5988467" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.3190873"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.3190873-0
 Parameter: XTRAN <- "-23.3190873"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.8651405"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.8651405-0
 Parameter: YTRAN <- "-52.8651405"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.5988467"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.5988467-0
 Parameter: ZTRAN <- "-18.5988467"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.3190873"
 Parameter: YTRAN -> "-52.8651405"
 Parameter: ZTRAN -> "-18.5988467"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -23.319087  -52.865141  -18.598847
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193548874"
Evaluating: 0.193548874*360.0
 Parameter: XPHI <- "69.6775946"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987147555"
Evaluating: 0.987147555*360.0
 Parameter: YPHI <- "355.37312"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.706183731"
Evaluating: 0.706183731*360.0
 Parameter: ZPHI <- "254.226143"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.3190873"
 Parameter: YPOS -> "-52.8651405"
 Parameter: ZPOS -> "-18.5988467"
 Parameter: XPHI -> "69.6775946"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.347302    0.937753
    0.000000   -0.937753    0.347302

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.3190873"
 Parameter: YPOS -> "-52.8651405"
 Parameter: ZPOS -> "-18.5988467"
 Parameter: YPHI -> "355.37312"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.996741    0.000000    0.080667
    0.000000    1.000000    0.000000
   -0.080667    0.000000    0.996741

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.3190873"
 Parameter: YPOS -> "-52.8651405"
 Parameter: ZPOS -> "-18.5988467"
 Parameter: ZPHI -> "254.226143"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.271841   -0.962342    0.000000
    0.962342   -0.271841    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  105.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.319087 XMAX =  -23.319087 XAVE =  -23.319087
    YMIN =  -52.865141 YMAX =  -52.865141 YAVE =  -52.865141
    ZMIN =  -18.598847 ZMAX =  -18.598847 ZAVE =  -18.598847
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.3190873"
Evaluating: -23.3190873+3.5
 Parameter: XMAX <- "-19.8190873"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.8651405"
Evaluating: -52.8651405+3.5
 Parameter: YMAX <- "-49.3651405"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.5988467"
Evaluating: -18.5988467+3.5
 Parameter: ZMAX <- "-15.0988467"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.3190873"
Evaluating: -23.3190873-3.5
 Parameter: XMIN <- "-26.8190873"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.8651405"
Evaluating: -52.8651405-3.5
 Parameter: YMIN <- "-56.3651405"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.5988467"
Evaluating: -18.5988467-3.5
 Parameter: ZMIN <- "-22.0988467"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.8190873"
 Parameter: XMIN -> "-26.8190873"
 Parameter: YMAX -> "-49.3651405"
 Parameter: YMIN -> "-56.3651405"
 Parameter: ZMAX -> "-15.0988467"
 Parameter: ZMIN -> "-22.0988467"
 SELRPN>     24 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      7 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     350      C15           3.1059
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     360      N             2.0721
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     360      C13           1.4427
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     360      C14           2.9369
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     360      C15           3.3314
60393 NEG      CLA      44       CLA     -**** MEMB     DMPC     360      C12           2.1820
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "161" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "117"
Evaluating: 161-117
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.259633825"
Evaluating: 128.065641*(0.259633825-0.5)
 Parameter: XPOS <- "-30.7826483"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.644067829"
Evaluating: 128.065641*(0.644067829-0.5)
 Parameter: YPOS <- "18.4501389"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.81213743"
Evaluating: 108.613069*(0.81213743-0.5)+-2.187274
 Parameter: ZPOS <- "31.7149302"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.7149302" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.7149302" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.319087 XMAX =  -23.319087 XAVE =  -23.319087
    YMIN =  -52.865141 YMAX =  -52.865141 YAVE =  -52.865141
    ZMIN =  -18.598847 ZMAX =  -18.598847 ZAVE =  -18.598847
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.7826483"
 RDCMND substituted energy or value "?XAVE" to "-23.3190873"
Evaluating: -30.7826483--23.3190873
 Parameter: XTRAN <- "-7.463561"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.4501389"
 RDCMND substituted energy or value "?YAVE" to "-52.8651405"
Evaluating: 18.4501389--52.8651405
 Parameter: YTRAN <- "71.3152794"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.7149302"
 RDCMND substituted energy or value "?ZAVE" to "-18.5988467"
Evaluating: 31.7149302--18.5988467
 Parameter: ZTRAN <- "50.3137769"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.463561"
 Parameter: YTRAN -> "71.3152794"
 Parameter: ZTRAN -> "50.3137769"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.463561   71.315279   50.313777
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.606778714"
Evaluating: 0.606778714*360.0
 Parameter: XPHI <- "218.440337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691220686"
Evaluating: 0.691220686*360.0
 Parameter: YPHI <- "248.839447"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201586422"
Evaluating: 0.201586422*360.0
 Parameter: ZPHI <- "72.5711119"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.7826483"
 Parameter: YPOS -> "18.4501389"
 Parameter: ZPOS -> "31.7149302"
 Parameter: XPHI -> "218.440337"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.783256   -0.621699
    0.000000    0.621699   -0.783256

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  141.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.7826483"
 Parameter: YPOS -> "18.4501389"
 Parameter: ZPOS -> "31.7149302"
 Parameter: YPHI -> "248.839447"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.360983    0.000000    0.932573
    0.000000    1.000000    0.000000
   -0.932573    0.000000   -0.360983

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  111.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.7826483"
 Parameter: YPOS -> "18.4501389"
 Parameter: ZPOS -> "31.7149302"
 Parameter: ZPHI -> "72.5711119"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.299522    0.954089    0.000000
   -0.954089    0.299522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.782648 XMAX =  -30.782648 XAVE =  -30.782648
    YMIN =   18.450139 YMAX =   18.450139 YAVE =   18.450139
    ZMIN =   31.714930 ZMAX =   31.714930 ZAVE =   31.714930
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.7826483"
Evaluating: -30.7826483+3.5
 Parameter: XMAX <- "-27.2826483"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.4501389"
Evaluating: 18.4501389+3.5
 Parameter: YMAX <- "21.9501389"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.7149302"
Evaluating: 31.7149302+3.5
 Parameter: ZMAX <- "35.2149302"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.7826483"
Evaluating: -30.7826483-3.5
 Parameter: XMIN <- "-34.2826483"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.4501389"
Evaluating: 18.4501389-3.5
 Parameter: YMIN <- "14.9501389"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.7149302"
Evaluating: 31.7149302-3.5
 Parameter: ZMIN <- "28.2149302"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.2826483"
 Parameter: XMIN -> "-34.2826483"
 Parameter: YMAX -> "21.9501389"
 Parameter: YMIN -> "14.9501389"
 Parameter: ZMAX -> "35.2149302"
 Parameter: ZMIN -> "28.2149302"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "162"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "162" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "162"
Evaluating: 162
 Parameter: J <- "162"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "162" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "162"
 Parameter: NPOS -> "117"
Evaluating: 162-117
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.727861"
Evaluating: 128.065641*(0.727861-0.5)
 Parameter: XPOS <- "29.181165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.529692417"
Evaluating: 128.065641*(0.529692417-0.5)
 Parameter: YPOS <- "3.80257842"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.313468813"
Evaluating: 108.613069*(0.313468813-0.5)+-2.187274
 Parameter: ZPOS <- "-22.4469987"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.4469987" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.181165"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.181165-0
 Parameter: XTRAN <- "29.181165"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.80257842"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.80257842-0
 Parameter: YTRAN <- "3.80257842"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.4469987"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.4469987-0
 Parameter: ZTRAN <- "-22.4469987"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.181165"
 Parameter: YTRAN -> "3.80257842"
 Parameter: ZTRAN -> "-22.4469987"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    29.181165    3.802578  -22.446999
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762268985"
Evaluating: 0.762268985*360.0
 Parameter: XPHI <- "274.416835"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131333665"
Evaluating: 0.131333665*360.0
 Parameter: YPHI <- "47.2801194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431014739"
Evaluating: 0.431014739*360.0
 Parameter: ZPHI <- "155.165306"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.181165"
 Parameter: YPOS -> "3.80257842"
 Parameter: ZPOS -> "-22.4469987"
 Parameter: XPHI -> "274.416835"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.077012   -0.997030
    0.000000    0.997030    0.077012

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   85.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.181165"
 Parameter: YPOS -> "3.80257842"
 Parameter: ZPOS -> "-22.4469987"
 Parameter: YPHI -> "47.2801194"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.678415    0.000000   -0.734679
    0.000000    1.000000    0.000000
    0.734679    0.000000    0.678415

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.181165"
 Parameter: YPOS -> "3.80257842"
 Parameter: ZPOS -> "-22.4469987"
 Parameter: ZPHI -> "155.165306"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.907523    0.420002    0.000000
   -0.420002   -0.907523    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  155.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.181165 XMAX =   29.181165 XAVE =   29.181165
    YMIN =    3.802578 YMAX =    3.802578 YAVE =    3.802578
    ZMIN =  -22.446999 ZMAX =  -22.446999 ZAVE =  -22.446999
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.181165"
Evaluating: 29.181165+3.5
 Parameter: XMAX <- "32.681165"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.80257842"
Evaluating: 3.80257842+3.5
 Parameter: YMAX <- "7.30257842"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.4469987"
Evaluating: -22.4469987+3.5
 Parameter: ZMAX <- "-18.9469987"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.181165"
Evaluating: 29.181165-3.5
 Parameter: XMIN <- "25.681165"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.80257842"
Evaluating: 3.80257842-3.5
 Parameter: YMIN <- "0.30257842"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.4469987"
Evaluating: -22.4469987-3.5
 Parameter: ZMIN <- "-25.9469987"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.681165"
 Parameter: XMIN -> "25.681165"
 Parameter: YMAX -> "7.30257842"
 Parameter: YMIN -> "0.30257842"
 Parameter: ZMAX -> "-18.9469987"
 Parameter: ZMIN -> "-25.9469987"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "163"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "163" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "163" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "117"
Evaluating: 163-117
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.543245805"
Evaluating: 128.065641*(0.543245805-0.5)
 Parameter: XPOS <- "5.53830174"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.584533191"
Evaluating: 128.065641*(0.584533191-0.5)
 Parameter: YPOS <- "10.8257973"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.612630291"
Evaluating: 108.613069*(0.612630291-0.5)+-2.187274
 Parameter: ZPOS <- "10.0458476"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.0458476" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.0458476" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "163" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "117"
Evaluating: 163-117
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.326496314"
Evaluating: 128.065641*(0.326496314-0.5)
 Parameter: XPOS <- "-22.2198608"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.996307588"
Evaluating: 128.065641*(0.996307588-0.5)
 Parameter: YPOS <- "63.5599494"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.341332019"
Evaluating: 108.613069*(0.341332019-0.5)+-2.187274
 Parameter: ZPOS <- "-19.4206904"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.4206904" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.2198608"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.2198608-0
 Parameter: XTRAN <- "-22.2198608"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "63.5599494"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 63.5599494-0
 Parameter: YTRAN <- "63.5599494"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.4206904"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.4206904-0
 Parameter: ZTRAN <- "-19.4206904"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.2198608"
 Parameter: YTRAN -> "63.5599494"
 Parameter: ZTRAN -> "-19.4206904"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.219861   63.559949  -19.420690
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950544366"
Evaluating: 0.950544366*360.0
 Parameter: XPHI <- "342.195972"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.500018525"
Evaluating: 0.500018525*360.0
 Parameter: YPHI <- "180.006669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.222856298"
Evaluating: 0.222856298*360.0
 Parameter: ZPHI <- "80.2282673"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.2198608"
 Parameter: YPOS -> "63.5599494"
 Parameter: ZPOS -> "-19.4206904"
 Parameter: XPHI -> "342.195972"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.952108   -0.305762
    0.000000    0.305762    0.952108

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.2198608"
 Parameter: YPOS -> "63.5599494"
 Parameter: ZPOS -> "-19.4206904"
 Parameter: YPHI -> "180.006669"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -1.000000    0.000000    0.000116
    0.000000    1.000000    0.000000
   -0.000116    0.000000   -1.000000

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.2198608"
 Parameter: YPOS -> "63.5599494"
 Parameter: ZPOS -> "-19.4206904"
 Parameter: ZPHI -> "80.2282673"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.169723    0.985492    0.000000
   -0.985492    0.169723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.219861 XMAX =  -22.219861 XAVE =  -22.219861
    YMIN =   63.559949 YMAX =   63.559949 YAVE =   63.559949
    ZMIN =  -19.420690 ZMAX =  -19.420690 ZAVE =  -19.420690
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.2198608"
Evaluating: -22.2198608+3.5
 Parameter: XMAX <- "-18.7198608"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "63.5599494"
Evaluating: 63.5599494+3.5
 Parameter: YMAX <- "67.0599494"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.4206904"
Evaluating: -19.4206904+3.5
 Parameter: ZMAX <- "-15.9206904"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.2198608"
Evaluating: -22.2198608-3.5
 Parameter: XMIN <- "-25.7198608"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "63.5599494"
Evaluating: 63.5599494-3.5
 Parameter: YMIN <- "60.0599494"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.4206904"
Evaluating: -19.4206904-3.5
 Parameter: ZMIN <- "-22.9206904"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.7198608"
 Parameter: XMIN -> "-25.7198608"
 Parameter: YMAX -> "67.0599494"
 Parameter: YMIN -> "60.0599494"
 Parameter: ZMAX -> "-15.9206904"
 Parameter: ZMIN -> "-22.9206904"
 SELRPN>      4 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60395 NEG      CLA      46       CLA     -**** MEMB     DMPC     359      O13           3.1082
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "163" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "117"
Evaluating: 163-117
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "7.187476472E-02"
Evaluating: 128.065641*(7.187476472E-02-0.5)
 Parameter: XPOS <- "-54.8281327"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.84038258"
Evaluating: 128.065641*(0.84038258-0.5)
 Parameter: YPOS <- "43.5913133"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.845895819"
Evaluating: 108.613069*(0.845895819-0.5)+-2.187274
 Parameter: ZPOS <- "35.3815325"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.3815325" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.3815325" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.219861 XMAX =  -22.219861 XAVE =  -22.219861
    YMIN =   63.559949 YMAX =   63.559949 YAVE =   63.559949
    ZMIN =  -19.420690 ZMAX =  -19.420690 ZAVE =  -19.420690
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.8281327"
 RDCMND substituted energy or value "?XAVE" to "-22.2198608"
Evaluating: -54.8281327--22.2198608
 Parameter: XTRAN <- "-32.6082719"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.5913133"
 RDCMND substituted energy or value "?YAVE" to "63.5599494"
Evaluating: 43.5913133-63.5599494
 Parameter: YTRAN <- "-19.9686361"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.3815325"
 RDCMND substituted energy or value "?ZAVE" to "-19.4206904"
Evaluating: 35.3815325--19.4206904
 Parameter: ZTRAN <- "54.8022229"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.6082719"
 Parameter: YTRAN -> "-19.9686361"
 Parameter: ZTRAN -> "54.8022229"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -32.608272  -19.968636   54.802223
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737803182"
Evaluating: 0.737803182*360.0
 Parameter: XPHI <- "265.609146"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.709597677"
Evaluating: 0.709597677*360.0
 Parameter: YPHI <- "255.455164"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289394095"
Evaluating: 0.289394095*360.0
 Parameter: ZPHI <- "104.181874"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.8281327"
 Parameter: YPOS -> "43.5913133"
 Parameter: ZPOS -> "35.3815325"
 Parameter: XPHI -> "265.609146"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.076560   -0.997065
    0.000000    0.997065   -0.076560

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.8281327"
 Parameter: YPOS -> "43.5913133"
 Parameter: ZPOS -> "35.3815325"
 Parameter: YPHI -> "255.455164"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.251138    0.000000    0.967951
    0.000000    1.000000    0.000000
   -0.967951    0.000000   -0.251138

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.8281327"
 Parameter: YPOS -> "43.5913133"
 Parameter: ZPOS -> "35.3815325"
 Parameter: ZPHI -> "104.181874"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.245001    0.969523    0.000000
   -0.969523   -0.245001    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.828133 XMAX =  -54.828133 XAVE =  -54.828133
    YMIN =   43.591313 YMAX =   43.591313 YAVE =   43.591313
    ZMIN =   35.381532 ZMAX =   35.381532 ZAVE =   35.381532
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.8281327"
Evaluating: -54.8281327+3.5
 Parameter: XMAX <- "-51.3281327"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.5913133"
Evaluating: 43.5913133+3.5
 Parameter: YMAX <- "47.0913133"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.3815325"
Evaluating: 35.3815325+3.5
 Parameter: ZMAX <- "38.8815325"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.8281327"
Evaluating: -54.8281327-3.5
 Parameter: XMIN <- "-58.3281327"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.5913133"
Evaluating: 43.5913133-3.5
 Parameter: YMIN <- "40.0913133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.3815325"
Evaluating: 35.3815325-3.5
 Parameter: ZMIN <- "31.8815325"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.3281327"
 Parameter: XMIN -> "-58.3281327"
 Parameter: YMAX -> "47.0913133"
 Parameter: YMIN -> "40.0913133"
 Parameter: ZMAX -> "38.8815325"
 Parameter: ZMIN -> "31.8815325"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "164"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "164" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "164"
Evaluating: 164
 Parameter: J <- "164"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "164" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "164"
 Parameter: NPOS -> "117"
Evaluating: 164-117
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.761560586E-02"
Evaluating: 128.065641*(9.761560586E-02-0.5)
 Parameter: XPOS <- "-51.5316154"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.737016015"
Evaluating: 128.065641*(0.737016015-0.5)
 Parameter: YPOS <- "30.3536079"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.309174043"
Evaluating: 108.613069*(0.309174043-0.5)+-2.187274
 Parameter: ZPOS <- "-22.9134668"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.9134668" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.5316154"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.5316154-0
 Parameter: XTRAN <- "-51.5316154"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.3536079"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.3536079-0
 Parameter: YTRAN <- "30.3536079"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.9134668"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.9134668-0
 Parameter: ZTRAN <- "-22.9134668"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.5316154"
 Parameter: YTRAN -> "30.3536079"
 Parameter: ZTRAN -> "-22.9134668"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -51.531615   30.353608  -22.913467
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262368453"
Evaluating: 0.262368453*360.0
 Parameter: XPHI <- "94.4526431"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513976584"
Evaluating: 0.513976584*360.0
 Parameter: YPHI <- "185.03157"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334722164"
Evaluating: 0.334722164*360.0
 Parameter: ZPHI <- "120.499979"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.5316154"
 Parameter: YPOS -> "30.3536079"
 Parameter: ZPOS -> "-22.9134668"
 Parameter: XPHI -> "94.4526431"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.077635    0.996982
    0.000000   -0.996982   -0.077635

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.5316154"
 Parameter: YPOS -> "30.3536079"
 Parameter: ZPOS -> "-22.9134668"
 Parameter: YPHI -> "185.03157"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.996147    0.000000    0.087705
    0.000000    1.000000    0.000000
   -0.087705    0.000000   -0.996147

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.5316154"
 Parameter: YPOS -> "30.3536079"
 Parameter: ZPOS -> "-22.9134668"
 Parameter: ZPHI -> "120.499979"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.507538    0.861629    0.000000
   -0.861629   -0.507538    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.531615 XMAX =  -51.531615 XAVE =  -51.531615
    YMIN =   30.353608 YMAX =   30.353608 YAVE =   30.353608
    ZMIN =  -22.913467 ZMAX =  -22.913467 ZAVE =  -22.913467
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.5316154"
Evaluating: -51.5316154+3.5
 Parameter: XMAX <- "-48.0316154"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.3536079"
Evaluating: 30.3536079+3.5
 Parameter: YMAX <- "33.8536079"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.9134668"
Evaluating: -22.9134668+3.5
 Parameter: ZMAX <- "-19.4134668"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.5316154"
Evaluating: -51.5316154-3.5
 Parameter: XMIN <- "-55.0316154"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.3536079"
Evaluating: 30.3536079-3.5
 Parameter: YMIN <- "26.8536079"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.9134668"
Evaluating: -22.9134668-3.5
 Parameter: ZMIN <- "-26.4134668"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.0316154"
 Parameter: XMIN -> "-55.0316154"
 Parameter: YMAX -> "33.8536079"
 Parameter: YMIN -> "26.8536079"
 Parameter: ZMAX -> "-19.4134668"
 Parameter: ZMIN -> "-26.4134668"
 SELRPN>      2 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "165"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "165" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "165"
Evaluating: 165
 Parameter: J <- "165"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "165" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "165"
 Parameter: NPOS -> "117"
Evaluating: 165-117
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.500245"
Evaluating: 128.065641*(0.500245-0.5)
 Parameter: XPOS <- "3.137608205E-02"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.635376481"
Evaluating: 128.065641*(0.635376481-0.5)
 Parameter: YPOS <- "17.3370758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.130451779"
Evaluating: 108.613069*(0.130451779-0.5)+-2.187274
 Parameter: ZPOS <- "-42.3250404"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.3250404" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.137608205E-02"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.137608205E-02-0
 Parameter: XTRAN <- "3.137608205E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.3370758"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.3370758-0
 Parameter: YTRAN <- "17.3370758"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.3250404"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.3250404-0
 Parameter: ZTRAN <- "-42.3250404"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.137608205E-02"
 Parameter: YTRAN -> "17.3370758"
 Parameter: ZTRAN -> "-42.3250404"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     0.031376   17.337076  -42.325040
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755808799"
Evaluating: 0.755808799*360.0
 Parameter: XPHI <- "272.091168"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137053817"
Evaluating: 0.137053817*360.0
 Parameter: YPHI <- "49.3393741"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.38243533"
Evaluating: 0.38243533*360.0
 Parameter: ZPHI <- "137.676719"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.137608205E-02"
 Parameter: YPOS -> "17.3370758"
 Parameter: ZPOS -> "-42.3250404"
 Parameter: XPHI -> "272.091168"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.036490   -0.999334
    0.000000    0.999334    0.036490

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.137608205E-02"
 Parameter: YPOS -> "17.3370758"
 Parameter: ZPOS -> "-42.3250404"
 Parameter: YPHI -> "49.3393741"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.651577    0.000000   -0.758582
    0.000000    1.000000    0.000000
    0.758582    0.000000    0.651577

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.137608205E-02"
 Parameter: YPOS -> "17.3370758"
 Parameter: ZPOS -> "-42.3250404"
 Parameter: ZPHI -> "137.676719"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.739358    0.673313    0.000000
   -0.673313   -0.739358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  137.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.031376 XMAX =    0.031376 XAVE =    0.031376
    YMIN =   17.337076 YMAX =   17.337076 YAVE =   17.337076
    ZMIN =  -42.325040 ZMAX =  -42.325040 ZAVE =  -42.325040
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.137608205E-02"
Evaluating: 3.137608205E-02+3.5
 Parameter: XMAX <- "3.53137608"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.3370758"
Evaluating: 17.3370758+3.5
 Parameter: YMAX <- "20.8370758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.3250404"
Evaluating: -42.3250404+3.5
 Parameter: ZMAX <- "-38.8250404"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.137608205E-02"
Evaluating: 3.137608205E-02-3.5
 Parameter: XMIN <- "-3.46862392"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.3370758"
Evaluating: 17.3370758-3.5
 Parameter: YMIN <- "13.8370758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.3250404"
Evaluating: -42.3250404-3.5
 Parameter: ZMIN <- "-45.8250404"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.53137608"
 Parameter: XMIN -> "-3.46862392"
 Parameter: YMAX -> "20.8370758"
 Parameter: YMIN -> "13.8370758"
 Parameter: ZMAX -> "-38.8250404"
 Parameter: ZMIN -> "-45.8250404"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "166"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "166" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "166"
Evaluating: 166
 Parameter: J <- "166"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "166" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "166"
 Parameter: NPOS -> "117"
Evaluating: 166-117
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.858334049E-03"
Evaluating: 128.065641*(6.858334049E-03-0.5)
 Parameter: XPOS <- "-63.1545036"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.766904308"
Evaluating: 128.065641*(0.766904308-0.5)
 Parameter: YPOS <- "34.1812713"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.431976922"
Evaluating: 108.613069*(0.431976922-0.5)+-2.187274
 Parameter: ZPOS <- "-9.57546926"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.57546926" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.57546926" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "166"
Evaluating: 166
 Parameter: J <- "166"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "166" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "166"
 Parameter: NPOS -> "117"
Evaluating: 166-117
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.473640884"
Evaluating: 128.065641*(0.473640884-0.5)
 Parameter: XPOS <- "-3.37569709"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.774534583"
Evaluating: 128.065641*(0.774534583-0.5)
 Parameter: YPOS <- "35.1584473"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.954785191"
Evaluating: 108.613069*(0.954785191-0.5)+-2.187274
 Parameter: ZPOS <- "47.2083413"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.2083413" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.2083413" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.37569709"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.37569709-0
 Parameter: XTRAN <- "-3.37569709"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.1584473"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.1584473-0
 Parameter: YTRAN <- "35.1584473"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.2083413"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.2083413-0
 Parameter: ZTRAN <- "47.2083413"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.37569709"
 Parameter: YTRAN -> "35.1584473"
 Parameter: ZTRAN -> "47.2083413"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -3.375697   35.158447   47.208341
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.730202308"
Evaluating: 0.730202308*360.0
 Parameter: XPHI <- "262.872831"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821884425"
Evaluating: 0.821884425*360.0
 Parameter: YPHI <- "295.878393"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882378256"
Evaluating: 0.882378256*360.0
 Parameter: ZPHI <- "317.656172"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.37569709"
 Parameter: YPOS -> "35.1584473"
 Parameter: ZPOS -> "47.2083413"
 Parameter: XPHI -> "262.872831"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.124072   -0.992273
    0.000000    0.992273   -0.124072

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   97.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.37569709"
 Parameter: YPOS -> "35.1584473"
 Parameter: ZPOS -> "47.2083413"
 Parameter: YPHI -> "295.878393"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.436463    0.000000    0.899722
    0.000000    1.000000    0.000000
   -0.899722    0.000000    0.436463

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.37569709"
 Parameter: YPOS -> "35.1584473"
 Parameter: ZPOS -> "47.2083413"
 Parameter: ZPHI -> "317.656172"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.739116   -0.673578    0.000000
    0.673578    0.739116    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.375697 XMAX =   -3.375697 XAVE =   -3.375697
    YMIN =   35.158447 YMAX =   35.158447 YAVE =   35.158447
    ZMIN =   47.208341 ZMAX =   47.208341 ZAVE =   47.208341
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.37569709"
Evaluating: -3.37569709+3.5
 Parameter: XMAX <- "0.12430291"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.1584473"
Evaluating: 35.1584473+3.5
 Parameter: YMAX <- "38.6584473"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.2083413"
Evaluating: 47.2083413+3.5
 Parameter: ZMAX <- "50.7083413"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.37569709"
Evaluating: -3.37569709-3.5
 Parameter: XMIN <- "-6.87569709"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.1584473"
Evaluating: 35.1584473-3.5
 Parameter: YMIN <- "31.6584473"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.2083413"
Evaluating: 47.2083413-3.5
 Parameter: ZMIN <- "43.7083413"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.12430291"
 Parameter: XMIN -> "-6.87569709"
 Parameter: YMAX -> "38.6584473"
 Parameter: YMIN -> "31.6584473"
 Parameter: ZMAX -> "50.7083413"
 Parameter: ZMIN -> "43.7083413"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "167"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "167" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "167" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "117"
Evaluating: 167-117
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.818678649"
Evaluating: 128.065641*(0.818678649-0.5)
 Parameter: XPOS <- "40.8117855"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.340604442"
Evaluating: 128.065641*(0.340604442-0.5)
 Parameter: YPOS <- "-20.4130943"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.619107232"
Evaluating: 108.613069*(0.619107232-0.5)+-2.187274
 Parameter: ZPOS <- "10.749328"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.749328" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.749328" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "167" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "117"
Evaluating: 167-117
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.291298899"
Evaluating: 128.065641*(0.291298899-0.5)
 Parameter: XPOS <- "-26.7274403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.498822838"
Evaluating: 128.065641*(0.498822838-0.5)
 Parameter: YPOS <- "-0.150754006"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.467551514"
Evaluating: 108.613069*(0.467551514-0.5)+-2.187274
 Parameter: ZPOS <- "-5.71160365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.71160365" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.71160365" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "167" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "117"
Evaluating: 167-117
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.780658824"
Evaluating: 128.065641*(0.780658824-0.5)
 Parameter: XPOS <- "35.9427522"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.76099256"
Evaluating: 128.065641*(0.76099256-0.5)
 Parameter: YPOS <- "33.4241795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.615066725"
Evaluating: 108.613069*(0.615066725-0.5)+-2.187274
 Parameter: ZPOS <- "10.3104761"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.3104761" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.3104761" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "167" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "117"
Evaluating: 167-117
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.231999639"
Evaluating: 128.065641*(0.231999639-0.5)
 Parameter: XPOS <- "-34.321638"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.153813061"
Evaluating: 128.065641*(0.153813061-0.5)
 Parameter: YPOS <- "-44.3346522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.306896912"
Evaluating: 108.613069*(0.306896912-0.5)+-2.187274
 Parameter: ZPOS <- "-23.160793"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.160793" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.321638"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.321638-0
 Parameter: XTRAN <- "-34.321638"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.3346522"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.3346522-0
 Parameter: YTRAN <- "-44.3346522"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.160793"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.160793-0
 Parameter: ZTRAN <- "-23.160793"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.321638"
 Parameter: YTRAN -> "-44.3346522"
 Parameter: ZTRAN -> "-23.160793"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -34.321638  -44.334652  -23.160793
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.927628074E-02"
Evaluating: 6.927628074E-02*360.0
 Parameter: XPHI <- "24.9394611"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.134705676"
Evaluating: 0.134705676*360.0
 Parameter: YPHI <- "48.4940434"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815863628"
Evaluating: 0.815863628*360.0
 Parameter: ZPHI <- "293.710906"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.321638"
 Parameter: YPOS -> "-44.3346522"
 Parameter: ZPOS -> "-23.160793"
 Parameter: XPHI -> "24.9394611"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.906754    0.421660
    0.000000   -0.421660    0.906754

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.321638"
 Parameter: YPOS -> "-44.3346522"
 Parameter: ZPOS -> "-23.160793"
 Parameter: YPHI -> "48.4940434"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.662698    0.000000   -0.748887
    0.000000    1.000000    0.000000
    0.748887    0.000000    0.662698

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   48.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.321638"
 Parameter: YPOS -> "-44.3346522"
 Parameter: ZPOS -> "-23.160793"
 Parameter: ZPHI -> "293.710906"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.402122   -0.915586    0.000000
    0.915586    0.402122    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.321638 XMAX =  -34.321638 XAVE =  -34.321638
    YMIN =  -44.334652 YMAX =  -44.334652 YAVE =  -44.334652
    ZMIN =  -23.160793 ZMAX =  -23.160793 ZAVE =  -23.160793
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.321638"
Evaluating: -34.321638+3.5
 Parameter: XMAX <- "-30.821638"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.3346522"
Evaluating: -44.3346522+3.5
 Parameter: YMAX <- "-40.8346522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.160793"
Evaluating: -23.160793+3.5
 Parameter: ZMAX <- "-19.660793"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.321638"
Evaluating: -34.321638-3.5
 Parameter: XMIN <- "-37.821638"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.3346522"
Evaluating: -44.3346522-3.5
 Parameter: YMIN <- "-47.8346522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.160793"
Evaluating: -23.160793-3.5
 Parameter: ZMIN <- "-26.660793"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.821638"
 Parameter: XMIN -> "-37.821638"
 Parameter: YMAX -> "-40.8346522"
 Parameter: YMIN -> "-47.8346522"
 Parameter: ZMAX -> "-19.660793"
 Parameter: ZMIN -> "-26.660793"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "168"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "168" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "168" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "117"
Evaluating: 168-117
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.633510212E-02"
Evaluating: 128.065641*(9.633510212E-02-0.5)
 Parameter: XPOS <- "-51.6956039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.958247628E-02"
Evaluating: 128.065641*(4.958247628E-02-0.5)
 Parameter: YPOS <- "-57.6830089"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.519088242"
Evaluating: 108.613069*(0.519088242-0.5)+-2.187274
 Parameter: ZPOS <- "-0.114041455"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.114041455" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.114041455" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "168" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "117"
Evaluating: 168-117
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.498401644E-02"
Evaluating: 128.065641*(6.498401644E-02-0.5)
 Parameter: XPOS <- "-55.7106008"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.276700984"
Evaluating: 128.065641*(0.276700984-0.5)
 Parameter: YPOS <- "-28.5969316"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.651814832"
Evaluating: 108.613069*(0.651814832-0.5)+-2.187274
 Parameter: ZPOS <- "14.3018008"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.3018008" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.3018008" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "168" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "117"
Evaluating: 168-117
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.503024202"
Evaluating: 128.065641*(0.503024202-0.5)
 Parameter: XPOS <- "0.387296368"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.494532892"
Evaluating: 128.065641*(0.494532892-0.5)
 Parameter: YPOS <- "-0.70014869"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.304926549"
Evaluating: 108.613069*(0.304926549-0.5)+-2.187274
 Parameter: ZPOS <- "-23.3748002"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.3748002" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.387296368"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.387296368-0
 Parameter: XTRAN <- "0.387296368"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.70014869"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.70014869-0
 Parameter: YTRAN <- "-0.70014869"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.3748002"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.3748002-0
 Parameter: ZTRAN <- "-23.3748002"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.387296368"
 Parameter: YTRAN -> "-0.70014869"
 Parameter: ZTRAN -> "-23.3748002"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     0.387296   -0.700149  -23.374800
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.967679108E-02"
Evaluating: 7.967679108E-02*360.0
 Parameter: XPHI <- "28.6836448"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537907711"
Evaluating: 0.537907711*360.0
 Parameter: YPHI <- "193.646776"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591809092"
Evaluating: 0.591809092*360.0
 Parameter: ZPHI <- "213.051273"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.387296368"
 Parameter: YPOS -> "-0.70014869"
 Parameter: ZPOS -> "-23.3748002"
 Parameter: XPHI -> "28.6836448"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.877283    0.479973
    0.000000   -0.479973    0.877283

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.387296368"
 Parameter: YPOS -> "-0.70014869"
 Parameter: ZPOS -> "-23.3748002"
 Parameter: YPHI -> "193.646776"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.971769    0.000000    0.235936
    0.000000    1.000000    0.000000
   -0.235936    0.000000   -0.971769

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.387296368"
 Parameter: YPOS -> "-0.70014869"
 Parameter: ZPOS -> "-23.3748002"
 Parameter: ZPHI -> "213.051273"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.838183   -0.545389    0.000000
    0.545389   -0.838183    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.387296 XMAX =    0.387296 XAVE =    0.387296
    YMIN =   -0.700149 YMAX =   -0.700149 YAVE =   -0.700149
    ZMIN =  -23.374800 ZMAX =  -23.374800 ZAVE =  -23.374800
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.387296368"
Evaluating: 0.387296368+3.5
 Parameter: XMAX <- "3.88729637"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.70014869"
Evaluating: -0.70014869+3.5
 Parameter: YMAX <- "2.79985131"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.3748002"
Evaluating: -23.3748002+3.5
 Parameter: ZMAX <- "-19.8748002"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.387296368"
Evaluating: 0.387296368-3.5
 Parameter: XMIN <- "-3.11270363"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.70014869"
Evaluating: -0.70014869-3.5
 Parameter: YMIN <- "-4.20014869"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.3748002"
Evaluating: -23.3748002-3.5
 Parameter: ZMIN <- "-26.8748002"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.88729637"
 Parameter: XMIN -> "-3.11270363"
 Parameter: YMAX -> "2.79985131"
 Parameter: YMIN -> "-4.20014869"
 Parameter: ZMAX -> "-19.8748002"
 Parameter: ZMIN -> "-26.8748002"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "169"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "169" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "169"
Evaluating: 169
 Parameter: J <- "169"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "169" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "169"
 Parameter: NPOS -> "117"
Evaluating: 169-117
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.589018717"
Evaluating: 128.065641*(0.589018717-0.5)
 Parameter: XPOS <- "11.4002391"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.952040033"
Evaluating: 128.065641*(0.952040033-0.5)
 Parameter: YPOS <- "57.8907966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.949417246"
Evaluating: 108.613069*(0.949417246-0.5)+-2.187274
 Parameter: ZPOS <- "46.6253123"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.6253123" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.6253123" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.4002391"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.4002391-0
 Parameter: XTRAN <- "11.4002391"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.8907966"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.8907966-0
 Parameter: YTRAN <- "57.8907966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.6253123"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.6253123-0
 Parameter: ZTRAN <- "46.6253123"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.4002391"
 Parameter: YTRAN -> "57.8907966"
 Parameter: ZTRAN -> "46.6253123"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    11.400239   57.890797   46.625312
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587189508"
Evaluating: 0.587189508*360.0
 Parameter: XPHI <- "211.388223"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376266981"
Evaluating: 0.376266981*360.0
 Parameter: YPHI <- "135.456113"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369522093"
Evaluating: 0.369522093*360.0
 Parameter: ZPHI <- "133.027953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.4002391"
 Parameter: YPOS -> "57.8907966"
 Parameter: ZPOS -> "46.6253123"
 Parameter: XPHI -> "211.388223"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.853658   -0.520834
    0.000000    0.520834   -0.853658

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  148.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.4002391"
 Parameter: YPOS -> "57.8907966"
 Parameter: ZPOS -> "46.6253123"
 Parameter: YPHI -> "135.456113"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.712713    0.000000   -0.701455
    0.000000    1.000000    0.000000
    0.701455    0.000000   -0.712713

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  135.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.4002391"
 Parameter: YPOS -> "57.8907966"
 Parameter: ZPOS -> "46.6253123"
 Parameter: ZPHI -> "133.027953"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.682355    0.731021    0.000000
   -0.731021   -0.682355    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  133.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.400239 XMAX =   11.400239 XAVE =   11.400239
    YMIN =   57.890797 YMAX =   57.890797 YAVE =   57.890797
    ZMIN =   46.625312 ZMAX =   46.625312 ZAVE =   46.625312
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.4002391"
Evaluating: 11.4002391+3.5
 Parameter: XMAX <- "14.9002391"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.8907966"
Evaluating: 57.8907966+3.5
 Parameter: YMAX <- "61.3907966"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.6253123"
Evaluating: 46.6253123+3.5
 Parameter: ZMAX <- "50.1253123"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.4002391"
Evaluating: 11.4002391-3.5
 Parameter: XMIN <- "7.9002391"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.8907966"
Evaluating: 57.8907966-3.5
 Parameter: YMIN <- "54.3907966"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.6253123"
Evaluating: 46.6253123-3.5
 Parameter: ZMIN <- "43.1253123"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.9002391"
 Parameter: XMIN -> "7.9002391"
 Parameter: YMAX -> "61.3907966"
 Parameter: YMIN -> "54.3907966"
 Parameter: ZMAX -> "50.1253123"
 Parameter: ZMIN -> "43.1253123"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "170"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "170" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "170" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "117"
Evaluating: 170-117
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.355203636"
Evaluating: 128.065641*(0.355203636-0.5)
 Parameter: XPOS <- "-18.5434392"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.176942509"
Evaluating: 128.065641*(0.176942509-0.5)
 Parameter: YPOS <- "-41.3725647"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.50254361"
Evaluating: 108.613069*(0.50254361-0.5)+-2.187274
 Parameter: ZPOS <- "-1.91100471"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.91100471" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.91100471" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "170" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "117"
Evaluating: 170-117
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.978548717"
Evaluating: 128.065641*(0.978548717-0.5)
 Parameter: XPOS <- "61.2856482"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.845919897"
Evaluating: 128.065641*(0.845919897-0.5)
 Parameter: YPOS <- "44.3004533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.71883069"
Evaluating: 108.613069*(0.71883069-0.5)+-2.187274
 Parameter: ZPOS <- "21.5805988"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.5805988" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.5805988" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.2856482"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.2856482-0
 Parameter: XTRAN <- "61.2856482"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.3004533"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.3004533-0
 Parameter: YTRAN <- "44.3004533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.5805988"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.5805988-0
 Parameter: ZTRAN <- "21.5805988"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.2856482"
 Parameter: YTRAN -> "44.3004533"
 Parameter: ZTRAN -> "21.5805988"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    61.285648   44.300453   21.580599
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310892569"
Evaluating: 0.310892569*360.0
 Parameter: XPHI <- "111.921325"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386899122"
Evaluating: 0.386899122*360.0
 Parameter: YPHI <- "139.283684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873202155"
Evaluating: 0.873202155*360.0
 Parameter: ZPHI <- "314.352776"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.2856482"
 Parameter: YPOS -> "44.3004533"
 Parameter: ZPOS -> "21.5805988"
 Parameter: XPHI -> "111.921325"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.373333    0.927697
    0.000000   -0.927697   -0.373333

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.2856482"
 Parameter: YPOS -> "44.3004533"
 Parameter: ZPOS -> "21.5805988"
 Parameter: YPHI -> "139.283684"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.757949    0.000000   -0.652314
    0.000000    1.000000    0.000000
    0.652314    0.000000   -0.757949

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.2856482"
 Parameter: YPOS -> "44.3004533"
 Parameter: ZPOS -> "21.5805988"
 Parameter: ZPHI -> "314.352776"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.699074   -0.715049    0.000000
    0.715049    0.699074    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.285648 XMAX =   61.285648 XAVE =   61.285648
    YMIN =   44.300453 YMAX =   44.300453 YAVE =   44.300453
    ZMIN =   21.580599 ZMAX =   21.580599 ZAVE =   21.580599
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.2856482"
Evaluating: 61.2856482+3.5
 Parameter: XMAX <- "64.7856482"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.3004533"
Evaluating: 44.3004533+3.5
 Parameter: YMAX <- "47.8004533"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.5805988"
Evaluating: 21.5805988+3.5
 Parameter: ZMAX <- "25.0805988"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.2856482"
Evaluating: 61.2856482-3.5
 Parameter: XMIN <- "57.7856482"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.3004533"
Evaluating: 44.3004533-3.5
 Parameter: YMIN <- "40.8004533"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.5805988"
Evaluating: 21.5805988-3.5
 Parameter: ZMIN <- "18.0805988"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.7856482"
 Parameter: XMIN -> "57.7856482"
 Parameter: YMAX -> "47.8004533"
 Parameter: YMIN -> "40.8004533"
 Parameter: ZMAX -> "25.0805988"
 Parameter: ZMIN -> "18.0805988"
 SELRPN>      6 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      3 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60402 NEG      CLA      53       CLA     -**** MEMB     DMPC     112      C14           3.9201
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "170" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "117"
Evaluating: 170-117
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.305339542E-02"
Evaluating: 128.065641*(8.305339542E-02-0.5)
 Parameter: XPOS <- "-53.3965342"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.429294822"
Evaluating: 128.065641*(0.429294822-0.5)
 Parameter: YPOS <- "-9.05490394"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.62151489"
Evaluating: 108.613069*(0.62151489-0.5)+-2.187274
 Parameter: ZPOS <- "11.0108311"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.0108311" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.0108311" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "170" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "117"
Evaluating: 170-117
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.366884636"
Evaluating: 128.065641*(0.366884636-0.5)
 Parameter: XPOS <- "-17.0475044"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.605432724"
Evaluating: 128.065641*(0.605432724-0.5)
 Parameter: YPOS <- "13.5023094"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.253451341"
Evaluating: 108.613069*(0.253451341-0.5)+-2.187274
 Parameter: ZPOS <- "-28.9656805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.9656805" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.285648 XMAX =   61.285648 XAVE =   61.285648
    YMIN =   44.300453 YMAX =   44.300453 YAVE =   44.300453
    ZMIN =   21.580599 ZMAX =   21.580599 ZAVE =   21.580599
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.0475044"
 RDCMND substituted energy or value "?XAVE" to "61.2856482"
Evaluating: -17.0475044-61.2856482
 Parameter: XTRAN <- "-78.3331526"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.5023094"
 RDCMND substituted energy or value "?YAVE" to "44.3004533"
Evaluating: 13.5023094-44.3004533
 Parameter: YTRAN <- "-30.7981439"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.9656805"
 RDCMND substituted energy or value "?ZAVE" to "21.5805988"
Evaluating: -28.9656805-21.5805988
 Parameter: ZTRAN <- "-50.5462793"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-78.3331526"
 Parameter: YTRAN -> "-30.7981439"
 Parameter: ZTRAN -> "-50.5462793"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -78.333153  -30.798144  -50.546279
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175202709"
Evaluating: 0.175202709*360.0
 Parameter: XPHI <- "63.0729752"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.40010232"
Evaluating: 0.40010232*360.0
 Parameter: YPHI <- "144.036835"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.385869941"
Evaluating: 0.385869941*360.0
 Parameter: ZPHI <- "138.913179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.0475044"
 Parameter: YPOS -> "13.5023094"
 Parameter: ZPOS -> "-28.9656805"
 Parameter: XPHI -> "63.0729752"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.452855    0.891584
    0.000000   -0.891584    0.452855

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.0475044"
 Parameter: YPOS -> "13.5023094"
 Parameter: ZPOS -> "-28.9656805"
 Parameter: YPHI -> "144.036835"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.809395    0.000000   -0.587265
    0.000000    1.000000    0.000000
    0.587265    0.000000   -0.809395

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.0475044"
 Parameter: YPOS -> "13.5023094"
 Parameter: ZPOS -> "-28.9656805"
 Parameter: ZPHI -> "138.913179"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.753715    0.657202    0.000000
   -0.657202   -0.753715    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.047504 XMAX =  -17.047504 XAVE =  -17.047504
    YMIN =   13.502309 YMAX =   13.502309 YAVE =   13.502309
    ZMIN =  -28.965681 ZMAX =  -28.965681 ZAVE =  -28.965681
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.0475044"
Evaluating: -17.0475044+3.5
 Parameter: XMAX <- "-13.5475044"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.5023094"
Evaluating: 13.5023094+3.5
 Parameter: YMAX <- "17.0023094"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.9656805"
Evaluating: -28.9656805+3.5
 Parameter: ZMAX <- "-25.4656805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.0475044"
Evaluating: -17.0475044-3.5
 Parameter: XMIN <- "-20.5475044"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.5023094"
Evaluating: 13.5023094-3.5
 Parameter: YMIN <- "10.0023094"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.9656805"
Evaluating: -28.9656805-3.5
 Parameter: ZMIN <- "-32.4656805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.5475044"
 Parameter: XMIN -> "-20.5475044"
 Parameter: YMAX -> "17.0023094"
 Parameter: YMIN -> "10.0023094"
 Parameter: ZMAX -> "-25.4656805"
 Parameter: ZMIN -> "-32.4656805"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "171"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "171" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "171" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "117"
Evaluating: 171-117
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.609835754"
Evaluating: 128.065641*(0.609835754-0.5)
 Parameter: XPOS <- "14.0661862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.862501886"
Evaluating: 128.065641*(0.862501886-0.5)
 Parameter: YPOS <- "46.4240364"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "2.192383162E-02"
Evaluating: 108.613069*(2.192383162E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-54.1125939"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.1125939" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.0661862"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.0661862-0
 Parameter: XTRAN <- "14.0661862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.4240364"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.4240364-0
 Parameter: YTRAN <- "46.4240364"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.1125939"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.1125939-0
 Parameter: ZTRAN <- "-54.1125939"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0661862"
 Parameter: YTRAN -> "46.4240364"
 Parameter: ZTRAN -> "-54.1125939"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    14.066186   46.424036  -54.112594
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938578858"
Evaluating: 0.938578858*360.0
 Parameter: XPHI <- "337.888389"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898647498"
Evaluating: 0.898647498*360.0
 Parameter: YPHI <- "323.513099"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355996228"
Evaluating: 0.355996228*360.0
 Parameter: ZPHI <- "128.158642"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.0661862"
 Parameter: YPOS -> "46.4240364"
 Parameter: ZPOS -> "-54.1125939"
 Parameter: XPHI -> "337.888389"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.926452   -0.376412
    0.000000    0.376412    0.926452

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   22.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.0661862"
 Parameter: YPOS -> "46.4240364"
 Parameter: ZPOS -> "-54.1125939"
 Parameter: YPHI -> "323.513099"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.803993    0.000000    0.594639
    0.000000    1.000000    0.000000
   -0.594639    0.000000    0.803993

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   36.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.0661862"
 Parameter: YPOS -> "46.4240364"
 Parameter: ZPOS -> "-54.1125939"
 Parameter: ZPHI -> "128.158642"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.617841    0.786303    0.000000
   -0.786303   -0.617841    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  128.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.066186 XMAX =   14.066186 XAVE =   14.066186
    YMIN =   46.424036 YMAX =   46.424036 YAVE =   46.424036
    ZMIN =  -54.112594 ZMAX =  -54.112594 ZAVE =  -54.112594
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.0661862"
Evaluating: 14.0661862+3.5
 Parameter: XMAX <- "17.5661862"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.4240364"
Evaluating: 46.4240364+3.5
 Parameter: YMAX <- "49.9240364"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.1125939"
Evaluating: -54.1125939+3.5
 Parameter: ZMAX <- "-50.6125939"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.0661862"
Evaluating: 14.0661862-3.5
 Parameter: XMIN <- "10.5661862"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.4240364"
Evaluating: 46.4240364-3.5
 Parameter: YMIN <- "42.9240364"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.1125939"
Evaluating: -54.1125939-3.5
 Parameter: ZMIN <- "-57.6125939"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.5661862"
 Parameter: XMIN -> "10.5661862"
 Parameter: YMAX -> "49.9240364"
 Parameter: YMIN -> "42.9240364"
 Parameter: ZMAX -> "-50.6125939"
 Parameter: ZMIN -> "-57.6125939"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "172"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "172" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "172"
Evaluating: 172
 Parameter: J <- "172"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "172" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "172"
 Parameter: NPOS -> "117"
Evaluating: 172-117
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.497358656"
Evaluating: 128.065641*(0.497358656-0.5)
 Parameter: XPOS <- "-0.338265412"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.916027323E-02"
Evaluating: 128.065641*(8.916027323E-02-0.5)
 Parameter: YPOS <- "-52.614453"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.766272649"
Evaluating: 108.613069*(0.766272649-0.5)+-2.187274
 Parameter: ZPOS <- "26.7334156"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.7334156" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.7334156" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.338265412"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.338265412-0
 Parameter: XTRAN <- "-0.338265412"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.614453"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.614453-0
 Parameter: YTRAN <- "-52.614453"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.7334156"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.7334156-0
 Parameter: ZTRAN <- "26.7334156"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.338265412"
 Parameter: YTRAN -> "-52.614453"
 Parameter: ZTRAN -> "26.7334156"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -0.338265  -52.614453   26.733416
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67199604"
Evaluating: 0.67199604*360.0
 Parameter: XPHI <- "241.918574"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.128141657"
Evaluating: 0.128141657*360.0
 Parameter: YPHI <- "46.1309965"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777774091"
Evaluating: 0.777774091*360.0
 Parameter: ZPHI <- "279.998673"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.338265412"
 Parameter: YPOS -> "-52.614453"
 Parameter: ZPOS -> "26.7334156"
 Parameter: XPHI -> "241.918574"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.470726   -0.882280
    0.000000    0.882280   -0.470726

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.338265412"
 Parameter: YPOS -> "-52.614453"
 Parameter: ZPOS -> "26.7334156"
 Parameter: YPHI -> "46.1309965"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.693012    0.000000   -0.720926
    0.000000    1.000000    0.000000
    0.720926    0.000000    0.693012

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   46.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.338265412"
 Parameter: YPOS -> "-52.614453"
 Parameter: ZPOS -> "26.7334156"
 Parameter: ZPHI -> "279.998673"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.173625   -0.984812    0.000000
    0.984812    0.173625    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.338265 XMAX =   -0.338265 XAVE =   -0.338265
    YMIN =  -52.614453 YMAX =  -52.614453 YAVE =  -52.614453
    ZMIN =   26.733416 ZMAX =   26.733416 ZAVE =   26.733416
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.338265412"
Evaluating: -0.338265412+3.5
 Parameter: XMAX <- "3.16173459"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.614453"
Evaluating: -52.614453+3.5
 Parameter: YMAX <- "-49.114453"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.7334156"
Evaluating: 26.7334156+3.5
 Parameter: ZMAX <- "30.2334156"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.338265412"
Evaluating: -0.338265412-3.5
 Parameter: XMIN <- "-3.83826541"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.614453"
Evaluating: -52.614453-3.5
 Parameter: YMIN <- "-56.114453"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.7334156"
Evaluating: 26.7334156-3.5
 Parameter: ZMIN <- "23.2334156"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.16173459"
 Parameter: XMIN -> "-3.83826541"
 Parameter: YMAX -> "-49.114453"
 Parameter: YMIN -> "-56.114453"
 Parameter: ZMAX -> "30.2334156"
 Parameter: ZMIN -> "23.2334156"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "173"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "173" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "173"
Evaluating: 173
 Parameter: J <- "173"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "173" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "173"
 Parameter: NPOS -> "117"
Evaluating: 173-117
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "4.002990548E-02"
Evaluating: 128.065641*(4.002990548E-02-0.5)
 Parameter: XPOS <- "-58.906365"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.287562319"
Evaluating: 128.065641*(0.287562319-0.5)
 Parameter: YPOS <- "-27.2059678"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "8.424410085E-02"
Evaluating: 108.613069*(8.424410085E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-47.3437982"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.3437982" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.906365"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -58.906365-0
 Parameter: XTRAN <- "-58.906365"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.2059678"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.2059678-0
 Parameter: YTRAN <- "-27.2059678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.3437982"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.3437982-0
 Parameter: ZTRAN <- "-47.3437982"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.906365"
 Parameter: YTRAN -> "-27.2059678"
 Parameter: ZTRAN -> "-47.3437982"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -58.906365  -27.205968  -47.343798
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977077975"
Evaluating: 0.977077975*360.0
 Parameter: XPHI <- "351.748071"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.728958631"
Evaluating: 0.728958631*360.0
 Parameter: YPHI <- "262.425107"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671462197"
Evaluating: 0.671462197*360.0
 Parameter: ZPHI <- "241.726391"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.906365"
 Parameter: YPOS -> "-27.2059678"
 Parameter: ZPOS -> "-47.3437982"
 Parameter: XPHI -> "351.748071"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.989647   -0.143526
    0.000000    0.143526    0.989647

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.906365"
 Parameter: YPOS -> "-27.2059678"
 Parameter: ZPOS -> "-47.3437982"
 Parameter: YPHI -> "262.425107"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.131822    0.000000    0.991273
    0.000000    1.000000    0.000000
   -0.991273    0.000000   -0.131822

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   97.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.906365"
 Parameter: YPOS -> "-27.2059678"
 Parameter: ZPOS -> "-47.3437982"
 Parameter: ZPHI -> "241.726391"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.473683   -0.880696    0.000000
    0.880696   -0.473683    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.906365 XMAX =  -58.906365 XAVE =  -58.906365
    YMIN =  -27.205968 YMAX =  -27.205968 YAVE =  -27.205968
    ZMIN =  -47.343798 ZMAX =  -47.343798 ZAVE =  -47.343798
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.906365"
Evaluating: -58.906365+3.5
 Parameter: XMAX <- "-55.406365"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.2059678"
Evaluating: -27.2059678+3.5
 Parameter: YMAX <- "-23.7059678"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.3437982"
Evaluating: -47.3437982+3.5
 Parameter: ZMAX <- "-43.8437982"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.906365"
Evaluating: -58.906365-3.5
 Parameter: XMIN <- "-62.406365"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.2059678"
Evaluating: -27.2059678-3.5
 Parameter: YMIN <- "-30.7059678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.3437982"
Evaluating: -47.3437982-3.5
 Parameter: ZMIN <- "-50.8437982"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.406365"
 Parameter: XMIN -> "-62.406365"
 Parameter: YMAX -> "-23.7059678"
 Parameter: YMIN -> "-30.7059678"
 Parameter: ZMAX -> "-43.8437982"
 Parameter: ZMIN -> "-50.8437982"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "174"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "174" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "174" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "117"
Evaluating: 174-117
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.794974812E-03"
Evaluating: 128.065641*(5.794974812E-03-0.5)
 Parameter: XPOS <- "-63.2906833"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.51861842"
Evaluating: 128.065641*(0.51861842-0.5)
 Parameter: YPOS <- "2.38437989"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.401368147"
Evaluating: 108.613069*(0.401368147-0.5)+-2.187274
 Parameter: ZPOS <- "-12.8999823"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.8999823" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.8999823" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "174" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "117"
Evaluating: 174-117
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.302303148"
Evaluating: 128.065641*(0.302303148-0.5)
 Parameter: XPOS <- "-25.3181741"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.915108843E-02"
Evaluating: 128.065641*(6.915108843E-02-0.5)
 Parameter: YPOS <- "-55.176942"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.490092458"
Evaluating: 108.613069*(0.490092458-0.5)+-2.187274
 Parameter: ZPOS <- "-3.26336254"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.26336254" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.26336254" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "174" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "117"
Evaluating: 174-117
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.391902928"
Evaluating: 128.065641*(0.391902928-0.5)
 Parameter: XPOS <- "-13.8435208"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.383724701"
Evaluating: 128.065641*(0.383724701-0.5)
 Parameter: YPOS <- "-14.8908707"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.13884486E-02"
Evaluating: 108.613069*(3.13884486E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-53.0846128"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.0846128" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8435208"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.8435208-0
 Parameter: XTRAN <- "-13.8435208"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.8908707"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.8908707-0
 Parameter: YTRAN <- "-14.8908707"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.0846128"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.0846128-0
 Parameter: ZTRAN <- "-53.0846128"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.8435208"
 Parameter: YTRAN -> "-14.8908707"
 Parameter: ZTRAN -> "-53.0846128"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -13.843521  -14.890871  -53.084613
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481949469"
Evaluating: 0.481949469*360.0
 Parameter: XPHI <- "173.501809"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.86591168"
Evaluating: 0.86591168*360.0
 Parameter: YPHI <- "311.728205"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277878057"
Evaluating: 0.277878057*360.0
 Parameter: ZPHI <- "100.036101"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8435208"
 Parameter: YPOS -> "-14.8908707"
 Parameter: ZPOS -> "-53.0846128"
 Parameter: XPHI -> "173.501809"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993575    0.113172
    0.000000   -0.113172   -0.993575

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8435208"
 Parameter: YPOS -> "-14.8908707"
 Parameter: ZPOS -> "-53.0846128"
 Parameter: YPHI -> "311.728205"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.665598    0.000000    0.746311
    0.000000    1.000000    0.000000
   -0.746311    0.000000    0.665598

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8435208"
 Parameter: YPOS -> "-14.8908707"
 Parameter: ZPOS -> "-53.0846128"
 Parameter: ZPHI -> "100.036101"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.174269    0.984698    0.000000
   -0.984698   -0.174269    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  100.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.843521 XMAX =  -13.843521 XAVE =  -13.843521
    YMIN =  -14.890871 YMAX =  -14.890871 YAVE =  -14.890871
    ZMIN =  -53.084613 ZMAX =  -53.084613 ZAVE =  -53.084613
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8435208"
Evaluating: -13.8435208+3.5
 Parameter: XMAX <- "-10.3435208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.8908707"
Evaluating: -14.8908707+3.5
 Parameter: YMAX <- "-11.3908707"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.0846128"
Evaluating: -53.0846128+3.5
 Parameter: ZMAX <- "-49.5846128"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8435208"
Evaluating: -13.8435208-3.5
 Parameter: XMIN <- "-17.3435208"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.8908707"
Evaluating: -14.8908707-3.5
 Parameter: YMIN <- "-18.3908707"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.0846128"
Evaluating: -53.0846128-3.5
 Parameter: ZMIN <- "-56.5846128"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3435208"
 Parameter: XMIN -> "-17.3435208"
 Parameter: YMAX -> "-11.3908707"
 Parameter: YMIN -> "-18.3908707"
 Parameter: ZMAX -> "-49.5846128"
 Parameter: ZMIN -> "-56.5846128"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "175"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "175" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "175"
Evaluating: 175
 Parameter: J <- "175"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "175" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "175"
 Parameter: NPOS -> "117"
Evaluating: 175-117
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.894973443"
Evaluating: 128.065641*(0.894973443-0.5)
 Parameter: XPOS <- "50.5825272"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "1.224574356E-02"
Evaluating: 128.065641*(1.224574356E-02-0.5)
 Parameter: YPOS <- "-62.4645615"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.656817684"
Evaluating: 108.613069*(0.656817684-0.5)+-2.187274
 Parameter: ZPOS <- "14.8451759"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.8451759" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.8451759" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "175"
Evaluating: 175
 Parameter: J <- "175"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "175" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "175"
 Parameter: NPOS -> "117"
Evaluating: 175-117
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.902189626"
Evaluating: 128.065641*(0.902189626-0.5)
 Parameter: XPOS <- "51.5066723"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.396839218"
Evaluating: 128.065641*(0.396839218-0.5)
 Parameter: YPOS <- "-13.2113517"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.358386474"
Evaluating: 108.613069*(0.358386474-0.5)+-2.187274
 Parameter: ZPOS <- "-17.5683537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.5683537" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.5066723"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.5066723-0
 Parameter: XTRAN <- "51.5066723"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.2113517"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.2113517-0
 Parameter: YTRAN <- "-13.2113517"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.5683537"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.5683537-0
 Parameter: ZTRAN <- "-17.5683537"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.5066723"
 Parameter: YTRAN -> "-13.2113517"
 Parameter: ZTRAN -> "-17.5683537"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    51.506672  -13.211352  -17.568354
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.459605037"
Evaluating: 0.459605037*360.0
 Parameter: XPHI <- "165.457813"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190660203"
Evaluating: 0.190660203*360.0
 Parameter: YPHI <- "68.6376731"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.855450082E-02"
Evaluating: 1.855450082E-02*360.0
 Parameter: ZPHI <- "6.6796203"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.5066723"
 Parameter: YPOS -> "-13.2113517"
 Parameter: ZPOS -> "-17.5683537"
 Parameter: XPHI -> "165.457813"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.967963    0.251093
    0.000000   -0.251093   -0.967963

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.5066723"
 Parameter: YPOS -> "-13.2113517"
 Parameter: ZPOS -> "-17.5683537"
 Parameter: YPHI -> "68.6376731"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.364265    0.000000   -0.931296
    0.000000    1.000000    0.000000
    0.931296    0.000000    0.364265

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.5066723"
 Parameter: YPOS -> "-13.2113517"
 Parameter: ZPOS -> "-17.5683537"
 Parameter: ZPHI -> "6.6796203"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.993212    0.116317    0.000000
   -0.116317    0.993212    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.506672 XMAX =   51.506672 XAVE =   51.506672
    YMIN =  -13.211352 YMAX =  -13.211352 YAVE =  -13.211352
    ZMIN =  -17.568354 ZMAX =  -17.568354 ZAVE =  -17.568354
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.5066723"
Evaluating: 51.5066723+3.5
 Parameter: XMAX <- "55.0066723"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.2113517"
Evaluating: -13.2113517+3.5
 Parameter: YMAX <- "-9.7113517"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.5683537"
Evaluating: -17.5683537+3.5
 Parameter: ZMAX <- "-14.0683537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.5066723"
Evaluating: 51.5066723-3.5
 Parameter: XMIN <- "48.0066723"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.2113517"
Evaluating: -13.2113517-3.5
 Parameter: YMIN <- "-16.7113517"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.5683537"
Evaluating: -17.5683537-3.5
 Parameter: ZMIN <- "-21.0683537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.0066723"
 Parameter: XMIN -> "48.0066723"
 Parameter: YMAX -> "-9.7113517"
 Parameter: YMIN -> "-16.7113517"
 Parameter: ZMAX -> "-14.0683537"
 Parameter: ZMIN -> "-21.0683537"
 SELRPN>     20 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     13 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      P             2.1292
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      O13           0.9323
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      O14           2.6583
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      O11           3.1289
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      O12           3.2824
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     187      C1            3.8526
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      P             3.1712
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      O13           3.6407
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      O14           1.8122
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      O21           3.6415
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      C21           3.9064
60407 NEG      CLA      58       CLA     -**** MEMB     DMPC     195      C22           3.3771
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "175"
Evaluating: 175
 Parameter: J <- "175"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "175" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "175"
 Parameter: NPOS -> "117"
Evaluating: 175-117
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.859206935"
Evaluating: 128.065641*(0.859206935-0.5)
 Parameter: XPOS <- "46.0020664"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.351400317"
Evaluating: 128.065641*(0.351400317-0.5)
 Parameter: YPOS <- "-19.0305137"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.929922381"
Evaluating: 108.613069*(0.929922381-0.5)+-2.187274
 Parameter: ZPOS <- "44.5079152"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.5079152" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.5079152" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.506672 XMAX =   51.506672 XAVE =   51.506672
    YMIN =  -13.211352 YMAX =  -13.211352 YAVE =  -13.211352
    ZMIN =  -17.568354 ZMAX =  -17.568354 ZAVE =  -17.568354
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0020664"
 RDCMND substituted energy or value "?XAVE" to "51.5066723"
Evaluating: 46.0020664-51.5066723
 Parameter: XTRAN <- "-5.5046059"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.0305137"
 RDCMND substituted energy or value "?YAVE" to "-13.2113517"
Evaluating: -19.0305137--13.2113517
 Parameter: YTRAN <- "-5.819162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.5079152"
 RDCMND substituted energy or value "?ZAVE" to "-17.5683537"
Evaluating: 44.5079152--17.5683537
 Parameter: ZTRAN <- "62.0762689"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.5046059"
 Parameter: YTRAN -> "-5.819162"
 Parameter: ZTRAN -> "62.0762689"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -5.504606   -5.819162   62.076269
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232295164"
Evaluating: 0.232295164*360.0
 Parameter: XPHI <- "83.626259"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819973024"
Evaluating: 0.819973024*360.0
 Parameter: YPHI <- "295.190289"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.570482491E-02"
Evaluating: 6.570482491E-02*360.0
 Parameter: ZPHI <- "23.653737"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0020664"
 Parameter: YPOS -> "-19.0305137"
 Parameter: ZPOS -> "44.5079152"
 Parameter: XPHI -> "83.626259"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.111013    0.993819
    0.000000   -0.993819    0.111013

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   83.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0020664"
 Parameter: YPOS -> "-19.0305137"
 Parameter: ZPOS -> "44.5079152"
 Parameter: YPHI -> "295.190289"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.425626    0.000000    0.904899
    0.000000    1.000000    0.000000
   -0.904899    0.000000    0.425626

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0020664"
 Parameter: YPOS -> "-19.0305137"
 Parameter: ZPOS -> "44.5079152"
 Parameter: ZPHI -> "23.653737"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.915987    0.401208    0.000000
   -0.401208    0.915987    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.002066 XMAX =   46.002066 XAVE =   46.002066
    YMIN =  -19.030514 YMAX =  -19.030514 YAVE =  -19.030514
    ZMIN =   44.507915 ZMAX =   44.507915 ZAVE =   44.507915
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0020664"
Evaluating: 46.0020664+3.5
 Parameter: XMAX <- "49.5020664"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.0305137"
Evaluating: -19.0305137+3.5
 Parameter: YMAX <- "-15.5305137"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.5079152"
Evaluating: 44.5079152+3.5
 Parameter: ZMAX <- "48.0079152"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0020664"
Evaluating: 46.0020664-3.5
 Parameter: XMIN <- "42.5020664"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.0305137"
Evaluating: -19.0305137-3.5
 Parameter: YMIN <- "-22.5305137"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.5079152"
Evaluating: 44.5079152-3.5
 Parameter: ZMIN <- "41.0079152"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5020664"
 Parameter: XMIN -> "42.5020664"
 Parameter: YMAX -> "-15.5305137"
 Parameter: YMIN -> "-22.5305137"
 Parameter: ZMAX -> "48.0079152"
 Parameter: ZMIN -> "41.0079152"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "176"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "176" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "176"
Evaluating: 176
 Parameter: J <- "176"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "176" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "176"
 Parameter: NPOS -> "117"
Evaluating: 176-117
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.433206942E-02"
Evaluating: 128.065641*(5.433206942E-02-0.5)
 Parameter: XPOS <- "-57.0747492"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.362480242"
Evaluating: 128.065641*(0.362480242-0.5)
 Parameter: YPOS <- "-17.611556"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.229821178"
Evaluating: 108.613069*(0.229821178-0.5)+-2.187274
 Parameter: ZPOS <- "-31.532225"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.532225" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.0747492"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.0747492-0
 Parameter: XTRAN <- "-57.0747492"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.611556"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.611556-0
 Parameter: YTRAN <- "-17.611556"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.532225"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.532225-0
 Parameter: ZTRAN <- "-31.532225"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.0747492"
 Parameter: YTRAN -> "-17.611556"
 Parameter: ZTRAN -> "-31.532225"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -57.074749  -17.611556  -31.532225
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262722272"
Evaluating: 0.262722272*360.0
 Parameter: XPHI <- "94.5800179"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262637993"
Evaluating: 0.262637993*360.0
 Parameter: YPHI <- "94.5496775"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.356530288"
Evaluating: 0.356530288*360.0
 Parameter: ZPHI <- "128.350904"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.0747492"
 Parameter: YPOS -> "-17.611556"
 Parameter: ZPOS -> "-31.532225"
 Parameter: XPHI -> "94.5800179"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.079851    0.996807
    0.000000   -0.996807   -0.079851

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.0747492"
 Parameter: YPOS -> "-17.611556"
 Parameter: ZPOS -> "-31.532225"
 Parameter: YPHI -> "94.5496775"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.079323    0.000000   -0.996849
    0.000000    1.000000    0.000000
    0.996849    0.000000   -0.079323

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.0747492"
 Parameter: YPOS -> "-17.611556"
 Parameter: ZPOS -> "-31.532225"
 Parameter: ZPHI -> "128.350904"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.620476    0.784225    0.000000
   -0.784225   -0.620476    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  128.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.074749 XMAX =  -57.074749 XAVE =  -57.074749
    YMIN =  -17.611556 YMAX =  -17.611556 YAVE =  -17.611556
    ZMIN =  -31.532225 ZMAX =  -31.532225 ZAVE =  -31.532225
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.0747492"
Evaluating: -57.0747492+3.5
 Parameter: XMAX <- "-53.5747492"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.611556"
Evaluating: -17.611556+3.5
 Parameter: YMAX <- "-14.111556"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.532225"
Evaluating: -31.532225+3.5
 Parameter: ZMAX <- "-28.032225"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.0747492"
Evaluating: -57.0747492-3.5
 Parameter: XMIN <- "-60.5747492"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.611556"
Evaluating: -17.611556-3.5
 Parameter: YMIN <- "-21.111556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.532225"
Evaluating: -31.532225-3.5
 Parameter: ZMIN <- "-35.032225"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.5747492"
 Parameter: XMIN -> "-60.5747492"
 Parameter: YMAX -> "-14.111556"
 Parameter: YMIN -> "-21.111556"
 Parameter: ZMAX -> "-28.032225"
 Parameter: ZMIN -> "-35.032225"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "177"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "177" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "177"
Evaluating: 177
 Parameter: J <- "177"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "177" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "177"
 Parameter: NPOS -> "117"
Evaluating: 177-117
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.495965567"
Evaluating: 128.065641*(0.495965567-0.5)
 Parameter: XPOS <- "-0.516672248"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.899896232"
Evaluating: 128.065641*(0.899896232-0.5)
 Parameter: YPOS <- "51.2129673"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.265314933"
Evaluating: 108.613069*(0.265314933-0.5)+-2.187274
 Parameter: ZPOS <- "-27.6771394"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.6771394" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.516672248"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.516672248-0
 Parameter: XTRAN <- "-0.516672248"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.2129673"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.2129673-0
 Parameter: YTRAN <- "51.2129673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.6771394"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.6771394-0
 Parameter: ZTRAN <- "-27.6771394"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.516672248"
 Parameter: YTRAN -> "51.2129673"
 Parameter: ZTRAN -> "-27.6771394"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -0.516672   51.212967  -27.677139
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.865672537"
Evaluating: 0.865672537*360.0
 Parameter: XPHI <- "311.642113"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507854357"
Evaluating: 0.507854357*360.0
 Parameter: YPHI <- "182.827569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.116991678E-02"
Evaluating: 7.116991678E-02*360.0
 Parameter: ZPHI <- "25.62117"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.516672248"
 Parameter: YPOS -> "51.2129673"
 Parameter: ZPOS -> "-27.6771394"
 Parameter: XPHI -> "311.642113"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.664476   -0.747310
    0.000000    0.747310    0.664476

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.516672248"
 Parameter: YPOS -> "51.2129673"
 Parameter: ZPOS -> "-27.6771394"
 Parameter: YPHI -> "182.827569"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.998783    0.000000    0.049330
    0.000000    1.000000    0.000000
   -0.049330    0.000000   -0.998783

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  177.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.516672248"
 Parameter: YPOS -> "51.2129673"
 Parameter: ZPOS -> "-27.6771394"
 Parameter: ZPHI -> "25.62117"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.901673    0.432419    0.000000
   -0.432419    0.901673    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.516672 XMAX =   -0.516672 XAVE =   -0.516672
    YMIN =   51.212967 YMAX =   51.212967 YAVE =   51.212967
    ZMIN =  -27.677139 ZMAX =  -27.677139 ZAVE =  -27.677139
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.516672248"
Evaluating: -0.516672248+3.5
 Parameter: XMAX <- "2.98332775"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.2129673"
Evaluating: 51.2129673+3.5
 Parameter: YMAX <- "54.7129673"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.6771394"
Evaluating: -27.6771394+3.5
 Parameter: ZMAX <- "-24.1771394"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.516672248"
Evaluating: -0.516672248-3.5
 Parameter: XMIN <- "-4.01667225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.2129673"
Evaluating: 51.2129673-3.5
 Parameter: YMIN <- "47.7129673"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.6771394"
Evaluating: -27.6771394-3.5
 Parameter: ZMIN <- "-31.1771394"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.98332775"
 Parameter: XMIN -> "-4.01667225"
 Parameter: YMAX -> "54.7129673"
 Parameter: YMIN -> "47.7129673"
 Parameter: ZMAX -> "-24.1771394"
 Parameter: ZMIN -> "-31.1771394"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "178"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "178" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "178"
Evaluating: 178
 Parameter: J <- "178"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "178" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "178"
 Parameter: NPOS -> "117"
Evaluating: 178-117
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.108343098"
Evaluating: 128.065641*(0.108343098-0.5)
 Parameter: XPOS <- "-50.1577922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.127297009"
Evaluating: 128.065641*(0.127297009-0.5)
 Parameter: YPOS <- "-47.7304474"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.532292503"
Evaluating: 108.613069*(0.532292503-0.5)+-2.187274
 Parameter: ZPOS <- "1.32011386"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.32011386" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.32011386" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "178"
Evaluating: 178
 Parameter: J <- "178"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "178" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "178"
 Parameter: NPOS -> "117"
Evaluating: 178-117
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.83295798"
Evaluating: 128.065641*(0.83295798-0.5)
 Parameter: XPOS <- "42.6404771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.986023201"
Evaluating: 128.065641*(0.986023201-0.5)
 Parameter: YPOS <- "62.2428728"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.62572866"
Evaluating: 108.613069*(0.62572866-0.5)+-2.187274
 Parameter: ZPOS <- "11.4685016"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.4685016" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.4685016" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "178"
Evaluating: 178
 Parameter: J <- "178"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "178" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "178"
 Parameter: NPOS -> "117"
Evaluating: 178-117
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.78368536"
Evaluating: 128.065641*(0.78368536-0.5)
 Parameter: XPOS <- "36.3303475"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.56697762"
Evaluating: 128.065641*(0.56697762-0.5)
 Parameter: YPOS <- "8.57753184"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.251382467"
Evaluating: 108.613069*(0.251382467-0.5)+-2.187274
 Parameter: ZPOS <- "-29.1903873"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.1903873" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.3303475"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.3303475-0
 Parameter: XTRAN <- "36.3303475"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.57753184"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.57753184-0
 Parameter: YTRAN <- "8.57753184"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.1903873"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.1903873-0
 Parameter: ZTRAN <- "-29.1903873"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.3303475"
 Parameter: YTRAN -> "8.57753184"
 Parameter: ZTRAN -> "-29.1903873"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    36.330348    8.577532  -29.190387
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819292183"
Evaluating: 0.819292183*360.0
 Parameter: XPHI <- "294.945186"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204647653"
Evaluating: 0.204647653*360.0
 Parameter: YPHI <- "73.6731551"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299765894"
Evaluating: 0.299765894*360.0
 Parameter: ZPHI <- "107.915722"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.3303475"
 Parameter: YPOS -> "8.57753184"
 Parameter: ZPOS -> "-29.1903873"
 Parameter: XPHI -> "294.945186"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.421751   -0.906712
    0.000000    0.906712    0.421751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.3303475"
 Parameter: YPOS -> "8.57753184"
 Parameter: ZPOS -> "-29.1903873"
 Parameter: YPHI -> "73.6731551"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.281116    0.000000   -0.959674
    0.000000    1.000000    0.000000
    0.959674    0.000000    0.281116

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.3303475"
 Parameter: YPOS -> "8.57753184"
 Parameter: ZPOS -> "-29.1903873"
 Parameter: ZPHI -> "107.915722"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.307618    0.951510    0.000000
   -0.951510   -0.307618    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.330348 XMAX =   36.330348 XAVE =   36.330348
    YMIN =    8.577532 YMAX =    8.577532 YAVE =    8.577532
    ZMIN =  -29.190387 ZMAX =  -29.190387 ZAVE =  -29.190387
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.3303475"
Evaluating: 36.3303475+3.5
 Parameter: XMAX <- "39.8303475"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.57753184"
Evaluating: 8.57753184+3.5
 Parameter: YMAX <- "12.0775318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.1903873"
Evaluating: -29.1903873+3.5
 Parameter: ZMAX <- "-25.6903873"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.3303475"
Evaluating: 36.3303475-3.5
 Parameter: XMIN <- "32.8303475"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.57753184"
Evaluating: 8.57753184-3.5
 Parameter: YMIN <- "5.07753184"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.1903873"
Evaluating: -29.1903873-3.5
 Parameter: ZMIN <- "-32.6903873"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.8303475"
 Parameter: XMIN -> "32.8303475"
 Parameter: YMAX -> "12.0775318"
 Parameter: YMIN -> "5.07753184"
 Parameter: ZMAX -> "-25.6903873"
 Parameter: ZMIN -> "-32.6903873"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "179"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "179" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "179"
Evaluating: 179
 Parameter: J <- "179"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "179" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "179"
 Parameter: NPOS -> "117"
Evaluating: 179-117
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.288768115"
Evaluating: 128.065641*(0.288768115-0.5)
 Parameter: XPOS <- "-27.0515468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.165568088"
Evaluating: 128.065641*(0.165568088-0.5)
 Parameter: YPOS <- "-42.8292372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "5.205969799E-03"
Evaluating: 108.613069*(5.205969799E-03-0.5)+-2.187274
 Parameter: ZPOS <- "-55.9283721"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.9283721" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.0515468"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.0515468-0
 Parameter: XTRAN <- "-27.0515468"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.8292372"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.8292372-0
 Parameter: YTRAN <- "-42.8292372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.9283721"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.9283721-0
 Parameter: ZTRAN <- "-55.9283721"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.0515468"
 Parameter: YTRAN -> "-42.8292372"
 Parameter: ZTRAN -> "-55.9283721"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -27.051547  -42.829237  -55.928372
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216459053"
Evaluating: 0.216459053*360.0
 Parameter: XPHI <- "77.9252591"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.10688361"
Evaluating: 0.10688361*360.0
 Parameter: YPHI <- "38.4780996"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.848014671E-02"
Evaluating: 3.848014671E-02*360.0
 Parameter: ZPHI <- "13.8528528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.0515468"
 Parameter: YPOS -> "-42.8292372"
 Parameter: ZPOS -> "-55.9283721"
 Parameter: XPHI -> "77.9252591"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.209187    0.977876
    0.000000   -0.977876    0.209187

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.0515468"
 Parameter: YPOS -> "-42.8292372"
 Parameter: ZPOS -> "-55.9283721"
 Parameter: YPHI -> "38.4780996"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.782846    0.000000   -0.622215
    0.000000    1.000000    0.000000
    0.622215    0.000000    0.782846

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.0515468"
 Parameter: YPOS -> "-42.8292372"
 Parameter: ZPOS -> "-55.9283721"
 Parameter: ZPHI -> "13.8528528"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.970914    0.239429    0.000000
   -0.239429    0.970914    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.051547 XMAX =  -27.051547 XAVE =  -27.051547
    YMIN =  -42.829237 YMAX =  -42.829237 YAVE =  -42.829237
    ZMIN =  -55.928372 ZMAX =  -55.928372 ZAVE =  -55.928372
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.0515468"
Evaluating: -27.0515468+3.5
 Parameter: XMAX <- "-23.5515468"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.8292372"
Evaluating: -42.8292372+3.5
 Parameter: YMAX <- "-39.3292372"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.9283721"
Evaluating: -55.9283721+3.5
 Parameter: ZMAX <- "-52.4283721"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.0515468"
Evaluating: -27.0515468-3.5
 Parameter: XMIN <- "-30.5515468"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.8292372"
Evaluating: -42.8292372-3.5
 Parameter: YMIN <- "-46.3292372"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.9283721"
Evaluating: -55.9283721-3.5
 Parameter: ZMIN <- "-59.4283721"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.5515468"
 Parameter: XMIN -> "-30.5515468"
 Parameter: YMAX -> "-39.3292372"
 Parameter: YMIN -> "-46.3292372"
 Parameter: ZMAX -> "-52.4283721"
 Parameter: ZMIN -> "-59.4283721"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "180"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "180" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "180"
Evaluating: 180
 Parameter: J <- "180"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "180" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "180"
 Parameter: NPOS -> "117"
Evaluating: 180-117
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.706209627"
Evaluating: 128.065641*(0.706209627-0.5)
 Parameter: XPOS <- "26.4083681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.755191703E-02"
Evaluating: 128.065641*(3.755191703E-02-0.5)
 Parameter: YPOS <- "-59.2237102"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.426988097"
Evaluating: 108.613069*(0.426988097-0.5)+-2.187274
 Parameter: ZPOS <- "-10.1173209"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.1173209" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.1173209" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "180"
Evaluating: 180
 Parameter: J <- "180"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "180" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "180"
 Parameter: NPOS -> "117"
Evaluating: 180-117
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.986579405"
Evaluating: 128.065641*(0.986579405-0.5)
 Parameter: XPOS <- "62.3141034"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.929054409"
Evaluating: 128.065641*(0.929054409-0.5)
 Parameter: YPOS <- "54.9471279"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.186126555"
Evaluating: 108.613069*(0.186126555-0.5)+-2.187274
 Parameter: ZPOS <- "-36.2780321"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.2780321" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "62.3141034"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 62.3141034-0
 Parameter: XTRAN <- "62.3141034"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.9471279"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 54.9471279-0
 Parameter: YTRAN <- "54.9471279"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.2780321"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.2780321-0
 Parameter: ZTRAN <- "-36.2780321"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "62.3141034"
 Parameter: YTRAN -> "54.9471279"
 Parameter: ZTRAN -> "-36.2780321"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    62.314103   54.947128  -36.278032
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760862612"
Evaluating: 0.760862612*360.0
 Parameter: XPHI <- "273.91054"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693192696"
Evaluating: 0.693192696*360.0
 Parameter: YPHI <- "249.549371"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574328121"
Evaluating: 0.574328121*360.0
 Parameter: ZPHI <- "206.758124"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "62.3141034"
 Parameter: YPOS -> "54.9471279"
 Parameter: ZPOS -> "-36.2780321"
 Parameter: XPHI -> "273.91054"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.068199   -0.997672
    0.000000    0.997672    0.068199

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "62.3141034"
 Parameter: YPOS -> "54.9471279"
 Parameter: ZPOS -> "-36.2780321"
 Parameter: YPHI -> "249.549371"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.349400    0.000000    0.936974
    0.000000    1.000000    0.000000
   -0.936974    0.000000   -0.349400

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  110.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "62.3141034"
 Parameter: YPOS -> "54.9471279"
 Parameter: ZPOS -> "-36.2780321"
 Parameter: ZPHI -> "206.758124"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.892915   -0.450225    0.000000
    0.450225   -0.892915    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   62.314103 XMAX =   62.314103 XAVE =   62.314103
    YMIN =   54.947128 YMAX =   54.947128 YAVE =   54.947128
    ZMIN =  -36.278032 ZMAX =  -36.278032 ZAVE =  -36.278032
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "62.3141034"
Evaluating: 62.3141034+3.5
 Parameter: XMAX <- "65.8141034"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.9471279"
Evaluating: 54.9471279+3.5
 Parameter: YMAX <- "58.4471279"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.2780321"
Evaluating: -36.2780321+3.5
 Parameter: ZMAX <- "-32.7780321"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "62.3141034"
Evaluating: 62.3141034-3.5
 Parameter: XMIN <- "58.8141034"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.9471279"
Evaluating: 54.9471279-3.5
 Parameter: YMIN <- "51.4471279"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.2780321"
Evaluating: -36.2780321-3.5
 Parameter: ZMIN <- "-39.7780321"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.8141034"
 Parameter: XMIN -> "58.8141034"
 Parameter: YMAX -> "58.4471279"
 Parameter: YMIN -> "51.4471279"
 Parameter: ZMAX -> "-32.7780321"
 Parameter: ZMIN -> "-39.7780321"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "181"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "181" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "181" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "117"
Evaluating: 181-117
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.57094002"
Evaluating: 128.065641*(0.57094002-0.5)
 Parameter: XPOS <- "9.08497913"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.594992701"
Evaluating: 128.065641*(0.594992701-0.5)
 Parameter: YPOS <- "12.1653011"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.353996111E-02"
Evaluating: 108.613069*(3.353996111E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-52.8509304"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.8509304" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.08497913"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.08497913-0
 Parameter: XTRAN <- "9.08497913"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.1653011"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.1653011-0
 Parameter: YTRAN <- "12.1653011"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.8509304"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.8509304-0
 Parameter: ZTRAN <- "-52.8509304"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.08497913"
 Parameter: YTRAN -> "12.1653011"
 Parameter: ZTRAN -> "-52.8509304"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     9.084979   12.165301  -52.850930
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59649362"
Evaluating: 0.59649362*360.0
 Parameter: XPHI <- "214.737703"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61384993"
Evaluating: 0.61384993*360.0
 Parameter: YPHI <- "220.985975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406771245"
Evaluating: 0.406771245*360.0
 Parameter: ZPHI <- "146.437648"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.08497913"
 Parameter: YPOS -> "12.1653011"
 Parameter: ZPOS -> "-52.8509304"
 Parameter: XPHI -> "214.737703"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.821769   -0.569820
    0.000000    0.569820   -0.821769

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.08497913"
 Parameter: YPOS -> "12.1653011"
 Parameter: ZPOS -> "-52.8509304"
 Parameter: YPHI -> "220.985975"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.754870    0.000000    0.655874
    0.000000    1.000000    0.000000
   -0.655874    0.000000   -0.754870

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.08497913"
 Parameter: YPOS -> "12.1653011"
 Parameter: ZPOS -> "-52.8509304"
 Parameter: ZPHI -> "146.437648"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.833285    0.552844    0.000000
   -0.552844   -0.833285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.084979 XMAX =    9.084979 XAVE =    9.084979
    YMIN =   12.165301 YMAX =   12.165301 YAVE =   12.165301
    ZMIN =  -52.850930 ZMAX =  -52.850930 ZAVE =  -52.850930
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.08497913"
Evaluating: 9.08497913+3.5
 Parameter: XMAX <- "12.5849791"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.1653011"
Evaluating: 12.1653011+3.5
 Parameter: YMAX <- "15.6653011"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.8509304"
Evaluating: -52.8509304+3.5
 Parameter: ZMAX <- "-49.3509304"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.08497913"
Evaluating: 9.08497913-3.5
 Parameter: XMIN <- "5.58497913"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.1653011"
Evaluating: 12.1653011-3.5
 Parameter: YMIN <- "8.6653011"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.8509304"
Evaluating: -52.8509304-3.5
 Parameter: ZMIN <- "-56.3509304"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.5849791"
 Parameter: XMIN -> "5.58497913"
 Parameter: YMAX -> "15.6653011"
 Parameter: YMIN -> "8.6653011"
 Parameter: ZMAX -> "-49.3509304"
 Parameter: ZMIN -> "-56.3509304"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "182"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "182" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "182"
Evaluating: 182
 Parameter: J <- "182"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "182" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "182"
 Parameter: NPOS -> "117"
Evaluating: 182-117
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.845927158"
Evaluating: 128.065641*(0.845927158-0.5)
 Parameter: XPOS <- "44.3013832"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.106030015"
Evaluating: 128.065641*(0.106030015-0.5)
 Parameter: YPOS <- "-50.4540187"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.269471699"
Evaluating: 108.613069*(0.269471699-0.5)+-2.187274
 Parameter: ZPOS <- "-27.2256603"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.2256603" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.3013832"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.3013832-0
 Parameter: XTRAN <- "44.3013832"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.4540187"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.4540187-0
 Parameter: YTRAN <- "-50.4540187"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.2256603"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.2256603-0
 Parameter: ZTRAN <- "-27.2256603"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.3013832"
 Parameter: YTRAN -> "-50.4540187"
 Parameter: ZTRAN -> "-27.2256603"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    44.301383  -50.454019  -27.225660
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426932243"
Evaluating: 0.426932243*360.0
 Parameter: XPHI <- "153.695607"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961867321"
Evaluating: 0.961867321*360.0
 Parameter: YPHI <- "346.272236"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863932662"
Evaluating: 0.863932662*360.0
 Parameter: ZPHI <- "311.015758"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.3013832"
 Parameter: YPOS -> "-50.4540187"
 Parameter: ZPOS -> "-27.2256603"
 Parameter: XPHI -> "153.695607"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.896452    0.443140
    0.000000   -0.443140   -0.896452

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.3013832"
 Parameter: YPOS -> "-50.4540187"
 Parameter: ZPOS -> "-27.2256603"
 Parameter: YPHI -> "346.272236"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.971434    0.000000    0.237309
    0.000000    1.000000    0.000000
   -0.237309    0.000000    0.971434

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   13.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.3013832"
 Parameter: YPOS -> "-50.4540187"
 Parameter: ZPOS -> "-27.2256603"
 Parameter: ZPHI -> "311.015758"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.656267   -0.754529    0.000000
    0.754529    0.656267    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.301383 XMAX =   44.301383 XAVE =   44.301383
    YMIN =  -50.454019 YMAX =  -50.454019 YAVE =  -50.454019
    ZMIN =  -27.225660 ZMAX =  -27.225660 ZAVE =  -27.225660
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.3013832"
Evaluating: 44.3013832+3.5
 Parameter: XMAX <- "47.8013832"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.4540187"
Evaluating: -50.4540187+3.5
 Parameter: YMAX <- "-46.9540187"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.2256603"
Evaluating: -27.2256603+3.5
 Parameter: ZMAX <- "-23.7256603"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.3013832"
Evaluating: 44.3013832-3.5
 Parameter: XMIN <- "40.8013832"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.4540187"
Evaluating: -50.4540187-3.5
 Parameter: YMIN <- "-53.9540187"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.2256603"
Evaluating: -27.2256603-3.5
 Parameter: ZMIN <- "-30.7256603"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.8013832"
 Parameter: XMIN -> "40.8013832"
 Parameter: YMAX -> "-46.9540187"
 Parameter: YMIN -> "-53.9540187"
 Parameter: ZMAX -> "-23.7256603"
 Parameter: ZMIN -> "-30.7256603"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "183"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "183" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "183"
Evaluating: 183
 Parameter: J <- "183"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "183" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "183"
 Parameter: NPOS -> "117"
Evaluating: 183-117
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.297604092"
Evaluating: 128.065641*(0.297604092-0.5)
 Parameter: XPOS <- "-25.9199617"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.171687636"
Evaluating: 128.065641*(0.171687636-0.5)
 Parameter: YPOS <- "-42.0455333"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.414318698"
Evaluating: 108.613069*(0.414318698-0.5)+-2.187274
 Parameter: ZPOS <- "-11.4933832"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.4933832" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.4933832" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "183"
Evaluating: 183
 Parameter: J <- "183"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "183" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "183"
 Parameter: NPOS -> "117"
Evaluating: 183-117
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.241914508"
Evaluating: 128.065641*(0.241914508-0.5)
 Parameter: XPOS <- "-33.051884"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.560960985"
Evaluating: 128.065641*(0.560960985-0.5)
 Parameter: YPOS <- "7.80700762"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.979880382"
Evaluating: 108.613069*(0.979880382-0.5)+-2.187274
 Parameter: ZPOS <- "49.934007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.934007" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.934007" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.051884"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.051884-0
 Parameter: XTRAN <- "-33.051884"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.80700762"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.80700762-0
 Parameter: YTRAN <- "7.80700762"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.934007"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.934007-0
 Parameter: ZTRAN <- "49.934007"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.051884"
 Parameter: YTRAN -> "7.80700762"
 Parameter: ZTRAN -> "49.934007"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -33.051884    7.807008   49.934007
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.962301951"
Evaluating: 0.962301951*360.0
 Parameter: XPHI <- "346.428702"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115805131"
Evaluating: 0.115805131*360.0
 Parameter: YPHI <- "41.6898472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659681495"
Evaluating: 0.659681495*360.0
 Parameter: ZPHI <- "237.485338"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.051884"
 Parameter: YPOS -> "7.80700762"
 Parameter: ZPOS -> "49.934007"
 Parameter: XPHI -> "346.428702"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.972079   -0.234655
    0.000000    0.234655    0.972079

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.051884"
 Parameter: YPOS -> "7.80700762"
 Parameter: ZPOS -> "49.934007"
 Parameter: YPHI -> "41.6898472"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.746756    0.000000   -0.665098
    0.000000    1.000000    0.000000
    0.665098    0.000000    0.746756

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.051884"
 Parameter: YPOS -> "7.80700762"
 Parameter: ZPOS -> "49.934007"
 Parameter: ZPHI -> "237.485338"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.537515   -0.843254    0.000000
    0.843254   -0.537515    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.051884 XMAX =  -33.051884 XAVE =  -33.051884
    YMIN =    7.807008 YMAX =    7.807008 YAVE =    7.807008
    ZMIN =   49.934007 ZMAX =   49.934007 ZAVE =   49.934007
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.051884"
Evaluating: -33.051884+3.5
 Parameter: XMAX <- "-29.551884"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.80700762"
Evaluating: 7.80700762+3.5
 Parameter: YMAX <- "11.3070076"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.934007"
Evaluating: 49.934007+3.5
 Parameter: ZMAX <- "53.434007"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.051884"
Evaluating: -33.051884-3.5
 Parameter: XMIN <- "-36.551884"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.80700762"
Evaluating: 7.80700762-3.5
 Parameter: YMIN <- "4.30700762"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.934007"
Evaluating: 49.934007-3.5
 Parameter: ZMIN <- "46.434007"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.551884"
 Parameter: XMIN -> "-36.551884"
 Parameter: YMAX -> "11.3070076"
 Parameter: YMIN -> "4.30700762"
 Parameter: ZMAX -> "53.434007"
 Parameter: ZMIN -> "46.434007"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "184"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "184" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "184" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "117"
Evaluating: 184-117
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.58363003"
Evaluating: 128.065641*(0.58363003-0.5)
 Parameter: XPOS <- "10.7101334"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.971006684"
Evaluating: 128.065641*(0.971006684-0.5)
 Parameter: YPOS <- "60.3197729"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.348647462"
Evaluating: 108.613069*(0.348647462-0.5)+-2.187274
 Parameter: ZPOS <- "-18.6261377"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6261377" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.7101334"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.7101334-0
 Parameter: XTRAN <- "10.7101334"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "60.3197729"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 60.3197729-0
 Parameter: YTRAN <- "60.3197729"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6261377"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6261377-0
 Parameter: ZTRAN <- "-18.6261377"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.7101334"
 Parameter: YTRAN -> "60.3197729"
 Parameter: ZTRAN -> "-18.6261377"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    10.710133   60.319773  -18.626138
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772044544"
Evaluating: 0.772044544*360.0
 Parameter: XPHI <- "277.936036"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246669003"
Evaluating: 0.246669003*360.0
 Parameter: YPHI <- "88.8008411"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.142891456"
Evaluating: 0.142891456*360.0
 Parameter: ZPHI <- "51.4409242"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.7101334"
 Parameter: YPOS -> "60.3197729"
 Parameter: ZPOS -> "-18.6261377"
 Parameter: XPHI -> "277.936036"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.138067   -0.990423
    0.000000    0.990423    0.138067

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.7101334"
 Parameter: YPOS -> "60.3197729"
 Parameter: ZPOS -> "-18.6261377"
 Parameter: YPHI -> "88.8008411"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.020928    0.000000   -0.999781
    0.000000    1.000000    0.000000
    0.999781    0.000000    0.020928

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   88.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.7101334"
 Parameter: YPOS -> "60.3197729"
 Parameter: ZPOS -> "-18.6261377"
 Parameter: ZPHI -> "51.4409242"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.623321    0.781966    0.000000
   -0.781966    0.623321    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.710133 XMAX =   10.710133 XAVE =   10.710133
    YMIN =   60.319773 YMAX =   60.319773 YAVE =   60.319773
    ZMIN =  -18.626138 ZMAX =  -18.626138 ZAVE =  -18.626138
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.7101334"
Evaluating: 10.7101334+3.5
 Parameter: XMAX <- "14.2101334"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "60.3197729"
Evaluating: 60.3197729+3.5
 Parameter: YMAX <- "63.8197729"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6261377"
Evaluating: -18.6261377+3.5
 Parameter: ZMAX <- "-15.1261377"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.7101334"
Evaluating: 10.7101334-3.5
 Parameter: XMIN <- "7.2101334"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "60.3197729"
Evaluating: 60.3197729-3.5
 Parameter: YMIN <- "56.8197729"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6261377"
Evaluating: -18.6261377-3.5
 Parameter: ZMIN <- "-22.1261377"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.2101334"
 Parameter: XMIN -> "7.2101334"
 Parameter: YMAX -> "63.8197729"
 Parameter: YMIN -> "56.8197729"
 Parameter: ZMAX -> "-15.1261377"
 Parameter: ZMIN -> "-22.1261377"
 SELRPN>     18 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      7 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      N             1.9205
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      C13           2.3360
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      C14           3.1850
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      C15           1.0314
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      C12           2.6225
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      C11           3.5318
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     282      O12           3.2497
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "184" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "117"
Evaluating: 184-117
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.546433359"
Evaluating: 128.065641*(0.546433359-0.5)
 Parameter: XPOS <- "5.94651788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.370904675"
Evaluating: 128.065641*(0.370904675-0.5)
 Parameter: YPOS <- "-16.5326755"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.674966593"
Evaluating: 108.613069*(0.674966593-0.5)+-2.187274
 Parameter: ZPOS <- "16.8163846"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.8163846" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.8163846" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.710133 XMAX =   10.710133 XAVE =   10.710133
    YMIN =   60.319773 YMAX =   60.319773 YAVE =   60.319773
    ZMIN =  -18.626138 ZMAX =  -18.626138 ZAVE =  -18.626138
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.94651788"
 RDCMND substituted energy or value "?XAVE" to "10.7101334"
Evaluating: 5.94651788-10.7101334
 Parameter: XTRAN <- "-4.76361552"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.5326755"
 RDCMND substituted energy or value "?YAVE" to "60.3197729"
Evaluating: -16.5326755-60.3197729
 Parameter: YTRAN <- "-76.8524484"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.8163846"
 RDCMND substituted energy or value "?ZAVE" to "-18.6261377"
Evaluating: 16.8163846--18.6261377
 Parameter: ZTRAN <- "35.4425223"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.76361552"
 Parameter: YTRAN -> "-76.8524484"
 Parameter: ZTRAN -> "35.4425223"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -4.763616  -76.852448   35.442522
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.495284054E-02"
Evaluating: 8.495284054E-02*360.0
 Parameter: XPHI <- "30.5830226"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126860498"
Evaluating: 0.126860498*360.0
 Parameter: YPHI <- "45.6697793"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.408457528"
Evaluating: 0.408457528*360.0
 Parameter: ZPHI <- "147.04471"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.94651788"
 Parameter: YPOS -> "-16.5326755"
 Parameter: ZPOS -> "16.8163846"
 Parameter: XPHI -> "30.5830226"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.860893    0.508786
    0.000000   -0.508786    0.860893

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   30.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.94651788"
 Parameter: YPOS -> "-16.5326755"
 Parameter: ZPOS -> "16.8163846"
 Parameter: YPHI -> "45.6697793"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.698793    0.000000   -0.715324
    0.000000    1.000000    0.000000
    0.715324    0.000000    0.698793

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.94651788"
 Parameter: YPOS -> "-16.5326755"
 Parameter: ZPOS -> "16.8163846"
 Parameter: ZPHI -> "147.04471"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.839095    0.543984    0.000000
   -0.543984   -0.839095    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.946518 XMAX =    5.946518 XAVE =    5.946518
    YMIN =  -16.532675 YMAX =  -16.532675 YAVE =  -16.532675
    ZMIN =   16.816385 ZMAX =   16.816385 ZAVE =   16.816385
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.94651788"
Evaluating: 5.94651788+3.5
 Parameter: XMAX <- "9.44651788"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.5326755"
Evaluating: -16.5326755+3.5
 Parameter: YMAX <- "-13.0326755"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.8163846"
Evaluating: 16.8163846+3.5
 Parameter: ZMAX <- "20.3163846"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.94651788"
Evaluating: 5.94651788-3.5
 Parameter: XMIN <- "2.44651788"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.5326755"
Evaluating: -16.5326755-3.5
 Parameter: YMIN <- "-20.0326755"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.8163846"
Evaluating: 16.8163846-3.5
 Parameter: ZMIN <- "13.3163846"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.44651788"
 Parameter: XMIN -> "2.44651788"
 Parameter: YMAX -> "-13.0326755"
 Parameter: YMIN -> "-20.0326755"
 Parameter: ZMAX -> "20.3163846"
 Parameter: ZMIN -> "13.3163846"
 SELRPN>     18 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     11 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       P             2.0480
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       O13           2.6468
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       O14           1.3575
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       O11           2.4354
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       O12           3.5654
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       C1            2.2908
60416 NEG      CLA      67       CLA     -**** MEMB     DMPC     28       C2            3.6419
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "184" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "117"
Evaluating: 184-117
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.573589828E-02"
Evaluating: 128.065641*(3.573589828E-02-0.5)
 Parameter: XPOS <- "-59.4562798"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.906918529"
Evaluating: 128.065641*(0.906918529-0.5)
 Parameter: YPOS <- "52.1122823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "6.28937118E-02"
Evaluating: 108.613069*(6.28937118E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-49.6627294"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.6627294" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.946518 XMAX =    5.946518 XAVE =    5.946518
    YMIN =  -16.532675 YMAX =  -16.532675 YAVE =  -16.532675
    ZMIN =   16.816385 ZMAX =   16.816385 ZAVE =   16.816385
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.4562798"
 RDCMND substituted energy or value "?XAVE" to "5.94651788"
Evaluating: -59.4562798-5.94651788
 Parameter: XTRAN <- "-65.4027977"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.1122823"
 RDCMND substituted energy or value "?YAVE" to "-16.5326755"
Evaluating: 52.1122823--16.5326755
 Parameter: YTRAN <- "68.6449578"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.6627294"
 RDCMND substituted energy or value "?ZAVE" to "16.8163846"
Evaluating: -49.6627294-16.8163846
 Parameter: ZTRAN <- "-66.479114"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-65.4027977"
 Parameter: YTRAN -> "68.6449578"
 Parameter: ZTRAN -> "-66.479114"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -65.402798   68.644958  -66.479114
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.449606664E-02"
Evaluating: 2.449606664E-02*360.0
 Parameter: XPHI <- "8.81858399"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842590938"
Evaluating: 0.842590938*360.0
 Parameter: YPHI <- "303.332738"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710727607"
Evaluating: 0.710727607*360.0
 Parameter: ZPHI <- "255.861939"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.4562798"
 Parameter: YPOS -> "52.1122823"
 Parameter: ZPOS -> "-49.6627294"
 Parameter: XPHI -> "8.81858399"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988179    0.153306
    0.000000   -0.153306    0.988179

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    8.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.4562798"
 Parameter: YPOS -> "52.1122823"
 Parameter: ZPOS -> "-49.6627294"
 Parameter: YPHI -> "303.332738"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.549500    0.000000    0.835494
    0.000000    1.000000    0.000000
   -0.835494    0.000000    0.549500

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.4562798"
 Parameter: YPOS -> "52.1122823"
 Parameter: ZPOS -> "-49.6627294"
 Parameter: ZPHI -> "255.861939"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.244259   -0.969710    0.000000
    0.969710   -0.244259    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.456280 XMAX =  -59.456280 XAVE =  -59.456280
    YMIN =   52.112282 YMAX =   52.112282 YAVE =   52.112282
    ZMIN =  -49.662729 ZMAX =  -49.662729 ZAVE =  -49.662729
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.4562798"
Evaluating: -59.4562798+3.5
 Parameter: XMAX <- "-55.9562798"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.1122823"
Evaluating: 52.1122823+3.5
 Parameter: YMAX <- "55.6122823"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.6627294"
Evaluating: -49.6627294+3.5
 Parameter: ZMAX <- "-46.1627294"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.4562798"
Evaluating: -59.4562798-3.5
 Parameter: XMIN <- "-62.9562798"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.1122823"
Evaluating: 52.1122823-3.5
 Parameter: YMIN <- "48.6122823"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.6627294"
Evaluating: -49.6627294-3.5
 Parameter: ZMIN <- "-53.1627294"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.9562798"
 Parameter: XMIN -> "-62.9562798"
 Parameter: YMAX -> "55.6122823"
 Parameter: YMIN -> "48.6122823"
 Parameter: ZMAX -> "-46.1627294"
 Parameter: ZMIN -> "-53.1627294"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "185"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "185" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "185"
Evaluating: 185
 Parameter: J <- "185"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "185" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "185"
 Parameter: NPOS -> "117"
Evaluating: 185-117
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.542792542"
Evaluating: 128.065641*(0.542792542-0.5)
 Parameter: XPOS <- "5.48025432"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.569871595"
Evaluating: 128.065641*(0.569871595-0.5)
 Parameter: YPOS <- "8.9481506"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.220944091"
Evaluating: 108.613069*(0.220944091-0.5)+-2.187274
 Parameter: ZPOS <- "-32.4963927"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.4963927" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.48025432"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.48025432-0
 Parameter: XTRAN <- "5.48025432"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.9481506"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.9481506-0
 Parameter: YTRAN <- "8.9481506"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.4963927"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.4963927-0
 Parameter: ZTRAN <- "-32.4963927"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.48025432"
 Parameter: YTRAN -> "8.9481506"
 Parameter: ZTRAN -> "-32.4963927"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     5.480254    8.948151  -32.496393
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.464162734E-02"
Evaluating: 3.464162734E-02*360.0
 Parameter: XPHI <- "12.4709858"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476158088"
Evaluating: 0.476158088*360.0
 Parameter: YPHI <- "171.416912"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887123897"
Evaluating: 0.887123897*360.0
 Parameter: ZPHI <- "319.364603"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.48025432"
 Parameter: YPOS -> "8.9481506"
 Parameter: ZPOS -> "-32.4963927"
 Parameter: XPHI -> "12.4709858"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.976405    0.215945
    0.000000   -0.215945    0.976405

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   12.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.48025432"
 Parameter: YPOS -> "8.9481506"
 Parameter: ZPOS -> "-32.4963927"
 Parameter: YPHI -> "171.416912"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.988800    0.000000   -0.149243
    0.000000    1.000000    0.000000
    0.149243    0.000000   -0.988800

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.48025432"
 Parameter: YPOS -> "8.9481506"
 Parameter: ZPOS -> "-32.4963927"
 Parameter: ZPHI -> "319.364603"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.758869   -0.651243    0.000000
    0.651243    0.758869    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.480254 XMAX =    5.480254 XAVE =    5.480254
    YMIN =    8.948151 YMAX =    8.948151 YAVE =    8.948151
    ZMIN =  -32.496393 ZMAX =  -32.496393 ZAVE =  -32.496393
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.48025432"
Evaluating: 5.48025432+3.5
 Parameter: XMAX <- "8.98025432"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.9481506"
Evaluating: 8.9481506+3.5
 Parameter: YMAX <- "12.4481506"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.4963927"
Evaluating: -32.4963927+3.5
 Parameter: ZMAX <- "-28.9963927"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.48025432"
Evaluating: 5.48025432-3.5
 Parameter: XMIN <- "1.98025432"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.9481506"
Evaluating: 8.9481506-3.5
 Parameter: YMIN <- "5.4481506"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.4963927"
Evaluating: -32.4963927-3.5
 Parameter: ZMIN <- "-35.9963927"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.98025432"
 Parameter: XMIN -> "1.98025432"
 Parameter: YMAX -> "12.4481506"
 Parameter: YMIN -> "5.4481506"
 Parameter: ZMAX -> "-28.9963927"
 Parameter: ZMIN -> "-35.9963927"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "186"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "186" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "186"
Evaluating: 186
 Parameter: J <- "186"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "186" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "186"
 Parameter: NPOS -> "117"
Evaluating: 186-117
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "9.985138769E-02"
Evaluating: 128.065641*(9.985138769E-02-0.5)
 Parameter: XPOS <- "-51.2452885"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.99901177"
Evaluating: 128.065641*(0.99901177-0.5)
 Parameter: YPOS <- "63.9062622"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.55362467"
Evaluating: 108.613069*(0.55362467-0.5)+-2.187274
 Parameter: ZPOS <- "3.63706598"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.63706598" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.63706598" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "186"
Evaluating: 186
 Parameter: J <- "186"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "186" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "186"
 Parameter: NPOS -> "117"
Evaluating: 186-117
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.90070794"
Evaluating: 128.065641*(0.90070794-0.5)
 Parameter: XPOS <- "51.3169192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.865470771"
Evaluating: 128.065641*(0.865470771-0.5)
 Parameter: YPOS <- "46.8042486"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.871620422"
Evaluating: 108.613069*(0.871620422-0.5)+-2.187274
 Parameter: ZPOS <- "38.1755605"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.1755605" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.1755605" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.3169192"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.3169192-0
 Parameter: XTRAN <- "51.3169192"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.8042486"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.8042486-0
 Parameter: YTRAN <- "46.8042486"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.1755605"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.1755605-0
 Parameter: ZTRAN <- "38.1755605"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.3169192"
 Parameter: YTRAN -> "46.8042486"
 Parameter: ZTRAN -> "38.1755605"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    51.316919   46.804249   38.175561
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178282038"
Evaluating: 0.178282038*360.0
 Parameter: XPHI <- "64.1815337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.999569425"
Evaluating: 0.999569425*360.0
 Parameter: YPHI <- "359.844993"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607668996"
Evaluating: 0.607668996*360.0
 Parameter: ZPHI <- "218.760839"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.3169192"
 Parameter: YPOS -> "46.8042486"
 Parameter: ZPOS -> "38.1755605"
 Parameter: XPHI -> "64.1815337"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.435521    0.900178
    0.000000   -0.900178    0.435521

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.3169192"
 Parameter: YPOS -> "46.8042486"
 Parameter: ZPOS -> "38.1755605"
 Parameter: YPHI -> "359.844993"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999996    0.000000    0.002705
    0.000000    1.000000    0.000000
   -0.002705    0.000000    0.999996

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    0.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.3169192"
 Parameter: YPOS -> "46.8042486"
 Parameter: ZPOS -> "38.1755605"
 Parameter: ZPHI -> "218.760839"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.779766   -0.626071    0.000000
    0.626071   -0.779766    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.316919 XMAX =   51.316919 XAVE =   51.316919
    YMIN =   46.804249 YMAX =   46.804249 YAVE =   46.804249
    ZMIN =   38.175561 ZMAX =   38.175561 ZAVE =   38.175561
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.3169192"
Evaluating: 51.3169192+3.5
 Parameter: XMAX <- "54.8169192"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.8042486"
Evaluating: 46.8042486+3.5
 Parameter: YMAX <- "50.3042486"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.1755605"
Evaluating: 38.1755605+3.5
 Parameter: ZMAX <- "41.6755605"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.3169192"
Evaluating: 51.3169192-3.5
 Parameter: XMIN <- "47.8169192"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.8042486"
Evaluating: 46.8042486-3.5
 Parameter: YMIN <- "43.3042486"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.1755605"
Evaluating: 38.1755605-3.5
 Parameter: ZMIN <- "34.6755605"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.8169192"
 Parameter: XMIN -> "47.8169192"
 Parameter: YMAX -> "50.3042486"
 Parameter: YMIN -> "43.3042486"
 Parameter: ZMAX -> "41.6755605"
 Parameter: ZMIN -> "34.6755605"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "187"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "187" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "187"
Evaluating: 187
 Parameter: J <- "187"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "187" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "187"
 Parameter: NPOS -> "117"
Evaluating: 187-117
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "8.758661145E-02"
Evaluating: 128.065641*(8.758661145E-02-0.5)
 Parameter: XPOS <- "-52.815985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.126586685"
Evaluating: 128.065641*(0.126586685-0.5)
 Parameter: YPOS <- "-47.8214155"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.207439975"
Evaluating: 108.613069*(0.207439975-0.5)+-2.187274
 Parameter: ZPOS <- "-33.9631162"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.9631162" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-52.815985"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -52.815985-0
 Parameter: XTRAN <- "-52.815985"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.8214155"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.8214155-0
 Parameter: YTRAN <- "-47.8214155"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.9631162"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.9631162-0
 Parameter: ZTRAN <- "-33.9631162"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.815985"
 Parameter: YTRAN -> "-47.8214155"
 Parameter: ZTRAN -> "-33.9631162"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -52.815985  -47.821416  -33.963116
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455755293"
Evaluating: 0.455755293*360.0
 Parameter: XPHI <- "164.071905"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.594620204E-02"
Evaluating: 9.594620204E-02*360.0
 Parameter: YPHI <- "34.5406327"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918182778"
Evaluating: 0.918182778*360.0
 Parameter: ZPHI <- "330.5458"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-52.815985"
 Parameter: YPOS -> "-47.8214155"
 Parameter: ZPOS -> "-33.9631162"
 Parameter: XPHI -> "164.071905"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.961607    0.274431
    0.000000   -0.274431   -0.961607

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  164.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-52.815985"
 Parameter: YPOS -> "-47.8214155"
 Parameter: ZPOS -> "-33.9631162"
 Parameter: YPHI -> "34.5406327"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.823724    0.000000   -0.566991
    0.000000    1.000000    0.000000
    0.566991    0.000000    0.823724

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   34.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-52.815985"
 Parameter: YPOS -> "-47.8214155"
 Parameter: ZPOS -> "-33.9631162"
 Parameter: ZPHI -> "330.5458"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.870749   -0.491728    0.000000
    0.491728    0.870749    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.815985 XMAX =  -52.815985 XAVE =  -52.815985
    YMIN =  -47.821416 YMAX =  -47.821416 YAVE =  -47.821416
    ZMIN =  -33.963116 ZMAX =  -33.963116 ZAVE =  -33.963116
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-52.815985"
Evaluating: -52.815985+3.5
 Parameter: XMAX <- "-49.315985"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.8214155"
Evaluating: -47.8214155+3.5
 Parameter: YMAX <- "-44.3214155"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.9631162"
Evaluating: -33.9631162+3.5
 Parameter: ZMAX <- "-30.4631162"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-52.815985"
Evaluating: -52.815985-3.5
 Parameter: XMIN <- "-56.315985"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.8214155"
Evaluating: -47.8214155-3.5
 Parameter: YMIN <- "-51.3214155"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.9631162"
Evaluating: -33.9631162-3.5
 Parameter: ZMIN <- "-37.4631162"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-49.315985"
 Parameter: XMIN -> "-56.315985"
 Parameter: YMAX -> "-44.3214155"
 Parameter: YMIN -> "-51.3214155"
 Parameter: ZMAX -> "-30.4631162"
 Parameter: ZMIN -> "-37.4631162"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "188"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "188" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "188"
Evaluating: 188
 Parameter: J <- "188"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "188" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "188"
 Parameter: NPOS -> "117"
Evaluating: 188-117
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.902118489"
Evaluating: 128.065641*(0.902118489-0.5)
 Parameter: XPOS <- "51.4975621"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.558561523"
Evaluating: 128.065641*(0.558561523-0.5)
 Parameter: YPOS <- "7.49971898"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.919603918"
Evaluating: 108.613069*(0.919603918-0.5)+-2.187274
 Parameter: ZPOS <- "43.3871953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.3871953" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.3871953" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.4975621"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.4975621-0
 Parameter: XTRAN <- "51.4975621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.49971898"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.49971898-0
 Parameter: YTRAN <- "7.49971898"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.3871953"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.3871953-0
 Parameter: ZTRAN <- "43.3871953"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.4975621"
 Parameter: YTRAN -> "7.49971898"
 Parameter: ZTRAN -> "43.3871953"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    51.497562    7.499719   43.387195
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.9633747"
Evaluating: 0.9633747*360.0
 Parameter: XPHI <- "346.814892"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278126012"
Evaluating: 0.278126012*360.0
 Parameter: YPHI <- "100.125364"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159623151"
Evaluating: 0.159623151*360.0
 Parameter: ZPHI <- "57.4643344"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.4975621"
 Parameter: YPOS -> "7.49971898"
 Parameter: ZPOS -> "43.3871953"
 Parameter: XPHI -> "346.814892"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.973638   -0.228098
    0.000000    0.228098    0.973638

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.4975621"
 Parameter: YPOS -> "7.49971898"
 Parameter: ZPOS -> "43.3871953"
 Parameter: YPHI -> "100.125364"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.175803    0.000000   -0.984425
    0.000000    1.000000    0.000000
    0.984425    0.000000   -0.175803

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.4975621"
 Parameter: YPOS -> "7.49971898"
 Parameter: ZPOS -> "43.3871953"
 Parameter: ZPHI -> "57.4643344"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.537825    0.843057    0.000000
   -0.843057    0.537825    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   57.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.497562 XMAX =   51.497562 XAVE =   51.497562
    YMIN =    7.499719 YMAX =    7.499719 YAVE =    7.499719
    ZMIN =   43.387195 ZMAX =   43.387195 ZAVE =   43.387195
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.4975621"
Evaluating: 51.4975621+3.5
 Parameter: XMAX <- "54.9975621"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.49971898"
Evaluating: 7.49971898+3.5
 Parameter: YMAX <- "10.999719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.3871953"
Evaluating: 43.3871953+3.5
 Parameter: ZMAX <- "46.8871953"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.4975621"
Evaluating: 51.4975621-3.5
 Parameter: XMIN <- "47.9975621"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.49971898"
Evaluating: 7.49971898-3.5
 Parameter: YMIN <- "3.99971898"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.3871953"
Evaluating: 43.3871953-3.5
 Parameter: ZMIN <- "39.8871953"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.9975621"
 Parameter: XMIN -> "47.9975621"
 Parameter: YMAX -> "10.999719"
 Parameter: YMIN -> "3.99971898"
 Parameter: ZMAX -> "46.8871953"
 Parameter: ZMIN -> "39.8871953"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "189"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "189" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "189"
Evaluating: 189
 Parameter: J <- "189"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "189" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "189"
 Parameter: NPOS -> "117"
Evaluating: 189-117
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.107633406"
Evaluating: 128.065641*(0.107633406-0.5)
 Parameter: XPOS <- "-50.2486794"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.980388522"
Evaluating: 128.065641*(0.980388522-0.5)
 Parameter: YPOS <- "61.521264"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.632035849"
Evaluating: 108.613069*(0.632035849-0.5)+-2.187274
 Parameter: ZPOS <- "12.1535448"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.1535448" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.1535448" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "189"
Evaluating: 189
 Parameter: J <- "189"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "189" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "189"
 Parameter: NPOS -> "117"
Evaluating: 189-117
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.549326171"
Evaluating: 128.065641*(0.549326171-0.5)
 Parameter: XPOS <- "6.31698771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.568318677"
Evaluating: 128.065641*(0.568318677-0.5)
 Parameter: YPOS <- "8.74927516"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.853739883"
Evaluating: 108.613069*(0.853739883-0.5)+-2.187274
 Parameter: ZPOS <- "36.2335003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.2335003" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.2335003" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.31698771"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.31698771-0
 Parameter: XTRAN <- "6.31698771"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.74927516"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.74927516-0
 Parameter: YTRAN <- "8.74927516"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.2335003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.2335003-0
 Parameter: ZTRAN <- "36.2335003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.31698771"
 Parameter: YTRAN -> "8.74927516"
 Parameter: ZTRAN -> "36.2335003"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     6.316988    8.749275   36.233500
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.145558654"
Evaluating: 0.145558654*360.0
 Parameter: XPHI <- "52.4011154"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13086507"
Evaluating: 0.13086507*360.0
 Parameter: YPHI <- "47.1114252"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314963064"
Evaluating: 0.314963064*360.0
 Parameter: ZPHI <- "113.386703"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.31698771"
 Parameter: YPOS -> "8.74927516"
 Parameter: ZPOS -> "36.2335003"
 Parameter: XPHI -> "52.4011154"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.610130    0.792302
    0.000000   -0.792302    0.610130

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   52.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.31698771"
 Parameter: YPOS -> "8.74927516"
 Parameter: ZPOS -> "36.2335003"
 Parameter: YPHI -> "47.1114252"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.680575    0.000000   -0.732679
    0.000000    1.000000    0.000000
    0.732679    0.000000    0.680575

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.31698771"
 Parameter: YPOS -> "8.74927516"
 Parameter: ZPOS -> "36.2335003"
 Parameter: ZPHI -> "113.386703"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.396935    0.917847    0.000000
   -0.917847   -0.396935    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.316988 XMAX =    6.316988 XAVE =    6.316988
    YMIN =    8.749275 YMAX =    8.749275 YAVE =    8.749275
    ZMIN =   36.233500 ZMAX =   36.233500 ZAVE =   36.233500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.31698771"
Evaluating: 6.31698771+3.5
 Parameter: XMAX <- "9.81698771"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.74927516"
Evaluating: 8.74927516+3.5
 Parameter: YMAX <- "12.2492752"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.2335003"
Evaluating: 36.2335003+3.5
 Parameter: ZMAX <- "39.7335003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.31698771"
Evaluating: 6.31698771-3.5
 Parameter: XMIN <- "2.81698771"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.74927516"
Evaluating: 8.74927516-3.5
 Parameter: YMIN <- "5.24927516"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.2335003"
Evaluating: 36.2335003-3.5
 Parameter: ZMIN <- "32.7335003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.81698771"
 Parameter: XMIN -> "2.81698771"
 Parameter: YMAX -> "12.2492752"
 Parameter: YMIN -> "5.24927516"
 Parameter: ZMAX -> "39.7335003"
 Parameter: ZMIN -> "32.7335003"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "190"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "190" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "190"
Evaluating: 190
 Parameter: J <- "190"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "190" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "190"
 Parameter: NPOS -> "117"
Evaluating: 190-117
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.495897145"
Evaluating: 128.065641*(0.495897145-0.5)
 Parameter: XPOS <- "-0.525434756"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.986846004"
Evaluating: 128.065641*(0.986846004-0.5)
 Parameter: YPOS <- "62.3482456"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.130056035"
Evaluating: 108.613069*(0.130056035-0.5)+-2.187274
 Parameter: ZPOS <- "-42.3680234"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.3680234" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.525434756"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.525434756-0
 Parameter: XTRAN <- "-0.525434756"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "62.3482456"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 62.3482456-0
 Parameter: YTRAN <- "62.3482456"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.3680234"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.3680234-0
 Parameter: ZTRAN <- "-42.3680234"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.525434756"
 Parameter: YTRAN -> "62.3482456"
 Parameter: ZTRAN -> "-42.3680234"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -0.525435   62.348246  -42.368023
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.761105869"
Evaluating: 0.761105869*360.0
 Parameter: XPHI <- "273.998113"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.110615728E-02"
Evaluating: 3.110615728E-02*360.0
 Parameter: YPHI <- "11.1982166"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.105137268"
Evaluating: 0.105137268*360.0
 Parameter: ZPHI <- "37.8494165"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.525434756"
 Parameter: YPOS -> "62.3482456"
 Parameter: ZPOS -> "-42.3680234"
 Parameter: XPHI -> "273.998113"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.069724   -0.997566
    0.000000    0.997566    0.069724

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.525434756"
 Parameter: YPOS -> "62.3482456"
 Parameter: ZPOS -> "-42.3680234"
 Parameter: YPHI -> "11.1982166"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.980961    0.000000   -0.194204
    0.000000    1.000000    0.000000
    0.194204    0.000000    0.980961

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.525434756"
 Parameter: YPOS -> "62.3482456"
 Parameter: ZPOS -> "-42.3680234"
 Parameter: ZPHI -> "37.8494165"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.789626    0.613588    0.000000
   -0.613588    0.789626    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   37.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.525435 XMAX =   -0.525435 XAVE =   -0.525435
    YMIN =   62.348246 YMAX =   62.348246 YAVE =   62.348246
    ZMIN =  -42.368023 ZMAX =  -42.368023 ZAVE =  -42.368023
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.525434756"
Evaluating: -0.525434756+3.5
 Parameter: XMAX <- "2.97456524"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "62.3482456"
Evaluating: 62.3482456+3.5
 Parameter: YMAX <- "65.8482456"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.3680234"
Evaluating: -42.3680234+3.5
 Parameter: ZMAX <- "-38.8680234"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.525434756"
Evaluating: -0.525434756-3.5
 Parameter: XMIN <- "-4.02543476"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "62.3482456"
Evaluating: 62.3482456-3.5
 Parameter: YMIN <- "58.8482456"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.3680234"
Evaluating: -42.3680234-3.5
 Parameter: ZMIN <- "-45.8680234"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.97456524"
 Parameter: XMIN -> "-4.02543476"
 Parameter: YMAX -> "65.8482456"
 Parameter: YMIN -> "58.8482456"
 Parameter: ZMAX -> "-38.8680234"
 Parameter: ZMIN -> "-45.8680234"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "191"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "191" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "191"
Evaluating: 191
 Parameter: J <- "191"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "191" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "191"
 Parameter: NPOS -> "117"
Evaluating: 191-117
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "3.346357881E-02"
Evaluating: 128.065641*(3.346357881E-02-0.5)
 Parameter: XPOS <- "-59.7472858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.550163281"
Evaluating: 128.065641*(0.550163281-0.5)
 Parameter: YPOS <- "6.42419274"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.813432202"
Evaluating: 108.613069*(0.813432202-0.5)+-2.187274
 Parameter: ZPOS <- "31.8555594"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.8555594" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.8555594" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.7472858"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.7472858-0
 Parameter: XTRAN <- "-59.7472858"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.42419274"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.42419274-0
 Parameter: YTRAN <- "6.42419274"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.8555594"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.8555594-0
 Parameter: ZTRAN <- "31.8555594"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.7472858"
 Parameter: YTRAN -> "6.42419274"
 Parameter: ZTRAN -> "31.8555594"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -59.747286    6.424193   31.855559
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73197025"
Evaluating: 0.73197025*360.0
 Parameter: XPHI <- "263.50929"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805109608"
Evaluating: 0.805109608*360.0
 Parameter: YPHI <- "289.839459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387945886"
Evaluating: 0.387945886*360.0
 Parameter: ZPHI <- "139.660519"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.7472858"
 Parameter: YPOS -> "6.42419274"
 Parameter: ZPOS -> "31.8555594"
 Parameter: XPHI -> "263.50929"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.113042   -0.993590
    0.000000    0.993590   -0.113042

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   96.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.7472858"
 Parameter: YPOS -> "6.42419274"
 Parameter: ZPOS -> "31.8555594"
 Parameter: YPHI -> "289.839459"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.339386    0.000000    0.940647
    0.000000    1.000000    0.000000
   -0.940647    0.000000    0.339386

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.7472858"
 Parameter: YPOS -> "6.42419274"
 Parameter: ZPOS -> "31.8555594"
 Parameter: ZPHI -> "139.660519"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.762222    0.647315    0.000000
   -0.647315   -0.762222    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.747286 XMAX =  -59.747286 XAVE =  -59.747286
    YMIN =    6.424193 YMAX =    6.424193 YAVE =    6.424193
    ZMIN =   31.855559 ZMAX =   31.855559 ZAVE =   31.855559
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.7472858"
Evaluating: -59.7472858+3.5
 Parameter: XMAX <- "-56.2472858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.42419274"
Evaluating: 6.42419274+3.5
 Parameter: YMAX <- "9.92419274"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.8555594"
Evaluating: 31.8555594+3.5
 Parameter: ZMAX <- "35.3555594"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.7472858"
Evaluating: -59.7472858-3.5
 Parameter: XMIN <- "-63.2472858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.42419274"
Evaluating: 6.42419274-3.5
 Parameter: YMIN <- "2.92419274"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.8555594"
Evaluating: 31.8555594-3.5
 Parameter: ZMIN <- "28.3555594"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.2472858"
 Parameter: XMIN -> "-63.2472858"
 Parameter: YMAX -> "9.92419274"
 Parameter: YMIN -> "2.92419274"
 Parameter: ZMAX -> "35.3555594"
 Parameter: ZMIN -> "28.3555594"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "192"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "192" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "192"
Evaluating: 192
 Parameter: J <- "192"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "192" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "192"
 Parameter: NPOS -> "117"
Evaluating: 192-117
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.958584249"
Evaluating: 128.065641*(0.958584249-0.5)
 Parameter: XPOS <- "58.7288858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.527260354"
Evaluating: 128.065641*(0.527260354-0.5)
 Parameter: YPOS <- "3.49111471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.858735201"
Evaluating: 108.613069*(0.858735201-0.5)+-2.187274
 Parameter: ZPOS <- "36.7760571"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.7760571" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.7760571" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.7288858"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.7288858-0
 Parameter: XTRAN <- "58.7288858"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.49111471"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.49111471-0
 Parameter: YTRAN <- "3.49111471"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.7760571"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.7760571-0
 Parameter: ZTRAN <- "36.7760571"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.7288858"
 Parameter: YTRAN -> "3.49111471"
 Parameter: ZTRAN -> "36.7760571"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    58.728886    3.491115   36.776057
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802860783"
Evaluating: 0.802860783*360.0
 Parameter: XPHI <- "289.029882"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700783265"
Evaluating: 0.700783265*360.0
 Parameter: YPHI <- "252.281975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256628149"
Evaluating: 0.256628149*360.0
 Parameter: ZPHI <- "92.3861336"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.7288858"
 Parameter: YPOS -> "3.49111471"
 Parameter: ZPOS -> "36.7760571"
 Parameter: XPHI -> "289.029882"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.326061   -0.945349
    0.000000    0.945349    0.326061

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   70.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.7288858"
 Parameter: YPOS -> "3.49111471"
 Parameter: ZPOS -> "36.7760571"
 Parameter: YPHI -> "252.281975"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.304333    0.000000    0.952566
    0.000000    1.000000    0.000000
   -0.952566    0.000000   -0.304333

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.7288858"
 Parameter: YPOS -> "3.49111471"
 Parameter: ZPOS -> "36.7760571"
 Parameter: ZPHI -> "92.3861336"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.041634    0.999133    0.000000
   -0.999133   -0.041634    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.728886 XMAX =   58.728886 XAVE =   58.728886
    YMIN =    3.491115 YMAX =    3.491115 YAVE =    3.491115
    ZMIN =   36.776057 ZMAX =   36.776057 ZAVE =   36.776057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.7288858"
Evaluating: 58.7288858+3.5
 Parameter: XMAX <- "62.2288858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.49111471"
Evaluating: 3.49111471+3.5
 Parameter: YMAX <- "6.99111471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.7760571"
Evaluating: 36.7760571+3.5
 Parameter: ZMAX <- "40.2760571"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.7288858"
Evaluating: 58.7288858-3.5
 Parameter: XMIN <- "55.2288858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.49111471"
Evaluating: 3.49111471-3.5
 Parameter: YMIN <- "-8.88529E-03"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.7760571"
Evaluating: 36.7760571-3.5
 Parameter: ZMIN <- "33.2760571"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.2288858"
 Parameter: XMIN -> "55.2288858"
 Parameter: YMAX -> "6.99111471"
 Parameter: YMIN -> "-8.88529E-03"
 Parameter: ZMAX -> "40.2760571"
 Parameter: ZMIN -> "33.2760571"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "193"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "193" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "193" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "117"
Evaluating: 193-117
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.161560419"
Evaluating: 128.065641*(0.161560419-0.5)
 Parameter: XPOS <- "-43.3424819"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.484904429"
Evaluating: 128.065641*(0.484904429-0.5)
 Parameter: YPOS <- "-1.93322398"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.630302285"
Evaluating: 108.613069*(0.630302285-0.5)+-2.187274
 Parameter: ZPOS <- "11.9652571"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.9652571" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.9652571" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "193" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "117"
Evaluating: 193-117
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.568106264"
Evaluating: 128.065641*(0.568106264-0.5)
 Parameter: XPOS <- "8.72207236"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.901772701"
Evaluating: 128.065641*(0.901772701-0.5)
 Parameter: YPOS <- "51.4532785"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.645123016"
Evaluating: 108.613069*(0.645123016-0.5)+-2.187274
 Parameter: ZPOS <- "13.5749822"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.5749822" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.5749822" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "193" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "117"
Evaluating: 193-117
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.59009946"
Evaluating: 128.065641*(0.59009946-0.5)
 Parameter: XPOS <- "11.5386451"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.751033799"
Evaluating: 128.065641*(0.751033799-0.5)
 Parameter: YPOS <- "32.1488044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.435545763"
Evaluating: 108.613069*(0.435545763-0.5)+-2.187274
 Parameter: ZPOS <- "-9.18784649"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.18784649" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.18784649" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "193" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "117"
Evaluating: 193-117
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.342739742"
Evaluating: 128.065641*(0.342739742-0.5)
 Parameter: XPOS <- "-20.1396357"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.34258259"
Evaluating: 128.065641*(0.34258259-0.5)
 Parameter: YPOS <- "-20.1597615"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.50254411"
Evaluating: 108.613069*(0.50254411-0.5)+-2.187274
 Parameter: ZPOS <- "-1.91095041"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.91095041" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.91095041" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "193" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "117"
Evaluating: 193-117
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "6.978075242E-02"
Evaluating: 128.065641*(6.978075242E-02-0.5)
 Parameter: XPOS <- "-55.0963037"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.715796717"
Evaluating: 128.065641*(0.715796717-0.5)
 Parameter: YPOS <- "27.6361449"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.731503708"
Evaluating: 108.613069*(0.731503708-0.5)+-2.187274
 Parameter: ZPOS <- "22.9570542"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.9570542" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.9570542" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.0963037"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -55.0963037-0
 Parameter: XTRAN <- "-55.0963037"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.6361449"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.6361449-0
 Parameter: YTRAN <- "27.6361449"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.9570542"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.9570542-0
 Parameter: ZTRAN <- "22.9570542"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-55.0963037"
 Parameter: YTRAN -> "27.6361449"
 Parameter: ZTRAN -> "22.9570542"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -55.096304   27.636145   22.957054
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947599598"
Evaluating: 0.947599598*360.0
 Parameter: XPHI <- "341.135855"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423800552"
Evaluating: 0.423800552*360.0
 Parameter: YPHI <- "152.568199"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933816488"
Evaluating: 0.933816488*360.0
 Parameter: ZPHI <- "336.173936"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.0963037"
 Parameter: YPOS -> "27.6361449"
 Parameter: ZPOS -> "22.9570542"
 Parameter: XPHI -> "341.135855"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946288   -0.323325
    0.000000    0.323325    0.946288

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.0963037"
 Parameter: YPOS -> "27.6361449"
 Parameter: ZPOS -> "22.9570542"
 Parameter: YPHI -> "152.568199"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.887560    0.000000   -0.460692
    0.000000    1.000000    0.000000
    0.460692    0.000000   -0.887560

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  152.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.0963037"
 Parameter: YPOS -> "27.6361449"
 Parameter: ZPOS -> "22.9570542"
 Parameter: ZPHI -> "336.173936"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.914776   -0.403961    0.000000
    0.403961    0.914776    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.096304 XMAX =  -55.096304 XAVE =  -55.096304
    YMIN =   27.636145 YMAX =   27.636145 YAVE =   27.636145
    ZMIN =   22.957054 ZMAX =   22.957054 ZAVE =   22.957054
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.0963037"
Evaluating: -55.0963037+3.5
 Parameter: XMAX <- "-51.5963037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.6361449"
Evaluating: 27.6361449+3.5
 Parameter: YMAX <- "31.1361449"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.9570542"
Evaluating: 22.9570542+3.5
 Parameter: ZMAX <- "26.4570542"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.0963037"
Evaluating: -55.0963037-3.5
 Parameter: XMIN <- "-58.5963037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.6361449"
Evaluating: 27.6361449-3.5
 Parameter: YMIN <- "24.1361449"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.9570542"
Evaluating: 22.9570542-3.5
 Parameter: ZMIN <- "19.4570542"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.5963037"
 Parameter: XMIN -> "-58.5963037"
 Parameter: YMAX -> "31.1361449"
 Parameter: YMIN -> "24.1361449"
 Parameter: ZMAX -> "26.4570542"
 Parameter: ZMIN -> "19.4570542"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "194"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "194" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "194"
Evaluating: 194
 Parameter: J <- "194"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "194" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "194"
 Parameter: NPOS -> "117"
Evaluating: 194-117
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.430714137"
Evaluating: 128.065641*(0.430714137-0.5)
 Parameter: XPOS <- "-8.87313846"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.554735521"
Evaluating: 128.065641*(0.554735521-0.5)
 Parameter: YPOS <- "7.00973958"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.863339615"
Evaluating: 108.613069*(0.863339615-0.5)+-2.187274
 Parameter: ZPOS <- "37.2761567"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.2761567" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.2761567" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.87313846"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.87313846-0
 Parameter: XTRAN <- "-8.87313846"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.00973958"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.00973958-0
 Parameter: YTRAN <- "7.00973958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.2761567"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.2761567-0
 Parameter: ZTRAN <- "37.2761567"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.87313846"
 Parameter: YTRAN -> "7.00973958"
 Parameter: ZTRAN -> "37.2761567"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -8.873138    7.009740   37.276157
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77139571"
Evaluating: 0.77139571*360.0
 Parameter: XPHI <- "277.702456"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877249064"
Evaluating: 0.877249064*360.0
 Parameter: YPHI <- "315.809663"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.5011364"
Evaluating: 0.5011364*360.0
 Parameter: ZPHI <- "180.409104"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.87313846"
 Parameter: YPOS -> "7.00973958"
 Parameter: ZPOS -> "37.2761567"
 Parameter: XPHI -> "277.702456"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.134029   -0.990977
    0.000000    0.990977    0.134029

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.87313846"
 Parameter: YPOS -> "7.00973958"
 Parameter: ZPOS -> "37.2761567"
 Parameter: YPHI -> "315.809663"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.717028    0.000000    0.697044
    0.000000    1.000000    0.000000
   -0.697044    0.000000    0.717028

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.87313846"
 Parameter: YPOS -> "7.00973958"
 Parameter: ZPOS -> "37.2761567"
 Parameter: ZPHI -> "180.409104"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.999975   -0.007140    0.000000
    0.007140   -0.999975    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.873138 XMAX =   -8.873138 XAVE =   -8.873138
    YMIN =    7.009740 YMAX =    7.009740 YAVE =    7.009740
    ZMIN =   37.276157 ZMAX =   37.276157 ZAVE =   37.276157
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.87313846"
Evaluating: -8.87313846+3.5
 Parameter: XMAX <- "-5.37313846"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.00973958"
Evaluating: 7.00973958+3.5
 Parameter: YMAX <- "10.5097396"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.2761567"
Evaluating: 37.2761567+3.5
 Parameter: ZMAX <- "40.7761567"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.87313846"
Evaluating: -8.87313846-3.5
 Parameter: XMIN <- "-12.3731385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.00973958"
Evaluating: 7.00973958-3.5
 Parameter: YMIN <- "3.50973958"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.2761567"
Evaluating: 37.2761567-3.5
 Parameter: ZMIN <- "33.7761567"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.37313846"
 Parameter: XMIN -> "-12.3731385"
 Parameter: YMAX -> "10.5097396"
 Parameter: YMIN -> "3.50973958"
 Parameter: ZMAX -> "40.7761567"
 Parameter: ZMIN -> "33.7761567"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "195"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "195" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "195"
Evaluating: 195
 Parameter: J <- "195"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "195" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "195"
 Parameter: NPOS -> "117"
Evaluating: 195-117
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.169955563"
Evaluating: 128.065641*(0.169955563-0.5)
 Parameter: XPOS <- "-42.2673524"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.167699684"
Evaluating: 128.065641*(0.167699684-0.5)
 Parameter: YPOS <- "-42.556253"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.624233692"
Evaluating: 108.613069*(0.624233692-0.5)+-2.187274
 Parameter: ZPOS <- "11.3061286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.3061286" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.3061286" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "195"
Evaluating: 195
 Parameter: J <- "195"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "195" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "195"
 Parameter: NPOS -> "117"
Evaluating: 195-117
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.528136759"
Evaluating: 128.065641*(0.528136759-0.5)
 Parameter: XPOS <- "3.60335208"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.60698122"
Evaluating: 128.065641*(0.60698122-0.5)
 Parameter: YPOS <- "13.7006185"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.726746647"
Evaluating: 108.613069*(0.726746647-0.5)+-2.187274
 Parameter: ZPOS <- "22.4403752"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.4403752" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.4403752" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.60335208"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.60335208-0
 Parameter: XTRAN <- "3.60335208"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.7006185"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.7006185-0
 Parameter: YTRAN <- "13.7006185"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.4403752"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.4403752-0
 Parameter: ZTRAN <- "22.4403752"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.60335208"
 Parameter: YTRAN -> "13.7006185"
 Parameter: ZTRAN -> "22.4403752"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR     3.603352   13.700618   22.440375
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.733497258"
Evaluating: 0.733497258*360.0
 Parameter: XPHI <- "264.059013"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.584947844"
Evaluating: 0.584947844*360.0
 Parameter: YPHI <- "210.581224"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874683297"
Evaluating: 0.874683297*360.0
 Parameter: ZPHI <- "314.885987"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.60335208"
 Parameter: YPOS -> "13.7006185"
 Parameter: ZPOS -> "22.4403752"
 Parameter: XPHI -> "264.059013"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.103504   -0.994629
    0.000000    0.994629   -0.103504

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.60335208"
 Parameter: YPOS -> "13.7006185"
 Parameter: ZPOS -> "22.4403752"
 Parameter: YPHI -> "210.581224"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.860909    0.000000    0.508759
    0.000000    1.000000    0.000000
   -0.508759    0.000000   -0.860909

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  149.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.60335208"
 Parameter: YPOS -> "13.7006185"
 Parameter: ZPOS -> "22.4403752"
 Parameter: ZPHI -> "314.885987"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.705698   -0.708512    0.000000
    0.708512    0.705698    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.603352 XMAX =    3.603352 XAVE =    3.603352
    YMIN =   13.700618 YMAX =   13.700618 YAVE =   13.700618
    ZMIN =   22.440375 ZMAX =   22.440375 ZAVE =   22.440375
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.60335208"
Evaluating: 3.60335208+3.5
 Parameter: XMAX <- "7.10335208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.7006185"
Evaluating: 13.7006185+3.5
 Parameter: YMAX <- "17.2006185"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.4403752"
Evaluating: 22.4403752+3.5
 Parameter: ZMAX <- "25.9403752"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.60335208"
Evaluating: 3.60335208-3.5
 Parameter: XMIN <- "0.10335208"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.7006185"
Evaluating: 13.7006185-3.5
 Parameter: YMIN <- "10.2006185"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.4403752"
Evaluating: 22.4403752-3.5
 Parameter: ZMIN <- "18.9403752"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.10335208"
 Parameter: XMIN -> "0.10335208"
 Parameter: YMAX -> "17.2006185"
 Parameter: YMIN -> "10.2006185"
 Parameter: ZMAX -> "25.9403752"
 Parameter: ZMIN -> "18.9403752"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60427 NEG      CLA      78       CLA     -8165 PROD     GLU      656      OE1           3.4679
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "195"
Evaluating: 195
 Parameter: J <- "195"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "195" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "195"
 Parameter: NPOS -> "117"
Evaluating: 195-117
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.491085234"
Evaluating: 128.065641*(0.491085234-0.5)
 Parameter: XPOS <- "-1.14167522"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.298393551"
Evaluating: 128.065641*(0.298393551-0.5)
 Parameter: YPOS <- "-25.8188591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.796094622"
Evaluating: 108.613069*(0.796094622-0.5)+-2.187274
 Parameter: ZPOS <- "29.9724716"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.9724716" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.9724716" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.603352 XMAX =    3.603352 XAVE =    3.603352
    YMIN =   13.700618 YMAX =   13.700618 YAVE =   13.700618
    ZMIN =   22.440375 ZMAX =   22.440375 ZAVE =   22.440375
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.14167522"
 RDCMND substituted energy or value "?XAVE" to "3.60335208"
Evaluating: -1.14167522-3.60335208
 Parameter: XTRAN <- "-4.7450273"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.8188591"
 RDCMND substituted energy or value "?YAVE" to "13.7006185"
Evaluating: -25.8188591-13.7006185
 Parameter: YTRAN <- "-39.5194776"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.9724716"
 RDCMND substituted energy or value "?ZAVE" to "22.4403752"
Evaluating: 29.9724716-22.4403752
 Parameter: ZTRAN <- "7.5320964"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.7450273"
 Parameter: YTRAN -> "-39.5194776"
 Parameter: ZTRAN -> "7.5320964"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -4.745027  -39.519478    7.532096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481426843"
Evaluating: 0.481426843*360.0
 Parameter: XPHI <- "173.313663"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671441413"
Evaluating: 0.671441413*360.0
 Parameter: YPHI <- "241.718909"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360187771"
Evaluating: 0.360187771*360.0
 Parameter: ZPHI <- "129.667598"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.14167522"
 Parameter: YPOS -> "-25.8188591"
 Parameter: ZPOS -> "29.9724716"
 Parameter: XPHI -> "173.313663"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993198    0.116434
    0.000000   -0.116434   -0.993198

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.14167522"
 Parameter: YPOS -> "-25.8188591"
 Parameter: ZPOS -> "29.9724716"
 Parameter: YPHI -> "241.718909"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.473798    0.000000    0.880634
    0.000000    1.000000    0.000000
   -0.880634    0.000000   -0.473798

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.14167522"
 Parameter: YPOS -> "-25.8188591"
 Parameter: ZPOS -> "29.9724716"
 Parameter: ZPHI -> "129.667598"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.638333    0.769761    0.000000
   -0.769761   -0.638333    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.141675 XMAX =   -1.141675 XAVE =   -1.141675
    YMIN =  -25.818859 YMAX =  -25.818859 YAVE =  -25.818859
    ZMIN =   29.972472 ZMAX =   29.972472 ZAVE =   29.972472
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.14167522"
Evaluating: -1.14167522+3.5
 Parameter: XMAX <- "2.35832478"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.8188591"
Evaluating: -25.8188591+3.5
 Parameter: YMAX <- "-22.3188591"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.9724716"
Evaluating: 29.9724716+3.5
 Parameter: ZMAX <- "33.4724716"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.14167522"
Evaluating: -1.14167522-3.5
 Parameter: XMIN <- "-4.64167522"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.8188591"
Evaluating: -25.8188591-3.5
 Parameter: YMIN <- "-29.3188591"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.9724716"
Evaluating: 29.9724716-3.5
 Parameter: ZMIN <- "26.4724716"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.35832478"
 Parameter: XMIN -> "-4.64167522"
 Parameter: YMAX -> "-22.3188591"
 Parameter: YMIN -> "-29.3188591"
 Parameter: ZMAX -> "33.4724716"
 Parameter: ZMIN -> "26.4724716"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "196"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "196" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "196"
Evaluating: 196
 Parameter: J <- "196"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "196" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "196"
 Parameter: NPOS -> "117"
Evaluating: 196-117
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.648751948"
Evaluating: 128.065641*(0.648751948-0.5)
 Parameter: XPOS <- "19.0500136"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.249091254"
Evaluating: 128.065641*(0.249091254-0.5)
 Parameter: YPOS <- "-32.1327894"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.255861329"
Evaluating: 108.613069*(0.255861329-0.5)+-2.187274
 Parameter: ZPOS <- "-28.7039243"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.7039243" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.0500136"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.0500136-0
 Parameter: XTRAN <- "19.0500136"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.1327894"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.1327894-0
 Parameter: YTRAN <- "-32.1327894"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.7039243"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.7039243-0
 Parameter: ZTRAN <- "-28.7039243"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.0500136"
 Parameter: YTRAN -> "-32.1327894"
 Parameter: ZTRAN -> "-28.7039243"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    19.050014  -32.132789  -28.703924
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426720849"
Evaluating: 0.426720849*360.0
 Parameter: XPHI <- "153.619506"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976997223"
Evaluating: 0.976997223*360.0
 Parameter: YPHI <- "351.719"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483097934"
Evaluating: 0.483097934*360.0
 Parameter: ZPHI <- "173.915256"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.0500136"
 Parameter: YPOS -> "-32.1327894"
 Parameter: ZPOS -> "-28.7039243"
 Parameter: XPHI -> "153.619506"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.895863    0.444330
    0.000000   -0.444330   -0.895863

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.0500136"
 Parameter: YPOS -> "-32.1327894"
 Parameter: ZPOS -> "-28.7039243"
 Parameter: YPHI -> "351.719"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.989574    0.000000    0.144028
    0.000000    1.000000    0.000000
   -0.144028    0.000000    0.989574

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.0500136"
 Parameter: YPOS -> "-32.1327894"
 Parameter: ZPOS -> "-28.7039243"
 Parameter: ZPHI -> "173.915256"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.994366    0.105999    0.000000
   -0.105999   -0.994366    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.050014 XMAX =   19.050014 XAVE =   19.050014
    YMIN =  -32.132789 YMAX =  -32.132789 YAVE =  -32.132789
    ZMIN =  -28.703924 ZMAX =  -28.703924 ZAVE =  -28.703924
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.0500136"
Evaluating: 19.0500136+3.5
 Parameter: XMAX <- "22.5500136"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.1327894"
Evaluating: -32.1327894+3.5
 Parameter: YMAX <- "-28.6327894"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.7039243"
Evaluating: -28.7039243+3.5
 Parameter: ZMAX <- "-25.2039243"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.0500136"
Evaluating: 19.0500136-3.5
 Parameter: XMIN <- "15.5500136"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.1327894"
Evaluating: -32.1327894-3.5
 Parameter: YMIN <- "-35.6327894"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.7039243"
Evaluating: -28.7039243-3.5
 Parameter: ZMIN <- "-32.2039243"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.5500136"
 Parameter: XMIN -> "15.5500136"
 Parameter: YMAX -> "-28.6327894"
 Parameter: YMIN -> "-35.6327894"
 Parameter: ZMAX -> "-25.2039243"
 Parameter: ZMIN -> "-32.2039243"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "197"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "197" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "197"
Evaluating: 197
 Parameter: J <- "197"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "197" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "197"
 Parameter: NPOS -> "117"
Evaluating: 197-117
 Parameter: J <- "80"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.859386976"
Evaluating: 128.065641*(0.859386976-0.5)
 Parameter: XPOS <- "46.0251234"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.518213355"
Evaluating: 128.065641*(0.518213355-0.5)
 Parameter: YPOS <- "2.33250498"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.237993535"
Evaluating: 108.613069*(0.237993535-0.5)+-2.187274
 Parameter: ZPOS <- "-30.6446003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.6446003" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0251234"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.0251234-0
 Parameter: XTRAN <- "46.0251234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.33250498"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.33250498-0
 Parameter: YTRAN <- "2.33250498"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.6446003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.6446003-0
 Parameter: ZTRAN <- "-30.6446003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.0251234"
 Parameter: YTRAN -> "2.33250498"
 Parameter: ZTRAN -> "-30.6446003"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    46.025123    2.332505  -30.644600
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748582088"
Evaluating: 0.748582088*360.0
 Parameter: XPHI <- "269.489552"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.455775513E-03"
Evaluating: 7.455775513E-03*360.0
 Parameter: YPHI <- "2.68407918"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.845965344"
Evaluating: 0.845965344*360.0
 Parameter: ZPHI <- "304.547524"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0251234"
 Parameter: YPOS -> "2.33250498"
 Parameter: ZPOS -> "-30.6446003"
 Parameter: XPHI -> "269.489552"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.008909   -0.999960
    0.000000    0.999960   -0.008909

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0251234"
 Parameter: YPOS -> "2.33250498"
 Parameter: ZPOS -> "-30.6446003"
 Parameter: YPHI -> "2.68407918"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.998903    0.000000   -0.046829
    0.000000    1.000000    0.000000
    0.046829    0.000000    0.998903

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0251234"
 Parameter: YPOS -> "2.33250498"
 Parameter: ZPOS -> "-30.6446003"
 Parameter: ZPHI -> "304.547524"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.567090   -0.823656    0.000000
    0.823656    0.567090    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.025123 XMAX =   46.025123 XAVE =   46.025123
    YMIN =    2.332505 YMAX =    2.332505 YAVE =    2.332505
    ZMIN =  -30.644600 ZMAX =  -30.644600 ZAVE =  -30.644600
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0251234"
Evaluating: 46.0251234+3.5
 Parameter: XMAX <- "49.5251234"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.33250498"
Evaluating: 2.33250498+3.5
 Parameter: YMAX <- "5.83250498"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.6446003"
Evaluating: -30.6446003+3.5
 Parameter: ZMAX <- "-27.1446003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0251234"
Evaluating: 46.0251234-3.5
 Parameter: XMIN <- "42.5251234"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.33250498"
Evaluating: 2.33250498-3.5
 Parameter: YMIN <- "-1.16749502"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.6446003"
Evaluating: -30.6446003-3.5
 Parameter: ZMIN <- "-34.1446003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5251234"
 Parameter: XMIN -> "42.5251234"
 Parameter: YMAX -> "5.83250498"
 Parameter: YMIN -> "-1.16749502"
 Parameter: ZMAX -> "-27.1446003"
 Parameter: ZMIN -> "-34.1446003"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "198"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "198" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "198"
Evaluating: 198
 Parameter: J <- "198"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "198" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "198"
 Parameter: NPOS -> "117"
Evaluating: 198-117
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.32772191"
Evaluating: 128.065641*(0.32772191-0.5)
 Parameter: XPOS <- "-22.062904"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.749789659"
Evaluating: 128.065641*(0.749789659-0.5)
 Parameter: YPOS <- "31.9894728"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "9.769258526E-02"
Evaluating: 108.613069*(9.769258526E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-45.883117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.883117" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.062904"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.062904-0
 Parameter: XTRAN <- "-22.062904"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.9894728"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.9894728-0
 Parameter: YTRAN <- "31.9894728"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.883117"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.883117-0
 Parameter: ZTRAN <- "-45.883117"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.062904"
 Parameter: YTRAN -> "31.9894728"
 Parameter: ZTRAN -> "-45.883117"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.062904   31.989473  -45.883117
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123495828"
Evaluating: 0.123495828*360.0
 Parameter: XPHI <- "44.4584981"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.651229433E-02"
Evaluating: 3.651229433E-02*360.0
 Parameter: YPHI <- "13.144426"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.841960029E-02"
Evaluating: 2.841960029E-02*360.0
 Parameter: ZPHI <- "10.2310561"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.062904"
 Parameter: YPOS -> "31.9894728"
 Parameter: ZPOS -> "-45.883117"
 Parameter: XPHI -> "44.4584981"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.713758    0.700392
    0.000000   -0.700392    0.713758

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.062904"
 Parameter: YPOS -> "31.9894728"
 Parameter: ZPOS -> "-45.883117"
 Parameter: YPHI -> "13.144426"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.973800    0.000000   -0.227406
    0.000000    1.000000    0.000000
    0.227406    0.000000    0.973800

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.062904"
 Parameter: YPOS -> "31.9894728"
 Parameter: ZPOS -> "-45.883117"
 Parameter: ZPHI -> "10.2310561"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.984099    0.177618    0.000000
   -0.177618    0.984099    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   10.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.062904 XMAX =  -22.062904 XAVE =  -22.062904
    YMIN =   31.989473 YMAX =   31.989473 YAVE =   31.989473
    ZMIN =  -45.883117 ZMAX =  -45.883117 ZAVE =  -45.883117
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.062904"
Evaluating: -22.062904+3.5
 Parameter: XMAX <- "-18.562904"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.9894728"
Evaluating: 31.9894728+3.5
 Parameter: YMAX <- "35.4894728"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.883117"
Evaluating: -45.883117+3.5
 Parameter: ZMAX <- "-42.383117"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.062904"
Evaluating: -22.062904-3.5
 Parameter: XMIN <- "-25.562904"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.9894728"
Evaluating: 31.9894728-3.5
 Parameter: YMIN <- "28.4894728"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.883117"
Evaluating: -45.883117-3.5
 Parameter: ZMIN <- "-49.383117"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.562904"
 Parameter: XMIN -> "-25.562904"
 Parameter: YMAX -> "35.4894728"
 Parameter: YMIN -> "28.4894728"
 Parameter: ZMAX -> "-42.383117"
 Parameter: ZMIN -> "-49.383117"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "199"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "199" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "199"
Evaluating: 199
 Parameter: J <- "199"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "199" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "199"
 Parameter: NPOS -> "117"
Evaluating: 199-117
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.775088781"
Evaluating: 128.065641*(0.775088781-0.5)
 Parameter: XPOS <- "35.2294211"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.610798846"
Evaluating: 128.065641*(0.610798846-0.5)
 Parameter: YPOS <- "14.1895252"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.528678338"
Evaluating: 108.613069*(0.528678338-0.5)+-2.187274
 Parameter: ZPOS <- "0.927568304"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.927568304" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.927568304" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "199"
Evaluating: 199
 Parameter: J <- "199"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "199" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "199"
 Parameter: NPOS -> "117"
Evaluating: 199-117
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.806901972"
Evaluating: 128.065641*(0.806901972-0.5)
 Parameter: XPOS <- "39.3035978"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.428695336"
Evaluating: 128.065641*(0.428695336-0.5)
 Parameter: YPOS <- "-9.1316775"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "2.460625258E-02"
Evaluating: 108.613069*(2.460625258E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-53.8212479"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.8212479" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.3035978"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.3035978-0
 Parameter: XTRAN <- "39.3035978"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.1316775"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.1316775-0
 Parameter: YTRAN <- "-9.1316775"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.8212479"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.8212479-0
 Parameter: ZTRAN <- "-53.8212479"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.3035978"
 Parameter: YTRAN -> "-9.1316775"
 Parameter: ZTRAN -> "-53.8212479"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    39.303598   -9.131678  -53.821248
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.199183712E-02"
Evaluating: 9.199183712E-02*360.0
 Parameter: XPHI <- "33.1170614"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895027249"
Evaluating: 0.895027249*360.0
 Parameter: YPHI <- "322.20981"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.643512981E-03"
Evaluating: 4.643512981E-03*360.0
 Parameter: ZPHI <- "1.67166467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.3035978"
 Parameter: YPOS -> "-9.1316775"
 Parameter: ZPOS -> "-53.8212479"
 Parameter: XPHI -> "33.1170614"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.837556    0.546351
    0.000000   -0.546351    0.837556

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.3035978"
 Parameter: YPOS -> "-9.1316775"
 Parameter: ZPOS -> "-53.8212479"
 Parameter: YPHI -> "322.20981"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.790260    0.000000    0.612772
    0.000000    1.000000    0.000000
   -0.612772    0.000000    0.790260

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.3035978"
 Parameter: YPOS -> "-9.1316775"
 Parameter: ZPOS -> "-53.8212479"
 Parameter: ZPHI -> "1.67166467"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999574    0.029172    0.000000
   -0.029172    0.999574    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    1.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.303598 XMAX =   39.303598 XAVE =   39.303598
    YMIN =   -9.131678 YMAX =   -9.131678 YAVE =   -9.131678
    ZMIN =  -53.821248 ZMAX =  -53.821248 ZAVE =  -53.821248
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.3035978"
Evaluating: 39.3035978+3.5
 Parameter: XMAX <- "42.8035978"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.1316775"
Evaluating: -9.1316775+3.5
 Parameter: YMAX <- "-5.6316775"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.8212479"
Evaluating: -53.8212479+3.5
 Parameter: ZMAX <- "-50.3212479"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.3035978"
Evaluating: 39.3035978-3.5
 Parameter: XMIN <- "35.8035978"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.1316775"
Evaluating: -9.1316775-3.5
 Parameter: YMIN <- "-12.6316775"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.8212479"
Evaluating: -53.8212479-3.5
 Parameter: ZMIN <- "-57.3212479"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.8035978"
 Parameter: XMIN -> "35.8035978"
 Parameter: YMAX -> "-5.6316775"
 Parameter: YMIN -> "-12.6316775"
 Parameter: ZMAX -> "-50.3212479"
 Parameter: ZMIN -> "-57.3212479"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "200"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "200" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "200"
Evaluating: 200
 Parameter: J <- "200"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "200" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "200"
 Parameter: NPOS -> "117"
Evaluating: 200-117
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.615654769"
Evaluating: 128.065641*(0.615654769-0.5)
 Parameter: XPOS <- "14.8114021"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.625561783"
Evaluating: 128.065641*(0.625561783-0.5)
 Parameter: YPOS <- "16.0801502"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.948117264"
Evaluating: 108.613069*(0.948117264-0.5)+-2.187274
 Parameter: ZPOS <- "46.4841173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.4841173" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.4841173" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.8114021"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.8114021-0
 Parameter: XTRAN <- "14.8114021"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.0801502"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.0801502-0
 Parameter: YTRAN <- "16.0801502"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.4841173"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.4841173-0
 Parameter: ZTRAN <- "46.4841173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.8114021"
 Parameter: YTRAN -> "16.0801502"
 Parameter: ZTRAN -> "46.4841173"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    14.811402   16.080150   46.484117
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.725700438"
Evaluating: 0.725700438*360.0
 Parameter: XPHI <- "261.252158"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281254641"
Evaluating: 0.281254641*360.0
 Parameter: YPHI <- "101.251671"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.996189904"
Evaluating: 0.996189904*360.0
 Parameter: ZPHI <- "358.628365"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.8114021"
 Parameter: YPOS -> "16.0801502"
 Parameter: ZPOS -> "46.4841173"
 Parameter: XPHI -> "261.252158"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.152086   -0.988367
    0.000000    0.988367   -0.152086

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.8114021"
 Parameter: YPOS -> "16.0801502"
 Parameter: ZPOS -> "46.4841173"
 Parameter: YPHI -> "101.251671"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.195119    0.000000   -0.980780
    0.000000    1.000000    0.000000
    0.980780    0.000000   -0.195119

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.8114021"
 Parameter: YPOS -> "16.0801502"
 Parameter: ZPOS -> "46.4841173"
 Parameter: ZPHI -> "358.628365"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.999713   -0.023937    0.000000
    0.023937    0.999713    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.811402 XMAX =   14.811402 XAVE =   14.811402
    YMIN =   16.080150 YMAX =   16.080150 YAVE =   16.080150
    ZMIN =   46.484117 ZMAX =   46.484117 ZAVE =   46.484117
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.8114021"
Evaluating: 14.8114021+3.5
 Parameter: XMAX <- "18.3114021"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.0801502"
Evaluating: 16.0801502+3.5
 Parameter: YMAX <- "19.5801502"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.4841173"
Evaluating: 46.4841173+3.5
 Parameter: ZMAX <- "49.9841173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.8114021"
Evaluating: 14.8114021-3.5
 Parameter: XMIN <- "11.3114021"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.0801502"
Evaluating: 16.0801502-3.5
 Parameter: YMIN <- "12.5801502"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.4841173"
Evaluating: 46.4841173-3.5
 Parameter: ZMIN <- "42.9841173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.3114021"
 Parameter: XMIN -> "11.3114021"
 Parameter: YMAX -> "19.5801502"
 Parameter: YMIN -> "12.5801502"
 Parameter: ZMAX -> "49.9841173"
 Parameter: ZMIN -> "42.9841173"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "201"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "201" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "201" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "117"
Evaluating: 201-117
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.440153874"
Evaluating: 128.065641*(0.440153874-0.5)
 Parameter: XPOS <- "-7.66423249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.761726035"
Evaluating: 128.065641*(0.761726035-0.5)
 Parameter: YPOS <- "33.5181124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "8.219314816E-02"
Evaluating: 108.613069*(8.219314816E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-47.5665584"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.5665584" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.66423249"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.66423249-0
 Parameter: XTRAN <- "-7.66423249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.5181124"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.5181124-0
 Parameter: YTRAN <- "33.5181124"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.5665584"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.5665584-0
 Parameter: ZTRAN <- "-47.5665584"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.66423249"
 Parameter: YTRAN -> "33.5181124"
 Parameter: ZTRAN -> "-47.5665584"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.664232   33.518112  -47.566558
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.703124028"
Evaluating: 0.703124028*360.0
 Parameter: XPHI <- "253.12465"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518123287"
Evaluating: 0.518123287*360.0
 Parameter: YPHI <- "186.524383"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915558538"
Evaluating: 0.915558538*360.0
 Parameter: ZPHI <- "329.601074"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.66423249"
 Parameter: YPOS -> "33.5181124"
 Parameter: ZPOS -> "-47.5665584"
 Parameter: XPHI -> "253.12465"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.290291   -0.956939
    0.000000    0.956939   -0.290291

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.66423249"
 Parameter: YPOS -> "33.5181124"
 Parameter: ZPOS -> "-47.5665584"
 Parameter: YPHI -> "186.524383"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.993524    0.000000    0.113626
    0.000000    1.000000    0.000000
   -0.113626    0.000000   -0.993524

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.66423249"
 Parameter: YPOS -> "33.5181124"
 Parameter: ZPOS -> "-47.5665584"
 Parameter: ZPHI -> "329.601074"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.862523   -0.506018    0.000000
    0.506018    0.862523    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.664232 XMAX =   -7.664232 XAVE =   -7.664232
    YMIN =   33.518112 YMAX =   33.518112 YAVE =   33.518112
    ZMIN =  -47.566558 ZMAX =  -47.566558 ZAVE =  -47.566558
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.66423249"
Evaluating: -7.66423249+3.5
 Parameter: XMAX <- "-4.16423249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.5181124"
Evaluating: 33.5181124+3.5
 Parameter: YMAX <- "37.0181124"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.5665584"
Evaluating: -47.5665584+3.5
 Parameter: ZMAX <- "-44.0665584"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.66423249"
Evaluating: -7.66423249-3.5
 Parameter: XMIN <- "-11.1642325"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.5181124"
Evaluating: 33.5181124-3.5
 Parameter: YMIN <- "30.0181124"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.5665584"
Evaluating: -47.5665584-3.5
 Parameter: ZMIN <- "-51.0665584"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.16423249"
 Parameter: XMIN -> "-11.1642325"
 Parameter: YMAX -> "37.0181124"
 Parameter: YMIN -> "30.0181124"
 Parameter: ZMAX -> "-44.0665584"
 Parameter: ZMIN -> "-51.0665584"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "202"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "202" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "202" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "117"
Evaluating: 202-117
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.912825133"
Evaluating: 128.065641*(0.912825133-0.5)
 Parameter: XPOS <- "52.8687153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.408483321"
Evaluating: 128.065641*(0.408483321-0.5)
 Parameter: YPOS <- "-11.7201422"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.167344143"
Evaluating: 108.613069*(0.167344143-0.5)+-2.187274
 Parameter: ZPOS <- "-38.3180475"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.3180475" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.8687153"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.8687153-0
 Parameter: XTRAN <- "52.8687153"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.7201422"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.7201422-0
 Parameter: YTRAN <- "-11.7201422"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.3180475"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.3180475-0
 Parameter: ZTRAN <- "-38.3180475"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.8687153"
 Parameter: YTRAN -> "-11.7201422"
 Parameter: ZTRAN -> "-38.3180475"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    52.868715  -11.720142  -38.318047
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.294399785"
Evaluating: 0.294399785*360.0
 Parameter: XPHI <- "105.983923"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193983957"
Evaluating: 0.193983957*360.0
 Parameter: YPHI <- "69.8342245"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236235555"
Evaluating: 0.236235555*360.0
 Parameter: ZPHI <- "85.0447998"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.8687153"
 Parameter: YPOS -> "-11.7201422"
 Parameter: ZPOS -> "-38.3180475"
 Parameter: XPHI -> "105.983923"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.275368    0.961339
    0.000000   -0.961339   -0.275368

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.8687153"
 Parameter: YPOS -> "-11.7201422"
 Parameter: ZPOS -> "-38.3180475"
 Parameter: YPHI -> "69.8342245"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.344738    0.000000   -0.938699
    0.000000    1.000000    0.000000
    0.938699    0.000000    0.344738

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.8687153"
 Parameter: YPOS -> "-11.7201422"
 Parameter: ZPOS -> "-38.3180475"
 Parameter: ZPHI -> "85.0447998"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.086377    0.996263    0.000000
   -0.996263    0.086377    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.868715 XMAX =   52.868715 XAVE =   52.868715
    YMIN =  -11.720142 YMAX =  -11.720142 YAVE =  -11.720142
    ZMIN =  -38.318047 ZMAX =  -38.318047 ZAVE =  -38.318047
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.8687153"
Evaluating: 52.8687153+3.5
 Parameter: XMAX <- "56.3687153"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.7201422"
Evaluating: -11.7201422+3.5
 Parameter: YMAX <- "-8.2201422"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.3180475"
Evaluating: -38.3180475+3.5
 Parameter: ZMAX <- "-34.8180475"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.8687153"
Evaluating: 52.8687153-3.5
 Parameter: XMIN <- "49.3687153"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.7201422"
Evaluating: -11.7201422-3.5
 Parameter: YMIN <- "-15.2201422"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.3180475"
Evaluating: -38.3180475-3.5
 Parameter: ZMIN <- "-41.8180475"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.3687153"
 Parameter: XMIN -> "49.3687153"
 Parameter: YMAX -> "-8.2201422"
 Parameter: YMIN -> "-15.2201422"
 Parameter: ZMAX -> "-34.8180475"
 Parameter: ZMIN -> "-41.8180475"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "203"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "203" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "203"
Evaluating: 203
 Parameter: J <- "203"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "203" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "203"
 Parameter: NPOS -> "117"
Evaluating: 203-117
 Parameter: J <- "86"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.3877389"
Evaluating: 128.065641*(0.3877389-0.5)
 Parameter: XPOS <- "-14.3767897"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "5.118612719E-02"
Evaluating: 128.065641*(5.118612719E-02-0.5)
 Parameter: YPOS <- "-57.4776363"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.942720393"
Evaluating: 108.613069*(0.942720393-0.5)+-2.187274
 Parameter: ZPOS <- "45.8979466"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8979466" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8979466" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.3767897"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.3767897-0
 Parameter: XTRAN <- "-14.3767897"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.4776363"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -57.4776363-0
 Parameter: YTRAN <- "-57.4776363"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8979466"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.8979466-0
 Parameter: ZTRAN <- "45.8979466"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.3767897"
 Parameter: YTRAN -> "-57.4776363"
 Parameter: ZTRAN -> "45.8979466"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -14.376790  -57.477636   45.897947
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834741665"
Evaluating: 0.834741665*360.0
 Parameter: XPHI <- "300.506999"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.32696264"
Evaluating: 0.32696264*360.0
 Parameter: YPHI <- "117.70655"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203741958"
Evaluating: 0.203741958*360.0
 Parameter: ZPHI <- "73.3471049"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.3767897"
 Parameter: YPOS -> "-57.4776363"
 Parameter: ZPOS -> "45.8979466"
 Parameter: XPHI -> "300.506999"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.507644   -0.861567
    0.000000    0.861567    0.507644

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.3767897"
 Parameter: YPOS -> "-57.4776363"
 Parameter: ZPOS -> "45.8979466"
 Parameter: YPHI -> "117.70655"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.464943    0.000000   -0.885340
    0.000000    1.000000    0.000000
    0.885340    0.000000   -0.464943

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.3767897"
 Parameter: YPOS -> "-57.4776363"
 Parameter: ZPOS -> "45.8979466"
 Parameter: ZPHI -> "73.3471049"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.286573    0.958058    0.000000
   -0.958058    0.286573    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.376790 XMAX =  -14.376790 XAVE =  -14.376790
    YMIN =  -57.477636 YMAX =  -57.477636 YAVE =  -57.477636
    ZMIN =   45.897947 ZMAX =   45.897947 ZAVE =   45.897947
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.3767897"
Evaluating: -14.3767897+3.5
 Parameter: XMAX <- "-10.8767897"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.4776363"
Evaluating: -57.4776363+3.5
 Parameter: YMAX <- "-53.9776363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8979466"
Evaluating: 45.8979466+3.5
 Parameter: ZMAX <- "49.3979466"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.3767897"
Evaluating: -14.3767897-3.5
 Parameter: XMIN <- "-17.8767897"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.4776363"
Evaluating: -57.4776363-3.5
 Parameter: YMIN <- "-60.9776363"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8979466"
Evaluating: 45.8979466-3.5
 Parameter: ZMIN <- "42.3979466"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.8767897"
 Parameter: XMIN -> "-17.8767897"
 Parameter: YMAX -> "-53.9776363"
 Parameter: YMIN -> "-60.9776363"
 Parameter: ZMAX -> "49.3979466"
 Parameter: ZMIN -> "42.3979466"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "204"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "204" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "204"
Evaluating: 204
 Parameter: J <- "204"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "204" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "204"
 Parameter: NPOS -> "117"
Evaluating: 204-117
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.449059975"
Evaluating: 128.065641*(0.449059975-0.5)
 Parameter: XPOS <- "-6.52366695"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.495967682"
Evaluating: 128.065641*(0.495967682-0.5)
 Parameter: YPOS <- "-0.516401389"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.819104938"
Evaluating: 108.613069*(0.819104938-0.5)+-2.187274
 Parameter: ZPOS <- "32.4716926"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.4716926" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.4716926" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.52366695"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.52366695-0
 Parameter: XTRAN <- "-6.52366695"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.516401389"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.516401389-0
 Parameter: YTRAN <- "-0.516401389"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.4716926"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.4716926-0
 Parameter: ZTRAN <- "32.4716926"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.52366695"
 Parameter: YTRAN -> "-0.516401389"
 Parameter: ZTRAN -> "32.4716926"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -6.523667   -0.516401   32.471693
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.911377599"
Evaluating: 0.911377599*360.0
 Parameter: XPHI <- "328.095936"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636973929"
Evaluating: 0.636973929*360.0
 Parameter: YPHI <- "229.310614"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634141341"
Evaluating: 0.634141341*360.0
 Parameter: ZPHI <- "228.290883"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.52366695"
 Parameter: YPOS -> "-0.516401389"
 Parameter: ZPOS -> "32.4716926"
 Parameter: XPHI -> "328.095936"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.848934   -0.528499
    0.000000    0.528499    0.848934

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.52366695"
 Parameter: YPOS -> "-0.516401389"
 Parameter: ZPOS -> "32.4716926"
 Parameter: YPHI -> "229.310614"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.651958    0.000000    0.758255
    0.000000    1.000000    0.000000
   -0.758255    0.000000   -0.651958

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  130.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.52366695"
 Parameter: YPOS -> "-0.516401389"
 Parameter: ZPOS -> "32.4716926"
 Parameter: ZPHI -> "228.290883"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.665349   -0.746532    0.000000
    0.746532   -0.665349    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.523667 XMAX =   -6.523667 XAVE =   -6.523667
    YMIN =   -0.516401 YMAX =   -0.516401 YAVE =   -0.516401
    ZMIN =   32.471693 ZMAX =   32.471693 ZAVE =   32.471693
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.52366695"
Evaluating: -6.52366695+3.5
 Parameter: XMAX <- "-3.02366695"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.516401389"
Evaluating: -0.516401389+3.5
 Parameter: YMAX <- "2.98359861"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.4716926"
Evaluating: 32.4716926+3.5
 Parameter: ZMAX <- "35.9716926"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.52366695"
Evaluating: -6.52366695-3.5
 Parameter: XMIN <- "-10.0236669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.516401389"
Evaluating: -0.516401389-3.5
 Parameter: YMIN <- "-4.01640139"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.4716926"
Evaluating: 32.4716926-3.5
 Parameter: ZMIN <- "28.9716926"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.02366695"
 Parameter: XMIN -> "-10.0236669"
 Parameter: YMAX -> "2.98359861"
 Parameter: YMIN -> "-4.01640139"
 Parameter: ZMAX -> "35.9716926"
 Parameter: ZMIN -> "28.9716926"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "205"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "205" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "205"
Evaluating: 205
 Parameter: J <- "205"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "205" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "205"
 Parameter: NPOS -> "117"
Evaluating: 205-117
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.157693204"
Evaluating: 128.065641*(0.157693204-0.5)
 Parameter: XPOS <- "-43.8377392"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.760798776"
Evaluating: 128.065641*(0.760798776-0.5)
 Parameter: YPOS <- "33.3993624"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.23771441"
Evaluating: 108.613069*(0.23771441-0.5)+-2.187274
 Parameter: ZPOS <- "-30.6749169"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.6749169" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.8377392"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.8377392-0
 Parameter: XTRAN <- "-43.8377392"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.3993624"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.3993624-0
 Parameter: YTRAN <- "33.3993624"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.6749169"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.6749169-0
 Parameter: ZTRAN <- "-30.6749169"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.8377392"
 Parameter: YTRAN -> "33.3993624"
 Parameter: ZTRAN -> "-30.6749169"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -43.837739   33.399362  -30.674917
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518831829"
Evaluating: 0.518831829*360.0
 Parameter: XPHI <- "186.779458"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915423788"
Evaluating: 0.915423788*360.0
 Parameter: YPHI <- "329.552564"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762173232"
Evaluating: 0.762173232*360.0
 Parameter: ZPHI <- "274.382364"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.8377392"
 Parameter: YPOS -> "33.3993624"
 Parameter: ZPOS -> "-30.6749169"
 Parameter: XPHI -> "186.779458"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993008   -0.118048
    0.000000    0.118048   -0.993008

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  173.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.8377392"
 Parameter: YPOS -> "33.3993624"
 Parameter: ZPOS -> "-30.6749169"
 Parameter: YPHI -> "329.552564"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.862094    0.000000    0.506748
    0.000000    1.000000    0.000000
   -0.506748    0.000000    0.862094

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   30.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.8377392"
 Parameter: YPOS -> "33.3993624"
 Parameter: ZPOS -> "-30.6749169"
 Parameter: ZPHI -> "274.382364"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.076412   -0.997076    0.000000
    0.997076    0.076412    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   85.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.837739 XMAX =  -43.837739 XAVE =  -43.837739
    YMIN =   33.399362 YMAX =   33.399362 YAVE =   33.399362
    ZMIN =  -30.674917 ZMAX =  -30.674917 ZAVE =  -30.674917
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.8377392"
Evaluating: -43.8377392+3.5
 Parameter: XMAX <- "-40.3377392"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.3993624"
Evaluating: 33.3993624+3.5
 Parameter: YMAX <- "36.8993624"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.6749169"
Evaluating: -30.6749169+3.5
 Parameter: ZMAX <- "-27.1749169"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.8377392"
Evaluating: -43.8377392-3.5
 Parameter: XMIN <- "-47.3377392"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.3993624"
Evaluating: 33.3993624-3.5
 Parameter: YMIN <- "29.8993624"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.6749169"
Evaluating: -30.6749169-3.5
 Parameter: ZMIN <- "-34.1749169"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.3377392"
 Parameter: XMIN -> "-47.3377392"
 Parameter: YMAX -> "36.8993624"
 Parameter: YMIN -> "29.8993624"
 Parameter: ZMAX -> "-27.1749169"
 Parameter: ZMIN -> "-34.1749169"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "206"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "206" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "206"
Evaluating: 206
 Parameter: J <- "206"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "206" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "206"
 Parameter: NPOS -> "117"
Evaluating: 206-117
 Parameter: J <- "89"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.745271668"
Evaluating: 128.065641*(0.745271668-0.5)
 Parameter: XPOS <- "31.4108734"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.553982227"
Evaluating: 128.065641*(0.553982227-0.5)
 Parameter: YPOS <- "6.9132685"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.929190988"
Evaluating: 108.613069*(0.929190988-0.5)+-2.187274
 Parameter: ZPOS <- "44.4284764"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.4284764" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.4284764" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.4108734"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.4108734-0
 Parameter: XTRAN <- "31.4108734"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.9132685"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.9132685-0
 Parameter: YTRAN <- "6.9132685"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.4284764"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.4284764-0
 Parameter: ZTRAN <- "44.4284764"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.4108734"
 Parameter: YTRAN -> "6.9132685"
 Parameter: ZTRAN -> "44.4284764"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    31.410873    6.913269   44.428476
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624588748"
Evaluating: 0.624588748*360.0
 Parameter: XPHI <- "224.851949"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.799822058E-02"
Evaluating: 4.799822058E-02*360.0
 Parameter: YPHI <- "17.2793594"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833271588"
Evaluating: 0.833271588*360.0
 Parameter: ZPHI <- "299.977772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.4108734"
 Parameter: YPOS -> "6.9132685"
 Parameter: ZPOS -> "44.4284764"
 Parameter: XPHI -> "224.851949"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.708932   -0.705277
    0.000000    0.705277   -0.708932

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.4108734"
 Parameter: YPOS -> "6.9132685"
 Parameter: ZPOS -> "44.4284764"
 Parameter: YPHI -> "17.2793594"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.954868    0.000000   -0.297031
    0.000000    1.000000    0.000000
    0.297031    0.000000    0.954868

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.4108734"
 Parameter: YPOS -> "6.9132685"
 Parameter: ZPOS -> "44.4284764"
 Parameter: ZPHI -> "299.977772"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.499664   -0.866219    0.000000
    0.866219    0.499664    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.410873 XMAX =   31.410873 XAVE =   31.410873
    YMIN =    6.913269 YMAX =    6.913269 YAVE =    6.913269
    ZMIN =   44.428476 ZMAX =   44.428476 ZAVE =   44.428476
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.4108734"
Evaluating: 31.4108734+3.5
 Parameter: XMAX <- "34.9108734"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.9132685"
Evaluating: 6.9132685+3.5
 Parameter: YMAX <- "10.4132685"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.4284764"
Evaluating: 44.4284764+3.5
 Parameter: ZMAX <- "47.9284764"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.4108734"
Evaluating: 31.4108734-3.5
 Parameter: XMIN <- "27.9108734"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.9132685"
Evaluating: 6.9132685-3.5
 Parameter: YMIN <- "3.4132685"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.4284764"
Evaluating: 44.4284764-3.5
 Parameter: ZMIN <- "40.9284764"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.9108734"
 Parameter: XMIN -> "27.9108734"
 Parameter: YMAX -> "10.4132685"
 Parameter: YMIN -> "3.4132685"
 Parameter: ZMAX -> "47.9284764"
 Parameter: ZMIN -> "40.9284764"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "207"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "207" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "207" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "117"
Evaluating: 207-117
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.734755014"
Evaluating: 128.065641*(0.734755014-0.5)
 Parameter: XPOS <- "30.0640513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.727129487"
Evaluating: 128.065641*(0.727129487-0.5)
 Parameter: YPOS <- "29.0874833"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.566172399"
Evaluating: 108.613069*(0.566172399-0.5)+-2.187274
 Parameter: ZPOS <- "4.99991334"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.99991334" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.99991334" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "207" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "117"
Evaluating: 207-117
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.480429634"
Evaluating: 128.065641*(0.480429634-0.5)
 Parameter: XPOS <- "-2.50629147"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.566687918"
Evaluating: 128.065641*(0.566687918-0.5)
 Parameter: YPOS <- "8.54043097"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.734673042"
Evaluating: 108.613069*(0.734673042-0.5)+-2.187274
 Parameter: ZPOS <- "23.3012853"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.3012853" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.3012853" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.50629147"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.50629147-0
 Parameter: XTRAN <- "-2.50629147"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.54043097"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.54043097-0
 Parameter: YTRAN <- "8.54043097"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.3012853"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.3012853-0
 Parameter: ZTRAN <- "23.3012853"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.50629147"
 Parameter: YTRAN -> "8.54043097"
 Parameter: ZTRAN -> "23.3012853"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -2.506291    8.540431   23.301285
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297087286"
Evaluating: 0.297087286*360.0
 Parameter: XPHI <- "106.951423"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918002481"
Evaluating: 0.918002481*360.0
 Parameter: YPHI <- "330.480893"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.663030788"
Evaluating: 0.663030788*360.0
 Parameter: ZPHI <- "238.691084"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.50629147"
 Parameter: YPOS -> "8.54043097"
 Parameter: ZPOS -> "23.3012853"
 Parameter: XPHI -> "106.951423"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.291561    0.956552
    0.000000   -0.956552   -0.291561

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  106.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.50629147"
 Parameter: YPOS -> "8.54043097"
 Parameter: ZPOS -> "23.3012853"
 Parameter: YPHI -> "330.480893"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.870191    0.000000    0.492714
    0.000000    1.000000    0.000000
   -0.492714    0.000000    0.870191

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.50629147"
 Parameter: YPOS -> "8.54043097"
 Parameter: ZPOS -> "23.3012853"
 Parameter: ZPHI -> "238.691084"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.519652   -0.854378    0.000000
    0.854378   -0.519652    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.506291 XMAX =   -2.506291 XAVE =   -2.506291
    YMIN =    8.540431 YMAX =    8.540431 YAVE =    8.540431
    ZMIN =   23.301285 ZMAX =   23.301285 ZAVE =   23.301285
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.50629147"
Evaluating: -2.50629147+3.5
 Parameter: XMAX <- "0.99370853"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.54043097"
Evaluating: 8.54043097+3.5
 Parameter: YMAX <- "12.040431"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.3012853"
Evaluating: 23.3012853+3.5
 Parameter: ZMAX <- "26.8012853"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.50629147"
Evaluating: -2.50629147-3.5
 Parameter: XMIN <- "-6.00629147"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.54043097"
Evaluating: 8.54043097-3.5
 Parameter: YMIN <- "5.04043097"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.3012853"
Evaluating: 23.3012853-3.5
 Parameter: ZMIN <- "19.8012853"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.99370853"
 Parameter: XMIN -> "-6.00629147"
 Parameter: YMAX -> "12.040431"
 Parameter: YMIN -> "5.04043097"
 Parameter: ZMAX -> "26.8012853"
 Parameter: ZMIN -> "19.8012853"
 SELRPN>     31 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     16 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60439 NEG      CLA      90       CLA     -8131 PROD     THR      654      OG1           3.1777
60439 NEG      CLA      90       CLA     -8138 PROD     THR      654      O             3.7044
60439 NEG      CLA      90       CLA     -8152 PROD     GLU      655      C             3.5140
60439 NEG      CLA      90       CLA     -8153 PROD     GLU      655      O             3.5973
60439 NEG      CLA      90       CLA     -8154 PROD     GLU      656      N             2.8899
60439 NEG      CLA      90       CLA     -8156 PROD     GLU      656      CA            2.1994
60439 NEG      CLA      90       CLA     -8158 PROD     GLU      656      CB            2.6993
60439 NEG      CLA      90       CLA     -8161 PROD     GLU      656      CG            3.3716
60439 NEG      CLA      90       CLA     -8167 PROD     GLU      656      C             1.2089
60439 NEG      CLA      90       CLA     -8168 PROD     GLU      656      O             2.2054
60439 NEG      CLA      90       CLA     -8169 PROD     ARG      657      N             0.6498
60439 NEG      CLA      90       CLA     -8171 PROD     ARG      657      CA            1.8552
60439 NEG      CLA      90       CLA     -8173 PROD     ARG      657      CB            2.8059
60439 NEG      CLA      90       CLA     -8179 PROD     ARG      657      CD            4.5597
60439 NEG      CLA      90       CLA     -8191 PROD     ARG      657      C             3.0373
60439 NEG      CLA      90       CLA     -8193 PROD     ARG      658      N             3.5237
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "207" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "117"
Evaluating: 207-117
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.305718001"
Evaluating: 128.065641*(0.305718001-0.5)
 Parameter: XPOS <- "-24.8808487"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.906744316"
Evaluating: 128.065641*(0.906744316-0.5)
 Parameter: YPOS <- "52.0899716"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.923495166"
Evaluating: 108.613069*(0.923495166-0.5)+-2.187274
 Parameter: ZPOS <- "43.8098357"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.8098357" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.8098357" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.506291 XMAX =   -2.506291 XAVE =   -2.506291
    YMIN =    8.540431 YMAX =    8.540431 YAVE =    8.540431
    ZMIN =   23.301285 ZMAX =   23.301285 ZAVE =   23.301285
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.8808487"
 RDCMND substituted energy or value "?XAVE" to "-2.50629147"
Evaluating: -24.8808487--2.50629147
 Parameter: XTRAN <- "-22.3745572"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.0899716"
 RDCMND substituted energy or value "?YAVE" to "8.54043097"
Evaluating: 52.0899716-8.54043097
 Parameter: YTRAN <- "43.5495406"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.8098357"
 RDCMND substituted energy or value "?ZAVE" to "23.3012853"
Evaluating: 43.8098357-23.3012853
 Parameter: ZTRAN <- "20.5085504"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.3745572"
 Parameter: YTRAN -> "43.5495406"
 Parameter: ZTRAN -> "20.5085504"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -22.374557   43.549541   20.508550
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.636200781E-02"
Evaluating: 9.636200781E-02*360.0
 Parameter: XPHI <- "34.6903228"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84045226"
Evaluating: 0.84045226*360.0
 Parameter: YPHI <- "302.562814"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815955591"
Evaluating: 0.815955591*360.0
 Parameter: ZPHI <- "293.744013"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.8808487"
 Parameter: YPOS -> "52.0899716"
 Parameter: ZPOS -> "43.8098357"
 Parameter: XPHI -> "34.6903228"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.822240    0.569141
    0.000000   -0.569141    0.822240

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.8808487"
 Parameter: YPOS -> "52.0899716"
 Parameter: ZPOS -> "43.8098357"
 Parameter: YPHI -> "302.562814"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.538224    0.000000    0.842802
    0.000000    1.000000    0.000000
   -0.842802    0.000000    0.538224

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.8808487"
 Parameter: YPOS -> "52.0899716"
 Parameter: ZPOS -> "43.8098357"
 Parameter: ZPHI -> "293.744013"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.402651   -0.915354    0.000000
    0.915354    0.402651    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.880849 XMAX =  -24.880849 XAVE =  -24.880849
    YMIN =   52.089972 YMAX =   52.089972 YAVE =   52.089972
    ZMIN =   43.809836 ZMAX =   43.809836 ZAVE =   43.809836
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.8808487"
Evaluating: -24.8808487+3.5
 Parameter: XMAX <- "-21.3808487"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.0899716"
Evaluating: 52.0899716+3.5
 Parameter: YMAX <- "55.5899716"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.8098357"
Evaluating: 43.8098357+3.5
 Parameter: ZMAX <- "47.3098357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.8808487"
Evaluating: -24.8808487-3.5
 Parameter: XMIN <- "-28.3808487"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.0899716"
Evaluating: 52.0899716-3.5
 Parameter: YMIN <- "48.5899716"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.8098357"
Evaluating: 43.8098357-3.5
 Parameter: ZMIN <- "40.3098357"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.3808487"
 Parameter: XMIN -> "-28.3808487"
 Parameter: YMAX -> "55.5899716"
 Parameter: YMIN -> "48.5899716"
 Parameter: ZMAX -> "47.3098357"
 Parameter: ZMIN -> "40.3098357"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "208"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "208" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "208" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "117"
Evaluating: 208-117
 Parameter: J <- "91"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.514961051"
Evaluating: 128.065641*(0.514961051-0.5)
 Parameter: XPOS <- "1.91599659"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.397801583"
Evaluating: 128.065641*(0.397801583-0.5)
 Parameter: YPOS <- "-13.0881058"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.488422635"
Evaluating: 108.613069*(0.488422635-0.5)+-2.187274
 Parameter: ZPOS <- "-3.44472714"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.44472714" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.44472714" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "208" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "117"
Evaluating: 208-117
 Parameter: J <- "91"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.917777034"
Evaluating: 128.065641*(0.917777034-0.5)
 Parameter: XPOS <- "53.5028837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.139330153"
Evaluating: 128.065641*(0.139330153-0.5)
 Parameter: YPOS <- "-46.1894151"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "4.41780118E-02"
Evaluating: 108.613069*(4.41780118E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-51.6954991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.6954991" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.5028837"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.5028837-0
 Parameter: XTRAN <- "53.5028837"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.1894151"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.1894151-0
 Parameter: YTRAN <- "-46.1894151"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.6954991"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.6954991-0
 Parameter: ZTRAN <- "-51.6954991"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.5028837"
 Parameter: YTRAN -> "-46.1894151"
 Parameter: ZTRAN -> "-51.6954991"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    53.502884  -46.189415  -51.695499
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.116286181"
Evaluating: 0.116286181*360.0
 Parameter: XPHI <- "41.8630252"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193873576"
Evaluating: 0.193873576*360.0
 Parameter: YPHI <- "69.7944874"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846789987"
Evaluating: 0.846789987*360.0
 Parameter: ZPHI <- "304.844395"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.5028837"
 Parameter: YPOS -> "-46.1894151"
 Parameter: ZPOS -> "-51.6954991"
 Parameter: XPHI -> "41.8630252"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.744742    0.667352
    0.000000   -0.667352    0.744742

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.5028837"
 Parameter: YPOS -> "-46.1894151"
 Parameter: ZPOS -> "-51.6954991"
 Parameter: YPHI -> "69.7944874"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.345388    0.000000   -0.938460
    0.000000    1.000000    0.000000
    0.938460    0.000000    0.345388

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.5028837"
 Parameter: YPOS -> "-46.1894151"
 Parameter: ZPOS -> "-51.6954991"
 Parameter: ZPHI -> "304.844395"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.571350   -0.820707    0.000000
    0.820707    0.571350    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.502884 XMAX =   53.502884 XAVE =   53.502884
    YMIN =  -46.189415 YMAX =  -46.189415 YAVE =  -46.189415
    ZMIN =  -51.695499 ZMAX =  -51.695499 ZAVE =  -51.695499
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.5028837"
Evaluating: 53.5028837+3.5
 Parameter: XMAX <- "57.0028837"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.1894151"
Evaluating: -46.1894151+3.5
 Parameter: YMAX <- "-42.6894151"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.6954991"
Evaluating: -51.6954991+3.5
 Parameter: ZMAX <- "-48.1954991"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.5028837"
Evaluating: 53.5028837-3.5
 Parameter: XMIN <- "50.0028837"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.1894151"
Evaluating: -46.1894151-3.5
 Parameter: YMIN <- "-49.6894151"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.6954991"
Evaluating: -51.6954991-3.5
 Parameter: ZMIN <- "-55.1954991"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.0028837"
 Parameter: XMIN -> "50.0028837"
 Parameter: YMAX -> "-42.6894151"
 Parameter: YMIN -> "-49.6894151"
 Parameter: ZMAX -> "-48.1954991"
 Parameter: ZMIN -> "-55.1954991"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      1 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "209"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "209" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "209"
Evaluating: 209
 Parameter: J <- "209"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "209" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "209"
 Parameter: NPOS -> "117"
Evaluating: 209-117
 Parameter: J <- "92"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.678884767"
Evaluating: 128.065641*(0.678884767-0.5)
 Parameter: XPOS <- "22.9089924"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.25210559"
Evaluating: 128.065641*(0.25210559-0.5)
 Parameter: YPOS <- "-31.7467565"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.907872847"
Evaluating: 108.613069*(0.907872847-0.5)+-2.187274
 Parameter: ZPOS <- "42.1130477"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.1130477" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.1130477" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.9089924"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.9089924-0
 Parameter: XTRAN <- "22.9089924"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7467565"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.7467565-0
 Parameter: YTRAN <- "-31.7467565"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.1130477"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.1130477-0
 Parameter: ZTRAN <- "42.1130477"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.9089924"
 Parameter: YTRAN -> "-31.7467565"
 Parameter: ZTRAN -> "42.1130477"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    22.908992  -31.746757   42.113048
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.174652968E-02"
Evaluating: 3.174652968E-02*360.0
 Parameter: XPHI <- "11.4287507"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.29901084"
Evaluating: 0.29901084*360.0
 Parameter: YPHI <- "107.643902"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313386353"
Evaluating: 0.313386353*360.0
 Parameter: ZPHI <- "112.819087"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.9089924"
 Parameter: YPOS -> "-31.7467565"
 Parameter: ZPOS -> "42.1130477"
 Parameter: XPHI -> "11.4287507"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980172    0.198149
    0.000000   -0.198149    0.980172

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.9089924"
 Parameter: YPOS -> "-31.7467565"
 Parameter: ZPOS -> "42.1130477"
 Parameter: YPHI -> "107.643902"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.303100    0.000000   -0.952959
    0.000000    1.000000    0.000000
    0.952959    0.000000   -0.303100

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.9089924"
 Parameter: YPOS -> "-31.7467565"
 Parameter: ZPOS -> "42.1130477"
 Parameter: ZPHI -> "112.819087"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.387823    0.921734    0.000000
   -0.921734   -0.387823    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.908992 XMAX =   22.908992 XAVE =   22.908992
    YMIN =  -31.746757 YMAX =  -31.746757 YAVE =  -31.746757
    ZMIN =   42.113048 ZMAX =   42.113048 ZAVE =   42.113048
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.9089924"
Evaluating: 22.9089924+3.5
 Parameter: XMAX <- "26.4089924"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7467565"
Evaluating: -31.7467565+3.5
 Parameter: YMAX <- "-28.2467565"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.1130477"
Evaluating: 42.1130477+3.5
 Parameter: ZMAX <- "45.6130477"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.9089924"
Evaluating: 22.9089924-3.5
 Parameter: XMIN <- "19.4089924"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7467565"
Evaluating: -31.7467565-3.5
 Parameter: YMIN <- "-35.2467565"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.1130477"
Evaluating: 42.1130477-3.5
 Parameter: ZMIN <- "38.6130477"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.4089924"
 Parameter: XMIN -> "19.4089924"
 Parameter: YMAX -> "-28.2467565"
 Parameter: YMIN -> "-35.2467565"
 Parameter: ZMAX -> "45.6130477"
 Parameter: ZMIN -> "38.6130477"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "210"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "210" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "210" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "117"
Evaluating: 210-117
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.71195864"
Evaluating: 128.065641*(0.71195864-0.5)
 Parameter: XPOS <- "27.1446191"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.785162711"
Evaluating: 128.065641*(0.785162711-0.5)
 Parameter: YPOS <- "36.5195454"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.538344731"
Evaluating: 108.613069*(0.538344731-0.5)+-2.187274
 Parameter: ZPOS <- "1.97746491"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.97746491" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.97746491" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "210" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "117"
Evaluating: 210-117
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.291819219"
Evaluating: 128.065641*(0.291819219-0.5)
 Parameter: XPOS <- "-26.6608052"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.68869902"
Evaluating: 128.065641*(0.68869902-0.5)
 Parameter: YPOS <- "24.165861"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.432292731"
Evaluating: 108.613069*(0.432292731-0.5)+-2.187274
 Parameter: ZPOS <- "-9.54116828"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.54116828" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.54116828" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "210" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "117"
Evaluating: 210-117
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.811119386"
Evaluating: 128.065641*(0.811119386-0.5)
 Parameter: XPOS <- "39.8437036"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.731999052"
Evaluating: 128.065641*(0.731999052-0.5)
 Parameter: YPOS <- "29.7111073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.925644402"
Evaluating: 108.613069*(0.925644402-0.5)+-2.187274
 Parameter: ZPOS <- "44.0432708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.0432708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.0432708" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8437036"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8437036-0
 Parameter: XTRAN <- "39.8437036"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.7111073"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.7111073-0
 Parameter: YTRAN <- "29.7111073"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.0432708"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.0432708-0
 Parameter: ZTRAN <- "44.0432708"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8437036"
 Parameter: YTRAN -> "29.7111073"
 Parameter: ZTRAN -> "44.0432708"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    39.843704   29.711107   44.043271
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.013177272E-02"
Evaluating: 1.013177272E-02*360.0
 Parameter: XPHI <- "3.64743818"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.558061051"
Evaluating: 0.558061051*360.0
 Parameter: YPHI <- "200.901978"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.390384181E-02"
Evaluating: 9.390384181E-02*360.0
 Parameter: ZPHI <- "33.8053831"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8437036"
 Parameter: YPOS -> "29.7111073"
 Parameter: ZPOS -> "44.0432708"
 Parameter: XPHI -> "3.64743818"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997974    0.063617
    0.000000   -0.063617    0.997974

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8437036"
 Parameter: YPOS -> "29.7111073"
 Parameter: ZPOS -> "44.0432708"
 Parameter: YPHI -> "200.901978"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.934192    0.000000    0.356770
    0.000000    1.000000    0.000000
   -0.356770    0.000000   -0.934192

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  159.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8437036"
 Parameter: YPOS -> "29.7111073"
 Parameter: ZPOS -> "44.0432708"
 Parameter: ZPHI -> "33.8053831"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.830932    0.556374    0.000000
   -0.556374    0.830932    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   33.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.843704 XMAX =   39.843704 XAVE =   39.843704
    YMIN =   29.711107 YMAX =   29.711107 YAVE =   29.711107
    ZMIN =   44.043271 ZMAX =   44.043271 ZAVE =   44.043271
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8437036"
Evaluating: 39.8437036+3.5
 Parameter: XMAX <- "43.3437036"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.7111073"
Evaluating: 29.7111073+3.5
 Parameter: YMAX <- "33.2111073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.0432708"
Evaluating: 44.0432708+3.5
 Parameter: ZMAX <- "47.5432708"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8437036"
Evaluating: 39.8437036-3.5
 Parameter: XMIN <- "36.3437036"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.7111073"
Evaluating: 29.7111073-3.5
 Parameter: YMIN <- "26.2111073"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.0432708"
Evaluating: 44.0432708-3.5
 Parameter: ZMIN <- "40.5432708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3437036"
 Parameter: XMIN -> "36.3437036"
 Parameter: YMAX -> "33.2111073"
 Parameter: YMIN -> "26.2111073"
 Parameter: ZMAX -> "47.5432708"
 Parameter: ZMIN -> "40.5432708"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "211"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "211" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "211"
Evaluating: 211
 Parameter: J <- "211"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "211" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "211"
 Parameter: NPOS -> "117"
Evaluating: 211-117
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.465831007"
Evaluating: 128.065641*(0.465831007-0.5)
 Parameter: XPOS <- "-4.37587399"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.51774214"
Evaluating: 128.065641*(0.51774214-0.5)
 Parameter: YPOS <- "2.27215853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.698712569"
Evaluating: 108.613069*(0.698712569-0.5)+-2.187274
 Parameter: ZPOS <- "19.395508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.395508" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.395508" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.37587399"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.37587399-0
 Parameter: XTRAN <- "-4.37587399"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.27215853"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.27215853-0
 Parameter: YTRAN <- "2.27215853"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.395508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.395508-0
 Parameter: ZTRAN <- "19.395508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.37587399"
 Parameter: YTRAN -> "2.27215853"
 Parameter: ZTRAN -> "19.395508"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -4.375874    2.272159   19.395508
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888197541"
Evaluating: 0.888197541*360.0
 Parameter: XPHI <- "319.751115"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.124440482"
Evaluating: 0.124440482*360.0
 Parameter: YPHI <- "44.7985735"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.573435331"
Evaluating: 0.573435331*360.0
 Parameter: ZPHI <- "206.436719"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.37587399"
 Parameter: YPOS -> "2.27215853"
 Parameter: ZPOS -> "19.395508"
 Parameter: XPHI -> "319.751115"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.763245   -0.646109
    0.000000    0.646109    0.763245

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.37587399"
 Parameter: YPOS -> "2.27215853"
 Parameter: ZPOS -> "19.395508"
 Parameter: YPHI -> "44.7985735"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.709588    0.000000   -0.704617
    0.000000    1.000000    0.000000
    0.704617    0.000000    0.709588

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.37587399"
 Parameter: YPOS -> "2.27215853"
 Parameter: ZPOS -> "19.395508"
 Parameter: ZPHI -> "206.436719"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.895427   -0.445209    0.000000
    0.445209   -0.895427    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.375874 XMAX =   -4.375874 XAVE =   -4.375874
    YMIN =    2.272159 YMAX =    2.272159 YAVE =    2.272159
    ZMIN =   19.395508 ZMAX =   19.395508 ZAVE =   19.395508
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.37587399"
Evaluating: -4.37587399+3.5
 Parameter: XMAX <- "-0.87587399"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.27215853"
Evaluating: 2.27215853+3.5
 Parameter: YMAX <- "5.77215853"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.395508"
Evaluating: 19.395508+3.5
 Parameter: ZMAX <- "22.895508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.37587399"
Evaluating: -4.37587399-3.5
 Parameter: XMIN <- "-7.87587399"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.27215853"
Evaluating: 2.27215853-3.5
 Parameter: YMIN <- "-1.22784147"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.395508"
Evaluating: 19.395508-3.5
 Parameter: ZMIN <- "15.895508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.87587399"
 Parameter: XMIN -> "-7.87587399"
 Parameter: YMAX -> "5.77215853"
 Parameter: YMIN -> "-1.22784147"
 Parameter: ZMAX -> "22.895508"
 Parameter: ZMIN -> "15.895508"
 SELRPN>     38 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>     18 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60443 NEG      CLA      94       CLA     -7331 PROD     SER      605      CB            4.9602
60443 NEG      CLA      94       CLA     -7337 PROD     SER      605      O             3.7641
60443 NEG      CLA      94       CLA     -8063 PROD     PHE      650      CG            3.8311
60443 NEG      CLA      94       CLA     -8064 PROD     PHE      650      CD1           3.3058
60443 NEG      CLA      94       CLA     -8066 PROD     PHE      650      CE1           2.0717
60443 NEG      CLA      94       CLA     -8068 PROD     PHE      650      CZ            1.1318
60443 NEG      CLA      94       CLA     -8070 PROD     PHE      650      CD2           3.3995
60443 NEG      CLA      94       CLA     -8072 PROD     PHE      650      CE2           2.2283
60443 NEG      CLA      94       CLA     -8191 PROD     ARG      657      C             4.9106
60443 NEG      CLA      94       CLA     -8192 PROD     ARG      657      O             4.6956
60443 NEG      CLA      94       CLA     -8193 PROD     ARG      658      N             4.1688
60443 NEG      CLA      94       CLA     -8195 PROD     ARG      658      CA            2.7398
60443 NEG      CLA      94       CLA     -8197 PROD     ARG      658      CB            2.7479
60443 NEG      CLA      94       CLA     -8200 PROD     ARG      658      CG            3.5941
60443 NEG      CLA      94       CLA     -8215 PROD     ARG      658      C             2.9588
60443 NEG      CLA      94       CLA     -8216 PROD     ARG      658      O             2.6694
60443 NEG      CLA      94       CLA     -8262 PROD     LEU      662      CB            4.7300
60443 NEG      CLA      94       CLA     -8265 PROD     LEU      662      CG            3.8146
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        18
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "211"
Evaluating: 211
 Parameter: J <- "211"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "211" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "211"
 Parameter: NPOS -> "117"
Evaluating: 211-117
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.902206743"
Evaluating: 128.065641*(0.902206743-0.5)
 Parameter: XPOS <- "51.5088644"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.739072889"
Evaluating: 128.065641*(0.739072889-0.5)
 Parameter: YPOS <- "30.6170228"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.365070062"
Evaluating: 108.613069*(0.365070062-0.5)+-2.187274
 Parameter: ZPOS <- "-16.8424287"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.8424287" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.375874 XMAX =   -4.375874 XAVE =   -4.375874
    YMIN =    2.272159 YMAX =    2.272159 YAVE =    2.272159
    ZMIN =   19.395508 ZMAX =   19.395508 ZAVE =   19.395508
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.5088644"
 RDCMND substituted energy or value "?XAVE" to "-4.37587399"
Evaluating: 51.5088644--4.37587399
 Parameter: XTRAN <- "55.8847384"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.6170228"
 RDCMND substituted energy or value "?YAVE" to "2.27215853"
Evaluating: 30.6170228-2.27215853
 Parameter: YTRAN <- "28.3448643"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.8424287"
 RDCMND substituted energy or value "?ZAVE" to "19.395508"
Evaluating: -16.8424287-19.395508
 Parameter: ZTRAN <- "-36.2379367"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.8847384"
 Parameter: YTRAN -> "28.3448643"
 Parameter: ZTRAN -> "-36.2379367"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    55.884738   28.344864  -36.237937
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371749888"
Evaluating: 0.371749888*360.0
 Parameter: XPHI <- "133.82996"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172201013"
Evaluating: 0.172201013*360.0
 Parameter: YPHI <- "61.9923647"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.411831463E-02"
Evaluating: 4.411831463E-02*360.0
 Parameter: ZPHI <- "15.8825933"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.5088644"
 Parameter: YPOS -> "30.6170228"
 Parameter: ZPOS -> "-16.8424287"
 Parameter: XPHI -> "133.82996"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.692520    0.721398
    0.000000   -0.721398   -0.692520

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.5088644"
 Parameter: YPOS -> "30.6170228"
 Parameter: ZPOS -> "-16.8424287"
 Parameter: YPHI -> "61.9923647"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.469589    0.000000   -0.882885
    0.000000    1.000000    0.000000
    0.882885    0.000000    0.469589

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.5088644"
 Parameter: YPOS -> "30.6170228"
 Parameter: ZPOS -> "-16.8424287"
 Parameter: ZPHI -> "15.8825933"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.961824    0.273667    0.000000
   -0.273667    0.961824    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   15.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.508864 XMAX =   51.508864 XAVE =   51.508864
    YMIN =   30.617023 YMAX =   30.617023 YAVE =   30.617023
    ZMIN =  -16.842429 ZMAX =  -16.842429 ZAVE =  -16.842429
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.5088644"
Evaluating: 51.5088644+3.5
 Parameter: XMAX <- "55.0088644"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.6170228"
Evaluating: 30.6170228+3.5
 Parameter: YMAX <- "34.1170228"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.8424287"
Evaluating: -16.8424287+3.5
 Parameter: ZMAX <- "-13.3424287"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.5088644"
Evaluating: 51.5088644-3.5
 Parameter: XMIN <- "48.0088644"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.6170228"
Evaluating: 30.6170228-3.5
 Parameter: YMIN <- "27.1170228"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.8424287"
Evaluating: -16.8424287-3.5
 Parameter: ZMIN <- "-20.3424287"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.0088644"
 Parameter: XMIN -> "48.0088644"
 Parameter: YMAX -> "34.1170228"
 Parameter: YMIN -> "27.1170228"
 Parameter: ZMAX -> "-13.3424287"
 Parameter: ZMIN -> "-20.3424287"
 SELRPN>     11 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      6 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
60443 NEG      CLA      94       CLA     -**** MEMB     DMPC     223      O13           2.9750
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "211"
Evaluating: 211
 Parameter: J <- "211"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "211" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "211"
 Parameter: NPOS -> "117"
Evaluating: 211-117
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.188759333"
Evaluating: 128.065641*(0.188759333-0.5)
 Parameter: XPOS <- "-39.8592355"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.415486314"
Evaluating: 128.065641*(0.415486314-0.5)
 Parameter: YPOS <- "-10.8232994"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "3.051097862E-02"
Evaluating: 108.613069*(3.051097862E-02-0.5)+-2.187274
 Parameter: ZPOS <- "-53.1799175"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.1799175" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.508864 XMAX =   51.508864 XAVE =   51.508864
    YMIN =   30.617023 YMAX =   30.617023 YAVE =   30.617023
    ZMIN =  -16.842429 ZMAX =  -16.842429 ZAVE =  -16.842429
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.8592355"
 RDCMND substituted energy or value "?XAVE" to "51.5088644"
Evaluating: -39.8592355-51.5088644
 Parameter: XTRAN <- "-91.3680999"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.8232994"
 RDCMND substituted energy or value "?YAVE" to "30.6170228"
Evaluating: -10.8232994-30.6170228
 Parameter: YTRAN <- "-41.4403222"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.1799175"
 RDCMND substituted energy or value "?ZAVE" to "-16.8424287"
Evaluating: -53.1799175--16.8424287
 Parameter: ZTRAN <- "-36.3374888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-91.3680999"
 Parameter: YTRAN -> "-41.4403222"
 Parameter: ZTRAN -> "-36.3374888"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR   -91.368100  -41.440322  -36.337489
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431840775"
Evaluating: 0.431840775*360.0
 Parameter: XPHI <- "155.462679"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670639451"
Evaluating: 0.670639451*360.0
 Parameter: YPHI <- "241.430202"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246830894"
Evaluating: 0.246830894*360.0
 Parameter: ZPHI <- "88.8591218"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.8592355"
 Parameter: YPOS -> "-10.8232994"
 Parameter: ZPOS -> "-53.1799175"
 Parameter: XPHI -> "155.462679"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.909691    0.415286
    0.000000   -0.415286   -0.909691

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.8592355"
 Parameter: YPOS -> "-10.8232994"
 Parameter: ZPOS -> "-53.1799175"
 Parameter: YPHI -> "241.430202"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.478229    0.000000    0.878235
    0.000000    1.000000    0.000000
   -0.878235    0.000000   -0.478229

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.8592355"
 Parameter: YPOS -> "-10.8232994"
 Parameter: ZPOS -> "-53.1799175"
 Parameter: ZPHI -> "88.8591218"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.019911    0.999802    0.000000
   -0.999802    0.019911    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.859235 XMAX =  -39.859235 XAVE =  -39.859235
    YMIN =  -10.823299 YMAX =  -10.823299 YAVE =  -10.823299
    ZMIN =  -53.179918 ZMAX =  -53.179918 ZAVE =  -53.179918
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.8592355"
Evaluating: -39.8592355+3.5
 Parameter: XMAX <- "-36.3592355"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.8232994"
Evaluating: -10.8232994+3.5
 Parameter: YMAX <- "-7.3232994"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.1799175"
Evaluating: -53.1799175+3.5
 Parameter: ZMAX <- "-49.6799175"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.8592355"
Evaluating: -39.8592355-3.5
 Parameter: XMIN <- "-43.3592355"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.8232994"
Evaluating: -10.8232994-3.5
 Parameter: YMIN <- "-14.3232994"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.1799175"
Evaluating: -53.1799175-3.5
 Parameter: ZMIN <- "-56.6799175"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.3592355"
 Parameter: XMIN -> "-43.3592355"
 Parameter: YMAX -> "-7.3232994"
 Parameter: YMIN -> "-14.3232994"
 Parameter: ZMAX -> "-49.6799175"
 Parameter: ZMIN -> "-56.6799175"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "212"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "212" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "212"
Evaluating: 212
 Parameter: J <- "212"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "212" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "212"
 Parameter: NPOS -> "117"
Evaluating: 212-117
 Parameter: J <- "95"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.442271278"
Evaluating: 128.065641*(0.442271278-0.5)
 Parameter: XPOS <- "-7.39306579"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.40461563"
Evaluating: 128.065641*(0.40461563-0.5)
 Parameter: YPOS <- "-12.2154605"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.31001168"
Evaluating: 108.613069*(0.31001168-0.5)+-2.187274
 Parameter: ZPOS <- "-22.8224885"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.8224885" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.39306579"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.39306579-0
 Parameter: XTRAN <- "-7.39306579"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.2154605"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.2154605-0
 Parameter: YTRAN <- "-12.2154605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.8224885"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.8224885-0
 Parameter: ZTRAN <- "-22.8224885"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.39306579"
 Parameter: YTRAN -> "-12.2154605"
 Parameter: ZTRAN -> "-22.8224885"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    -7.393066  -12.215461  -22.822488
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711661172"
Evaluating: 0.711661172*360.0
 Parameter: XPHI <- "256.198022"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780029284"
Evaluating: 0.780029284*360.0
 Parameter: YPHI <- "280.810542"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.421708511"
Evaluating: 0.421708511*360.0
 Parameter: ZPHI <- "151.815064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.39306579"
 Parameter: YPOS -> "-12.2154605"
 Parameter: ZPOS -> "-22.8224885"
 Parameter: XPHI -> "256.198022"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.238567   -0.971126
    0.000000    0.971126   -0.238567

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.39306579"
 Parameter: YPOS -> "-12.2154605"
 Parameter: ZPOS -> "-22.8224885"
 Parameter: YPHI -> "280.810542"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.187562    0.000000    0.982253
    0.000000    1.000000    0.000000
   -0.982253    0.000000    0.187562

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   79.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.39306579"
 Parameter: YPOS -> "-12.2154605"
 Parameter: ZPOS -> "-22.8224885"
 Parameter: ZPHI -> "151.815064"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.881428    0.472319    0.000000
   -0.472319   -0.881428    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.393066 XMAX =   -7.393066 XAVE =   -7.393066
    YMIN =  -12.215461 YMAX =  -12.215461 YAVE =  -12.215461
    ZMIN =  -22.822488 ZMAX =  -22.822488 ZAVE =  -22.822488
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.39306579"
Evaluating: -7.39306579+3.5
 Parameter: XMAX <- "-3.89306579"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.2154605"
Evaluating: -12.2154605+3.5
 Parameter: YMAX <- "-8.7154605"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.8224885"
Evaluating: -22.8224885+3.5
 Parameter: ZMAX <- "-19.3224885"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.39306579"
Evaluating: -7.39306579-3.5
 Parameter: XMIN <- "-10.8930658"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.2154605"
Evaluating: -12.2154605-3.5
 Parameter: YMIN <- "-15.7154605"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.8224885"
Evaluating: -22.8224885-3.5
 Parameter: ZMIN <- "-26.3224885"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.89306579"
 Parameter: XMIN -> "-10.8930658"
 Parameter: YMAX -> "-8.7154605"
 Parameter: YMIN -> "-15.7154605"
 Parameter: ZMAX -> "-19.3224885"
 Parameter: ZMIN -> "-26.3224885"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "213"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "213" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "213"
Evaluating: 213
 Parameter: J <- "213"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "213" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "213"
 Parameter: NPOS -> "117"
Evaluating: 213-117
 Parameter: J <- "96"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.657999802"
Evaluating: 128.065641*(0.657999802-0.5)
 Parameter: XPOS <- "20.2343459"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.289688873"
Evaluating: 128.065641*(0.289688873-0.5)
 Parameter: YPOS <- "-26.9336293"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.50664033"
Evaluating: 108.613069*(0.50664033-0.5)+-2.187274
 Parameter: ZPOS <- "-1.46604738"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.46604738" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.46604738" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "213"
Evaluating: 213
 Parameter: J <- "213"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "213" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "213"
 Parameter: NPOS -> "117"
Evaluating: 213-117
 Parameter: J <- "96"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.630062523"
Evaluating: 128.065641*(0.630062523-0.5)
 Parameter: XPOS <- "16.6565404"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.510938195"
Evaluating: 128.065641*(0.510938195-0.5)
 Parameter: YPOS <- "1.40080695"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.275285222"
Evaluating: 108.613069*(0.275285222-0.5)+-2.187274
 Parameter: ZPOS <- "-26.5942357"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.5942357" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.6565404"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.6565404-0
 Parameter: XTRAN <- "16.6565404"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.40080695"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.40080695-0
 Parameter: YTRAN <- "1.40080695"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.5942357"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.5942357-0
 Parameter: ZTRAN <- "-26.5942357"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.6565404"
 Parameter: YTRAN -> "1.40080695"
 Parameter: ZTRAN -> "-26.5942357"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    16.656540    1.400807  -26.594236
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877326866"
Evaluating: 0.877326866*360.0
 Parameter: XPHI <- "315.837672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878928262"
Evaluating: 0.878928262*360.0
 Parameter: YPHI <- "316.414174"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722409537"
Evaluating: 0.722409537*360.0
 Parameter: ZPHI <- "260.067433"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.6565404"
 Parameter: YPOS -> "1.40080695"
 Parameter: ZPOS -> "-26.5942357"
 Parameter: XPHI -> "315.837672"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.717369   -0.696694
    0.000000    0.696694    0.717369

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.6565404"
 Parameter: YPOS -> "1.40080695"
 Parameter: ZPOS -> "-26.5942357"
 Parameter: YPHI -> "316.414174"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.724342    0.000000    0.689440
    0.000000    1.000000    0.000000
   -0.689440    0.000000    0.724342

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.6565404"
 Parameter: YPOS -> "1.40080695"
 Parameter: ZPOS -> "-26.5942357"
 Parameter: ZPHI -> "260.067433"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.172489   -0.985011    0.000000
    0.985011   -0.172489    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.656540 XMAX =   16.656540 XAVE =   16.656540
    YMIN =    1.400807 YMAX =    1.400807 YAVE =    1.400807
    ZMIN =  -26.594236 ZMAX =  -26.594236 ZAVE =  -26.594236
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.6565404"
Evaluating: 16.6565404+3.5
 Parameter: XMAX <- "20.1565404"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.40080695"
Evaluating: 1.40080695+3.5
 Parameter: YMAX <- "4.90080695"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.5942357"
Evaluating: -26.5942357+3.5
 Parameter: ZMAX <- "-23.0942357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.6565404"
Evaluating: 16.6565404-3.5
 Parameter: XMIN <- "13.1565404"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.40080695"
Evaluating: 1.40080695-3.5
 Parameter: YMIN <- "-2.09919305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.5942357"
Evaluating: -26.5942357-3.5
 Parameter: ZMIN <- "-30.0942357"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.1565404"
 Parameter: XMIN -> "13.1565404"
 Parameter: YMAX -> "4.90080695"
 Parameter: YMIN -> "-2.09919305"
 Parameter: ZMAX -> "-23.0942357"
 Parameter: ZMIN -> "-30.0942357"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "214"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "214" and "214".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "214"
Evaluating: 214
 Parameter: J <- "214"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "117"
 Comparing "214" and "117".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "214"
 Parameter: NPOS -> "117"
Evaluating: 214-117
 Parameter: J <- "97"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.757879737"
Evaluating: 128.065641*(0.757879737-0.5)
 Parameter: XPOS <- "33.0255338"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "128.065641"
 RDCMND substituted energy or value "?RANDOM" to "0.381526929"
Evaluating: 128.065641*(0.381526929-0.5)
 Parameter: YPOS <- "-15.1723298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "108.613069"
 Parameter: ZCEN -> "-2.187274"
 RDCMND substituted energy or value "?RANDOM" to "0.991152548"
Evaluating: 108.613069*(0.991152548-0.5)+-2.187274
 Parameter: ZPOS <- "51.1583116"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.1583116" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.1583116" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.0255338"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.0255338-0
 Parameter: XTRAN <- "33.0255338"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.1723298"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.1723298-0
 Parameter: YTRAN <- "-15.1723298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.1583116"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.1583116-0
 Parameter: ZTRAN <- "51.1583116"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.0255338"
 Parameter: YTRAN -> "-15.1723298"
 Parameter: ZTRAN -> "51.1583116"
 SELRPN>      1 atoms have been selected out of  60446
 TRANSLATION VECTOR    33.025534  -15.172330   51.158312
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.27838572"
Evaluating: 0.27838572*360.0
 Parameter: XPHI <- "100.218859"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.740894635"
Evaluating: 0.740894635*360.0
 Parameter: YPHI <- "266.722069"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78045319"
Evaluating: 0.78045319*360.0
 Parameter: ZPHI <- "280.963148"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.0255338"
 Parameter: YPOS -> "-15.1723298"
 Parameter: ZPOS -> "51.1583116"
 Parameter: XPHI -> "100.218859"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.177409    0.984137
    0.000000   -0.984137   -0.177409

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.0255338"
 Parameter: YPOS -> "-15.1723298"
 Parameter: ZPOS -> "51.1583116"
 Parameter: YPHI -> "266.722069"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
   -0.057179    0.000000    0.998364
    0.000000    1.000000    0.000000
   -0.998364    0.000000   -0.057179

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   93.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.0255338"
 Parameter: YPOS -> "-15.1723298"
 Parameter: ZPOS -> "51.1583116"
 Parameter: ZPHI -> "280.963148"
 SELRPN>      1 atoms have been selected out of  60446
 ROTATION MATRIX
    0.190178   -0.981750    0.000000
    0.981750    0.190178    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   79.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  60446
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.025534 XMAX =   33.025534 XAVE =   33.025534
    YMIN =  -15.172330 YMAX =  -15.172330 YAVE =  -15.172330
    ZMIN =   51.158312 ZMAX =   51.158312 ZAVE =   51.158312
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.0255338"
Evaluating: 33.0255338+3.5
 Parameter: XMAX <- "36.5255338"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.1723298"
Evaluating: -15.1723298+3.5
 Parameter: YMAX <- "-11.6723298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.1583116"
Evaluating: 51.1583116+3.5
 Parameter: ZMAX <- "54.6583116"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.0255338"
Evaluating: 33.0255338-3.5
 Parameter: XMIN <- "29.5255338"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.1723298"
Evaluating: -15.1723298-3.5
 Parameter: YMIN <- "-18.6723298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.1583116"
Evaluating: 51.1583116-3.5
 Parameter: ZMIN <- "47.6583116"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.5255338"
 Parameter: XMIN -> "29.5255338"
 Parameter: YMAX -> "-11.6723298"
 Parameter: YMIN -> "-18.6723298"
 Parameter: ZMAX -> "54.6583116"
 Parameter: ZMIN -> "47.6583116"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  16808 atoms have been selected out of  60446
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16808"
 Comparing "16808" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  77321
 SELRPN>      0 atoms have been selected out of  77321

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "215"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "214"
 Comparing "215" and "214".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "117"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "97"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    117 atoms have been selected out of  60446
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "60233"
 Parameter: POSAT <- "60233"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     97 atoms have been selected out of  60446
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "60350"
 Parameter: NEGAT <- "60350"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "60350" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "60350"
 Comparing "60233" and "60350".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  60446
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>    117 atoms have been selected out of  60446
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "117"
 Parameter: NPOSATOMS <- "117"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     97 atoms have been selected out of  60446
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "97"
 Parameter: NNEGATOMS <- "97"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>    117 atoms have been selected out of  60446
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>    117 atoms have been selected out of  60446
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "117"
 Parameter: NIONATOMS <- "117"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "117" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "97" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =       10   Number of residues   =     1646
         Number of atoms         =    60446   Number of groups     =    15625
         Number of bonds         =    60004   Number of angles     =   113741
         Number of dihedrals     =   159806   Number of impropers  =     3528
         Number of cross-terms   =     1048   Number of autogens   =        0
         Number of HB acceptors  =     1636   Number of HB donors  =     1899
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:     6/ 2/24      0:11:22      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 60232 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-1.449507181E-12"
Evaluating: -1.449507181E-12
 Parameter: CGTOTINIT <- "-1.449507181E-12"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-1.449507181E-12"
Evaluating: INT(-1.449507181E-12)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-1.449507181E-12"
Evaluating: ABS(0--1.449507181E-12)
 Parameter: CGDIFF <- "1.449507181E-12"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "1.449507181E-12" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  60232 atoms have been selected out of  60446

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:       1432 residues deleted.

 Message from MAPIC:          9 segments deleted.
 DELTIC:     60004 bonds deleted
 DELTIC:    113741 angles deleted
 DELTIC:    159806 dihedrals deleted
 DELTIC:      3528 improper dihedrals deleted
 DELTIC:      1048 crossterm maps deleted
 DELTIC:      1899 donors deleted
 DELTIC:      1636 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      214
         Number of atoms         =      214   Number of groups     =      214
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   20.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 117
 RDTITL> * SET NNEGTOT = 97
 RDTITL> * SET NIONTOT = 214
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     33.81 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    33.81  SECONDS 
                         CPU TIME:    24.24  SECONDS 
